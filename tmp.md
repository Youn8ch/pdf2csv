## Page 1

华为云
Stack
8.1.0
故障管理
文档版本
09
发布日期
2023-10-13
华为技术有限公司

## Page 2

版权所有
©
华为技术有限公司 2023。 保留一切权利。
非经本公司书面许可，任何单位和个人不得擅自摘抄、复制本文档内容的部分或全部，并不得以任何形式传
播。
商标声明
和其他华为商标均为华为技术有限公司的商标。
本文档提及的其他所有商标或注册商标，由各自的所有人拥有。
注意
您购买的产品、服务或特性等应受华为公司商业合同和条款的约束，本文档中描述的全部或部分产品、服务或
特性可能不在您的购买或使用范围之内。除非合同另有约定，华为公司对本文档内容不做任何明示或暗示的声
明或保证。
由于产品版本升级或其他原因，本文档内容会不定期进行更新。除非另有约定，本文档仅作为使用指导，本文
档中的所有陈述、信息和建议不构成任何明示或暗示的担保。
华为技术有限公司
地址： 深圳市龙岗区坂田华为总部办公楼 邮编：518129
网址：
https://e.huawei.com

## Page 3

前言
概述
本文档详细的描述了华为云Stack告警参考和故障处理的操作指导，提供各部件的告警
信息和对应的处理方法、常见的问题解答及故障处理方法，指导系统维护人员及时处
理系统告警和故障，使系统恢复正常运行状态。
读者对象
本文档主要适用于以下工程师：
●
技术支持工程师
●
维护工程师
符号约定
在本文中可能出现下列标志，它们所代表的含义如下。
符号 说明
表示如不避免则将会导致死亡或严重伤害的具有高等级风险的危
害。
表示如不避免则可能导致死亡或严重伤害的具有中等级风险的危
害。
表示如不避免则可能导致轻微或中度伤害的具有低等级风险的危
害。
用于传递设备或环境安全警示信息。如不避免则可能会导致设备
损坏、数据丢失、设备性能降低或其它不可预知的结果。
“须知”不涉及人身伤害。
对正文中重点信息的补充说明。
“说明”不是安全警示信息，不涉及人身、设备及环境伤害信
息。

## Page 4

修改记录
文档版本 发布日期 修改说明
09 2023-10-13
第九次正式发布。
刷新1.4.1.2.2 ALM-48305-证书已经过
期。
08 2023-04-14
第八次正式发布。
修改：
刷新1.4.1.1.5 ALM-48117-无法正常接收
Opsagent心跳章节。
07 2022-11-11
第七次正式发布。
●
优化1.3.12.5.1
ALM-
servicemonitor_rabbit_mq_status
RabbitMQ集群状态异常。
●
新增3.41 如何开启调用链功能。
06 2022-08-26
第六次正式发布。
修改2.5.7.17 安装MOICAgent异常的步骤
2、步骤3。

## Page 5

文档版本 发布日期 修改说明
05 2022-04-13
第五次正式发布。
新增：
●
新增1.2.3.1.45 drextend-agent组件故
障处理。
●
新增1.2.3.1.46 drextend-api组件故障
处理。
修改：
● 1.3.1.98 ALM-000B00020000004D
资
源性能断采章节修改告警处理步骤。
● 1.3.19.1 ALM-0001000300030003
Elasticsearch索引个数超限章节和
1.3.19.2 ALM-0001000300030004
Elasticsearch集群状态异常章节添加参
考信息。
● 1.3.12.5.1 ALM-
servicemonitor_rabbit_mq_status
RabbitMQ集群状态异常章节修改查看
进程状态的命令。
● 1.3.23
URL拨测章节修改查看定位信息
和告警可能原因步骤。
● 1.3.22.1 ALM-1001001004
计量话单文
件磁盘配额使用率超阈值章节增加告警
参数信息。
●
新增1.3.12.1.18
ALM-
servicemonitor_os.disk.io_util
硬盘IO
操作时间占比阈值告警。
●
新增1.3.12.1.19
ALM-
servicemonitor_fhcount_percent_ala
rm
文件句柄使用率告警。
●
调整1.3.25.1
ALM-10000011
ManageOne管理资源超过部署规格限
制的父目录。
04 2021-12-03
第四次正式发布。
增加HiCloud服务相关内容。
03 2021-10-30
第三次正式发布。
02 2021-10-15
第二次正式发布。
01 2021-09-30
第一次正式发布。

## Page 6

目 录
前言.................................................................................................................................................ii
1
告警参考......................................................................................................................................1
1.1
告警监控......................................................................................................................................................................................1
1.1.1
简介...........................................................................................................................................................................................1
1.1.1.1
什么是告警监控..................................................................................................................................................................1
1.1.1.2
价值描述...............................................................................................................................................................................5
1.1.1.3
应用场景...............................................................................................................................................................................6
1.1.1.4
功能介绍...............................................................................................................................................................................7
1.1.1.5
实现逻辑............................................................................................................................................................................12
1.1.2
使用流程................................................................................................................................................................................17
1.1.3
监控和查看告警/事件........................................................................................................................................................19
1.1.3.1
监控和查看当前告警.......................................................................................................................................................19
1.1.3.2
查看告警日志....................................................................................................................................................................21
1.1.3.3
查看事件日志....................................................................................................................................................................22
1.1.4
处理告警................................................................................................................................................................................25
1.1.5
分析告警................................................................................................................................................................................28
1.1.5.1
查看历史告警和被屏蔽告警..........................................................................................................................................28
1.1.5.2
分析历史告警....................................................................................................................................................................30
1.1.6
配置告警................................................................................................................................................................................30
1.1.6.1 设置告警/事件颜色.........................................................................................................................................................30
1.1.6.2 设置告警展示方式...........................................................................................................................................................31
1.1.6.3 设置告警声音....................................................................................................................................................................31
1.1.6.4 设置告警字体颜色...........................................................................................................................................................32
1.1.6.5
设置告警高亮显示...........................................................................................................................................................32
1.1.6.6
配置屏蔽规则....................................................................................................................................................................33
1.1.6.7
配置闪断/振荡规则.........................................................................................................................................................36
1.1.6.8
配置汇聚规则....................................................................................................................................................................38
1.1.6.9
配置相关性规则...............................................................................................................................................................42
1.1.6.10
配置自动确认规则.........................................................................................................................................................45
1.1.6.11
配置级别和类型重定义规则.......................................................................................................................................47
1.1.6.12
配置名称重定义规则....................................................................................................................................................49
1.1.6.13
配置标识规则.................................................................................................................................................................50
1.1.6.14
配置事件转ADMC告警..............................................................................................................................................52

## Page 7

1.1.6.15
设置告警/事件名称组...................................................................................................................................................53
1.1.6.16
配置远程通知规则.........................................................................................................................................................53
1.1.6.17
配置通知内容模板.........................................................................................................................................................56
1.1.6.18
手动同步告警.................................................................................................................................................................57
1.1.6.19
维护经验管理.................................................................................................................................................................57
1.1.6.20
设置当前告警阈值提示................................................................................................................................................58
1.1.6.21
配置告警静态信息.........................................................................................................................................................59
1.1.6.22
配置告警/事件手工转储任务......................................................................................................................................60
1.1.6.23
手动同步CMA告警......................................................................................................................................................63
1.1.7
告警监控参考.......................................................................................................................................................................64
1.1.7.1
参数说明：监控和查看告警..........................................................................................................................................64
1.1.8 FAQs.......................................................................................................................................................................................74
1.1.8.1
当前告警界面操作技巧..................................................................................................................................................74
1.1.8.2
被屏蔽告警和事件是否可以批量导出........................................................................................................................74
1.1.8.3
如何处理Firefox下停止告警声音不生效的问题.....................................................................................................75
1.1.8.4
如何查看告警在VMware中的告警级别...................................................................................................................75
1.1.8.5
为何告警管理系统上的告警比第三方系统多...........................................................................................................75
1.1.8.6
为什么告警信息中的确认用户或清除用户显示为<系统>.....................................................................................76
1.1.8.7
为什么告警信息中的清除用户显示为<网元>...........................................................................................................76
1.1.8.8
如何屏蔽指定告警...........................................................................................................................................................77
1.1.8.9
为什么告警上报会延时..................................................................................................................................................77
1.1.8.10
如何自定义当前告警或历史告警的显示列信息....................................................................................................77
1.1.8.11
为什么按网元时间查询告警时部分告警查询不到................................................................................................78
1.1.8.12
为什么查询或转储告警的结果中包含不在查询时间范围内的告警..................................................................78
1.1.8.13
为什么使用Chrome浏览器查看当前告警页面无法听到告警提示音.............................................................79
1.1.8.14
如何处理Firefox浏览器下载ZIP类型文件慢的问题..........................................................................................80
1.1.8.15
为什么当前告警无法自动清除...................................................................................................................................80
1.1.8.16
为什么告警已上报但是查询不到对应告警.............................................................................................................81
1.2
资源池告警...............................................................................................................................................................................81
1.2.1 FusionSphere
OpenStack告警参考..............................................................................................................................81
1.2.1.1 ALM-6008
上传日志到OBS服务失败......................................................................................................................81
1.2.1.2 ALM-6010
NTP服务器与外部时钟源时间差超过阈值.........................................................................................87
1.2.1.3 ALM-6014
DNS服务器连接中断................................................................................................................................91
1.2.1.4 ALM-6015
NTP服务器与外部时钟源网络故障或外部时钟源故障...................................................................93
1.2.1.5 ALM-6016
日志服务连接OBS失败...........................................................................................................................98
1.2.1.6 ALM-6017
主机状态异常...........................................................................................................................................102
1.2.1.7 ALM-6018
主机CPU占用率超过阈值....................................................................................................................110
1.2.1.8 ALM-6019
主机内存占用率超过阈值......................................................................................................................111
1.2.1.9 ALM-6020
主机逻辑磁盘占用率超过阈值.............................................................................................................113
1.2.1.10 ALM-6021
主机网口状态异常................................................................................................................................117
1.2.1.11 ALM-6022
主机与NTP服务器心跳状态异常.....................................................................................................122
1.2.1.12 ALM-6023
主机存储链路中断................................................................................................................................126

## Page 8

1.2.1.13 ALM-6024
存储资源管理链路中断或认证失败..................................................................................................128
1.2.1.14 ALM-6025
存储使用率超过阈值............................................................................................................................131
1.2.1.15 ALM-6026
主机光纤通道中断................................................................................................................................132
1.2.1.16 ALM-6027
网口自协商速率没有达到服务器网口最大速率的一半...............................................................136
1.2.1.17 ALM-6028
本地NTP客户端与本地NTP服务器时间差超过60秒.............................................................139
1.2.1.18 ALM-6029
服务自动备份失败................................................................................................................................142
1.2.1.19 ALM-6030
IP冲突故障.............................................................................................................................................145
1.2.1.20 ALM-6031
上传日志到FTP服务器失败..............................................................................................................148
1.2.1.21 ALM-6033
I层服务CPU占用率超过阈值...........................................................................................................151
1.2.1.22 ALM-6034
I层服务内存占用率超过阈值.............................................................................................................154
1.2.1.23 ALM-6038
主机磁盘占用率超过阈值...................................................................................................................156
1.2.1.24 ALM-6039
主机虚拟化域内存占用率超过阈值..................................................................................................158
1.2.1.25 ALM-6040
主机虚拟化域CPU占用率超过阈值................................................................................................160
1.2.1.26 ALM-6041
主机存在非法内存占用........................................................................................................................162
1.2.1.27 ALM-6042
主机实际要求资源隔离超过当前配置..............................................................................................164
1.2.1.28 ALM-70100
虚拟机审计告警..................................................................................................................................167
1.2.1.29 ALM-70101
虚拟机操作系统故障告警.................................................................................................................169
1.2.1.30 ALM-70102
虚拟机ERROR状态告警..................................................................................................................172
1.2.1.31 ALM-70105
异构VMware虚拟机卷数据残留告警..........................................................................................175
1.2.1.32 ALM-70106
虚拟机HA中间态告警......................................................................................................................177
1.2.1.33 ALM-70107
虚拟机发生HA....................................................................................................................................179
1.2.1.34 ALM-70108
虚拟机目录文件异常..........................................................................................................................181
1.2.1.35 ALM-70109
虚拟机BDM残留审计告警..............................................................................................................184
1.2.1.36 ALM-70111
本地盘ERROR状态告警..................................................................................................................185
1.2.1.37 ALM-70112
IB网卡故障..........................................................................................................................................187
1.2.1.38 ALM-70113 NVME
SSD盘或卡故障....................................................................................................................188
1.2.1.39 ALM-70127
主机组内NVMe SSD大盘使用率超过阈值................................................................................191
1.2.1.40 ALM-70128
主机组内NVMe SSD小盘使用率超过阈值................................................................................192
1.2.1.41 ALM-70129
主机组内GPU使用率超过阈值......................................................................................................193
1.2.1.42 ALM-70130
虚拟机HA失败...................................................................................................................................194
1.2.1.43 ALM-70131
主机组CPU分配率超过阈值...........................................................................................................196
1.2.1.44 ALM-70132
主机组内存分配率超过阈值............................................................................................................198
1.2.1.45 ALM-70135
内存复用率超过阈值告警.................................................................................................................199
1.2.1.46 ALM-70201
DHCP-agent管理的network数量超过阈值..............................................................................200
1.2.1.47 ALM-70203
主机上虚拟端口上线处理异常........................................................................................................204
1.2.1.48 ALM-70251
聚合网口状态异常..............................................................................................................................206
1.2.1.49 ALM-70300
卷审计告警...........................................................................................................................................209
1.2.1.50 ALM-70310
快照审计告警.......................................................................................................................................211
1.2.1.51 ALM-70400
镜像审计告警.......................................................................................................................................213
1.2.1.52 ALM-70401
镜像完整性校验失败..........................................................................................................................214
1.2.1.53 ALM-70402
整机快照残留.......................................................................................................................................216
1.2.1.54 ALM-73005
残留LUN告警....................................................................................................................................218

## Page 9

1.2.1.55 ALM-73008
虚拟网络资源审计告警.....................................................................................................................219
1.2.1.56 ALM-73010
文件系统故障告警..............................................................................................................................220
1.2.1.57 ALM-73011
关键进程异常告警..............................................................................................................................227
1.2.1.58 ALM-73012
磁盘分区inode资源不足告警........................................................................................................229
1.2.1.59 ALM-73013
存储磁盘I/O时延过大告警.............................................................................................................231
1.2.1.60 ALM-73014
系统文件完整性异常..........................................................................................................................234
1.2.1.61 ALM-73015
大页内存不足.......................................................................................................................................236
1.2.1.62 ALM-73016
CPU主频异常......................................................................................................................................238
1.2.1.63 ALM-73017
主机系统用户密码过期预警............................................................................................................240
1.2.1.64 ALM-73018
swap分区I/O时延过大...................................................................................................................242
1.2.1.65 ALM-73019
主机进程数异常..................................................................................................................................243
1.2.1.66 ALM-73102
虚拟网络端口错包率超过告警阈值告警.......................................................................................246
1.2.1.67 ALM-73104
OVS/EVS卡死.....................................................................................................................................250
1.2.1.68 ALM-73107
虚拟机发生反复重启故障.................................................................................................................253
1.2.1.69 ALM-73108
虚拟机Watchdog异常告警............................................................................................................255
1.2.1.70 ALM-73109
UVP关键进程内存占用率超过阈值告警......................................................................................258
1.2.1.71 ALM-73110
虚拟网络关键资源不足.....................................................................................................................260
1.2.1.72 ALM-73111
主机连接跟踪表超过阈值告警........................................................................................................263
1.2.1.73 ALM-73112
虚拟机网卡异常..................................................................................................................................265
1.2.1.74 ALM-73201
HAProxy代理服务不可用................................................................................................................267
1.2.1.75 ALM-73202
管理节点发生主备倒换.....................................................................................................................270
1.2.1.76 ALM-73203
组件故障...............................................................................................................................................271
1.2.1.77 ALM-73204
主机版本不一致告警..........................................................................................................................275
1.2.1.78 ALM-73205
Iaas层资源配置不一致告警............................................................................................................277
1.2.1.79 ALM-73207
主机名重复...........................................................................................................................................279
1.2.1.80 ALM-73208
对接外部仲裁服务异常.....................................................................................................................280
1.2.1.81 ALM-73209
zookeeper健康检查告警.................................................................................................................284
1.2.1.82 ALM-73210
未配置管理数据备份至第三方服务器...........................................................................................286
1.2.1.83 ALM-73302
存在网络未配置VLAN探测平面....................................................................................................287
1.2.1.84 ALM-73401
rabbitmq服务故障............................................................................................................................288
1.2.1.85 ALM-73403
gaussdb主备数据不同步.................................................................................................................292
1.2.1.86 ALM-73404
检测到gaussdb恶意访问................................................................................................................295
1.2.1.87 ALM-73405
gaussdb连接数超过阈值.................................................................................................................298
1.2.1.88 ALM-73410
UVP关键进程CPU占用率超过阈值.............................................................................................300
1.2.1.89 ALM-73411
数据库文件损坏..................................................................................................................................303
1.2.1.90 ALM-73412
检测到gaussdb存在长事务............................................................................................................310
1.2.1.91 ALM-1060047
后端存储虚拟容量使用率超过阈值...........................................................................................313
1.2.1.92 ALM-1060049
挂载双活卷单边故障告警............................................................................................................315
1.2.1.93 ALM-1060050
后端存储证书异常.........................................................................................................................318
1.2.1.94 ALM-1101315
主机组内本地直通盘使用率超过阈值......................................................................................320
1.2.1.95 ALM-1101317
MCS主机组内本地盘使用率超过阈值.....................................................................................321
1.2.1.96 ALM-1101320
NPU使用率超过阈值...................................................................................................................323

## Page 10

1.2.1.97 ALM-1101321
虚拟机存储链路未完全恢复........................................................................................................324
1.2.1.98 ALM-1126000
裸金属服务器电源状态未获取到...............................................................................................326
1.2.1.99 ALM-1126001
裸金属服务器管理状态不可用...................................................................................................327
1.2.1.100 ALM-1126002
裸金属服务器审计告警..............................................................................................................329
1.2.1.101 ALM-1200067
DHCP服务不可用.......................................................................................................................331
1.2.1.102 ALM-1200075
主机设备端口错包告警..............................................................................................................337
1.2.1.103 ALM-1200076
主机设备端口丢包告警..............................................................................................................340
1.2.1.104 ALM-1200077 Dpdk lacp
bond聚合失败........................................................................................................343
1.2.1.105 ALM-1200081
网络服务业务网卡异常告警.....................................................................................................346
1.2.1.106 ALM-1200082
交换机异步配置失败..................................................................................................................352
1.2.1.107 ALM-1200083
虚拟机端口连接跟踪数过大告警.............................................................................................355
1.2.1.108 ALM-1200084
二层桥接或增强型云专线交换机连接失败...........................................................................359
1.2.1.109 ALM-1200085
裸机接入交换机连接失败..........................................................................................................363
1.2.1.110 ALM-1200090
NAT网关双主告警......................................................................................................................366
1.2.1.111 ALM-1200100
redis集群异常..............................................................................................................................368
1.2.1.112 ALM-1200101
redis集群内实例持久化异常....................................................................................................371
1.2.1.113 ALM-1200102
redis主备实例持久化异常........................................................................................................374
1.2.1.114 ALM-1200200
BGP对等体状态异常告警.........................................................................................................377
1.2.1.115 ALM-1200400
CloudConnect服务tomcat进程异常...................................................................................379
1.2.1.116 ALM-1223017
负载均衡器后端实例不在线.....................................................................................................382
1.2.1.117 ALM-1240001 FusionSphere
Neutron和Agile
Controller-DCN
进行数据一致性修复时失败........385
1.2.1.118 ALM-1240002 FusionSphere
Neutron和Agile
Controller-DCN
HTTP连接故障...............................388
1.2.1.119 ALM-1240003 FusionSphere
Neutron和Agile
Controller-DCN
Websocket连接故障....................391
1.2.1.120 ALM-1260001
BR-Agent访问UGW配置文件异常......................................................................................394
1.2.1.121 ALM-1260005
自动隔离BR节点........................................................................................................................396
1.2.1.122 ALM-1260015
BR数据面异常.............................................................................................................................399
1.2.1.123 ALM-1260016
BR-Agent与其他组件连接异常...............................................................................................401
1.2.1.124 ALM-1301021 EVS/OVS-DPDK
转发能力达到瓶颈告警..............................................................................407
1.2.1.125 ALM-1316000
OpenStack服务包升级完成后未提交...................................................................................410
1.2.1.126 ALM-1316001
忽略升级的单板未处理..............................................................................................................412
1.2.1.127 ALM-1316002
热补丁运行异常告警..................................................................................................................415
1.2.1.128 ALM-1316003
QEMU版本异常告警.................................................................................................................418
1.2.1.129 ALM-1507002
RabbitMQ资源使用率超过阈值.............................................................................................420
1.2.1.130 ALM-1607000
弹性裸机容器引擎故障告警.....................................................................................................424
1.2.1.131 ALM-1607011
弹性裸机审计告警.......................................................................................................................425
1.2.2 Service
OM告警参考......................................................................................................................................................427
1.2.2.1 ALM-9206 Service
OM数据备份失败....................................................................................................................427
1.2.2.2 ALM-9207
License即将过期.....................................................................................................................................431
1.2.2.3 ALM-9208
License已经过期.....................................................................................................................................433
1.2.2.4 ALM-9209
当前资源数量大于License许可上限.................................................................................................435
1.2.2.5 ALM-9210
当前License已失效...............................................................................................................................437
1.2.2.6 ALM-9215
系统磁盘使用率过大..............................................................................................................................439

## Page 11

1.2.2.7 ALM-9216
软件订阅与保障年费即将到期.............................................................................................................441
1.2.2.8 ALM-9217
软件订阅与保障年费已经过期.............................................................................................................442
1.2.2.9 ALM-9801 Service
OM资源异常............................................................................................................................444
1.2.2.10 ALM-9902 Service
OM双机心跳中断.................................................................................................................447
1.2.2.11 ALM-9903 Service
OM双机文件同步失败.........................................................................................................449
1.2.2.12 ALM-9913
系统默认证书使用提醒........................................................................................................................451
1.2.2.13 ALM-9915
证书过期预警.........................................................................................................................................452
1.2.2.14 ALM-9917 Service
OM虚拟机CPU占用率超过阈值......................................................................................454
1.2.2.15 ALM-9918 Service
OM虚拟机内存占用率超过阈值.......................................................................................455
1.2.3
常见问题.............................................................................................................................................................................457
1.2.3.1 FusionSphere
OpenStack类.....................................................................................................................................457
1.2.3.1.1
如何处理强制时间同步失败....................................................................................................................................457
1.2.3.1.2
nova-compute组件故障处理................................................................................................................................458
1.2.3.1.3
nova-api组件故障处理...........................................................................................................................................460
1.2.3.1.4
nova-scheduler组件故障处理...............................................................................................................................460
1.2.3.1.5
nova-conductor组件故障处理..............................................................................................................................461
1.2.3.1.6
vmware-nova-compute组件故障处理...............................................................................................................462
1.2.3.1.7
memcache组件故障处理.......................................................................................................................................463
1.2.3.1.8
cinder-volume组件故障处理.................................................................................................................................464
1.2.3.1.9
nova-compute-ironic组件故障处理....................................................................................................................465
1.2.3.1.10
glance组件故障处理.............................................................................................................................................466
1.2.3.1.11
gaussdb组件故障处理..........................................................................................................................................467
1.2.3.1.12
keystone组件故障处理.........................................................................................................................................469
1.2.3.1.13
rabbitmq组件故障处理........................................................................................................................................470
1.2.3.1.14
neutron-server组件故障处理.............................................................................................................................472
1.2.3.1.15
neutron-l3-service-agent组件故障处理.........................................................................................................474
1.2.3.1.16
neutron-vrouter组件故障处理...........................................................................................................................475
1.2.3.1.17
neutron-ipv6-vrouter组件故障处理.................................................................................................................476
1.2.3.1.18
neutron-l3-nat-agent组件故障处理................................................................................................................477
1.2.3.1.19
neutron-cascading-proxy组件故障处理.........................................................................................................480
1.2.3.1.20
neutron-openvswitch-agent组件故障处理....................................................................................................482
1.2.3.1.21
neutron-garbage-collector组件故障处理......................................................................................................483
1.2.3.1.22
neutron-dvr-compute-agent组件故障处理...................................................................................................485
1.2.3.1.23
neutron-dhcp-agent组件故障处理...................................................................................................................486
1.2.3.1.24
neutron-metadata-agent组件故障处理.........................................................................................................488
1.2.3.1.25
neutron-vc-vswitch-agent组件故障处理........................................................................................................490
1.2.3.1.26
neutron-elb-proxy组件故障处理.......................................................................................................................491
1.2.3.1.27
neutron-l3-agent组件故障处理........................................................................................................................492
1.2.3.1.28
neutron-nat-gw-dataplane组件故障处理......................................................................................................492
1.2.3.1.29
neutron-nat-gw-data-agent组件故障处理...................................................................................................494
1.2.3.1.30
neutron-ipv6-service-agent组件故障处理.....................................................................................................496
1.2.3.1.31
neutron-ngfw-agent组件故障处理..................................................................................................................497

## Page 12

1.2.3.1.32
neutron-fw-proxy组件故障处理........................................................................................................................499
1.2.3.1.33
neutron-ngfw-vpn-agent组件故障处理.........................................................................................................500
1.2.3.1.34
neutron-sriov-nic-agent组件故障处理............................................................................................................500
1.2.3.1.35
neutron-evs-agent组件故障处理......................................................................................................................501
1.2.3.1.36
ceilometer-agent-compute组件故障处理......................................................................................................502
1.2.3.1.37
ceilometer-agent-hardware组件故障处理.....................................................................................................503
1.2.3.1.38
ceilometer-collector组件故障处理...................................................................................................................503
1.2.3.1.39
ce1800v组件故障处理..........................................................................................................................................505
1.2.3.1.40
pecado-controller组件故障处理........................................................................................................................507
1.2.3.1.41
redis组件故障处理.................................................................................................................................................508
1.2.3.1.42
device-manager组件故障处理...........................................................................................................................509
1.2.3.1.43
bgp-broker组件故障处理....................................................................................................................................509
1.2.3.1.44
neutron-bm-switch-agent组件故障处理.......................................................................................................510
1.2.3.1.45
drextend-agent组件故障处理............................................................................................................................511
1.2.3.1.46
drextend-api组件故障处理.................................................................................................................................512
1.3
云管平台告警........................................................................................................................................................................512
1.3.1
性能监控.............................................................................................................................................................................512
1.3.1.1 ALM-0001000100010001
【自定义监控】网络设备平均CPU利用率超过阈值.......................................512
1.3.1.2 ALM-0001000100010002
【自定义监控】网络设备平均内存利用率超过阈值.........................................514
1.3.1.3 ALM-0001000100010003
【自定义监控】网络设备响应时间超过阈值......................................................515
1.3.1.4 ALM-0001000100010004
【自定义监控】网络设备当日不可达比率超过阈值.........................................517
1.3.1.5 ALM-0001000100020003
【自定义监控】网络设备当前会话新建速率超过阈值.....................................518
1.3.1.6 ALM-0001000100020004
【自定义监控】网络设备当前会话总数超过阈值.............................................520
1.3.1.7 ALM-0001000100020005
【自定义监控】网络设备网络流量值超过阈值..................................................521
1.3.1.8 ALM-0001000200010001
【自定义监控】接口接收速率超过阈值...............................................................523
1.3.1.9 ALM-0001000200010002
【自定义监控】接口发送速率超过阈值...............................................................525
1.3.1.10 ALM-0001000200010003
【自定义监控】接口流入带宽利用率超过阈值...............................................526
1.3.1.11 ALM-0001000200010004
【自定义监控】接口流出带宽利用率超过阈值...............................................528
1.3.1.12 ALM-0001000200020001
【自定义监控】接口接收包丢弃率超过阈值...................................................529
1.3.1.13 ALM-0001000200020002
【自定义监控】接口发送包丢弃率超过阈值...................................................531
1.3.1.14 ALM-0001000200020003
【自定义监控】接口丢弃发送包数超过阈值...................................................533
1.3.1.15 ALM-0001000200020004
【自定义监控】接口丢弃接收包数超过阈值...................................................534
1.3.1.16 ALM-0001000200020005
【自定义监控】接口发送包错误率超过阈值...................................................536
1.3.1.17 ALM-0001000200020006
【自定义监控】接口接收包错误率超过阈值...................................................537
1.3.1.18 ALM-0001000200020007
【自定义监控】接口发送包数超过阈值............................................................539
1.3.1.19 ALM-0001000200020008
【自定义监控】接口接收包数超过阈值............................................................540
1.3.1.20 ALM-0001000200020009
【自定义监控】接口接收包速率超过阈值........................................................542
1.3.1.21 ALM-000100020002000A
【自定义监控】接口发送包速率超过阈值.......................................................544
1.3.1.22 ALM-000100020002000B
【自定义监控】接口发送错误包数超过阈值...................................................545
1.3.1.23 ALM-000100020002000C
【自定义监控】接口接收错误包数超过阈值...................................................547
1.3.1.24 ALM-000100020002000D
【自定义监控】接口发送字节数超过阈值.......................................................548
1.3.1.25 ALM-000100020002000E
【自定义监控】接口接收字节数超过阈值........................................................550

## Page 13

1.3.1.26 ALM-0001000300010001
【自定义监控】并发连接数超过阈值................................................................551
1.3.1.27 ALM-0001000300020003
【自定义监控】网络流入流速超过阈值............................................................553
1.3.1.28 ALM-0001000300020004
【自定义监控】网络流出流速超过阈值............................................................555
1.3.1.29 ALM-0001000300010004
【自定义监控】新建连接数超过阈值................................................................556
1.3.1.30 ALM-0001000300010002
【自定义监控】活跃连接数超过阈值................................................................558
1.3.1.31 ALM-0001000300010003
【自定义监控】非活跃连接数超过阈值............................................................559
1.3.1.32 ALM-0001000300020001
【自定义监控】流入数据包数超过阈值............................................................561
1.3.1.33 ALM-0001000300020002
【自定义监控】流出数据包数超过阈值............................................................562
1.3.1.34 ALM-0001000300020005
【自定义监控】异常主机数超过阈值................................................................564
1.3.1.35 ALM-0001000300020006
【自定义监控】正常主机数超过阈值................................................................565
1.3.1.36 ALM-0001000400010001
【自定义监控】单板CPU利用率超过阈值......................................................567
1.3.1.37 ALM-0001000400010002
【自定义监控】单板内存利用率超过阈值........................................................569
1.3.1.38 ALM-0001000500010001
【自定义监控】光模块接收功率超过阈值........................................................570
1.3.1.39 ALM-0001000500010002
【自定义监控】光模块发送功率超过阈值........................................................572
1.3.1.40 ALM-0003000200010001
【自定义监控】电源功率超过阈值.....................................................................573
1.3.1.41 ALM-0005000100010001
【自定义监控】CPU使用率超过阈值................................................................575
1.3.1.42 ALM-0005000100020008
【自定义监控】内存使用率超过阈值................................................................576
1.3.1.43 ALM-000500010003000B
【自定义监控】网络流入速率超过阈值............................................................578
1.3.1.44 ALM-000500010003000C
【自定义监控】网络流出速率超过阈值............................................................580
1.3.1.45 ALM-0005000100040014
【自定义监控】磁盘使用率超过阈值................................................................581
1.3.1.46 ALM-0005000100040026
【自定义监控】带内磁盘使用率超过阈值........................................................583
1.3.1.47 ALM-0002000200010001
【自定义监控】CPU使用率超过阈值................................................................584
1.3.1.48 ALM-0002000200020003
【自定义监控】内存使用率超过阈值................................................................586
1.3.1.49 ALM-0002000200040004
【自定义监控】云硬盘使用率超过阈值............................................................588
1.3.1.50 ALM-0002000200030020
【自定义监控】带内磁盘使用率超过阈值........................................................589
1.3.1.51 ALM-0005000200010001
【自定义监控】CPU使用率超过阈值................................................................591
1.3.1.52 ALM-0005000200020003
【自定义监控】内存使用率超过阈值................................................................592
1.3.1.53 ALM-0005000200040004
【自定义监控】云硬盘使用率超过阈值............................................................594
1.3.1.54 ALM-0005000200040026
【自定义监控】带内磁盘使用率超过阈值........................................................595
1.3.1.55 ALM-0005000300010001
【自定义监控】CPU使用率超过阈值................................................................597
1.3.1.56 ALM-0005000300020007
【自定义监控】内存使用率超过阈值................................................................599
1.3.1.57 ALM-0005000300030010
【自定义监控】网络流入速率超过阈值............................................................600
1.3.1.58 ALM-0005000300030011
【自定义监控】网络流出速率超过阈值............................................................602
1.3.1.59 ALM-0007000100010001
【自定义监控】端口速率超过阈值.....................................................................603
1.3.1.60 ALM-0007000100010002
【自定义监控】端口CRC错误超过阈值...........................................................605
1.3.1.61 ALM-0007000100010003
【自定义监控】端口发送link reset错误超过阈值........................................606
1.3.1.62 ALM-0007000100010004
【自定义监控】端口接收link reset错误超过阈值........................................608
1.3.1.63 ALM-0007000100010005
【自定义监控】端口link reset错误总数超过阈值........................................609
1.3.1.64 ALM-0007000100010006
【自定义监控】端口class
3
discard错误超过阈值......................................611
1.3.1.65 ALM-0007000100010007
【自定义监控】端口sync loss错误超过阈值.................................................612
1.3.1.66 ALM-0007000100010008
【自定义监控】端口接收利用率超过阈值........................................................614
1.3.1.67 ALM-0007000100010009
【自定义监控】端口缓冲信用量超过阈值........................................................615

## Page 14

1.3.1.68 ALM-000700010001000A
【自定义监控】端口接收速率超过阈值............................................................617
1.3.1.69 ALM-000700010001000B
【自定义监控】端口发送利用率超过阈值........................................................618
1.3.1.70 ALM-000700010001000C
【自定义监控】端口带宽利用率超过阈值........................................................620
1.3.1.71 ALM-000700010001000D
【自定义监控】端口link failure错误超过阈值.............................................621
1.3.1.72 ALM-000700010001000E
【自定义监控】端口signal loss错误超过阈值..............................................623
1.3.1.73 ALM-000700010001000F
【自定义监控】端口总error数超过阈值.........................................................624
1.3.1.74 ALM-0008000100010001
【自定义监控】CPU使用率超过阈值................................................................626
1.3.1.75 ALM-0008000100010002
【自定义监控】内存使用率超过阈值................................................................627
1.3.1.76 ALM-0008000100010003
【自定义监控】磁盘使用率超过阈值................................................................629
1.3.1.77 ALM-0002000500000001
【自定义监控】上行流量超过阈值.....................................................................630
1.3.1.78 ALM-0002000500000003
【自定义监控】下行流量超过阈值.....................................................................632
1.3.1.79 ALM-0002000A00000001
【自定义监控】用户空间CPU使用率超过阈值.............................................634
1.3.1.80 ALM-0002000A0000000D
【自定义监控】内存使用率超过阈值...............................................................635
1.3.1.81 ALM-0002000A00000014
【自定义监控】磁盘使用率超过阈值................................................................637
1.3.1.82 ALM-0002000700000001
【自定义监控】CPU使用率超过阈值................................................................638
1.3.1.83 ALM-0002000700000002
【自定义监控】内存使用率超过阈值................................................................640
1.3.1.84 ALM-0002000700000003
【自定义监控】IOPS超过阈值............................................................................641
1.3.1.85 ALM-000200070000002A
【自定义监控】数据库连接数超过阈值............................................................643
1.3.1.86 ALM-0002000700000036
【自定义监控】使用中的数据库连接数超过阈值...........................................644
1.3.1.87 ALM-0002000800000003
【自定义监控】主机内存使用率超过阈值........................................................646
1.3.1.88 ALM-0002000800000004
【自定义监控】主机CPU使用率超过阈值......................................................647
1.3.1.89 ALM-0002000900000003
【自定义监控】主机内存使用率超过阈值........................................................649
1.3.1.90 ALM-0002000900000004
【自定义监控】主机CPU使用率超过阈值......................................................650
1.3.1.91 ALM-0002000700000048
【自定义监控】CPU使用率超过阈值................................................................652
1.3.1.92 ALM-0002000700000049
【自定义监控】内存使用率超过阈值................................................................653
1.3.1.93 ALM-0003000200010005
【自定义监控】电源功率超过阈值.....................................................................655
1.3.1.94 ALM-000A000200000010
【自定义监控】每秒并发操作数超过阈值.......................................................656
1.3.1.95 ALM-000A000200000021
【自定义监控】缓存命中率超过阈值................................................................658
1.3.1.96 ALM-000A00020000002D
【自定义监控】每秒并发操作数超过阈值.......................................................659
1.3.1.97 ALM-000A00020000004D
【自定义监控】CPU平均利用率超过阈值......................................................661
1.3.1.98 ALM-000B00020000004D
资源性能断采...........................................................................................................662
1.3.1.99 ALM-0001000700010001
【自定义监控】SNAT连接数超过阈值.............................................................665
1.3.1.100 ALM-0001000700010002
【自定义监控】SNAT连接率超过阈值...........................................................667
1.3.2
接入管理.............................................................................................................................................................................669
1.3.2.1 ALM-100002
证书已经过期.......................................................................................................................................669
1.3.3
驱动管理.............................................................................................................................................................................671
1.3.3.1 ALM-100502
系统连通性检测失败告警.................................................................................................................671
1.3.3.2 ALM-100553
SNMP连通性检测失败告警............................................................................................................677
1.3.4
驱动框架.............................................................................................................................................................................686
1.3.4.1 ALM-100550
LVS配置失败告警..............................................................................................................................686
1.3.4.2 ALM-100551
LVS中断服务告警..............................................................................................................................688
1.3.5
容量管理.............................................................................................................................................................................690

## Page 15

1.3.5.1 ALM-CloudCapacityMgmt_Base_1001
vCPU分配率超过阈值......................................................................690
1.3.5.2 ALM-CloudCapacityMgmt_Base_1002
vMemory分配率超过阈值..............................................................693
1.3.5.3 ALM-CloudCapacityMgmt_Base_1003
块存储使用率超过阈值.....................................................................695
1.3.5.4 ALM-CloudCapacityMgmt_Base_1004
块存储分配率超过阈值.....................................................................697
1.3.5.5 ALM-CloudCapacityMgmt_Base_1005
弹性IP分配率超过阈值...................................................................699
1.3.5.6 ALM-CloudCapacityMgmt_Base_1006
数据存储使用率超过阈值................................................................701
1.3.6
告警管理.............................................................................................................................................................................703
1.3.6.1 ALM-157
当前告警数量达到阈值............................................................................................................................704
1.3.6.2 ALM-832
同类告警数量超出门限............................................................................................................................705
1.3.6.3 ALM-132
雪崩告警......................................................................................................................................................707
1.3.6.4 ALM-100007
告警服务健康检查异常.....................................................................................................................709
1.3.7
安全管理.............................................................................................................................................................................711
1.3.7.1 ALM-128
远端认证主服务器连接失败告警...........................................................................................................711
1.3.7.2 ALM-160
远端认证备服务器连接失败告警...........................................................................................................713
1.3.7.3 ALM-1777670
RADIUS服务器连接失败告警.......................................................................................................716
1.3.7.4 ALM-30004
用户密码即将过期................................................................................................................................718
1.3.7.5 ALM-30005
用户密码已过期.....................................................................................................................................719
1.3.7.6 ALM-505001106
登录尝试次数达到最大值..........................................................................................................721
1.3.7.7 ALM-100013
用户证书即将过期..............................................................................................................................722
1.3.7.8 ALM-100014
用户证书过期.......................................................................................................................................724
1.3.8
日志转发.............................................................................................................................................................................725
1.3.8.1 ALM-126
切换到备系统日志服务器告警...............................................................................................................725
1.3.8.2 ALM-127
连接主、备系统日志服务器均失败告警..............................................................................................727
1.3.9
许可管理.............................................................................................................................................................................728
1.3.9.1 ALM-99999999961
ManageOne许可控制项超量.............................................................................................728
1.3.9.2 ALM-99999999962
ManageOne许可控制项使用量超过阈值.......................................................................730
1.3.9.3 ALM-99999999963
云服务许可控制项超期.........................................................................................................732
1.3.9.4 ALM-99999999964
云服务许可控制项即将超期................................................................................................734
1.3.9.5 ALM-99999999965
产品许可控制项超期.............................................................................................................736
1.3.9.6 ALM-99999999966
产品许可控制项即将超期.....................................................................................................737
1.3.9.7 ALM-99999999967
产品维保超期..........................................................................................................................739
1.3.9.8 ALM-99999999968
产品维保即将超期..................................................................................................................741
1.3.9.9 ALM-99999999969
商用永久产品许可未包含维保过期时间...........................................................................742
1.3.9.10 ALM-99999999970
ManageOne连接云服务许可系统失败.........................................................................744
1.3.9.11 ALM-99999999971
ManageOne连接产品许可系统失败.............................................................................745
1.3.9.12 ALM-99999999972
产品处于试用期....................................................................................................................746
1.3.9.13 ALM-99999999973
产品试用期超期....................................................................................................................747
1.3.9.14 ALM-99999999974
云服务处于试用期...............................................................................................................749
1.3.9.15 ALM-99999999975
云服务试用期超期...............................................................................................................750
1.3.10
远程通知管理..................................................................................................................................................................751
1.3.10.1 ALM-505001111
远程通知发送失败....................................................................................................................751
1.3.10.2 ALM-103400
远程通知服务证书即将过期..........................................................................................................754

## Page 16

1.3.10.3 ALM-103401
远程通知服务证书已经过期..........................................................................................................756
1.3.11
系统维护...........................................................................................................................................................................759
1.3.11.1 ALM-MOMaintenanceService_100103
证书即将过期...................................................................................759
1.3.11.2 ALM-MOMaintenanceService_100106
证书即将过期...................................................................................760
1.3.12
服务监控...........................................................................................................................................................................762
1.3.12.1
系统类............................................................................................................................................................................762
1.3.12.1.1 ALM-1000001002
NTP同步状态阈值告警.....................................................................................................762
1.3.12.1.2 ALM-1000001003
NTP偏移阈值告警..............................................................................................................764
1.3.12.1.3 ALM-1000001004
节点心跳中断.......................................................................................................................767
1.3.12.1.4 ALM-1000001005
服务监控所管理节点数量已超过性能基线...................................................................769
1.3.12.1.5 ALM-1000001006
操作系统帐号密码剩余有效期阈值告警.......................................................................771
1.3.12.1.6 ALM-1000001010
inode的空闲率阈值告警..................................................................................................773
1.3.12.1.7 ALM-servicemonitor_agent_heartbeat 节点连续中断................................................................................776
1.3.12.1.8 ALM-servicemonitor_os.fs.percent 硬盘使用率阈值告警...........................................................................780
1.3.12.1.9 ALM-servicemonitor_cpu.percent
CPU使用率阈值告警............................................................................782
1.3.12.1.10 ALM-servicemonitor_memory.percent
物理内存使用率阈值告警........................................................783
1.3.12.1.11 ALM-servicemonitor_os.nic.rx_dropped_ps
网卡流入丢包率阈值告警................................................785
1.3.12.1.12 ALM-servicemonitor_os.nic.rx_errors_ps
网卡流入错包率阈值告警.....................................................786
1.3.12.1.13 ALM-servicemonitor_os.nic.tx_dropped
网卡流出丢包率阈值告警......................................................788
1.3.12.1.14 ALM-servicemonitor_os.nic.tx_errors
网卡流出错包率阈值告警...........................................................789
1.3.12.1.15 ALM-servicemonitor_os.disk.io_waite
硬盘IO等待时间阈值告警.......................................................790
1.3.12.1.16 ALM-servicemonitor_os.disk.rd_rsp_time
硬盘读响应时间阈值告警...................................................792
1.3.12.1.17 ALM-servicemonitor_os.disk.wt_rsp_time
硬盘写响应时间阈值告警..................................................794
1.3.12.1.18 ALM- servicemonitor_os.disk.io_util
硬盘IO操作时间占比阈值告警.................................................796
1.3.12.1.19 ALM- servicemonitor_fhcount_percent_alarm
文件句柄使用率告警..................................................798
1.3.12.2
进程类............................................................................................................................................................................799
1.3.12.2.1 ALM-1000001001
NTP进程异常告警..............................................................................................................800
1.3.12.3
Redis类.........................................................................................................................................................................802
1.3.12.3.1 ALM-servicemonitor_redis.dbsvrStatus
Redis数据库实例状态阈值告警..............................................802
1.3.12.3.2 ALM-servicemonitor_redis.dbcopyStatus
Redis数据库实例复制状态阈值告警..................................805
1.3.12.3.3 ALM-servicemonitor_redis.connectedClientsRate
Redis数据库实例的客户端连接使用率阈值告警
.........................................................................................................................................................................................................807
1.3.12.4
高斯数据库类...............................................................................................................................................................810
1.3.12.4.1 ALM-1000001008
数据库实例的CPU使用率阈值告警..............................................................................810
1.3.12.4.2 ALM-1000001009 数据库实例的内存使用率阈值告警................................................................................811
1.3.12.4.3 ALM-servicemonitor_zenith.connectedClientsRate Zenith数据库实例的客户端连接使用率阈值告
警.....................................................................................................................................................................................................813
1.3.12.5
RabbitMQ类...............................................................................................................................................................815
1.3.12.5.1 ALM-servicemonitor_rabbit_mq_status
RabbitMQ集群状态异常.........................................................816
1.3.13
证书管理...........................................................................................................................................................................819
1.3.13.1 ALM-MOCertMgmt_100101
系统存在即将过期证书告警............................................................................819
1.3.14
密码管理...........................................................................................................................................................................820
1.3.14.1 ALM-100021
自动修改密码失败...........................................................................................................................820

## Page 17

1.3.14.2 ALM-100020
同步BMC密码失败.........................................................................................................................822
1.3.15
统一日志...........................................................................................................................................................................823
1.3.15.1 ALM-0001000300030001
Elasticsearch集群心跳检测异常.........................................................................823
1.3.16
备份管理...........................................................................................................................................................................826
1.3.16.1 ALM-1000001101
未配置备份服务器..................................................................................................................826
1.3.16.2 ALM-1000001102
周期备份任务执行失败.........................................................................................................827
1.3.17
华为虚拟化资源池..........................................................................................................................................................828
1.3.17.1 ALM-MOVCDRService_100091
话单文件发送到计量中心文件服务器失败告警.....................................828
1.3.18
部署面告警参考..............................................................................................................................................................830
1.3.18.1
CloudSOP管理............................................................................................................................................................830
1.3.18.1.1 ALM-101209
节点故障倒换.................................................................................................................................830
1.3.18.1.2 ALM-51023 NTP
服务异常..................................................................................................................................832
1.3.18.1.3 ALM-101211
数据库实例故障倒换....................................................................................................................839
1.3.18.1.4 ALM-101212
连接ZooKeeper失败..................................................................................................................840
1.3.18.1.5 ALM-103707
关系数据库核心文件变更...........................................................................................................842
1.3.18.1.6 ALM-103695
保护密码已经过期........................................................................................................................843
1.3.18.1.7 ALM-103696
保护密码即将过期........................................................................................................................843
1.3.18.1.8 ALM-103644
操作系统用户密码已经过期.......................................................................................................844
1.3.18.1.9 ALM-103643
操作系统用户密码即将过期.......................................................................................................845
1.3.18.2
系统监控.......................................................................................................................................................................
846
1.3.18.2.1 ALM-151
CPU占用率过高告警..........................................................................................................................846
1.3.18.2.2 ALM-152
网管服务异常退出告警.......................................................................................................................849
1.3.18.2.3 ALM-101208
节点状态异常.................................................................................................................................851
1.3.18.2.4 ALM-154
内存占用率过高告警...........................................................................................................................855
1.3.18.2.5 ALM-36
磁盘占用率过高告警.............................................................................................................................857
1.3.18.2.6 ALM-38
数据库进程异常......................................................................................................................................860
1.3.18.2.7 ALM-44
数据库占用率过高告警.........................................................................................................................862
1.3.18.2.8 ALM-47
服务内存占用过高告警.........................................................................................................................864
1.3.18.2.9 ALM-101206
SSH管理通道故障........................................................................................................................867
1.3.18.2.10 ALM-53080
部署面服务进程资源占用异常..................................................................................................869
1.3.18.2.11 ALM-101210
数据库本地主备复制异常.........................................................................................................871
1.3.18.2.12 ALM-103606
平均IO等待时间过长...............................................................................................................873
1.3.18.2.13 ALM-103607
数据库连接数即将耗尽.............................................................................................................875
1.3.18.2.14 ALM-30001100
网卡状态异常告警.................................................................................................................877
1.3.18.2.15 ALM-103708
数据库实例主备复制时间差超长告警...................................................................................878
1.3.18.2.16 ALM-103709
数据库用户被锁定告警.............................................................................................................879
1.3.18.2.17 ALM-103710
数据库用户密码过期告警.........................................................................................................880
1.3.18.2.18 ALM-700012
OS用户SSH免密指纹文件内容格式错误...........................................................................882
1.3.18.3
备份与恢复...................................................................................................................................................................883
1.3.18.3.1 ALM-1067
备份数据包不存在.............................................................................................................................883
1.3.18.3.2 ALM-101205
产品数据定时备份失败...............................................................................................................885
1.3.18.3.3 ALM-101216
定时备份失败.................................................................................................................................888

## Page 18

1.3.18.3.4 ALM-101217
产品应用程序定时备份失败.......................................................................................................892
1.3.18.3.5 ALM-101218
产品数据库应用程序定时备份失败..........................................................................................895
1.3.18.4
证书................................................................................................................................................................................898
1.3.18.4.1 ALM-51020
证书即将过期...................................................................................................................................899
1.3.18.4.2 ALM-51021
证书已经过期...................................................................................................................................900
1.3.18.4.3 ALM-51022
证书更新失败...................................................................................................................................901
1.3.18.5
异地容灾.......................................................................................................................................................................
902
1.3.18.5.1 ALM-101200
复制异常.........................................................................................................................................902
1.3.18.5.2 ALM-101201
心跳异常.........................................................................................................................................907
1.3.18.5.3 ALM-101204
主备站点部署异常........................................................................................................................909
1.3.18.5.4 ALM-101230
系统健康检查异常........................................................................................................................911
1.3.18.5.5 ALM-51024
站点状态异常...................................................................................................................................913
1.3.18.5.6 ALM-51025
异地容灾证书已过期......................................................................................................................916
1.3.18.5.7 ALM-51026
异地容灾系统的证书即将过期.....................................................................................................917
1.3.19
数据分析平台..................................................................................................................................................................918
1.3.19.1 ALM-0001000300030003
Elasticsearch索引个数超限..................................................................................918
1.3.19.2 ALM-0001000300030004
Elasticsearch集群状态异常..................................................................................919
1.3.20 IAM....................................................................................................................................................................................921
1.3.20.1 ALM-36064531474581504
IAM数据库资源使用异常或服务异常..............................................................921
1.3.20.2 ALM-0004000700010009
IAM鉴权失败...........................................................................................................923
1.3.21
VDC管理..........................................................................................................................................................................925
1.3.21.1 ALM-36064531474581505
租户下用户组关联资源集数超过阈值..............................................................925
1.3.22
计量....................................................................................................................................................................................926
1.3.22.1 ALM-1001001004
计量话单文件磁盘配额使用率超阈值...............................................................................926
1.3.23
URL拨测..........................................................................................................................................................................
928
1.3.23.1 ALM-0001000300040001
URL拨测状态码阈值告警......................................................................................928
1.3.23.2 ALM-0001000300040002
URL拨测响应时间阈值告警.................................................................................931
1.3.23.3 ALM-0001000300040003
URL拨测超时告警...................................................................................................932
1.3.23.4 ALM-0001000300040004
URL拨测丢包率阈值告警......................................................................................934
1.3.23.5 ALM-0001000300050001
URL拨测异常告警...................................................................................................936
1.3.24
运营指挥中心..................................................................................................................................................................938
1.3.24.1 ALM-99999996
数据源连接异常告警..................................................................................................................938
1.3.24.2 ALM-1000009010
Manageone运营指挥中心许可控制项超量...................................................................940
1.3.24.3 ALM-1000009002
ManageOne运营指挥中心与MapReduce Service连接异常...................................942
1.3.25
资源管理...........................................................................................................................................................................943
1.3.25.1 ALM-10000011
ManageOne管理资源超过部署规格限制............................................................................944
1.3.25.2 ALM-100000200001
系统管理的自定义模型数量超过规格上限.................................................................946
1.3.25.3 ALM-100000200002
系统管理的自定义资源数量超过规格上限.................................................................948
1.3.25.4 ALM-MOCMDB_Specification_1001
系统管理的资源数量超过规格上限.................................................950
1.3.26
CA服务.............................................................................................................................................................................951
1.3.26.1 ALM-800001
CA即将过期......................................................................................................................................951
1.3.26.2 ALM-800002
CA已过期...........................................................................................................................................952

## Page 19

1.3.26.3 ALM-800003
CA服务所支持签发的证书个数即将达到上限.........................................................................954
1.3.26.4 ALM-800004
CA服务所支持签发的证书个数已达上限..................................................................................955
1.3.26.5 ALM-800005
CRL发布失败....................................................................................................................................955
1.3.26.6 ALM-800006
CA服务的证书即将过期.................................................................................................................957
1.3.26.7 ALM-800007
CA服务的证书已过期.....................................................................................................................959
1.3.27
SNMP告警接口..............................................................................................................................................................961
1.3.27.1 ALM-100006
认证失败次数达到最大限制..........................................................................................................961
1.3.28
eSgiht告警......................................................................................................................................................................962
1.4
公共组件告警........................................................................................................................................................................963
1.4.1 APIGateway.......................................................................................................................................................................963
1.4.1.1
通信告警..........................................................................................................................................................................963
1.4.1.1.1
ALM-48101-无法访问shubao..............................................................................................................................963
1.4.1.1.2
ALM-48102-无法访问etcd....................................................................................................................................965
1.4.1.1.3
ALM-48110-无法访问DB.......................................................................................................................................967
1.4.1.1.4
ALM-48111-无法访问apimgr...............................................................................................................................969
1.4.1.1.5
ALM-48117-无法正常接收Opsagent心跳.......................................................................................................971
1.4.1.2
处理错误告警.................................................................................................................................................................973
1.4.1.2.1
ALM-48304-证书即将过期.....................................................................................................................................973
1.4.1.2.2
ALM-48305-证书已经过期.....................................................................................................................................975
1.4.1.2.3
ALM-48306-证书校验失败.....................................................................................................................................976
1.4.1.2.4
ALM-48316-请求超出单实例流控阈值...............................................................................................................978
1.4.1.2.5
ALM-48318-证书回退失败.....................................................................................................................................979
1.4.1.2.6
ALM-48319-证书无法生效.....................................................................................................................................982
1.4.1.2.7
ALM-48320-证书即将过期.....................................................................................................................................984
1.4.1.2.8
ALM-48321-证书已经被吊销.................................................................................................................................985
1.4.1.3
设备告警..........................................................................................................................................................................987
1.4.1.3.1
ALM-48401-进程未启动..........................................................................................................................................987
1.4.1.3.2
ALM-48402-端口冲突..............................................................................................................................................988
1.4.1.3.3
ALM-48409-文件句柄使用率超过门限值...........................................................................................................991
1.4.2 CCS.......................................................................................................................................................................................993
1.4.2.1 ALM-1320004
ccs进程异常......................................................................................................................................994
1.4.2.2 ALM-1320019
证书异常.............................................................................................................................................995
1.4.3 CPAS.....................................................................................................................................................................................998
1.4.3.1 ALM-2000266
节点系统时钟跳变超过一分钟......................................................................................................998
1.4.3.2 ALM-2001106
Etcd服务状态异常........................................................................................................................1000
1.4.3.3 ALM-2002101
Monitor进程异常.........................................................................................................................1003
1.4.3.4 ALM-2002302
Monitor与对端站点通信异常....................................................................................................1005
1.4.3.5 ALM-2002501
站点网络状态异常.........................................................................................................................1006
1.4.3.6 ALM-2001107
第三方站点异常.............................................................................................................................1008
1.4.4 DMK..................................................................................................................................................................................1010
1.4.4.1 ALM-8000888
dmk服务异常.................................................................................................................................1010
1.4.5 DNS................................................................................................................................................................................... 1012

## Page 20

1.4.5.1 ALM-8000021 DNS
named进程异常.................................................................................................................1012
1.4.6 GaussDB...........................................................................................................................................................................1014
1.4.6.1 ALM-1510000
GaussdbHA服务进程异常..........................................................................................................1014
1.4.6.2 ALM-1510002
GaussdbHA备份失败..................................................................................................................1017
1.4.6.3 ALM-1510003
GaussdbHA证书异常..................................................................................................................1018
1.4.6.4 ALM-1510005
GaussdbHA主备同步异常..........................................................................................................1025
1.4.6.5 ALM-1510006
GaussdbHA上传远端备份服务器失败....................................................................................1028
1.4.7 HAProxy...........................................................................................................................................................................1030
1.4.7.1 ALM-2000904
haproxy服务异常..........................................................................................................................1030
1.4.7.2 ALM-2000906
haproxy的浮动IP不可达...........................................................................................................1033
1.4.7.3 ALM-2000908
keepalived进程不存在................................................................................................................1035
1.4.7.4 ALM-2000909
haproxy浮动IP端口不可达.......................................................................................................1037
1.4.8 LVS.....................................................................................................................................................................................1040
1.4.8.1 ALM-2001101
lvs_keepalived进程不存在.........................................................................................................1040
1.4.9 Nginx.................................................................................................................................................................................1041
1.4.9.1 ALM-2001002
nginx服务异常..............................................................................................................................1041
1.4.10 SDR..................................................................................................................................................................................1043
1.4.10.1
计量话单告警参考....................................................................................................................................................1043
1.4.10.1.1 ALM-2000301
计量话单生成话单失败..........................................................................................................1043
1.4.10.1.2 ALM-2000317
计量话单服务异常...................................................................................................................1045
1.4.10.1.3 ALM-2000327
计量话单证书告警...................................................................................................................1048
1.4.10.1.4 ALM-2000328
计量话单证书告警...................................................................................................................1052
1.4.10.2
参考信息.....................................................................................................................................................................1055
1.4.10.2.1
配置屏蔽规则.........................................................................................................................................................1055
1.4.11 TaskCenter....................................................................................................................................................................1057
1.4.11.1 ALM-2000722
taskcenter服务异常...................................................................................................................1057
1.4.11.2 ALM-2000724
证书异常........................................................................................................................................1059
1.4.12
组合API..........................................................................................................................................................................1063
1.4.12.1
组合API......................................................................................................................................................................1063
1.4.12.1.1 ALM-1150001
组合API节点NTP进程状态异常.......................................................................................1063
1.4.12.1.2 ALM-1150002
组合API节点CPU使用率过高............................................................................................1066
1.4.12.1.3 ALM-1150003
组合API节点内存使用率过高.............................................................................................1068
1.4.12.1.4 ALM-1150004
组合API节点tomcat进程异常..........................................................................................1070
1.4.12.1.5 ALM-1150017
组合API节点tomcat进程不存在......................................................................................1072
1.4.12.1.6 ALM-1150018
组合API节点tomcat存在多进程......................................................................................1074
1.4.12.2
云硬盘.........................................................................................................................................................................1076
1.4.12.2.1 1060036
evs周期性检测cinder连通性失败................................................................................................1076
1.4.12.2.2
修改配置文件中对接其他组件或服务的帐户密码........................................................................................1079
1.4.12.3
镜像服务.....................................................................................................................................................................1081
1.4.12.3.1 ALM-1131007
ntp进程不存在........................................................................................................................1081
1.4.12.3.2 ALM-1131009
tomcat多进程..........................................................................................................................1083
1.4.12.3.3 ALM-1131011
tomcat进程不存在.................................................................................................................1085

## Page 21

1.4.12.3.4 ALM-1131012
tomcat进程down掉.............................................................................................................1088
1.4.12.4 弹性云服务器............................................................................................................................................................1090
1.4.12.4.1 ALM-1101308
连接ECS数据库失败..............................................................................................................1090
1.4.12.4.2 ALM-1101312
ECS连接FSP失败...................................................................................................................1093
1.4.12.4.3 ALM-6043
主机组内vGPU使用率超过阈值................................................................................................1096
1.4.12.4.4
登录FusionSphere OpenStack后台...............................................................................................................1098
1.4.12.4.5
导入环境变量.........................................................................................................................................................1101
1.4.12.4.6
登录Service OM界面.........................................................................................................................................1102
1.4.13
CloudScope公共组件告警........................................................................................................................................1103
1.5 云服务告警..........................................................................................................................................................................1104
2
故障处理...............................................................................................................................1110
2.1
通用故障处理......................................................................................................................................................................1110
2.1.1
故障处理原则..................................................................................................................................................................1110
2.1.2 故障处理流程和方法.....................................................................................................................................................1111
2.1.3
操作过程关键信息获取.................................................................................................................................................1113
2.1.4
收集故障信息..................................................................................................................................................................1114
2.1.4.1
声明................................................................................................................................................................................1114
2.1.4.2
基本信息收集...............................................................................................................................................................1114
2.1.4.3
告警信息收集...............................................................................................................................................................1115
2.1.4.4
基于AutoOps故障场景信息收集列表.................................................................................................................1115
2.2
典型故障场景及常用故障工具.......................................................................................................................................1115
2.2.1 云平台故障诊断（调用链）........................................................................................................................................1115
2.2.2
ECS网络故障诊断..........................................................................................................................................................1121
2.2.3
ECS存储故障诊断..........................................................................................................................................................1122
2.2.4
ManageOne工具箱......................................................................................................................................................1124
2.2.4.1
启停应用实例...............................................................................................................................................................1124
2.2.4.2
维护操作案例...............................................................................................................................................................1125
2.2.5
巡检工具FusionCare....................................................................................................................................................1129
2.2.6
网络诊断工具CloudNetDebug..................................................................................................................................1129
2.2.7
调用链工具G-ray...........................................................................................................................................................1129
2.3
硬件故障..............................................................................................................................................................................1129
2.4
资源池故障..........................................................................................................................................................................1130
2.4.1 FusionSphere
OpenStack故障..................................................................................................................................1130
2.4.1.1
信息收集.......................................................................................................................................................................
1130
2.4.1.1.1 收集故障信息...........................................................................................................................................................1130
2.4.1.1.2
回传故障信息...........................................................................................................................................................1133
2.4.1.2
节点类故障...................................................................................................................................................................1136
2.4.1.2.1
故障主机上虚拟机的恢复......................................................................................................................................1136
2.4.1.2.2
主机操作系统故障...................................................................................................................................................1138
2.4.1.2.3
主机硬件故障...........................................................................................................................................................1146
2.4.1.2.4
多个控制主机故障...................................................................................................................................................1146
2.4.1.2.5
计算节点磁盘分区故障恢复.................................................................................................................................1150

## Page 22

2.4.1.2.6
NAT网关业务下发故障（Region
Type
I）......................................................................................................1151
2.4.1.2.7
AZ内误接入主机的处理方法...............................................................................................................................1153
2.4.1.2.8
网络节点主机操作系统故障（Region
Type
I）..............................................................................................1156
2.4.1.2.9
虚拟机冷迁移或变更规格失败处理....................................................................................................................1159
2.4.1.2.10
跨存储迁移异常处理............................................................................................................................................1161
2.4.1.2.11
整机冷迁移异常处理............................................................................................................................................1163
2.4.1.2.12
虚拟机系统卷损坏后无法登录的救援方法.....................................................................................................1166
2.4.1.2.13
虚拟机卸载系统磁盘后发生故障的恢复方法.................................................................................................1172
2.4.1.3
基础设施类故障..........................................................................................................................................................1178
2.4.1.3.1
CPS服务不可用.......................................................................................................................................................1178
2.4.1.3.2
主备服务出现双备故障..........................................................................................................................................1182
2.4.1.3.3
服务对接的远端存储故障......................................................................................................................................1185
2.4.1.3.4
Swift分区拉远到远端存储后上传、下载镜像失败........................................................................................1188
2.4.1.4
Gaussdb数据库故障.................................................................................................................................................1189
2.4.1.4.1
故障定位流程...........................................................................................................................................................1189
2.4.1.4.2
数据库状态异常处理..............................................................................................................................................1190
2.4.1.4.3
数据库组件访问失败..............................................................................................................................................1200
2.4.1.4.4
数据库单节点主机系统故障.................................................................................................................................1202
2.4.1.4.5
主数据库故障，备数据库升主异常处理............................................................................................................1202
2.4.1.4.6
数据库双节点主机系统故障.................................................................................................................................1203
2.4.2 Service
OM故障............................................................................................................................................................1206
2.4.2.1
管理节点故障...............................................................................................................................................................1206
2.4.2.1.1
主备Service OM虚拟机同时故障......................................................................................................................1206
2.4.2.1.2
主备部署时单个Service OM虚拟机故障.........................................................................................................1217
2.4.2.1.3
主备部署时Service OM主节点磁盘I/O启动无响应导致备节点无法升主故障...................................1222
2.4.2.2
常用操作.......................................................................................................................................................................
1224
2.4.2.2.1
系统时间错误...........................................................................................................................................................1224
2.4.2.2.2
获取Service OM根证书.......................................................................................................................................1226
2.4.3
附录....................................................................................................................................................................................1227
2.4.3.1
虚拟机状态异常..........................................................................................................................................................1227
2.4.3.2
通过FusionSphere OpenStack快速采集故障信息..........................................................................................1228
2.4.3.3
数据库操作...................................................................................................................................................................1229
2.4.3.3.1
定位所需的日志路径..............................................................................................................................................1229
2.4.3.3.2
登录数据库所在节点..............................................................................................................................................1230
2.4.3.4
如何处理盘符变化......................................................................................................................................................1231
2.5
云管平台故障......................................................................................................................................................................1232
2.5.1
NTP服务故障..................................................................................................................................................................1232
2.5.1.1
系统时间与NTP时间不一致...................................................................................................................................1232
2.5.1.2
NTP服务器状态异常.................................................................................................................................................1235
2.5.2
节点故障...........................................................................................................................................................................1238
2.5.2.1
约束限制.......................................................................................................................................................................
1238
2.5.2.2
操作前准备...................................................................................................................................................................1238

## Page 23

2.5.2.3
系统盘故障...................................................................................................................................................................1239
2.5.2.3.1
重建故障系统盘.......................................................................................................................................................1239
2.5.2.3.2
修改虚拟机网卡配置..............................................................................................................................................1241
2.5.2.3.3
修复加固配置项.......................................................................................................................................................1242
2.5.2.4
数据盘故障...................................................................................................................................................................1254
2.5.2.4.1
创建新的虚拟机.......................................................................................................................................................1255
2.5.2.4.2
创建新的数据盘.......................................................................................................................................................1257
2.5.2.4.3
对新建数据盘进行磁盘划分.................................................................................................................................1258
2.5.2.4.4
恢复数据盘................................................................................................................................................................1261
2.5.2.5
单节点故障...................................................................................................................................................................1266
2.5.3
最小恢复系统..................................................................................................................................................................1272
2.5.3.1
重新安装IAM应用程序............................................................................................................................................1272
2.5.3.2
恢复IAM数据库数据................................................................................................................................................1274
2.5.3.3
调整IAM接口流控参数............................................................................................................................................1275
2.5.3.4
切换运维面至最小系统状态.....................................................................................................................................1276
2.5.3.5
运维面关键微服务清单和IAM接口等级划分.....................................................................................................1278
2.5.4
资源管理服务异常..........................................................................................................................................................1278
2.5.5
数据库故障.......................................................................................................................................................................1279
2.5.5.1
产品数据库实例异常..................................................................................................................................................1279
2.5.5.2
系统重启后主数据库实例运行状态异常...............................................................................................................1281
2.5.5.3
主数据库实例异常且备数据库实例无法自动升主..............................................................................................1283
2.5.6
异地容灾系统故障..........................................................................................................................................................1284
2.5.6.1
异地容灾系统心跳异常.............................................................................................................................................1284
2.5.6.2
异地容灾复制异常......................................................................................................................................................1286
2.5.6.2.1
主备站点数据库数据同步异常.............................................................................................................................1286
2.5.6.2.2
高可靠消息数据复制异常......................................................................................................................................1288
2.5.6.3
异地容灾系统界面加载异常或者操作时发生异常..............................................................................................1289
2.5.6.4
重启主备站点异地容灾服务后产品状态异常......................................................................................................1291
2.5.6.5
重启主用站点容灾服务后异地容灾系统异常......................................................................................................1292
2.5.6.6
异地容灾接管后主用站点的主备数据库实例异常..............................................................................................1292
2.5.6.7
删除异地容灾系统后清除产品节点的容灾信息..................................................................................................1293
2.5.6.8
操作异地容灾系统后的任务列表详细信息提示消息队列出现异常...............................................................1295
2.5.7
其它故障...........................................................................................................................................................................1296
2.5.7.1
浏览器故障（Firefox浏览器访问Web界面时显示异常）.............................................................................1296
2.5.7.2
MCZKService数据文件损坏导致mczkapp进程异常......................................................................................1297
2.5.7.3
备份服务器存储空间不足导致备份文件失败......................................................................................................1298
2.5.7.4
部署面无法访问..........................................................................................................................................................1299
2.5.7.5
系统故障导致告警无法自动清除............................................................................................................................1302
2.5.7.6
备份文件版本不对应导致恢复产品节点操作系统失败.....................................................................................1303
2.5.7.7
tmp目录的空间满导致部署面Web页面显示空白...........................................................................................1304
2.5.7.8
ZookeeperService数据文件损坏导致zookeeperapp进程异常....................................................................1304
2.5.7.9
节点重启后服务状态异常.........................................................................................................................................1306

## Page 24

2.5.7.10
磁盘损坏进入维护模式...........................................................................................................................................1307
2.5.7.11 操作系统出现只读状态...........................................................................................................................................1308
2.5.7.12
登录ManageOne时界面提示无法访问............................................................................................................1309
2.5.7.13
PKI证书过期导致运营面无法登录.......................................................................................................................1310
2.5.7.14
ER证书过期导致运维面和运营面无法登录.......................................................................................................1310
2.5.7.15
节点时间跳变后周期报表中部分周期报表未继续执行...................................................................................1313
2.5.7.16
SFTP复制状态异常..................................................................................................................................................1314
2.5.7.17
安装MOICAgent异常............................................................................................................................................1315
2.5.8
数据库常用操作..............................................................................................................................................................1320
2.5.9 eSight故障......................................................................................................................................................................1321
2.6
公共组件故障......................................................................................................................................................................1321
2.6.1
Gaussdb故障..................................................................................................................................................................1321
2.6.1.1
数据库系统故障处理..................................................................................................................................................1321
2.6.1.1.1
备数据库无法升主...................................................................................................................................................1322
2.6.1.1.2 备数据库异常无法启动..........................................................................................................................................1324
2.6.1.2
非数据库系统故障处理.............................................................................................................................................1325
2.6.1.2.1
单数据库节点故障...................................................................................................................................................1325
2.6.1.2.2
主备数据库节点故障..............................................................................................................................................1327
2.6.2
DNS故障..........................................................................................................................................................................1328
2.6.2.1
管理虚拟机上所有域名无法解析............................................................................................................................1328
2.6.2.2
租户虚拟机上域名无法解析.....................................................................................................................................1329
2.6.2.3
某个域名无法解析或解析错误................................................................................................................................1332
2.6.3 APIGateway故障...........................................................................................................................................................1333
2.6.3.1
访问业务API，返回“502
Bad
Gateway”.......................................................................................................1333
2.6.3.2
访问业务API，返回“404
Not
Found”.............................................................................................................1334
2.6.3.3
访问业务API，返回“504
Gateway
Time-out”.............................................................................................1335
2.6.3.4
访问业务API，返回“500
Internal Server
Error”.........................................................................................1336
2.6.4
组合API故障..................................................................................................................................................................1336
2.6.4.1
组合API服务故障......................................................................................................................................................1336
2.6.5
CloudScope公共组件故障..........................................................................................................................................1338
2.7
云服务故障..........................................................................................................................................................................1339
3
常见问题...............................................................................................................................1345
3.1
导入环境变量......................................................................................................................................................................1345
3.2
使用PuTTY通过公私钥对认证方式登录节点............................................................................................................1346
3.3 登录和注销Service OM界面.........................................................................................................................................1349
3.4
登录FusionSphere OpenStack安装部署界面（ManageOne方式）...............................................................1350
3.5
使用PuTTY登录FusionSphere OpenStack节点....................................................................................................1350
3.6
使用PuTTY登录Service OM节点..............................................................................................................................1351
3.7
技术支持..............................................................................................................................................................................1352
3.8
查找并处理主机或者虚拟机系统中的大文件.............................................................................................................1352
3.9
手动调整物理网络平面映射关系...................................................................................................................................1354
3.10
如何清理DNS缓存........................................................................................................................................................1362

## Page 25

3.11
虚拟机状态异常...............................................................................................................................................................1363
3.12
操作日志ID的获取方法................................................................................................................................................1363
3.13
如何查找节点对应的IP地址........................................................................................................................................1364
3.14
如何查找数据库实例所在节点的IP地址和端口号.................................................................................................1365
3.15
如何查找服务所在节点的IP地址...............................................................................................................................1365
3.16
判断节点的主备...............................................................................................................................................................1366
3.17
启动部署面数据库...........................................................................................................................................................1367
3.18
查询产品名称...................................................................................................................................................................1368
3.19
加密签名证书的私钥......................................................................................................................................................1369
3.20
恢复部署面........................................................................................................................................................................1370
3.21
共部署节点故障...............................................................................................................................................................1373
3.21.1
单个共部署节点故障...................................................................................................................................................1373
3.21.2
多个共部署节点故障...................................................................................................................................................1373
3.22
启动部署面服务...............................................................................................................................................................1377
3.23
启动产品数据库...............................................................................................................................................................1380
3.24
取消与恢复ServiceOM基于ManageOne运维面的单点登录..........................................................................1380
3.25
创建虚拟机........................................................................................................................................................................1382
3.26
创建磁盘............................................................................................................................................................................1385
3.27
挂载磁盘............................................................................................................................................................................1387
3.28
清理IAM Redis数据库缓存.........................................................................................................................................1388
3.29
如何检查故障恢复后虚拟机进程的运行状态是否正常.........................................................................................1390
3.30
如何避免因停电等故障导致的虚拟机时间错误......................................................................................................1391
3.31
如何清理磁盘空间...........................................................................................................................................................1392
3.32
如何设置浮动IP地址.....................................................................................................................................................1394
3.33
如何检查IP地址冲突.....................................................................................................................................................1394
3.34
如何在异常下电后上电系统.........................................................................................................................................1395
3.35
如何处理虚拟机异常上下电导致的磁盘异常...........................................................................................................1396
3.36
如何处理虚拟机下电MessagingBrokeService服务重启后Kafka异常..........................................................1397
3.37
如何下载日志...................................................................................................................................................................1398
3.38
如何设置ManageOne虚拟机规格............................................................................................................................1401
3.39
如何恢复ManageOne-SubRegion-Static虚拟机的产品....................................................................................1418
3.40
如何恢复MORabbitMQService服务故障...............................................................................................................1422
3.41
如何开启调用链功能......................................................................................................................................................1424
3.42
典型Cinder问题定位指导............................................................................................................................................1425
3.42.1
排查FusionSphere
OpenStack...............................................................................................................................1425
3.42.1.1
查询对应卷信息........................................................................................................................................................1425
3.42.1.2
查看cinder-api日志...............................................................................................................................................1427
3.42.1.3
查看cinder-scheduler日志...................................................................................................................................1429
3.42.1.4
查询cinder-volume日志.......................................................................................................................................1430

## Page 26

1
告警参考
1.1
告警监控
1.1.1
简介
1.1.1.1
什么是告警监控
运维人员通过告警监控来监控、管理系统自身或管理对象上报的告警或事件。告警监
控提供了丰富的监控和处理规则，还可以将故障通知给运维人员，帮助高效监控、快
速定位和处理网络故障，从而保证业务正常运行。
图1-1 告警监控示意图
在进行告警监控相关操作之前，请先了解以下基本概念。
告警和事件
系统自身或管理对象检测到自身存在异常或正常运行时的重要状态变化，将分别以告
警或事件显示在告警管理界面中。管理对象指接入告警管理系统的对象或网元。告警
和事件的定义等信息如表1-1所示。
1

## Page 27

表1-1 告警和事件
名
称
含义 区别 共同点
告
警
系统自身或
管理对象检
测到故障而
产生的通
知。
●
告警的产生预示着系统自身或管理对
象发生了异常或故障；事件是系统自
身或管理对象在正常运行状态下产生
的通知。
●
告警必须要处理，否则会导致业务异
常；事件不需要处理，用来帮助分
析、定位问题。
●
用户可以在界面上对告警进行确认和
清除；用户不能对事件进行确认和清
除。
以通知方式提示用
户。
事
件
系统自身或
管理对象在
正常运行状
态下产生且
需要主动提
示用户的通
知。
告警级别
告警级别用来表示故障的严重程度、重要性和紧迫性，帮助运维人员在大量告警中快
速识别告警的重要程度，采取相应的处理策略，运维人员也可以根据需要调整告警的
级别。
告警的级别说明如表1-2所示。
表1-2 告警级别
告警级
别
缺省
颜色
说明 处理策略
紧急 已经影响业务，需要立即采取纠
正措施。
需要紧急处理，否则有业务中
断或系统瘫痪的风险。
重要 已经影响业务，如果不及时处理
会产生较为严重后果。
需要及时处理，否则会影响重
要业务运行。
次要 目前对业务影响轻微，但需要采
取纠正措施，以防止更为严重的
故障发生。
需要查找告警原因，消除故障
隐患。
提示 检测到潜在的或即将发生的影响
业务的故障，但是目前对业务还
没有影响。
可根据告警了解网络和网元的
运行状态，视具体情况进行处
理。
告警状态
告警的状态分类如表1-3所示。
1

## Page 28

表1-3 告警状态分类
状态名称 告警状态 说明
确认状态 已确认、未
确认
初始确认状态为“未确认”。当用户已经看到此告警并
纳入到处理计划中，此时对告警进行“确认”操作，告
警变为“已确认”状态；当此告警暂时不处理但需要后
续关注或者其他用户进行处理时，用户可以进行“反确
认”操作，则告警恢复为“未确认”状态。用户也可以
通过配置“自动确认规则”来实现告警自动确认。
清除状态 已清除、未
清除
初始清除状态为“未清除”。当修复了引起告警的故
障，对应的清除通知自动上报到告警管理系统后，告警
状态将变为“已清除”。部分告警修复后，清除通知无
法自动上报至告警管理系统，则用户需确认故障修复后
手工执行“清除”操作。“已清除”告警的背景色在界
面中显示为绿色。
维护状态 正常态、维
护态
●
正常态：告警初始维护状态为正常态。
●
维护态：因调测产生而非故障产生的告警，在监控或
查询告警时，可通过过滤条件将维护态告警过滤掉，
运维人员不用耗费时间关注这类告警。用户可通过配
置“标识规则”将其设置为“维护态”，也可直接在
当前告警列表中将此类告警设为维护。维护态包括：
新建、扩容、升级、调测。
失效状态 有效告警、
无效告警
●
有效告警：告警初始失效状态为有效。
●
无效告警：运维人员通过经验判断为无用的告警。可
通过配置“标识规则”将其设置为“无效”，也可直
接在当前告警列表中将此类告警设为无效。在监控或
查询告警时，可通过过滤条件将无效告警过滤掉，运
维人员不用耗费时间关注这类告警。
事件状态
事件的状态分类如表1-4所示。
表1-4 事件状态分类
状态名称 事件状态 说明
维护状态 正常态、维
护态
事件的维护状态是固定的，在监控或查询事件时，可通
过过滤条件将维护态事件过滤掉，运维人员不用耗费时
间关注这类事件。
说明
●
“正常态”的事件在事件日志中的“维护状态”显示为“普
通”。
●
“维护态”的事件在事件日志中的“维护状态”显示为“新
建”、“扩容”、“升级”或“调测”。
1

## Page 29

当前告警和历史告警
当前告警和历史告警的说明如表1-5所示。
表1-5 当前告警和历史告警
名称 说明
当前告警 包括：未确认未清除告警、已确认未清除告警、未确认已清除告
警。用户可监控当前告警，及时发现故障，并作相应操作，通知
给运维人员处理。
历史告警 已确认已清除告警。用户可对历史告警进行分析，优化系统的性
能。
告警和事件的类型
用户可以设置告警或事件的某些类型为过滤条件进行查询，以便进行分析、处理。
告警和事件的类型说明如表1-6所示。
表1-6 告警和事件的类型
名称 说明
通信告警 网元内部、网元之间、网元与管理系统之间、管理系统之间的
通信失败而引起的告警。如：设备通信中断告警。
业务质量告警 业务质量退化问题而引起的告警。如：设备拥塞告警。
处理错误告警 软件或处理过程错误而引起的告警。如：版本不匹配告警。
设备告警 物理资源故障而引起的告警。如：单板故障告警。
环境告警 设备所处环境出现问题而引起的告警。如：硬件温度过高而产
生的温度告警。
完整性告警 请求的操作不能正常提供。如：非法的修改、增加和删除用户
信息。
操作告警 所需服务因不可用、故障或错误调用等问题无法正常运行而引
起的告警。如：服务拒绝、服务退出、程序性错误。
物理资源告警 物理资源受到破坏而引起的告警。如：电缆破损、非法闯入机
房。
安全告警 安全服务或机制检测到有关安全方面的问题发生。如：鉴权失
败、机密泄露、非法访问。
时间域告警 某事在不应该发生的时间内发生。如：信息延迟、密钥失效、
在非授权时间段访问资源。
属性值改变 管理对象的属性值发生变化。如：属性增加、减少和改变。
对象创建 管理对象的实例被创建。
1

## Page 30

名称 说明
对象删除 管理对象的实例被删除。
关系改变 管理对象的关系属性发生变化。
状态改变 管理对象的状态属性发生变化。
路由改变 路由发生变化。
保护倒换 倒换引起的告警或事件。
越限 当性能指标达到阈值时，上报该类告警或事件。
文件传输状态 文件传输成功/失败后上报该类告警或事件。
备份状态 管理对象的备份状态发生变化。
心跳 发送心跳通知。
1.1.1.2
价值描述
ManageOne运维面告警管理可以集中监控系统服务或第三方系统的告警，快速定位和
处理网络已发生的故障，从而保证业务正常运行。告警管理致力于实现数据中心全栈
告警监控，提供丰富的监控和处理规则，监控和管理系统自身或管理对象上报的告警
或事件，帮助运维人员高效监控，提升运维效率。
图1-2 告警监控价值
1

## Page 31

●
集中监控
–
提供多领域、多厂商数据采集能力，支持从下层第三方系统采集网元的告警
信息，然后将处理后的告警集中显示在监控界面中，运维人员在日常工作中
可在统一的监控界面上集中监控告警。
–
提供灵活的告警实时上报接口，将告警数据上报给上级网管，方便运维人员
集中监控告警。
●
精准监控
支持灵活的告警规则配置，将海量的告警进行关联和压缩，减少告警噪声，实现
精准监控。
●
多样化监控
提供了多样化的告警过滤方式，帮助运维人员快速筛选所关注的告警，提高监控
效率。
●
个性化监控
支持个性化设置告警/事件的颜色，告警的声音，告警的字体颜色等，满足不同场
景下的需求。
1.1.1.3
应用场景
告警管理全景图描绘不同运维场景下的告警操作任务。用户可以根据实际场景，执行
对应的运维任务。
告警管理全景图如图1-3所示。
1

## Page 32

图1-3 告警管理
1.1.1.4
功能介绍
告警管理提供了丰富的监控和处理规则：通过配置告警/事件可以帮助用户压缩告警
量、实现告警实时通知、满足个性化监控需要；多个监控页面为用户提供多样、便捷
的监控与处理方式；在告警数据的日常维护方面，提供了可设置的保障机制，避免因
数据库存储满而影响新告警的上报。
可配置的告警/事件规则说明请参见表1-7。
1

## Page 33

表1-7 配置告警/事件规则
功能 描述
配置告警/事件 提供告警相关规则和设置的可视化管理界面。异地容灾场景，主备
站点的告警规则每小时同步一次，异地容灾倒换后，告警规则5分
钟内完成全量同步。
●
屏蔽规则
系统自身或管理对象在维修、测试或者开局期间，上报的告警/
事件是可预料的，不需要被关注、处理，可以通过设置屏蔽规
则使其在当前告警、历史告警或事件日志中不可见。在设置屏
蔽规则时，用户可以选择将被屏蔽的告警/事件丢弃（不在告警
数据库中保存），或将被屏蔽的告警显示在被屏蔽告警中。
●
标识规则
设置该规则后系统将自动给符合规则条件的告警设置状态标
识。例如，当运维人员在维护设备时，可将设备调试产生的告
警设置为维护态，此时可设置过滤条件将该类告警过滤掉从而
精简告警，提升告警处理效率。
●
级别和类型重定义规则
为优先保障某区域网络设备或某些关键设备通畅运行，可通过
重定义规则调整告警/事件级别和类型。例如可将重点关注的告
警设置为高级别，运维人员将会对该告警优先处理，从而提供
优质网络保障服务。
● 名称重定义规则
有些告警/事件名称比较专业化，用户难以理解，通过名称重定
义，用户可以根据自己的实际需要重新设置告警/事件名称。
●
相关性规则
相关性规则中定义了告警之间的根源与衍生关系。根源衍生关
系指产生原因有关联的几个告警，其中一个告警是其他告警产
生的根源。用户可根据需要自定义相关性规则或启停缺省相关
性规则。
在监控或查看告警时可以将衍生告警过滤掉，只关注要处理的
根源告警。
●
闪断/振荡规则
当一条告警的产生时间与清除时间的间隔小于指定的时间，则
该告警称为闪断告警。
当指定周期内同一告警源上报的同一告警（告警ID相同）次数
达到触发条件时，则启动振荡处理。
通过设置闪断/振荡告警处理规则，可以将闪断告警或振荡期间
生产的告警丢弃或屏蔽，以减少海量重复告警对运维的干扰。
●
汇聚规则
同一告警/事件源多次上报的同一告警/事件（ID相同），形成了
重复告警/事件。根据规则将指定周期内上报的重复告警/事件汇
聚到同一个告警下，以减少大量重复告警/事件对运维的干扰，
运维人员可在告警的详情页面查看被汇聚的告警。
●
事件转ADMC告警
若需要提升对事件的关注度，可设置将事件转为ADMC（Auto
Detected Manually
Cleared）告警。该类告警无法自动清除。
●
自动确认规则
1

## Page 34

功能 描述
设置自动确认规则后，告警管理将处于清除状态的当前告警，
按照指定的规则进行自动确认并移入到历史告警列表中。
告警远程通知 通过告警远程通知功能，告警管理能够实时的将告警/事件信息通
过短消息或电子邮件的方式发送给用户，以便用户在非工作时间也
能实时掌握告警/事件情况，及时处理重要告警/事件。
个性化监控 告警管理提供了多种告警/事件的显示方式和声音提示规则。用户
可以根据需要修改告警视听规则，通过不同的通知方式获取最新的
告警/事件信息。
●
颜色设置：设置不同级别告警/事件对应的颜色，用户可更方便
地浏览关注的告警/事件。
●
告警声音：设置不同级别告警对应的提示声音，用户可更方便
地监控告警。
●
字体颜色：设置已读告警和未读告警的颜色，以便于用户区
分。
● 高亮显示：通过设置告警高亮显示，若告警在设定时间内没有
得到处理（即状态没有改变），则该告警在告警列表中高亮显
示，提示用户关注此告警。
●
告警展示方式：设置不同级别和不同状态的告警展示方式，方
便用户快速识别关注的告警。
监控告警/事件和处理告警的具体方式说明请参见表1-8。
1

## Page 35

表1-8 监控告警/事件和处理告警
功能 描述
监控和查看告警/
事件
在告警管理中，运维人员可以监控和查看告警/事件，以便实时
了解系统中的告警/事件状况并采取相应的措施。
●
告警/事件列表
–
提供当前告警列表，主动将告警推送至当前告警界面。运
维人员可在该列表中实时监控和处理告警。告警上报后存
储在数据库中，数据库中当前告警的容量上限有2万、5
万、10万、20万、30万、50万和100W条的档位，在系统
安装部署时配置为缺省显示2万条，不建议更改。
–
提供告警日志列表，支持查看当前告警和历史告警，缺省
显示20000条。
–
提供事件日志列表，支持查看设备向系统发送的具体事件
消息。缺省显示20000条。
●
统计面板
在当前告警页面中提供了统计面板，支持显示以下统计数
据：
– Top 10
告警：统计出数量最多的10个告警。
–
告警持续时长：统计出各持续时长下的当前告警数量。
– Top 10
告警源：统计出当前告警数量最多的10个告警源。
–
告警级别：统计当前告警总数和各告警级别的当前告警数
量。
–
告警状态：统计各清除确认状态下的告警数量。
●
告警/事件名称组
用户可将多个告警/事件名称添加至一个名称组下，以便同时
对多个告警/事件进行操作。
● 告警声光提示
当有新的告警上报时，告警管理发出提示声音，告警板中对
应级别的告警灯开始闪烁，以提醒用户及时处理告警。
●
过滤
运维人员可设置过滤条件，筛选出重点关注的告警，实现精
准监控。
1

## Page 36

功能 描述
处理告警 在告警管理中，运维人员可以对告警进行操作处理，以辅助故障
处理。例如为告警指定处理人、确认告警、清除告警等操作。告
警处理的主要功能如下：
●
查看告警详情
获取告警名称、定位信息等告警重要信息，协助运维人员定
位及排除告警对应的故障。
●
手工确认告警
确认告警表示某条告警已有人跟踪处理，其他用户不必过多
关注。如果要其他用户关注该告警，可以对该告警进行反确
认操作。告警管理支持告警的手工确认、反确认以及按级别
自动确认。
●
指定处理人
将告警指派给具体的运维人员处理。
● 记录维护经验
当运维人员处理告警后，及时记录处理告警的经验，以便为
后续处理相同告警时提供参考。
●
手工清除告警
对一些无法自动清除的告警，或者故障已确定排除但告警状
态仍为未清除的告警，可以手工清除。
告警数据管理等日常维护的相关功能说明请参见表1-9。
表1-9 日常维护相关功能
功能 描述
性能优化和统计 查看历史告警和被屏蔽告警。用户可通过对历史告警和被屏蔽告
警的分析，了解设备的运行情况及检查规则配置的合理性。
●
提供历史告警列表，支持查看已确认已清除的告警，缺省显
示20000条。
●
提供被屏蔽告警列表，运维人员可通过查看被屏蔽的告警检
查规则配置的合理性。缺省显示20000条。
告警/事件数据管
理
●
当前告警阈值提示
用户可在“当前告警阈值提示”页面查看当前告警的容量上
限。当数据库中的当前告警容量达到上限时，系统将对当前
告警进行满处理，将当前告警转为历史告警。为避免用户关
注的告警被转为历史告警，用户可设置当前告警阈值提示，
当前告警数量达到一定阈值时，上报告警，提示用户对当前
告警进行处理。
●
手动同步告警
对接系统与当前系统断连后导致对接系统侧告警无法上报，
二者重新连通后需将告警同步到当前系统，便于当前系统监
控。
1

## Page 37

功能 描述
维护经验管理 处理告警后，及时将处理经验记录在维护经验库中，以便在后续
维护工作中进行参考或对其他人的维护工作提供借鉴和指导。维
护经验支持导入或导出。
1.1.1.5
实现逻辑
介绍告警处理机制和告警/事件内部处理流程。
告警处理机制
告警管理提供了3种告警处理机制，请参见表1-10。
表1-10 告警处理机制
机制 描述
告警归并规则 为帮助用户提高监控、处理告警的效率，告警管理提供了告警归
并规则，即将指定字段（定位信息、告警ID等）全相同的告警归
并成一条告警。该规则仅用于在“当前告警”页面监控和查看告
警，且仅对当前告警生效。
具体执行方案如下：
●
新上报的告警未匹配到符合归并规则的已上报告警，该新上报
的告警记作归并告警，其“次数”为1。
●
当新上报的告警B与已上报告警A符合归并规则，则告警B与告
警A归并为一条告警记录，并按照清除状态（未清除告警在
前）及发生时间的降序进行排序。
若告警A排第一，告警A仍记作归并告警，且归并告警的“次
数”加1，告警B记作被归并告警。
在告警列表中，单击告警的“次数”可查看归并告警和被归并
告警的详细信息。
●
若归并告警的状态由未清除变为已清除，则该归并告警转为被
归并告警，原有的被归并告警中，并按照清除状态（未清除告
警在前）及发生时间的降序进行排序。
● 若归并告警或被归并告警的状态转为已清除已确认，则将该告
警转为历史告警，告警“次数”减1。
1

## Page 38

机制 描述
告警满处理规
则
为了避免因当前告警过多影响系统性能，告警管理功能提供了告
警满处理规则。当数据库中的当前告警数量达到上限阈值时，按
以下规则将部分告警转为历史告警，当告警数量恢复到上限阈值
的90%时，停止满处理。
●
告警类型按照“已清除告警”、“已确认未清除的不可自动清
除告警”、“已确认未清除的可自动清除告警”及“未确认未
清除告警”的先后顺序，依次转为历史告警。
●
类型相同的告警按照时间顺序优先将较早发生的告警转为历史
告警。
●
分布式场景下，网元分区后上报的告警满处理时，依次将所在
节点的告警按照数量由高到低的顺序转为历史告警，上报告警
越多的节点转历史优先级越高。例如网元分别接入到A、B节
点，A节点接入的网元告警量大，会优先将A节点的告警进行满
处理，上报告警量少的网元节点B不做处理。
告警转储规则 为避免告警数据库数据过多，系统每2分钟按以下规则对事件、被
屏蔽告警、历史告警数据进行转储处理，被转储的告警/事件在告
警/事件列表中无法查询到。
●
数据库空间使用率达到“80%”则按照发生时间顺序以及数据
表的类型的顺序（事件、被屏蔽告警、历史告警）将数据库中
的数据转储至文件。当转储后空间使用率达到转储前使用率的
“80%”时，停止转储。
●
当检测到数据库表中数据发生时间都在90天之前则会转储该
表。
转储后的文件符合以下任一规则，将会被删除。
●
转储后的文件超过180天，则会被删除。
●
转储后的文件总大小超过1GB或者文件总数超过1000个，系统
会删除时间较早的文件。
告警内部处理流程
告警内部处理流程是指告警上报至告警管理后，告警管理对告警的内部处理流程，包
括进行屏蔽、相关性分析、级别重定义等操作。
告警内部处理流程如图1-4所示。
1

## Page 39

图1-4 告警内部处理流程
告警内部流程说明请参见表1-11。
表1-11 告警内部处理流程说明
操作 说明
名称重定义 告警管理接收到告警后，首先根据名称重定义规则对告警进行
匹配，修改符合规则的告警名称。
告警屏蔽 将符合屏蔽规则的告警丢弃（不进入数据库）或记录在被屏蔽
告警数据表中，不再进行后续的告警预处理。
闪断/振荡（预处
理）
将符合闪断/振荡规则条件的告警记录在闪断/振荡数据表中，不
再进行后续的告警预处理。
告警标识 将符合标识规则的告警进行状态标识处理。
1

## Page 40

操作 说明
告警变更 根据上报的变更告警，更新当前告警信息，例如清除告警、修
改级别等。
级别和类型重定
义
将符合级别和类型重定义规则的告警进行重定义处理。
相关性分析 根据相关性规则将符合条件的告警标记为根源/衍生告警，并根
据规则中的动作对根源/衍生告警进行处理。
汇聚 将符合汇聚规则的告警根据汇聚动作进行处理。
远程通知 当符合远程通知规则的告警上报时，发送邮件或短消息通知运
维人员。
北向过滤 将符合上报条件的告警发送给上级网管。
自动确认 将符合自动确认规则的告警进行自动确认，自动确认后的告警
记录在历史告警数据表中。
入数据库 经过以上步骤处理的告警记录到数据库中。告警预处理中被屏
蔽告警或转历史的告警将不会进行告警后处理，直接实时通
知。
闪断/振荡（后处
理）
对闪断/振荡数据表中的告警进行分析，将符合闪断/振荡策略的
告警进行处理。
告警归并 将符合归并条件的告警进行归并。
实时通知 实时刷新告警界面中的告警信息。
事件内部处理流程
事件内部处理流程如图1-5所示。
1

## Page 41

图1-5 事件内部处理流程
事件内部流程说明请参见表1-12。
表1-12 事件内部处理流程说明
操作 说明
名称重定义 告警管理接收到事件后，首先根据名称重定义规则对事件进行
匹配，修改符合规则的事件名称。
事件屏蔽 将符合屏蔽规则的事件丢弃（不进入数据库），不再进行后续
的处理。
1

## Page 42

操作 说明
事件转ADMC告警 符合事件转ADMC告警规则的事件将转为告警，进行告警的处
理流程。不符合规则的事件将继续进行事件的处理流程。
级别和类型重定
义
将符合级别和类型重定义规则的事件进行重定义处理。
汇聚 将符合汇聚规则的事件根据汇聚动作进行处理。
远程通知 当符合远程通知规则的事件上报时，发送邮件或短消息通知运
维人员。
北向过滤 将符合上报条件的事件发送给上级网管。
入数据库 将经过以上步骤处理的事件记录到数据库中。
实时通知 实时刷新事件日志中的事件信息。
1.1.2
使用流程
运维人员可以监控和查看告警/事件，以便实时了解系统中的告警/事件状况并采取相应
的措施。
1

## Page 43

1.
配置告警或事件规则（可选）
告警监控提供了丰富的监控和处理规则，用户可以配置告警/事件处理规则，帮助
用户压缩告警量、实现告警实时通知等。具体操作请参见1.1.6 配置告警。
2.
查看当前告警/事件
运维人员可以监控和查看告警/事件，以便实时了解系统中的告警/事件状况。具体
操作请参见1.1.3 监控和查看告警/事件。
3.
处理告警
运维人员接收到告警上报后，需要及时采取措施处理告警，进行问题定位，辅助
故障处理。具体操作请参见1.1.4 处理告警。
4.
分析告警
1

## Page 44

运维人员可以通过分析历史告警，及时了解系统的运行情况及潜在的隐患，及时
处理，避免故障发生。具体操作请参见1.1.5 分析告警。
5.
个性化监控（可选）
告警监控提供个性化设置告警/事件的颜色，告警声音等，满足不同场景下用户的
需求。具体操作请参见1.1.6 配置告警。
1.1.3
监控和查看告警/事件
在告警管理中，运维人员可以监控和查看告警/事件，以便实时了解系统中的告警/事件
状况并采取相应的措施。
1.1.3.1
监控和查看当前告警
在“当前告警”页面，运维人员可以查看实时更新的当前告警，以便掌握最新告警动
态。
背景信息
●
如果有新告警上报且当前告警条数超过该上限，告警管理会启动告警满处理，将
部分告警转为历史告警。
●
用户首次进入“当前告警”界面时，告警列表缺省按照最近到达网管时间的顺序
排列。
●
新上报告警将在页面中加粗显示。
●
“已清除”告警的背景色在界面中显示为绿色。
●
用户只能监控和查看已授权管理对象的告警。
●
最多支持不同用户打开200个“当前告警”页面。
●
异地容灾场景，主备站点的告警规则每小时同步一次，异地容灾倒换后，告警规
则5分钟内完成全量同步。
操作步骤
● 监控告警
a. 在主菜单中选择“集中监控 > 告警管理 > 当前告警”。
b. 监控告警方式请参见下表。
表1-13 监控告警方式
任务名称 任务描述
通过告警列表监控
告警
通过“当前告警”页面实时监控所有网元和系统上报
的告警。
通过告警灯监控告
警
在“当前告警”页面右上角的告警灯显示4种告警级
别（紧急、重要、次要、提示）的告警数量。
1

## Page 45

任务名称 任务描述
通过统计面板监控
告警
在“当前告警”页面右上角单击 ，可监控告警的
统计结果图表，统计结果基于过滤后的告警得出。
统计面板可展示“Top
10
告警”、“告警持续时
长”、“Top
10
告警源”、“告警级别”、“告警
状态”五个统计图表。系统支持同时展示4个统计图
表，用户可在统计面板右上角单击 ，进入编辑面
板，单击统计图表右上角下拉框，选择想要展示的图
表与当前图表作替换。
在统计面板中，单击任意统计图形可快速过滤该条件
下的告警。关闭统计面板将自动取消面板中选中的过
滤条件。
说明
●
告警管理最多支持在线用户同时打开10个统计面板。
●
可以在统计面板右上角单击 执行手动刷新统计数
据。在打开统计面板或执行手动刷新后的10分钟内，每
分钟执行1次自动刷新。
●
查询告警
a.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”。
b.
用户可在页面左上方单击“默认模板”，打开快速过滤和分组列表。
▪
快速过滤：显示所有过滤模板，单击某个模板后，告警列表会立即根据
该模板更新。
▪
分组列表：显示所有分组，单击某个分组后，告警列表会立即更新为来
自该分组内资源的告警。
具有Administrators角色的用户可管理所有用户保存的模板。
系统提供以下类型的模板：
▪
关注模板：用户关注的模板，用户可将常用模板设置为关注模板，便于
选择。
▪
自定义模板：当前用户自定义的模板，用户可设定是否将模板共享给其
他用户。
▪
共享模板：其他用户共享的可使用的模板。
▪
预置模板：系统缺省的模板。预置模板中的默认模板，是用户首次登录
系统后默认使用的过滤模板。采用默认模板，当前告警页面只展示普通
告警、根源告警和汇聚告警。
▪
其他模板：其他用户不共享的模板。其他模板只对具有Administrators角
色的用户可见。
说明
当前告警、告警日志、历史告警、被屏蔽告警、事件日志各界面的过滤模板相对独
立，不能共用。
1

## Page 46

c.
若模板管理中的过滤模板不满足用户需求，在“当前告警”页面左上角单击
“过滤”设置过滤条件。在过滤条件区域选择过滤条件并单击“确定”搜索
告警，查看当前需要关注和处理的告警。
d.
单击“保存”或“另存为”将当前过滤条件保存或另存为过滤模板。
e.
导出当前告警。系统支持导出后缀为.xlsx或.csv的文件，当导出格式为.xlsx且
告警数量超过10万条时，文件将以zip压缩包的格式导出。当导出格式为.csv
且告警数量超过1万条时，文件将以zip压缩包的格式导出。
▪
导出部分告警：选择要导出的告警，单击“导出”，选择“导出选
中”。
▪
导出全部告警：单击“导出”，选择“全部”。
说明
导出告警时，只能导出界面中配置显示的告警列信息，可在告警列表右上方单击
，设置要显示的告警列。
1.1.3.2
查看告警日志
通过设置告警日志查询条件，可以查看到每条告警的信息，包括当前告警和历史告
警。
背景信息
●
已确认已清除的告警为历史告警，其他为当前告警。
●
缺省展示2万条告警。当告警条数超过该上限时，则根据过滤条件和排序结果显示
前2万条告警。如果想要查询其他告警，可以修改过滤条件和排序进行查询。
●
用户只能监控和查看已授权管理对象的告警。
●
“告警日志”页面支持打开的数量缺省不超过30个。
操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警日志”。
1.
在“告警日志”页面，单击“过滤”，通过设置过滤条件，可以快速找到所关注
的告警。
2.
单击“保存”或“另存为”将当前过滤条件保存或另存为过滤模板。
用户可在页面左上方单击“模板管理”查看当前界面的全部过滤模板，并在“快
速过滤”中选择过滤模板。具有Administrators角色的用户可管理所有用户保存的
模板。
系统提供以下类型的模板：
–
关注模板：用户关注的模板，用户可将常用模板设置为关注模板，便于选
择。
–
自定义模板：当前用户自定义的模板，用户可设定是否将模板共享给其他用
户。
–
共享模板：其他用户共享的可使用的模板。
–
其他模板：其他用户不共享的模板。其他模板只对具有Administrators角色的
用户可见。
1

## Page 47

说明
当前告警、告警日志、历史告警、被屏蔽告警、事件日志、告警日志统计各界面的过
滤模板相对独立，不能共用。
步骤2 导出告警。系统支持导出后缀为.xlsx、.csv或.html的文件，当导出格式为.xlsx且告警数
量超过10万条时，文件将以.zip压缩包的格式导出；当导出格式为.csv或.html，且告警
数量超过1万条时，文件将以.zip压缩包的格式导出。
●
导出部分告警：选择要导出的告警，单击“导出”，选择“导出选中”。
●
导出全部告警：单击“导出”，选择“全部”。
说明
导出告警时，只能导出界面中配置显示的告警列信息，可在告警列表右上方单击 ，设置要显
示的告警列。
----结束
1.1.3.3
查看事件日志
通过查询事件信息，可以查看到设备向系统发送的具体事件消息。用户可在“事件日
志”中实时监控事件。
背景信息
●
缺省展示2万条事件。当事件条数超过该上限时，则根据过滤条件和排序结果显示
前2万条事件。如果想要查询其他事件，可以修改过滤条件和排序进行查询。
● 用户只能监控和查看管理对象的事件。
●
“自动刷新”功能默认关闭，同一时间最多支持两个窗口打开该功能。
●
打开“自动刷新”后，新上报的事件将在页面顶端显示。此时若对事件列表进行
了排序，新上报事件也在页面顶端显示。
操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
事件日志”。
1.
在“事件日志”页面，通过设置过滤条件，可以快速找到所关注的事件。
2.
单击“保存”将当前过滤条件保存为过滤模板。
用户可在页面左上方单击关注按钮“模板管理”查看当前界面的全部过滤模板，
并在“快速过滤”中选择过滤模板。具有Administrators角色的用户可管理所有用
户保存的模板。
系统提供以下类型的模板：
–
关注模板：用户关注的模板，用户可将常用模板设置为关注模板，便于选
择。
–
自定义模板：当前用户自定义的模板，用户可设定是否将模板共享给其他用
户。
–
共享模板：其他用户共享的可使用的模板。
–
其他模板：其他用户不共享的模板。其他模板只对具有Administrators角色的
用户可见。
1

## Page 48

说明
当前告警、告警日志、历史告警、被屏蔽告警、事件日志各界面的过滤模板相对独立，不
能共用。
步骤2 导出事件。系统支持导出后缀为.xlsx或.csv的文件，当导出格式为.xlsx且告警数量超过
10万条时，文件将以zip压缩包的格式导出。当导出格式为.csv且告警数量超过1万条
时，文件将以zip压缩包的格式导出。
●
导出部分事件：选择要导出的事件，单击“导出”，选择“导出选中”。
●
导出全部事件：单击“导出”，选择“全部”。
说明
导出事件时，只能导出界面中配置显示的事件列信息，可在事件列表右上方单击 ，设置要显
示的事件列。
----结束
参数说明
表1-14 事件日志参数说明
名称 说明
事件流水号 一条事件从产生开始，中间可能经过多次改变，根据该流水号
可以唯一确定一条事件。
事件源 产生事件的设备名称/网元名称。
名称 事件的名称。根据事件名称可以了解事件源发生了什么改变。
VDC ID
VDC的ID，与VDC名称一一对应。
VDC名称 VDC的名称。
事件ID 与事件名称一一对应。
事件匹配的规则名 事件经过规则匹配后，打上生效的规则标记。
级别 包括4种级别：紧急、重要、次要、提示。
可能原因 描述引起该事件的所有可能原因，引导维护人员处理事件。
来源系统 事件来源系统的信息，包含位置、数据中心、系统类型、系统
名称等信息。
来源系统流水号 告警管理为事件来源系统分配的标识。
事件源类型 发生事件的网元类型。
类型 事件的类型。
定位信息 辅助进行定位的信息。通过定位信息可以快速地定位到产生事
件的位置。
发生时间 事件发生的时间。
到达网管时间 事件到达告警管理系统的时间。
1

## Page 49

名称 说明
区域 事件源所属逻辑位置的名称。
部署区域 设备部署区域标识。区域可能对应于一个物理的数据中心，也
可能对应于逻辑区域。
厂商 网元所属的厂商。
领域 产生事件的网元所属的产品类型。
IP地址/URL/域名 事件物理设备的IP地址。
附加信息 记录事件的一些和定位无关的信息，辅助用户理解该事件。
租户标识 事件源所属的租户标识。
租户名称 事件源所属的租户名称。
影响业务名称 事件所影响的业务名称。
影响业务标识
●
是：对业务有影响。
●
否：对业务无影响。
●
未知：对业务的影响不明确。
来源系统类型 事件来源系统的类型。
NFV资源池 事件源所属NFV资源池的名称。
备份状态 通过该参数反映该事件对业务的影响程度，包括3种状态：
● 是，表示承载的业务已倒换到备用资源上，并没有对现有业
务能力造成直接的影响；
●
否，表示承载的业务未倒换到备用资源上，对于同一个事
件，备份状态为“否”对业务的影响程度比备份状态为
“是”的事件要高；
●
未知：表示对于承载的业务是否倒换到备用资源上不能确
定。
原因标识 导致该事件的具体原因的ID。
数据中心 事件源所属数据中心的名称。
维护状态 事件的维护状态，如“普通”表示事件源正常运行，没有处于
调测或升级等状态。
资源名称 事件源的资源名称。
资源标识 事件源的资源ID。
可用区 事件源所属可用区的名称。
备注 由用户填写的事件备注信息，长度不超过512个字符。
设置方法：用户可选中一条事件并单击“备注”按钮，输入事
件备注信息。
1

## Page 50

名称 说明
阈值信息 包含故障相关的测量指标的门限和当前值。例如：上报“环境
温度越限告警”时，需要说明温度过高还是过低，对应的门限
值和当前的温度值。
操作
●
“设置屏蔽规则”，具体请参见1.1.6.6 配置屏蔽规则；
●
“设置远程通知规则”，具体请参见1.1.6.16 配置远程通知
规则；
●
“设置级别和类型重定义规则”，具体请参见1.1.6.11 配置
级别和类型重定义规则；
●
“设置名称重定义规则”，具体请参见1.1.6.12 配置名称重
定义规则；
●
“设置汇聚规则”，具体请参见1.1.6.8 配置汇聚规则。
1.1.4
处理告警
在告警管理中，运维人员可以对告警进行操作处理，以辅助故障处理。例如为告警指
定处理人、确认告警、清除告警等操作。
前提条件
已具备“告警处理”、“告警清除”、“修改告警级别”和“同步网元告警”权限。
背景信息
告警管理主要提供了处理告警的确认和清除以及调整级别、设为无效、设为维护态等
操作，确认和清除如表1-15所示。告警状态转换关系如图1-6。
表1-15 告警处理操作
名称 作用 说明
确认 标识告警由谁处理，避免多人同
时处理同一条告警。
对告警进行确认表示告警即将或已经
被处理。告警被确认后，由未确认状
态变成已确认状态。
如果要更换告警处理人员，可对该告
警进行反确认操作。告警被反确认
后，由已确认状态变成未确认状态。
清除 标识告警对应的故障是否恢复。 当对接网元或系统自身发生故障时，
产生告警；当故障排除后，产生清除
告警，原告警被清除。如果网络出现
故障导致系统没有接收到清除告警或
告警不能自动清除，就需要用户手工
清除告警。
用户对告警执行手工清除后，告警管
理会下发清除告警命令，对接网元或
系统自身会清除相应的告警。
1

## Page 51

图1-6 告警状态转换关系
根据告警的确认、清除状态，告警管理将告警分为：
●
当前告警：包括未确认未清除告警、已确认未清除告警、未确认已清除告警。需
运维人员重点关注的，可在“当前告警”中进行监控、处理告警。
●
历史告警：指已确认已清除告警。供运维人员查询、统计告警数据，为网络性能
优化提供数据来源。
操作步骤
说明
●
两级运维场景下，总部ManageOne运维面可展示全网的告警，包括总部和分部。分部告警
的处理请在分部ManageOne运维面执行，执行后会同步至总部。
●
对于“来源系统”为“CloudScope”的告警，ManageOne运维面只支持查看，不支持处理
告警的相关操作。
步骤1 在主菜单中选择“集中监控
>
告警管理
>
当前告警”。
步骤2 在“当前告警”界面可以进行如下操作。
操作名称 场景 操作
查看告警
详情
获取告警名称、定位信息等告警重
要信息，协助运维人员定位及排除
告警对应的故障。
在告警列表中，单击目标告警所
在行左侧的箭头，展开目标告警
的拓展行。
说明
展开拓展行后，“自动刷新”开关将
自动关闭，关闭拓展行后自动开启。
手工确认
告警
为避免他人同时对某条告警进行处
理，用户在处理告警时需手工确认
该告警，确认状态表示该告警已有
人跟进处理，其他用户不必关注。
告警被确认后，由未确认状态变成
已确认状态。
选中一条或多条告警，单击告警
列表上方的“确认”；也可以在
告警列表中单击某条告警操作列
的 。
确认后，告警参数“确认用户”
显示为确认的用户名。
1

## Page 52

操作名称 场景 操作
指定处理
人
将告警指派给具体的运维人员处
理。
在告警列表中选择目标告警，在
告警操作栏中单击 ，选择
“指定处理人”，选择处理告警
的用户。
设置后，告警参数“处理人”显
示为设置的用户名。
处理告警 运维人员可以参考告警帮助文档对
告警进行处理，以辅助处理故障。
1.
在告警列表中，单击目标告警
所在行左侧的箭头，显示目标
告警的详细信息。
2.
选择“告警帮助”页签。
3.
单击“告警帮助地址”中的链
接，页面将跳转至运维帮助中
心中该告警的告警帮助文档页
面。
4.
参考告警帮助文档中的帮助信
息处理告警。
5.
如果存在多条告警，请重复执
行步骤2.1～步骤2.4，直至所
有告警都处理完成。
手工清除
告警
某些特定的告警或某些特定场景产
生的告警不能自动清除时，排除相
关故障后，需手工清除。
说明
特定场景举例：有多个控制器的设备
发生控制器倒换时，设备的IP地址会
发生变化，导致同一条告警可能以不
同的IP地址多次上报，且这些告警的
名称、告警源和来源系统流水号都相
同。此时如果设备上报告警清除信
息，ManageOne上这些告警只能自动
清除一条，其余的需要手动清除。
选中一条或多条告警，单击告警
列表上方的“清除”按钮；也可
以在告警列表中单击某条告警操
作列的 。
●
清除后，若该告警已被确认，
该告警将自动被移入历史告警
列表中。
●
清除后，若该告警还未被确
认，在告警列表中该告警的背
景颜色由白色变成绿色。
说明
执行清除操作后将不能恢复，请谨慎
操作。
记录维护
经验
当运维人员处理告警后，及时记录
处理告警的经验，以便为后续处理
相同告警名称的告警提供参考。
这里填写的维护经验可在“集中监
控
>
告警管理
>
告警设置”的
“维护经验”中进行管理。
在告警列表中，单击目标告警所
在行左侧的箭头，展开拓展行。
在“维护经验”中，单击“编
辑”填写。
告警规则
快捷入口
运维人员可通过快捷入口快速设置
与本条告警相关的规则，需具备对
应规则的权限才可操作。各规则说
明请参见表1-16。
在目标告警所在的操作列中，单
击 ，选择对应规则。
1

## Page 53

表1-16 快捷入口规则介绍
规则 说明
发送邮件通知 将选中告警的相关信息通过邮件方式立即发送给运维人员。
发送短信通知 将选中告警的相关信息通过短信方式立即发送给运维人员。
设置屏蔽规则 对于设备上报而不需要关注的告警，可以通过创建屏蔽规
则，使后续上报且符合屏蔽规则的告警不会出现在当前告警
列表中。
设置标识规则 设置该规则后系统将自动给符合规则条件的告警设置状态标
识。当用户监控或查询告警时，设置过滤条件可将该类告警
过滤掉从而精简告警，提升告警处理效率。如调测场景下产
生的告警可通过规则将其标识为“维护态”。
设置远程通知规则 系统按照规则中设置的通知方式和内容模板将符合规则条件
的告警信息自动发送给运维人员，方便其及时了解告警信息
而采取相应措施。
设置级别和类型重定
义规则
为优先保障某区域网络设备或某些关键设备通畅运行，可通
过级别和类型重定义调整告警级别和类型。例如，可将重点
关注的告警设置为高级别，运维人员将会对该告警优先处
理，从而提供优质网络保障服务。
设置名称重定义规则 如果用户认为某告警名称过于专业化，难以理解，可以通过
设置告警名称重定义规则，根据实际需要重新设置告警名
称。
设置闪断/振荡规则 通过设置该规则，可以选择将闪断或振荡告警丢弃或屏蔽，
以减少海量重复告警对运维的干扰。
设置汇聚规则 根据规则将指定周期内上报的重复告警汇聚到同一个告警
下，以减少大量重复告警对运维的干扰。
----结束
1.1.5
分析告警
在告警管理中，可查看历史告警和被屏蔽告警，分析历史告警并及时处理，可避免故
障发生。
1.1.5.1
查看历史告警和被屏蔽告警
用户可通过对历史告警和被屏蔽告警的分析，了解设备的运行情况及检查规则配置的
合理性。
背景信息
●
缺省展示2万条历史告警和被屏蔽告警。当告警条数超过该上限时，则根据过滤条
件和排序结果显示前2万条告警。如果想要查询其他告警，可以修改过滤条件和排
序进行查询。
1

## Page 54

●
对于设备上报而不需要关注的告警，可以通过创建屏蔽规则，使后续上报且符合
屏蔽规则的告警不在“当前告警”列表中显示，而在“被屏蔽告警”列表中显示
或丢弃。
●
被屏蔽告警不会因相应屏蔽规则的停止或删除而从“被屏蔽告警”列表中删除。
●
用户只能监控和查看被授权管理对象的告警。
●
“历史告警”页面支持打开的数量缺省不超过30个。“被屏蔽告警”页面支持打
开的数量缺省不超过5个。
操作步骤
步骤1 查看历史告警和被屏蔽告警。
●
查看历史告警
a.
在运维面主菜单中选择“业务监控
>
告警监控
>
历史告警”。
b.
在“历史告警”页面，单击“过滤”展开过滤面板，通过设置历史告警过滤
条件，可以快速找到所关注的历史告警。
●
查看被屏蔽告警
a.
在运维面主菜单中选择“业务监控
>
告警监控
>
被屏蔽告警”。
b.
在“被屏蔽告警”页面，单击“过滤”展开过滤面板，通过设置被屏蔽告警
过滤条件，可以快速找到所关注的被屏蔽告警。
步骤2 单击“保存”或“另存为”将当前过滤条件保存或另存为过滤模板。
用户可在页面左上方单击“模板管理”查看当前界面的全部过滤模板，并在“快速过
滤”中选择过滤模板。具有Administrators角色的用户可管理所有用户保存的模板。
系统提供以下类型的模板：
●
关注模板：用户关注的模板，用户可将常用模板设置为关注模板，便于选择。
●
自定义模板：当前用户自定义的模板，用户可设定是否将模板共享给其他用户。
●
共享模板：其他用户共享的可使用的模板。
●
其他模板：其他用户不共享的模板。其他模板只对具有Administrators角色的用户
可见。
说明
当前告警、告警日志、历史告警、被屏蔽告警、事件日志、告警日志统计各界面的过滤模板相对
独立，不能共用。
步骤3 导出历史告警或被屏蔽告警。系统支持导出后缀为.xlsx、.csv或.html的文件，当导出
格式为.xlsx且告警数量超过10万条时，文件将以.zip压缩包的格式导出；当导出格式
为.csv或.html，且告警数量超过1万条时，文件将以.zip压缩包的格式导出。
●
导出部分告警：选择要导出的告警，单击“导出”，选择“导出选中”。
●
导出全部告警：单击“导出”，选择“全部”。
说明
导出告警时，只能导出界面中配置显示的告警列信息，可在告警列表右上方单击 ，设置要显
示的告警列。
----结束
1

## Page 55

1.1.5.2
分析历史告警
通过分析历史告警，可以发现系统潜在问题，对这些问题进行及时处理可避免故障发
生，保障系统的正常运行。
前提条件
●
已具备管理对象的“告警处理”操作权限。
●
已登录ManageOne运维面。
操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
历史告警”。
步骤2 查询一周内的历史告警。
在页面左上角单击“过滤”，并将“发生时间”设置为“最近7天”。
单击“确定”。
步骤3 导出查询结果。
单击“导出
>
全部”，导出结果保存在本地文件夹。
步骤4 统计分析告警。
打开保存的文件，按照告警发生频次、告警源等信息统计TOP告警，识别潜在故障。
步骤5 安排维护工程师处理潜在故障。
----结束
1.1.6
配置告警
介绍告警管理的相关配置操作。
1.1.6.1
设置告警/事件颜色
通过设置不同级别告警/事件对应的颜色，可以方便地浏览关注的告警/事件。
背景信息
设置不同级别告警/事件对应的颜色后，告警灯颜色、告警列表和事件列表中级别的颜
色将显示为已设置的颜色。
操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“个性化
>
颜色设置”。
步骤3 在“颜色设置”页面中设置不同告警/事件级别对应的颜色。
步骤4 单击“确定”。
----结束
1

## Page 56

1.1.6.2
设置告警展示方式
当用户需要在监控告警时更方便地识别不同状态的告警时，可以根据自身的需要设置
告警展示方式，快速识别关注的告警。
背景信息
设置告警展示方式后，告警/事件列表的“级别”参数列将按照设置的样式显示，不同
状态的告警将显示为设置的背景色。
操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“个性化 > 告警展示方式”。
步骤3 在“告警展示方式”页面中选择“模式”和不同状态告警及事件的背景色。
●
图标：告警/事件列表中的“级别”列显示级别图标和级别参数，级别图标的颜色
按级别对应的颜色显示。告警背景色显示为设置的状态对应颜色。
●
按列着色：告警/事件列表中的“级别”列的级别参数背景色显示为级别对应的颜
色。告警背景色显示为设置的状态对应颜色。
●
按行着色：“未确认&未清除”状态的告警背景色显示为级别对应的颜色，其他状
态的告警背景色显示为设置的状态对应颜色。事件背景色显示为级别对应的颜
色。
步骤4 单击“确定”。
----结束
1.1.6.3
设置告警声音
通过设置不同级别提示声音或针对告警名称指定告警提示声音，可以更方便的监控告
警。当告警发生时，用户计算机上的音箱会发出对应的声音。
背景信息
系统缺省提供四种告警提示声音。紧急/按告警名称发声：Critical.mp3；重要：
Major.mp3；次要：Minor.mp3；提示：Warning.mp3。
操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“个性化
>
告警声音”。
步骤3 在“告警声音”页面中设置不同级别对应的提示声音。
●
单击 可试听当前选择声音文件。
●
单击 ，在弹出的“自定义告警声音”对话框中，可上传、查看和删除自定义声
音文件。
●
单击 ，选择“按告警名称发声”的告警，最多支持选择20个告警。
步骤4 设置不同级别需要发出提示音的“监控状态”。
1

## Page 57

当符合指定监控状态的相应级别告警上报，或相应级别告警的状态变化为指定监控状
态时，都会发出告警提示音。
步骤5 设置告警提示音的播放时长。当告警上报时，告警提示音播放对应时长后自动停止，
同时告警灯持续闪烁对应的播放时长（静音时，告警灯依然闪烁）。当前发声级别的
告警全部清除或确认时，停止当前发声和告警灯闪烁；“按告警名称发声”的告警被
清除或确认时，不会停止当前发声和告警灯闪烁。
步骤6 选择是否启用该声音设置。若选择不启用，则对应级别的告警上报时将不会播放提示
音。
步骤7 单击“确定”。
说明
当告警既满足“按告警名称发声”规则，也满足某级别（“紧急”、“重要”、“次要”、“提
示”）发声的规则，且这些规则被启用时，该告警按“按告警名称发声”中设置的声音发声。
----结束
1.1.6.4
设置告警字体颜色
设置告警列表中已读告警和未读告警的颜色，以便于用户区分。
背景信息
新上报的告警均为未读告警。
操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“个性化
>
字体颜色”。
步骤3 设置已读告警和未读告警的字体颜色。
步骤4 单击“确定”。
----结束
1.1.6.5
设置告警高亮显示
通过设置告警高亮显示，若告警在设定时间内没有得到处理（即状态没有改变），则
该告警在告警列表中高亮显示，提示用户关注此告警。
背景信息
● 高亮显示只对当前告警生效。
●
符合高亮显示条件的告警，在告警列表中字体颜色为： 。
操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“个性化
>
高亮显示”。
1

## Page 58

步骤3 在“高亮显示”页面中，设置“生效时间(分)”和“监控状态”。表示当该级别的告
警产生后，若该告警在指定监控状态下的持续时间大于等于指定生效时间，该告警将
高亮显示。
步骤4 设置是否启用对应级别的告警高亮显示。
步骤5 单击“确定”。
----结束
1.1.6.6
配置屏蔽规则
对于上报而不需要关注的告警/事件，用户可以通过创建屏蔽规则，使后续上报的符合
屏蔽规则的告警/事件不会显示在当前告警和事件日志中。系统有预置的屏蔽规则，方
便用户屏蔽掉不关注的告警/事件。当预置的屏蔽规则无法满足需要时，管理员可以根
据需求创建新的屏蔽规则。
警告
●
预置屏蔽规则删除后不支持一键式恢复，请谨慎操作。
●
如果误删后还需要使用预置屏蔽规则，请联系技术支持工程师协助解决。
前提条件
已具备“设置屏蔽规则”操作权限。
背景信息
●
创建规则成功后，如果规则的告警/事件源设置为“所有告警源”或“所有事件
源”，只有管理对象为“All Resources”的用户可以对该规则进行修改或删除。
其他用户只能修改或删除告警/事件源为“自定义告警源”或“自定义事件源”的
规则。
●
规则启用后，将对在生效期间上报的告警/事件生效。在规则生效前符合条件的当
前告警不会被屏蔽，但在规则生效后若同一告警源上报了同一告警，则规则生效
前的告警将会被自动清除，生效后上报的告警将被屏蔽或丢弃。
●
屏蔽规则是以名称重定义后的属性来进行屏蔽的。如果针对某条告警设置了名称
重定义规则和屏蔽规则，则名称重定义规则先生效，然后屏蔽规则才生效。
●
最多支持创建1000条屏蔽规则。
● 同时满足以下条件的屏蔽规则会屏蔽所有告警/事件，将导致告警/事件无法上报。
– 屏蔽规则已启用。
– 屏蔽规则选择了所有告警/事件源。
– 屏蔽规则选择了所有告警/事件级别。
– 屏蔽规则未设置指定告警/事件和高级条件。
–
屏蔽规则未设置时间条件。
●
缺省情况下，创建的规则依次按照已启用和未启用的顺序排列，当规则启停状态
相同时，则按照修改时间降序排列。
1

## Page 59

操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
告警设置”。
步骤2 在左侧导航树中选择“屏蔽规则”。
步骤3 在“屏蔽规则”页面中，单击“创建” ，选择“告警屏蔽规则”或“事件屏蔽规
则”。
步骤4 在“基本信息”区域中，设置规则的名称、描述信息、是否启用规则。
步骤5 在“条件”区域中，设置规则生效的告警级别、告警/事件、告警/事件源，设置高级条
件可以根据告警/事件参数来筛选规则生效的告警/事件。
说明
●
只有管理对象为所有资源的用户可以选择“所有告警源”或“所有事件源”。
●
在设置“告警源”或“事件源”时，选择“所有告警源”或“所有事件源”将对系统自身和
所有管理对象产生的符合条件的告警或事件进行屏蔽，请谨慎使用。
步骤6 在“时间条件”区域中，设置规则生效的时间和生效周期。
步骤7 在“动作”区域中，设置屏蔽后的告警/事件处理策略。可选择“丢弃”或“显示在
“被屏蔽告警”中”。
说明
●
创建事件屏蔽规则时，被屏蔽的事件只能被丢弃。
●
选择“丢弃”后该告警将无法查看，请用户谨慎操作。
步骤8 在“其他”区域中，设置规则的优先级。
步骤9 单击“确定”。
----结束
相关任务
●
删除规则：对于冗余的规则，用户可在规则列表中选中后，单击“删除”，以减
少规则的维护工作量。
●
启用/停用规则：对于暂时不需要使用的规则，用户可在规则列表中选中后，单击
“停用”。若要重新使用已停用的规则，可在选中规则后单击“启用”。
●
迁移规则：在迁移场景下，用户可在原系统规则页面中，单击“导出规则”将原
系统的规则导出，然后在目标系统中单击“导入规则”，将原系统中导出的规则
文件导入，完成规则的迁移。
●
备份、统计、审核、批量修改规则：用户可在规则页面单击“导出规则”将规则
导出，对规则进行备份、集中检查和统计；如需要批量调整规则，可以在导出的
规则文件中进行批量修改，修改完成后在规则页面单击“导入规则”将规则文件
导入。
任务示例
场景描述
运维人员计划于20XX年4月的每周一凌晨1点对设备A进行调测操作，每次调测在2个小
时以内完成，设备A承载的业务届时会中断。这个期间产生的告警是可预测到的，且不
需要被处理，需要配置屏蔽规则屏蔽这些告警，以避免这些告警被关注。
1

## Page 60

配置步骤
1.
在“屏蔽规则”页面中，单击“创建”，选择“告警屏蔽规则”。
2.
设置“规则名称”。
3.
选择“自定义告警源”，在自定义告警源中添加设备A。
4.
在“时间条件”区域中，设置“生效时间”为“20XX-04-01 00:00:00到
20XX-04-30
23:59:59”，设置“生效周期”的“按天”为“星期一”，“按时
段”为“01:00到03:00”。
5.
在“动作”区域中，选择“屏蔽后的告警”为“显示在“被屏蔽告警”中”。
6.
其他参数保持缺省设置。
7.
单击“确定”。
操作结果
设备A在20XX年4月的每周一凌晨1~3点产生的告警在“当前告警”、“告警日志”、
“历史告警”中均不可见。在“被屏蔽告警”页面可查看到这些被屏蔽的告警。
参数说明
事件规则的参数和告警规则的参数相似，参数说明以告警规则为例。
表1-17 创建告警屏蔽规则参数说明
参数项 参数名称 说明
条件 级别 紧急、重要、次要、提示。
告警
●
若选择“指定告警”，则规则仅对添加的告警生
效。
“告警ID”、“分组名称”：唯一标识一条告
警。
●
若不选择“指定告警”，则默认对所有告警生
效。
告警源
●
所有告警源：该规则对所有告警源产生的告警生
效。
● 自定义告警源：该规则仅对指定告警源产生的告
警生效。
高级条件 对各参数项（定位信息、告警源类型等）的条件限
制，各参数的含义请参见表1-30。例如需要根据告
警的定位信息进行筛选告警，则选择“定位信
息”、“包含”，并输入对应的目标告警的定位信
息关键字段。
时间条件 生效时间 设置规则的生效时间段，缺省为服务器时间。
按天 设置一周当中规则生效的天数。
按时段 设置一天当中规则生效的时间段。
1

## Page 61

参数项 参数名称 说明
动作 屏蔽后的告警
●
显示在“被屏蔽告警”中：被屏蔽告警会在“集
中监控
>
告警管理
>
被屏蔽告警”中显示，可供
查看。
●
丢弃：被屏蔽的告警会被删除。选择“丢弃”后
该告警将无法查看，请用户谨慎操作。
其他 优先级 用户可自定义告警屏蔽规则执行的优先级。
修改记录
-
在屏蔽规则被成功创建后，单击规则名称，可在修
改记录中查看该规则的创建人、创建时间、修改人
和修改时间。未完成创建的规则看不到此项。
1.1.6.7
配置闪断/振荡规则
通过设置该规则，可以选择将闪断或振荡告警丢弃或者显示到“被屏蔽告警”当中，
以减少海量重复告警对运维的干扰。系统有自动预置的闪断/振荡规则，方便用户减少
当前告警中的重复告警与无效告警。当预置的闪断/振荡规则无法满足需要时，管理员
可以根据需求创建新的闪断/振荡规则。
警告
●
预置闪断/振荡规则删除后不支持一键式恢复，请谨慎操作。
●
如果误删后还需要使用预置闪断/振荡规则，请联系技术支持工程师协助解决。
前提条件
●
已具备设置闪断/振荡规则的操作权限。
●
用户只能对管理对象的规则进行配置，对非管理对象的规则只能查看。
●
已登录ManageOne运维面。
操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
告警设置”。
步骤2 在左侧导航树中选择“闪断/振荡规则”。
步骤3 在“闪断/振荡规则”页面中，单击“创建”。
步骤4 在“基本信息”区域中，设置规则的名称、描述信息、是否启用规则。
步骤5 在“条件”区域中，设置规则生效的告警级别、告警、告警源、设置高级条件可以根
据告警参数来筛选规则生效的告警。
步骤6 在“时间条件”区域中，设置规则生效的时间，用户可根据需要选择规则的生效时间
和生效周期。
说明
“时间条件”中所有条件缺省为去勾选，表示规则在所有时间下生效。
1

## Page 62

步骤7 在“分析类型”区域中选择类型。
步骤8 在“闪断策略”和“振荡策略”区域中配置策略。
●
闪断策略：设置闪断周期及动作。例如闪断周期为30且告警处理方式选择丢弃。
表示当该告警的产生与清除时间间隔小于30秒，该告警会被丢弃。
–
闪断周期：当告警的产生与清除时间间隔小于闪断周期时，该告警符合闪断
策略。
–
动作：选择将符合闪断策略的告警丢弃或显示在“被屏蔽告警”页面中。
●
振荡策略：设置振荡的触发条件、结束条件及处理策略。
–
触发条件：指定周期内，产生的告警数大于设定的阈值，触发振荡。
– 结束条件：指定周期内，产生的告警数小于或等于设定的阈值，结束振荡。
–
处理策略：
▪
产生振荡告警, 并将触发振荡后的源告警显示在"被屏蔽告警"中。
▪
产生振荡告警, 源告警直接上报。
▪
产生振荡告警, 并丢弃触发振荡后的源告警。
▪
产生雪崩告警, 并将触发振荡后的源告警显示在"被屏蔽告警"中。
▪
产生雪崩告警, 源告警直接上报。
▪
产生雪崩告警, 并丢弃触发振荡后的源告警。
▪
重定义触发振荡后的源告警级别。
步骤9 在“其他”区域中，设置规则的优先级。
步骤10 单击“确定”。
----结束
相关任务
●
删除规则：对于冗余的规则，用户可在规则列表中选中后，单击“删除”，以减
少规则的维护工作量。
●
启用/停用规则：对于暂时不需要使用的规则，用户可在规则列表中选中后，单击
“停用”。如果要重新使用已停用的规则，可在选中规则后单击“启用”。
●
迁移规则：在迁移场景下，可将原系统中的规则导出，再导入目标系统，完成规
则的迁移。
●
备份、统计、审核、批量修改规则：用户可在规则页面单击“导出规则”将规则
导出，对规则进行备份、集中检查和统计；如需要批量调整规则，可以在导出的
规则文件中进行批量修改，修改完成后在规则页面单击“导入规则”将规则文件
导入。
说明
导出的.xls文件已自动不显示第一行，请不要修改第一行的文字，否则会导致导入失败。
任务示例
场景描述
1

## Page 63

在短时间内某次要级别告警M持续时间较短或频繁上报，可能是某设备/服务不断在正
常/异常的状态间切换，为了减少此类告警的干扰，通过设置闪断/振荡规则，按以下策
略处理该类告警。
●
闪断策略：设置在30秒内告警M上报且清除时，丢弃该告警。
●
振荡策略：设置告警M在60秒内产生的次数大于2时，触发振荡处理；当在60秒内
产生的次数小于等于0时，结束振荡处理。
配置步骤
1.
在“闪断/振荡规则”页面中，单击“创建”。
2.
在“基本信息”区域中，输入规则名称。
3.
在“条件”区域中，选中“指定告警”，单击“增加告警”，选择告警M，表示
需要对告警M进行闪断/振荡处理。
4.
在“分析类型”中，勾选“闪断分析”和“振荡分析”。
5.
配置策略。
–
闪断策略：配置“闪断周期(T)”为30秒，“动作”为“丢弃”。
–
振荡策略：在“触发条件”中配置周期为60秒，产生告警数目为2；在“结束
条件”中配置周期为60秒，产生告警数目为0；设置“处理策略”为“产生振
荡告警，并丢弃触发振荡后的源告警”。
6.
单击“确定”完成配置。
操作结果
如果告警M上报后在30秒内清除，将被丢弃；如果告警M频繁上报，触发振荡策略后
的源告警直接丢弃，并生成一条新的振荡告警。
1.1.6.8
配置汇聚规则
ManageOne系统根据所配置的汇聚规则将指定周期内上报的重复告警汇聚到同一个告
警下，以减少大量重复告警对运维的干扰。在监控或查看告警时可以将被汇聚告警过
滤掉（在过滤条件“关联告警标识”中选择“汇聚告警”），只关注要处理的汇聚告
警。系统有自动预置的汇聚规则，方便用户减少当前告警中的重复告警与无效告警。
当预置的汇聚规则无法满足需要时，管理员可以根据需求创建新的汇聚规则。
警告
●
预置汇聚规则删除后不支持一键式恢复，请谨慎操作。
● 如果误删后还需要使用预置汇聚规则，请联系技术支持工程师协助解决。
前期条件
●
已登录ManageOne运维面。
●
已具备设置汇聚规则的操作权限。
●
只有管理对象为所有资源的用户能对规则进行启停和增删改，其他用户只能查看
和导出。
1

## Page 64

背景信息
●
规则只对规则启用且在生效期间上报的告警/事件生效。
●
符合告警汇聚规则所有条件的告警为源告警。当规则选择生成汇聚告警时，这些
源告警会被标记为被汇聚告警，可在当前告警页面的过滤条件“关联告警标识”
中选择“被汇聚告警”，将被汇聚告警（源告警）显示出来。
●
通过告警汇聚规则生成的汇聚告警支持联动清除和反向联动清除，即清除汇聚告
警时会清除所有被汇聚告警，或者在清除所有被汇聚告警后，汇聚告警也会清
除。如果要处理汇聚告警，请先逐条处理被汇聚告警对应的故障。
●
最多可创建1000条自定义汇聚规则。
●
缺省情况下，创建的规则依次按照已启用和未启用的顺序排列，当规则启停状态
相同时，则按照修改时间降序排列。
●
创建事件汇聚规则与创建告警汇聚规则的操作类似，本操作以创建告警汇聚规则
为例，如需创建事件汇聚规则请在“汇聚规则”页面中单击“创建”，选择“事
件汇聚规则”。
●
事件汇聚规则的汇聚动作只支持选择“生成一条汇聚告警”或“生成一条汇聚告
警，并丢弃所有源事件”。通过事件汇聚规则生成的汇聚告警信息与其中一条源
事件信息相同，且此类汇聚告警无法查看其对应源事件。
操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
告警设置”，进入“告警设置”页面。
步骤2 在左侧导航树中选择“汇聚规则”。
步骤3 单击汇聚规则列表上方“创建”右侧的 ，选择“告警汇聚规则”。参考表1-18填写
汇聚规则的配置参数。
表1-18 参数说明
类别 参数 说明 取值样例
基本信息 规则名称 汇聚规则的名称。 系统连通性检测失败
告警
描述 对汇聚规则的详细信息描述。 系统连通性检测失败
告警汇聚规则
启用 默认勾选。 勾选
条件 告警名称
单击 ，在弹出的“增加
告警”对话框中进行选择。
系统连通性检测失败
告警
告警ID 告警ID，“告警名称”确定后
会自动关联，无需手动填写。
100502
分组名称 告警分组名称“告警名称”确
定后会自动关联，无需手动填
写。
100000
告警源
●
所有告警源
●
自定义告警源
所有告警源
1

## Page 65

类别 参数 说明 取值样例
高级条件 选择所需要的高级条件。 告警源类型
汇聚参数 汇聚范围 表示汇聚同一告警源上符合条
件的告警。
网元内
关键参数 设置定位信息精准匹配条件，
当上报告警的定位信息符合该
条件时，进行汇聚判定。
●
指定属性匹配：当源告警
定位信息中的属性值与条
件中的设置匹配时，满足
该条件。
●
整个信息匹配：当源告警
的定位信息完全相同时，
满足该条件。
说明
“关键参数”只能设置定位
信息条件。
指定属性匹配
触发条件
●
周期：汇聚规则的采集周
期，单位为秒。
●
产生告警数目：汇聚规则
产生告警的数目。
20
结束条件
2
1

## Page 66

类别 参数 说明 取值样例
汇聚动作 汇聚动作
●
生成一条汇聚告警：新生
成一条汇聚告警，将源告
警标记为被汇聚告警，并
上报给上层网管。
●
生成一条汇聚告警，并将
所有源告警置为衍生告
警：新生成一条汇聚告
警，将所有源告警标记为
衍生告警。
●
生成一条汇聚告警，并北
向屏蔽所有源告警：新生
成一条汇聚告警，将源告
警标记为被汇聚告警。此
时，这些被汇聚告警不会
上报给上层网管。
● 无论汇聚触发与否都将所
有源告警显示在"被屏蔽告
警"中，汇聚触发后生成一
条汇聚告警：无论汇聚触
发与否，都会将所有源告
警显示于“被屏蔽告警”
页面中，汇聚触发后生成
一条汇聚告警。
●
生成一条汇聚告警，并丢
弃所有源告警：新生成一
条汇聚告警，并将所有源
告警丢弃。
●
生成一条汇聚告警，并丢
弃进入汇聚之后的所有源
告警：新生成一条汇聚告
警，将触发汇聚后上报的
源告警丢弃。
●
直接上报源告警，不生成
汇聚告警：不生成汇聚告
警，源告警也不会标记为
被汇聚告警。选择此项
时，用户可在下方的“源
告警设置”中自定义源告
警的级别。
生成一条汇聚告警
1

## Page 67

类别 参数 说明 取值样例
汇聚告警设
置
告警源：
●
网元：上报一条告警源为
网元的汇聚告警。
●
OSS：上报一条告警源为
OSS的汇聚告警，即
“ALM-832 同类告警数量
超出门限”。
定位信息保留字段：设置后，
被汇聚告警的指定字段将显示
在汇聚告警的“附加信息”
中。
用户还可对汇聚告警中的部分
字段进行自定义，比如自定义
级别。级别可选：
●
紧急
● 重要
●
次要
●
提示
网元
步骤4 单击“确定”。创建成功后在汇聚规则列表中可查看创建的汇聚规则，默认状态为
“已启用”。
----结束
相关任务
●
删除规则：对于冗余的规则，用户可在规则列表中选中后，单击“删除”，以减
少规则的维护工作量。
●
启用/停用规则：对于暂时不需要使用的规则，用户可在规则列表中选中后，单击
“停用”。如果要重新使用已停用的规则，可在选中规则后单击“启用”。
●
迁移规则：在迁移场景下，可将原系统中的规则导出，再导入目标系统，完成规
则的迁移。
●
备份、统计、审核、批量修改规则：用户可在规则页面单击“导出规则”将规则
导出，对规则进行备份、集中检查和统计；如需要批量调整规则，可以在导出的
规则文件中进行批量修改，修改完成后在规则页面单击“导入规则”将规则文件
导入。
说明
导出的.xls文件已自动不显示第一行，请不要修改第一行的文字，否则会导致导入失败。
1.1.6.9
配置相关性规则
当一条告警产生引起了其他告警的产生，用户可通过相关性规则定义这些告警之间的
根源衍生关系，在监控或查看告警时可以将衍生告警过滤掉，只关注要处理的根源告
警。
1

## Page 68

前提条件
已具备“设置相关性规则”的操作权限。
背景信息
●
规则启用后，将对在生效期间上报的告警生效。
●
最多可创建1000条自定义相关性规则。
●
缺省相关性规则只能启停，不能修改和删除。
●
告警发生的时间早于告警到达网管的时间超过30分钟时，不会匹配相关性规则。
●
缺省情况下，创建的规则依次按照已启用和未启用的顺序排列，当规则启停状态
相同时，则按照修改时间降序排列。
操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“相关性规则”。
步骤3 在“相关性规则”界面中选择“缺省规则”页签，查看缺省相关性规则中是否已存在
满足需求的规则。
●
是：执行步骤4。
●
否：执行步骤5。
步骤4 在“缺省规则”中根据需要启停对应规则。
步骤5 创建自定义相关性规则。
1.
在“相关性规则”界面中选择“自定义规则”页签，单击“创建”。
2.
在“基本信息”区域中，设置规则的名称、描述信息、是否启用规则。
3.
在“告警”区域中，选择根源告警及衍生告警并设置对应的动作。
–
根源告警：产生多条相关告警的源头告警。
–
衍生告警：由根源告警导致产生的相关告警。
4. 在“条件”区域中，单击“创建”，创建根源告警与衍生告警的关联规则。
5.
在“其他”区域中，设置根源告警与衍生告警的发生间隔时间和规则的优先级。
根源告警与衍生告警产生间隔时间小于等于设置的值，才构成根源告警与衍生告
警的关系。
6.
单击“确定”。
----结束
相关任务
●
删除规则：对于冗余的规则，用户可在规则列表中选中后，单击“删除”，以减
少规则的维护工作量。
●
启用/停用规则：对于暂时不需要使用的规则，用户可在规则列表中选中后，单击
“停用”。若要重新使用已停用的规则，可在选中规则后单击“启用”。
●
迁移规则：在迁移场景下，用户可在原系统规则页面中，单击“导出规则”将原
系统的规则导出，然后在目标系统中单击“导入规则”，将原系统中导出的规则
文件导入，完成规则的迁移。
1

## Page 69

●
备份、统计、审核、批量修改规则：用户可在规则页面单击“导出规则”将规则
导出，对规则进行备份、集中检查和统计；如需要批量调整规则，可以在导出的
规则文件中进行批量修改，修改完成后在规则页面单击“导入规则”将规则文件
导入。
任务示例
场景描述
某网元的连接发生了故障后，该网元会定时上报告警M。同时，由于该连接的中断，
会引发该网元或其他网元产生大量的同类连接中断告警N。此时，只需要处理告警M，
而不必关注告警N。通过设置告警相关性规则，可以将晚于告警M之后产生的告警N设
置为衍生告警。
配置步骤
1.
在“相关性规则
>
自定义规则”页面中，单击“创建”。
2.
在“基本信息”区域中，设置“规则名称”。
3.
在“告警”区域中，选择“根源告警”为告警M，“衍生告警”为告警N。
4.
在“条件”区域中，单击“创建”，设置规则生效条件为告警N的发生时间大于告
警M的发生时间，单击“确定”，完成条件配置。
5.
单击“确定”完成相关性规则配置。
操作结果
当告警N的发生时间晚于告警M时，告警M为告警N的根源告警。此时，打开“当前告
警”过滤面板，在“高级设置”中设置“关联告警标识”的“操作符”为“属于”、
“值”为“普通告警”和“根源告警”。启动查询，当前告警列表将不再显示衍生告
警N，用户只需关注和处理根源告警M即可。
参数说明
表1-19 创建相关性规则参数说明
参数项 参数名称 说明
告警 根源告警 产生多条相关告警的源头告警。
根源告警可选择如下动作，表示
当符合条件的告警上报时，对根
源告警进行的操作。
●
无
●
级别提升一级
1

## Page 70

参数项 参数名称 说明
衍生告警 根源告警产生的多条相关告警。
衍生告警可选择如下动作，表示
当符合条件的告警上报时，对衍
生告警进行的操作。
●
级别重定义为“紧急”
●
级别重定义为“重要”
●
级别重定义为“次要”
● 级别重定义为“提示”
●
丢弃
●
无
条件 定位信息、告警源类型
等。
可以设定对各参数项的条件限
制。
比较方式 选择条件的比较方式。
●
值：表示用告警的某个属性与
指定值做比较。
●
告警：表示比较两个告警某个
属性的值。
其他 时间间隔 根源告警与衍生告警的发生间隔
时间。当间隔时间小于或等于设
定的值时，所选的根源告警与衍
生告警才能构成根源与衍生的关
系。
优先级 规则生效的优先级。
1.1.6.10
配置自动确认规则
自动确认是将处于清除状态的当前告警，按照指定的规则进行自动确认后移入到历史
告警列表中。系统有自动预置的自动确认规则，方便用户减少当前告警中的重复告警
与无效告警。当预置的自动确认规则无法满足需要时，管理员可以根据需求创建新的
自动确认规则。
说明
ManageOne系统默认对已清除未确认的“提示、次要、重要、紧急”级别告警进行自动“立即
确认”和“延时确认”，用户可根据实际需要创建、删除、启用、停用自动确认规则。
警告
●
预置自动确认规则删除后不支持一键式恢复，请谨慎操作。
●
如果误删后还需要使用预置自动确认规则，请联系技术支持工程师协助解决。
1

## Page 71

前提条件
●
已具备设置自动确认规则的操作权限。
●
只有管理对象为所有资源的用户能对规则进行设置，其他用户只能查看。
●
已登录ManageOne运维面。
背景信息
●
自动确认规则只对未确认已清除的告警生效，启用立即确认前已清除的告警不受
影响。
●
最多可存在1000条自动确认规则，系统已存在4条预置规则，用户最多可创建996
条。
●
缺省情况下，创建的规则依次按照已启用和未启用的顺序排列，当规则启停状态
相同时，则按照修改时间降序排列。
操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
告警设置”。
步骤2 在左侧导航树中选择“自动确认规则”，进入告警自动确认规则配置页面。
步骤3 配置自动确认规则。相关操作请参见表1-20进行配置。
表1-20 配置任务说明
操作任务 操作步骤
创建自动确认规则 1.在“自动确认规则”页面中，单击“创建”。
2.在“基本信息”区域中，设置规则的名称、描述信息、是否
启用规则。
3.在“条件”区域中，设置规则生效的告警级别、告警、告警
源、设置高级条件可以根据告警参数来筛选规则生效的告警。
说明
●
“指定告警”缺省为去勾选，表示规则对所有告警生效。
●
只有管理对象为所有资源的用户可以选择“所有告警源”。
4.在“其他”区域中，设置规则的确认方式。
●
立即确认：告警被清除后立即被自动确认。
●
延时确认：告警被清除后根据“延时设置”中设置的参数进
行自动确认。
5.单击“确定”完成配置。
删除自动确认规则
●
单条告警自动确认规则的删除：单击操作列的“删除”。
●
批量告警自动确认规则的删除：勾选需要删除的告警自动确
认规则，单击列表右上角的“删除”。
1

## Page 72

操作任务 操作步骤
启用自动确认规则
●
单条告警自动确认规则的启用：单击状态列的 。
●
批量告警自动确认规则的启用：勾选需要启用的告警自动确
认规则，单击列表右上角的“启用”。
例如，勾选“紧急（预置）”级别告警的自动确认规则，单击
“启用”，已清除未确认的紧急级别告警将会自动确认转为历
史告警。
停用自动确认规则
●
单条告警自动确认规则的停用：单击状态列的 。
●
批量告警自动确认规则的停用：勾选需要停用的告警自动确
认规则，单击列表右上角的“停用”。
例如，勾选“重要（预置）”级别告警的自动确认规则，单击
“停用”，已清除未确认的重要级别告警将不会自动确认转为
历史告警。
延时设置自动确认
规则
当规则中的确认方式为延时确认时，系统将根据延时设置中的
配置对相关告警进行自动确认。
1.
单击“延时设置”，设置延时参数。
a.
执行时间（服务器时间）：每日定时执行告警自动确认规
则的时间。
b.
时长（天）：告警清除时间超过该参数，该告警才能够被
自动确认。
2.
单击“确定”，完成延时设置。
----结束
1.1.6.11
配置级别和类型重定义规则
用户可对告警/事件的级别和类型进行重定义，例如可将重点关注的告警/事件设置为高
级别，运维人员将会对该告警/事件优先处理，从而提供优质网络保障服务。
前提条件
已具备“设置重定义规则”的操作权限。
背景信息
●
规则启用后，将对在生效期间上报的告警/事件生效。
●
级别和类型修改不会下发到网元，只能修改告警/事件界面展示的告警/事件级别和
类型，无法修改告警/事件在网元上的级别和类型。
●
重定义告警/事件级别或类型后，在告警/事件列表中将显示修改后的级别和类型。
但在配置规则中选择告警/事件时，依旧显示原始的级别和类型。
●
若存在多条规则对同一条告警/事件的级别和类型进行了重定义，则最近配置的规
则生效。
●
最多可创建1000条级别和类型重定义规则。
●
缺省情况下，创建的规则依次按照已启用和未启用的顺序排列，当规则启停状态
相同时，则按照修改时间降序排列。
1

## Page 73

操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“重定义规则
>
级别和类型”。
步骤3 在“级别和类型”页面中，单击“创建”，选择需要创建规则的类型。
步骤4 在“基本信息”区域中，设置规则的名称、描述信息、是否启用规则。
步骤5 在“告警”或“事件”区域中，设置目标告警/事件名称、告警/事件ID、分组名称。
步骤6 在“动作”区域中，设置重定义后的级别和类型。
步骤7 在“告警源”或“事件源”区域中，选择所有告警/事件源或自定义告警/事件源。
说明
当用户的管理对象为“All Resources”时，才可选择“所有告警源”或“所有事件源”。
步骤8 在“条件”区域中，设置告警/事件参数条件来筛选需要重定义级别或类型的告警/事
件。
例如需要根据告警的定位信息进行筛选，则选择“定位信息”、“包含”，并输入对
应的目标告警的定位信息关键字段。
步骤9 在“时间条件”区域中，设置规则生效的时间，用户可根据需要选择规则的生效时间
和生效周期。
步骤10 单击“确定”。
----结束
相关任务
●
删除规则：对于冗余的规则，用户可在规则列表中选中后，单击“删除”，以减
少规则的维护工作量。
●
启用/停用规则：对于暂时不需要使用的规则，用户可在规则列表中选中后，单击
“停用”。若要重新使用已停用的规则，可在选中规则后单击“启用”。
●
迁移规则：在迁移场景下，用户可在原系统规则页面中，单击“导出规则”将原
系统的规则导出，然后在目标系统中单击“导入规则”，将原系统中导出的规则
文件导入，完成规则的迁移。
●
备份、统计、审核、批量修改规则：用户可在规则页面单击“导出规则”将规则
导出，对规则进行备份、集中检查和统计；如需要批量调整规则，可以在导出的
规则文件中进行批量修改，修改完成后在规则页面单击“导入规则”将规则文件
导入。
参数说明
事件规则的参数和告警规则的参数相似，参数说明以告警规则为例。
表1-21 创建级别和类型重定义规则参数
参数项 参数名称 说明
告警 告警名称 告警的名称。
1

## Page 74

参数项 参数名称 说明
告警ID 告警的ID标识。
分组名称 由上报告警的网元或设备为上
报的告警分配。
动作 告警新级别 符合该规则的告警重定义后的
新级别。
告警新类型 符合该规则的告警重定义后的
新类型。
告警源 所有告警源 该规则对所有告警源产生的告
警生效。
自定义告警源 该规则仅对指定告警源产生的
告警生效。
条件 定位信息、告警源类型等。 可以设定对各参数项的条件限
制。
时间条件 生效时间 设置规则的生效时间段，缺省
为服务器时间。
按天 设置一周当中规则的具体生效
日。
按时段 设置一天当中规则生效的时间
段。
1.1.6.12
配置名称重定义规则
如果用户认为某告警/事件名称过于专业化，难以理解，可以通过设置告警/事件名称重
定义规则，根据实际需要重新设置告警/事件名称。
前提条件
已具备“设置重定义规则”的操作权限。
背景信息
●
规则启用后，将对在生效期间上报的告警/事件生效。
●
名称修改不会下发到对接网元，即无法修改告警/事件在对接网元上的名称。
●
重定义告警/事件名称后，在配置其他规则中选择告警/事件时，显示重定义后的告
警/事件名称。若在配置名称重定义规则中选择告警/事件，依旧显示原始的告警/
事件名称。
●
若存在多条规则对同一条告警的名称进行了重定义，则最近时间配置的规则生
效。
●
最多可创建1000条名称重定义规则。
●
缺省情况下，创建的规则依次按照已启用和未启用的顺序排列，当规则启停状态
相同时，则按照修改时间降序排列。
1

## Page 75

操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“重定义规则
>
名称”。
步骤3 在“名称”页面中，单击“创建”，选择“告警名称重定义规则”或“事件名称重定
义规则”。
步骤4 在“基本信息”区域中，设置规则的名称、描述信息、是否启用规则。
步骤5 在“告警”或“事件”区域中，设置目标告警/事件名称、告警/事件ID、分组名称。
步骤6 在“动作”区域中，输入重定义后的名称。
步骤7 单击“确定”。
----结束
相关任务
●
删除规则：对于冗余的规则，用户可在规则列表中选中后，单击“删除”，以减
少规则的维护工作量。
●
启用/停用规则：对于暂时不需要使用的规则，用户可在规则列表中选中后，单击
“停用”。若要重新使用已停用的规则，可在选中规则后单击“启用”。
●
迁移规则：在迁移场景下，用户可在原系统规则页面中，单击“导出规则”将原
系统的规则导出，然后在目标系统中单击“导入规则”，将原系统中导出的规则
文件导入，完成规则的迁移。
●
备份、统计、审核、批量修改规则：用户可在规则页面单击“导出规则”将规则
导出，对规则进行备份、集中检查和统计；如需要批量调整规则，可以在导出的
规则文件中进行批量修改，修改完成后在规则页面单击“导入规则”将规则文件
导入。
1.1.6.13
配置标识规则
配置该规则后系统自动将符合规则条件的告警标识为维护态或无效。当用户监控或查
询告警时，设置过滤条件可将该类告警过滤掉从而精简告警，提升告警处理效率。如
调测场景下产生的告警可通过规则将其标识为“维护态”；对于某些告警，运维人员
通过经验判断为无用的告警，可将其设置为无效告警。
前提条件
已具备“设置标识规则”的操作权限。
背景信息
●
规则启用后，将对在生效期间上报的告警生效。
●
告警在未配置告警标识规则之前，告警参数“无效状态”缺省为“有效”，告警
参数“维护状态”缺省为“普通”，即为“正常态”。
●
最多支持创建1000条标识规则。
●
缺省情况下，创建的规则依次按照已启用和未启用的顺序排列，当规则启停状态
相同时，则按照修改时间降序排列。
1

## Page 76

操作步骤
步骤1 在运维面主菜单中选择“业务监控 > 告警监控 > 告警设置”。
步骤2 在左侧导航树中选择“标识规则”。
步骤3 在“标识规则”页面中，单击“创建”。
步骤4 在“基本信息”区域中，设置规则的名称、描述信息、是否启用规则。
步骤5 在“条件”区域中，设置规则生效的告警级别、告警、告警源，设置高级条件可以根
据告警参数来筛选规则生效的告警。
说明
只有管理对象为所有资源的用户可以选择“所有告警源”。
步骤6 在“时间条件”区域中，设置规则生效的时间，用户可根据需要选择规则的生效时间
和生效周期。
步骤7 在“动作”区域中，选择告警被标识的状态。
步骤8 单击“确定”。
----结束
相关任务
●
删除规则：对于冗余的规则，用户可在规则列表中选中后，单击“删除”，以减
少规则的维护工作量。
●
启用/停用规则：对于暂时不需要使用的规则，用户可在规则列表中选中后，单击
“停用”。若要重新使用已停用的规则，可在选中规则后单击“启用”。
参数说明
表1-22 创建标识规则参数说明
参数项 参数名称 说明
条件 告警
●
若选择“指定告警”，则规则仅对添加的告警
生效。
“告警ID”、“分组名称”：唯一标识一条告
警。
●
若不选择“指定告警”，则默认对所有告警生
效。
告警源
●
所有告警源：该规则对所有告警源产生的告警
生效。
●
自定义告警源：该规则仅对指定告警源产生的
告警生效。
高级条件 对各参数项（定位信息、告警源类型等）的条件
限制。例如需要根据告警的定位信息进行筛选告
警，则选择“定位信息”、“包含”，并输入对
应的目标告警的定位信息关键字段。
1

## Page 77

参数项 参数名称 说明
时间条件 生效时间 设置规则的生效时间段，缺省为服务器时间。
按天 设置一周当中规则的具体生效日。
按时段 设置一天当中规则生效的时间段。
动作 告警标识为
●
维护态：用于标识因网元调测或者维修而产生
的告警。
●
无效：用于标识运维人员通过经验主观判断为
无用的告警。
在监控或查询告警时，可通过过滤条件将“维护
态”或“无效告警”告警过滤掉。
1.1.6.14
配置事件转
ADMC
告警
设置事件转告警后，符合条件的事件将会转为告警上报。用户可通过该设置将需要关
注的事件转为告警，以便在“当前告警”中进行监控和查看。该类告警无法自动清
除。
前提条件
已具备“设置事件转ADMC告警”的操作权限。
背景信息
●
当事件满足“事件转ADMC告警”的规则时产生告警，但是不会上报清除该告警
的通知，所以需要由维护人员判断故障是否已经消失，手工对告警进行清除。
●
事件转为告警后，将不在“事件日志”中显示，只在“当前告警”中显示。取消
事件转告警设置后，新上报的事件在事件日志中显示。
●
当选择“告警设置”进入告警规则配置时，在选择指定告警时无法选择由事件转
化的告警。例如，在创建“屏蔽规则”时，“指定告警”无法选择该类告警进行
屏蔽。但在“当前告警”页面中，告警列表操作列的各规则（如级别和类型重定
义规则）仍可以对该类告警设置。
●
最多可配置2000条事件转ADMC告警。
操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“事件转ADMC告警”。
步骤3 在“事件转ADMC告警”页面中，单击“增加事件”。
步骤4 选择需要转为告警的事件，单击“确定”。
1

## Page 78

表1-23 “增加事件”对话框参数说明
参数 说明
名称 事件的名称。
事件ID 与事件名称一一对应。
分组名称 由上报事件的网元或设备为不同的事件分配。
----结束
1.1.6.15
设置告警/事件名称组
用户可将多个告警/事件名称添加至一个名称组下，在设置查询、统计告警/事件的过滤
条件时支持选择名称组，以便同时对多个告警/事件进行操作。
背景信息
只有角色为“Administrator”的用户可以修改或删除所有名称组，其他用户只能修改
或删除自己创建的名称组。
操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“告警/事件名称组”。
步骤3 在“告警/事件名称组”页面中，单击“创建” ，选择“告警名称组”或“事件名称
组”。
步骤4 设置分组的名称。
步骤5 在“成员”中单击“增加告警”或“增加事件”，选择该名称组中包含的告警/事件，
告警/事件出现在“已选”区域后，单击“确定”。
步骤6 单击“确定”，完成告警/事件名称组配置。
----结束
1.1.6.16
配置远程通知规则
由于非工作时间或出差等原因，运维人员无法通过告警管理界面查看告警/事件，但又
想实时了解告警/事件的产生或清除情况时，可以配置远程通知规则，将关注的告警/事
件通过邮件或短消息方式发送给运维人员，方便其及时了解告警/事件信息而采取相应
措施。
前提条件
●
已完成远程通知的相关配置，配置入口为：在运维面主菜单中选择“系统管理
>
系统设置
>
远程通知”。
●
已具备“设置远程通知规则”操作权限。
1

## Page 79

背景信息
●
远程通知邮件和短信使用第三方服务器和设备进行发送，发送能力（如到达用户
邮箱的时延等）会受到第三方服务器和设备影响。
●
事件远程通知规则不支持设置延迟时间。
●
缺省情况下，创建的规则依次按照已启用和未启用的顺序排列，当规则启停状态
相同时，则按照修改时间降序排列。
●
最多支持创建1000条远程通知规则。
操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
告警设置”。
步骤2 在左侧导航树中选择“远程通知规则”。
步骤3 在“远程通知规则”页面中，单击“创建”，选择“告警远程通知规则”或“事件远
程通知规则”。
步骤4 在“基本信息”区域中，设置规则的名称、描述信息、是否启用规则。
步骤5 在“条件”区域中，设置规则生效的级别、告警状态、告警/事件、告警/事件源，设置
高级条件可以根据告警/事件参数来筛选规则生效的告警/事件。
说明
只有管理对象为所有资源的用户可以选择“所有告警源”或“所有事件源”。
步骤6 在“时间条件”区域中，设置规则生效的时间，用户可根据需要选择规则的生效时间
和生效周期。
步骤7 设置发送通知的方式和内容、接收者时区、通知的用户。当规则中设置的告警上报
时，系统将发送邮件或短消息通知给指定用户组中的用户。创建远程通知规则的参数
说明请参见表1-24。
说明
为了发送远程通知，需要用户录入手机号码和邮箱地址等个人数据。您需遵循所适用国家的法律
或公司用户隐私政策采取足够的措施，以确保用户的个人数据受到充分的保护。
步骤8 单击“确定”。
----结束
相关任务
●
删除规则：对于冗余的规则，用户可在规则列表中选中后，单击“删除”，以减
少规则的维护工作量。
● 启用/停用规则：对于暂时不需要使用的规则，用户可在规则列表中选中后，单击
“停用”。若要重新使用已停用的规则，可在选中规则后单击“启用”。
●
迁移规则：在迁移场景下，用户可在原系统规则页面中，单击“导出规则”将原
系统的规则导出，然后在目标系统中单击“导入规则”，将原系统中导出的规则
文件导入，完成规则的迁移。
●
备份、统计、审核、批量修改规则：用户可在规则页面单击“导出规则”将规则
导出，对规则进行备份、集中检查和统计；如需要批量调整规则，可以在导出的
规则文件中进行批量修改，修改完成后在规则页面单击“导入规则”将规则文件
导入。
1

## Page 80

说明
导出规则会导出用户的邮箱地址和电话号码，您需遵循所适用国家的法律或公司用户隐私
政策采取足够的措施，以确保用户的个人数据受到充分的保护。
参数说明
事件规则的参数和告警规则的参数相似，参数说明以告警规则为例。
表1-24 创建远程通知规则参数
参数项 参数名称 说明
条件 告警
●
若选择“指定告警”，则规则仅对添加的告
警生效。
“告警ID”、“分组名称”：唯一标识一条
告警。
●
若不选择“指定告警”，则默认对所有告警
生效。
告警源
●
所有告警源：该规则对所有告警源产生的告
警生效。
● 自定义告警源：该规则仅对指定告警源产生
的告警生效。
高级条件 对各参数项（定位信息、告警源类型等）的条
件限制。例如需要根据告警的定位信息进行筛
选告警，则选择“定位信息”、“包含”，并
输入对应的目标告警的定位信息关键字段。
时间条件
说明
规则缺省在
所有时间下
生效。
生效时间 设置规则的生效时间段，缺省为服务器时间。
按月 设置一年当中规则生效的月份。
按天 设置一周当中规则的具体生效日。
按时段 设置一天当中规则生效的时间段。
通知方式 邮件 邮件通知方式，用户需选择通知模板。当系统
缺省的通知模板不能满足需求，用户可以自定
义通知模板。
短消息 短消息通知方式，用户需选择通知模板。当系
统缺省的通知模板不能满足需求，用户可以自
定义通知模板。
延迟时间（分钟） 设置告警延迟发送远程通知的时长。告警到达
告警管理系统后，系统记录其“到达网管时
间”，如果告警在到达系统后的延时时长内被
清除，则不发送远程通知，否则发送远程通
知。
1

## Page 81

参数项 参数名称 说明
接收者时区 接收者时区 表示接收通知的用户所在时区。当接收者时区
与服务器时区不同时，通知中告警的发生时间
等字段会按照接收者时区进行换算。不支持夏
令时。
通知用户组 通知用户组 设置需要接收通知的用户组。
1.1.6.17
配置通知内容模板
当系统缺省通知内容模板不满足用户需求时，用户可创建新的通知内容模板，并在配
置远程通知规则时选择使用。系统将根据通知内容模板将告警信息填充至邮件或短消
息中发送给相关用户。
前提条件
已具备“设置远程通知规则”操作权限。
操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
告警设置”。
步骤2 在左侧导航树中选择“通知内容模板”。
步骤3 在“通知内容模板”页面中，单击“创建”。
步骤4 在“基本信息”区域中，输入模板名称和模板描述。
步骤5 在“通知方式和内容”区域中，选择邮件或短消息通知方式，并设置通知消息的重要
信息内容。为了唯一确定一条告警，建议包含告警流水号、级别、名称、告警ID、来
源系统、告警源、发生时间、清除时间、到达网管时间等内容。
●
若在“子标题”选中“新增告警数量
+
新增清除告警数量”选项，一封远程通知
邮件可以发送多条告警/事件，一封邮件最大容量为2MB，超过最大容量则拆分多
个邮件发送。创建远程通知规则时，告警/事件最多以200条/封邮件发送，如果设
置延迟时间，告警不受200条/封的限制。
●
若在“子标题”取消选中“新增告警数量
+
新增清除告警数量”选项，一封远程
通知邮件一次只发送一条告警/事件。
说明
模板中的黑色字体为包含在邮件或短消息中的固定字段，可以根据用户需要修改。蓝色字体根据
具体告警变化，展示告警的实质信息，用户不需要手工编辑，可通过选择“内容”下方的标签来
添加。
“发生时间”在不同场景中的含义如下：
●
一般告警上报时，此参数为上报时间，对应“当前告警”界面“首次发生时间”。
●
归并告警上报时，此参数为归并告警上报时间，对应“当前告警”界面“最近发生时间”。
●
清除告警通知时，此参数为该条告警的实际发生时间，对应“告警日志”界面中该告警的
“最近发生时间”。
步骤6 单击“确定”。
----结束
1

## Page 82

1.1.6.18
手动同步告警
对接系统与CloudSOP断连后导致部分对接系统侧告警无法上报，二者重新连通后建议
执行手动同步将告警同步到CloudSOP，便于CloudSOP监控。
前提条件
已具备“同步网元告警”的操作权限。
背景信息
正常情况下，告警管理自动同步对接系统侧的告警数据到告警管理。
操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“告警同步”。
步骤3 在“告警同步”页面中选择需要同步的告警源。“同步对象”参数说明请参见表
1-25。
步骤4 在“时间范围”中选择具体的时间段，表示只同步该段时间内的告警。
步骤5 单击“执行同步”开始同步告警。
----结束
参数说明
表1-25 同步对象参数说明
同步对象 说明
所有告警源 选择所有的告警源。
指定告警源范围 以“来源系统”为粒度选择一个或多个
来源系统下所有的告警源。
自定义告警源 以单个告警源为最小粒度选择告警源。
1.1.6.19
维护经验管理
处理告警后，及时将处理经验记录在维护经验库中，以便为后续或他人的维护工作中
提供参考和借鉴。
前提条件
已具备“设置告警维护经验”的操作权限。
背景信息
●
“告警设置
>
维护经验”中管理的维护经验与告警详情中的维护经验为同一个经
验库。
1

## Page 83

●
最多可创建10000条维护经验。
操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
告警设置”。
步骤2 在左侧导航树中选择“维护经验”。
步骤3 在“维护经验”页面中，单击“创建”。
步骤4 选择需要创建维护经验的告警。创建维护经验参数说明请参见表1-26。
步骤5 输入维护经验。
步骤6 单击“确定”，完成一条维护经验的创建。
----结束
相关任务
用户可导入/导出维护经验，以便统计、审核、迁移维护经验。在“维护经验”页面
中，单击“导出”或“导入”进行操作。
参数说明
表1-26 创建维护经验参数说明
参数 说明
告警名称 告警的名称。
标识 告警ID。
分组名称 由上报告警的网元或设备为上报的告警
分配。
1.1.6.20
设置当前告警阈值提示
当系统中的当前告警数量达到了容量上限时，系统将按满处理规则将部分当前告警转
为历史告警。为避免用户关注的告警被转为历史告警，用户可设置当前告警阈值提
示，当前告警数量达到一定阈值时上报告警，提示用户对当前告警进行处理。
前提条件
只有角色为“Administrators”的用户可进行该配置。
背景信息
为了避免因当前告警过多影响系统性能，告警管理功能提供了告警满处理规则。当数
据库中的当前告警数量达到上限阈值时，按以下规则将部分告警转为历史告警，当告
警数量恢复到上限阈值的90%时，停止满处理。
●
告警类型按照“已清除告警”、“已确认未清除的不可自动清除告警”、“已确
认未清除的可自动清除告警”及“未确认未清除告警”的先后顺序，依次转为历
史告警。
1

## Page 84

●
类型相同的告警按照时间顺序优先将较早发生的告警转为历史告警。
●
分布式场景下，网元分区后上报的告警满处理时，依次将所在节点的告警按照数
量由高到低的顺序转为历史告警，上报告警越多的节点转历史优先级越高。例如
网元分别接入到A、B节点，A节点接入的网元告警量大，会优先将A节点的告警进
行满处理，上报告警量少的网元节点B不做处理。
操作步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“当前告警阈值提示”。
步骤3 选择是否在当前告警数量达到阈值时发送告警，并设置产生告警和恢复告警的阈值。
●
产生阈值：当前告警的数量与容量上限的占比大于等于指定的阈值时，产生
“ALM-157 当前告警数量达到阈值”告警。
●
恢复阈值：当前告警的数量与容量上限的占比小于指定的阈值时，“ALM-157 当
前告警数量达到阈值”告警恢复。恢复阈值不能高于产生阈值。
步骤4 单击“应用”。
----结束
1.1.6.21
配置告警静态信息
当首次安装部署或者新增告警时，管理员需要配置告警静态信息。管理员在告警扩展
页面下载模板，依照模板要求填写告警静态信息，并将告警静态信息导入ManageOne
系统，以便管理员在告警设置页面对已导入的告警设置规则。
导入的告警静态信息与告警管理建立关联，管理员可在告警设置页面对具体告警设置
规则，并通过导出全量查看已导入的告警静态信息，实现告警静态信息的统一管理。
告警静态信息包括告警ID、告警分组ID、告警类型ID、告警名称、告警分组名称、告
警级别及告警描述等信息。
前提条件
●
已登录ManageOne运维面。
●
已具有告警扩展“查询权限”和“设置权限”操作权限。
操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
告警扩展”。
进入“告警扩展”页面。
步骤2 在“告警信息导入”中，单击“下载模板”。
根据模板要求填写告警静态信息。
步骤3 单击“导入文件”左侧的 ，选择步骤2已填写的告警信息的Excel文件，单击“导入
文件”。
1

## Page 85

图1-7 告警信息导入操作图
说明
● Excel文件中至少包括一条告警静态信息。
●
如果需要更新已导入的告警静态信息，请导入已更新告警信息的Excel文件，告警ID且告警分
组ID相同的告警，告警静态信息将被更新。
步骤4 弹出“上传结果”对话框，查看上传成功和上传失败的数据。
若存在上传失败数据，单击“下载失败详情”，查看上传失败的告警信息。
说明
失败详情信息只保留30分钟，超时则获取到的失败详情内容为空，请及时下载并查看失败详情
信息。若关闭“上传结果”对话框，将无法下载并查看失败详情信息。
步骤5 如需查看已有的告警静态信息，可单击“告警信息导出”下的“导出”按钮，在导出
的Excel文件中查看告警静态信息。
----结束
1.1.6.22
配置告警/事件手工转储任务
为避免告警数据过多导致数据库空间不足，用户可以通过手工创建转储任务，转储历
史告警、被屏蔽告警和事件日志等不常关注的数据，被转储的告警/事件数据会以ZIP
压缩文件的格式存放在服务部署节点路径上，用户可登录服务部署节点查看对应转储
ZIP压缩文件，转储后的告警/事件则会自动从数据库清除，释放数据库空间。
警告
告警转储是不可逆的，请谨慎操作，一旦选择转储，被转储的告警/事件数据就会从数
据库中自动清除，如果用户想要继续查看这些数据，只能登录服务部署节点查看对应
转储的ZIP压缩文件。
前提条件
●
已登录ManageOne运维面。
●
已具有告警扩展“查询权限”和“设置权限”操作权限。
操作步骤
创建告警/事件手工转储任务
1

## Page 86

步骤1 在主菜单中选择“集中监控
>
告警管理
>
告警扩展” 。
步骤2 在左侧导航树中选择“告警转储”。
进入“告警转储”页面。
步骤3 单击右上方“转储”，在“转储”对话框中设置转储参数。参考表1-27填写转储配置
参数。
图1-8 转储操作图
表1-27 参数说明
类别 参数 说明 取例样值
文件 文件路径
●
数据库中的告警/事件数据转储
后的ZIP压缩文件存放路径。
●
非固定路径，根据安装配置情
况，告警会自动生成这个存储
文件路径。
默认生成路
径:/opt/share/
Product/
FMService/
ManualDump/
FM
1

## Page 87

类别 参数 说明 取例样值
文件格式 数据库中的告警/事件数据转储为
CSV、XML或者TXT格式的ZIP压
缩文件。
CSV
数据产生时
间
开始时间
●
需要从数据库中转储的告警/事
件数据产生的开始时间和结束
时间。
●
数据产生时间分为2种：开始
时间、结束时间。根据需要指
定一种或者都指定进行转储，
默认转储所有时间范围的数
据。
–
如果没有指定“开始时
间”，表示转储从安装
ManageOne以来到“结束
时间”之间的数据。
–
如果没有指定“结束时
间”，表示转储从“开始时
间”到当前操作时间之间的
数据。
–
如果没有指定“开始时间”
和“结束时间”，表示转储
所有时间范围的数据。
05.08.2020
08:07:44 PM
结束时间
05.08.2020
08:07:51 PM
符合转储条
件的数量
历史告警记录
数据（条）
●
数据产生时间段内，符合转储
条件的历史告警记录数量。
● 数据产生时间段内，符合转储
条件的屏蔽告警记录数量。
●
数据产生时间段内，符合转储
条件的事件记录数量。
●
需要单击 才能显示对应
的数据。
●
符合转储条件的记录分为3
种：历史告警记录数据
（条）、屏蔽告警记录数据
（条）、事件记录数据
（条）。根据需要指定一种或
多种条件进行转储，默认所有
的告警/事件数据都符合转储条
件。
1714
屏蔽告警记录
数据（条）
332
事件记录数据
（条）
5
-
恢复缺省值 恢复默认设置。
-
-
删除转储文件 删除“文件路径”参数所示路径
下的告警/事件转储文件。
-
1

## Page 88

步骤4 单击“确定”完成转储任务创建。创建成功后可以在告警转储页面“基本信息”区域
中查看转储任务的相关信息。基本信息展示最近一次执行的转储任务信息。
●
开始时间：本次任务执行的开始时间。
●
结束时间：本次任务执行的结束时间。
●
进度：本次任务的执行进度。
●
执行状态：正常执行状态有启动成功、执行中、全部成功。异常执行状态有全部
失败、部分失败、未执行、错过、未知、启动失败、执行失败等。如果出现异常
执行状态，可以等待一段时间重新创建该转储任务。
----结束
查看手工转储后的ZIP压缩文件
步骤1 使用PuTTY工具以sopuser用户登录FM服务所在的节点。
FM服务所在节点为ManageOne-Service03/04的任一节点或ManageOne-
AppServer0X的任一节点。
步骤2 执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
步骤3 执行以下命令，进入转储文件目录。
cd /opt/share/Product/FMService/ManualDump/FM
说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
步骤4 查看对应目录下生成的文件夹和文件夹下的zip包。
注意
转储时一份zip包只会随机存储到其中一个节点。
----结束
1.1.6.23
手动同步
CMA
告警
为避免CloudScope上通过CMA管理的高阶云服务、eSight等告警与实际从CMA自动上
报至ManageOne的高阶云服务、eSight等告警的数量不一致，用户可以通过手动同步
CMA告警直接上报至ManageOne的当前告警页面。
前提条件
●
已登录ManageOne运维面。
●
已具有告警扩展“查询权限”和“设置权限”操作权限。
1

## Page 89

操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
告警扩展”。
步骤2 在左侧导航树中选择“同步CMA告警”。
进入“同步CMA告警”页面。
步骤3 单击“同步CMA告警”，可以手动同步CMA的全量告警。
说明
●
该告警同步仅支持手动同步CMA（CloudMonitorAlarm）的告警，不支持自动定时同步。本
次同步10分钟以后才可以进行下一次同步。
●
一次手动同步操作最多可以同步2万条CMA告警，同步上来的告警可以在“集中监控
>
告警
管理
>
当前告警”页面查看。
----结束
1.1.7
告警监控参考
介绍告警管理相关参考。
1.1.7.1
参数说明：监控和查看告警
介绍“当前告警”、“历史告警”、“告警日志”、“被屏蔽告警”页面中的关键参
数。
告警过滤栏
告警过滤栏参数说明请参见表1-28。
表1-28 告警过滤栏参数说明
参数项 说明
告警名称 选择需要查看的告警名称。用户在选择告警名称时可导入/导出
已选告警名称条件，也可导出所有的告警名称。
告警源 产生告警的设备/网元。
存在多个告警源条件时，过滤结果取所有条件的并集，即满足任
一条件的告警都会被筛选出来。
级别 请参见告警级别。
告警状态 请参见告警状态。该参数不在“被屏蔽告警”中显示。
最近发生时间 告警第一次发生的时间和最近一次发生的时间。
该参数在“告警日志”、“被屏蔽告警”和“历史告警”中显示
为“发生时间”，表示告警最近一次发生的时间。
清除时间 告警清除的时间。
该参数不在“被屏蔽告警”中显示。
1

## Page 90

参数项 说明
高级设置 用户可对告警参数设定条件过滤出需要查看的告警，具体参数的
含义请参见表1-30。
操作符说明（输入的英文字母区分大小写）：
●
包含：筛选出包含指定字符串的告警。
●
不包含：筛选出不包含指定字符串的告警。
●
等于：筛选出与指定关键词完全相同的告警。
● 不等于：筛选出与指定关键词不相同的告警。
●
开头是：筛选出以指定字符串开始的告警。
●
结尾是：筛选出以指定字符串结束的告警。
●
属于：筛选出与指定字符串完全相同的告警。例如：在“定
位信息”选项中选择“操作符”为“属于”，设置“值”为
“XXX”，过滤出告警源名称为“XXX”的告警，此时告警源
名称为“XXX123”的告警不会被过滤出来。
●
不属于：筛选出指定字符串不相同的告警。例如：在“定位
信息”选项中选择“操作符”为“不属于”，设置“值”为
“XXX”，过滤出告警源名称不为“XXX”的告警，此时告警
源名称为“XXX123”的告警将被过滤出来。
●
空：筛选出该选项为空的告警。
●
非空：筛选出该选项不为空的告警。
为提高维护效率，建议用户将“关联告警标识”保持为缺省选中
的“根源告警”、“汇聚告警”和“普通告警”，该参数不在
“被屏蔽告警”和“历史告警”中显示。各选项含义：
●
普通告警：表示该告警不存在对应的根源/衍生告警和汇聚/被
汇聚告警。
●
根源告警：产生多条相关告警的源头告警。
●
衍生告警：由根源告警导致产生的相关告警。
●
汇聚告警：当符合汇聚规则条件的告警上报后，系统新生成
的告警，对应多条被汇聚告警。
●
被汇聚告警：符合汇聚规则条件的告警，对应一条汇聚告
警。
告警操作栏
告警操作栏按钮说明请参见表1-29。
表1-29 告警操作栏按钮说明
按钮 说明
自动刷新
●
开启：实时刷新当前界面的告警。
●
关闭：当前界面的告警将被锁定，此时只刷新当前界面的告
警信息。若有其他告警上报，将不在该界面显示。
1

## Page 91

按钮 说明
快速过滤 快速筛选出已选中告警。
组合排序 根据多个告警字段对告警进行排序，最多可设置4个告警字段。
清除 当故障已经排除而告警没有自动清除时，需通过“清除”按钮
进行手动清除。告警被清除后，状态变为“已清除”。
确认/反确认 对告警进行确认表示告警即将或已经被处理。告警被确认后，
由未确认状态变成已确认状态。
如果要更换告警处理人员，可对该告警进行反确认操作。告警
被反确认后，由已确认状态变成未确认状态。
指定处理人 标识处理该告警的用户，设置后告警参数“处理人”显示为设
置的指定用户。可以选择：给我处理、选择处理用户、取消指
定。
备注 编辑告警的备注信息。
导出 导出XLSX或CSV格式的告警表，当导出的告警数量超过10万条
时，文件将以zip压缩包的格式导出。
调整级别 更改告警的级别，如：将告警级别从“重要”改为“紧急”。
通过级别的变更提升或降低维护人员对此条告警的关注度。
设为有效/设为无
效
将选中的告警设置为无效告警或有效告警，当用户监控或查询
告警时，设置过滤条件可将该类告警过滤掉从而精简告警，提
升告警处理效率。例如运维人员通过经验主观判断为无用的告
警，可将其设置为无效告警。
设为维护/设为正
常
将选中的告警设置为维护态或正常态，当用户监控或查询告警
时，设置过滤条件可将该类告警过滤掉从而精简告警，提升告
警处理效率。如调测场景下产生的告警可通过规则将其标识为
“维护态”。
核对 该操作告警管理中选中的当前告警的清除状态与网元侧进行比
对，使两边的清除状态保持一致。当比对结果不一致时，告警
管理中该告警的清除状态变为网元侧的。
发送邮件通知 将选中告警的相关信息通过邮件方式立即发送给运维人员。
发送短信通知 将选中告警的相关信息通过短信方式立即发送给运维人员。
告警列
告警列参数说明请参见表1-30。
表1-30 告警列参数说明
名称 说明
告警ID 告警 ID，与告警一一对应。
1

## Page 92

名称 说明
告警流水号 一条告警从产生开始，中间可能经过多次改变，例如级别变
更、被清除等，根据该流水号可以唯一的确定一条告警。
告警归并时，原有的告警放入历史告警，当前告警中记录新的
告警及新的告警流水号。
列表流水号 告警在归并处理后被赋予的流水号，区别于“告警流水号”。
告警匹配的规则名 告警经过规则匹配后，打上生效的规则标记。
VDC ID
VDC的ID，与VDC名称一一对应。
VDC名称 VDC的名称。
次数 记录同一故障点发生同一告警的重复次数或被归并次数，以提
高用户的关注和处理效率。
该参数不在“被屏蔽告警”和“历史告警”中显示。
告警源 产生告警的设备/网元。
例如：OSS，即运营支撑系统（Operations
Support
System）。
名称 告警的名称。根据告警名称可以了解告警源发生了什么故障。
如：CPU占用率过高告警，根据名称即可知道是CPU发生了告
警。
告警名称中各图标含义如下：
●
：根源告警，可展开告警拓展显示区域查看该告警相关的
衍生告警。
●
：衍生告警，可展开告警拓展显示区域查看该告警相关的
根源告警。
●
：汇聚告警。
●
：被汇聚告警。
●
：无效告警。
●
：维护态告警。
●
：振荡告警，可在过滤条件的“高级设置”中设置“振荡
标识”进行过滤。
●
：表示该告警存在对应的告警参考页面，可直接单击图标
跳转查看。
●
：表示该告警已存在备注，可单击告警名称在告警详情页
面中查看备注信息。
级别 包括4种级别：紧急、重要、次要、提示。
1

## Page 93

名称 说明
确认状态 告警的确认状态，两种状态：
●
已确认：被确认的告警，“确认状态”显示为“已确认”。
●
未确认：被反确认的告警，“确认状态”显示为“未确
认”。
该参数不在“被屏蔽告警”中显示。
清除状态 告警的清除状态，有两种状态：
●
已清除。
●
未清除。
该参数不在“被屏蔽告警”中显示。
可能原因 描述引起该告警的所有可能原因，引导维护人员处理告警。
振荡次数 振荡期间告警被屏蔽或丢弃的次数。
该参数不在“被屏蔽告警”中显示。
维护状态 告警的维护状态，如“普通”表示告警源正常运行，没有处于
调测或升级等状态。
该参数不在“被屏蔽告警”中显示。
确认时间 告警确认的时间。
该参数不在“被屏蔽告警”中显示。
清除时间 告警清除的时间。
该参数不在“被屏蔽告警”中显示。
来源系统 告警来源系统的名称。
说明
两级运维场景下，总部ManageOne运维面展示全网所有的告警，来源
系统用于识别当前告警来源于总部还是分部。
来源系统流水号 告警管理为来源系统分配的标识。
告警源类型 发生告警的网元类型。
类型 告警的类型请参见告警和事件的类型。
1

## Page 94

名称 说明
操作 提供可对本条告警执行的操作：
●
确认告警；
●
清除告警；
●
核对；
● 发送邮件通知；
●
发送短信通知；
●
“设置屏蔽规则”，具体请参见1.1.6.6 配置屏蔽规则；
●
“设置标识规则”，具体请参见1.1.6.13 配置标识规则；
●
“设置远程通知规则”，具体请参见1.1.6.16 配置远程通知
规则；
●
“设置级别和类型重定义规则”，具体请参见1.1.6.11 配置
级别和类型重定义规则；
●
“设置名称重定义规则”，具体请参见1.1.6.12 配置名称重
定义规则；
●
“设置闪断/振荡规则”，具体请参见1.1.6.7 配置闪断/振荡
规则；
●
“设置汇聚规则”，具体请参见1.1.6.8 配置汇聚规则。
定位信息 辅助进行故障定位的信息。通过定位信息可以快速地定位到产
生告警的位置。
发生时间 如果该告警是归并告警，则发生时间是该告警第一次发生的时
间。如果该告警不是归并告警，界面上显示的是该告警的发生
时间。
该参数不在“被屏蔽告警”和“历史告警”中显示。
到达网管时间 告警到达告警管理系统的时间。
最近发生时间 如果该告警是归并告警，则最近发生时间是该告警最近一次发
生的时间。如果该告警不是归并告警，界面上显示的是该告警
的发生时间。
该参数在“被屏蔽告警”和“历史告警”中显示为“发生时
间”。
确认用户 执行告警确认操作的用户。若用户进行反确认操作，则会显示
反确认用户。
该参数不在“被屏蔽告警”中显示。
清除用户 清除告警的用户。
该参数不在“被屏蔽告警”中显示。
处理人 运维人员可将告警指派给具体用户处理，该字段记录当前处理
的用户名。
设置：选中一条或多条告警，单击“指定处理人”，在下拉菜
单中选择操作。
该参数不在“被屏蔽告警”中显示。
1

## Page 95

名称 说明
可自动清除 告警是否可以自动清除。
●
是：表示该告警可以自动清除，则产生该告警的故障消除
后，该告警的“清除状态”会自动变为“已清除”。
●
否：表示该告警不可以自动清除，则产生该告警的故障消除
后，需要手工清除告警。
该参数不在“被屏蔽告警”中显示。
部署区域 设备部署区域标识。区域可能对应于一个物理的数据中心，也
可能对应于逻辑区域。
厂商 网元所属的厂商。
领域 告警网元所属的产品类型。
说明
两级运维场景下，如果是总部上报的告警，则为空，如果是非总部上报
的告警，则显示“省级告警”。
IP地址/URL/域名 告警物理设备的IP地址。
对象类型 产生告警的资源对象的类型，例如单板、文件目录和端口等。
附加信息 记录告警的一些和定位无关的信息，辅助用户理解该告警。
租户标识 告警源所属的租户标识。
租户名称 告警源所属的租户名称。
备注 由用户填写的告警备注信息，长度不超过512个字符。
设置方法：用户可选中一条告警并单击“备注”按钮，输入告
警备注信息。
影响业务名称 告警所影响的业务名称。
影响业务标识
●
是：对业务有影响。
●
否：对业务无影响。
●
未知：对业务的影响不明确。
来源系统类型 告警来源系统的类型。
NFV资源池 告警源所属NFV资源池的名称。
备份状态 反映该告警对业务的影响程度，包括3种状态：
●
是，表示承载的业务已倒换到备用资源上，并没有对现有业
务能力造成直接的影响；
●
否，表示承载的业务未倒换到备用资源上，对于同一个告
警，备份状态为“否”对业务的影响程度比备份状态为
“是”的告警要高；
●
未知：表示对于承载的业务是否倒换到备用资源上不能确
定。
原因标识 导致该告警的具体原因的ID。
1

## Page 96

名称 说明
数据中心 告警源所属数据中心的名称。
区域 告警源所属逻辑位置的名称。
清除类型
●
空：未清除；
●
正常清除：设备故障恢复，接收到清除告警，告警被自动清
除；
●
复位清除：设备在重启动后，重新开始检测是否存在故障，
原来存在的故障告警被自动清除；
● 手动清除：告警被用户手动清除；
●
配置清除：资源对象删除使此资源对象相关的告警被自动清
除；
●
相关性清除：告警管理在进行相关性规则处理时，当接收到
未清除的衍生告警的根源告警时，则在上报根源告警的同
时，自动清除该衍生告警，该衍生告警的清除类型为相关性
清除；
●
系统清除：由于存储空间的容量限制，根据满处理规则对较
早上报的告警执行清除；
●
状态切换清除：由于设备发生状态切换，设备前一状态的活
动告警被自动清除，而后以切换后的设备状态重新上报告
警，前一设备状态的活动告警的清除类型为状态切换清除；
●
网管同步清除：当同步告警时，如果告警管理上原有的未清
除告警在同步上来的告警中不存在了，则该告警被自动清
除。
该参数不在“被屏蔽告警”中显示。
可用区 告警源所属可用区的名称。
失效状态 缺省为“有效”，在“标识规则”中可将告警设置为“无
效”。
该参数不在“被屏蔽告警”中显示。
持续时间 告警“最近发生时间”到“清除时间”之间的时间。
该参数不在“被屏蔽告警”中显示。
资源名称 告警源的资源名称。
资源标识 告警源的资源ID。
阈值信息 包含故障相关的测量指标的门限和当前值。例如：上报“环境
温度越限告警”时，需要说明温度过高还是过低，对应的门限
值和当前的温度值。
告警信息列
单击告警左侧箭头可展开告警信息列，查看告警详情等内容，各页签说明请参见表
1-31。
1

## Page 97

表1-31 告警信息列页签说明
页签 说明 操作方法
告警详情 告警的参数说明请参见表
1-30。
设置告警详情的显示信息：在“告
警详情”区域的右上角单击“选择
列”。
告警帮助 提供对应的告警帮助链接地
址。
告警处理过程中涉及到运维自
动化工具的告警，会提供告警
帮助辅助处理工具入口。
告警帮助为告警处理的入口，请单
击告警帮助链接地址，根据告警帮
助进行操作。
维护经验 “维护经验”页签可查看或修
改维护经验。
修改维护经验：单击“维护经验”
标签，在区域右侧单击“编辑”，
填写维护经验，单击“保存”。
备注 为该告警添加备注信息。 修改备注：在区域右上角单击“编
辑”，填写告警备注信息，单击
“保存”。
最近2个月处
理记录
可查看最近2个月对该告警执
行的所有手工操作，以便运维
人员在处理告警时参考。
-
根源告警/衍
生告警
●
当上报的告警是根源告警
时，扩展列展示“衍生告
警”页签，可查看该告警
的衍生告警。
●
当上报的告警是衍生告警
时，扩展列展示“根源告
警”页签，可查看该告警
的根源告警。
●
当上报的告警既是根源告
警又是衍生告警时，扩展
列将同时展示“根源告
警”和“衍生告警”页
签。
-
汇聚告警/被
汇聚告警
●
当上报的告警是汇聚告警
时，扩展列展示“被汇聚
告警”页签，可查看该告
警下哪些告警被汇聚。
●
当上报的告警是被汇聚告
警时，扩展列展示“汇聚
告警”页签，可查看该告
警汇聚为哪一条告警。
-
过滤模板
单击页面左侧“默认模板”，在“快速过滤”中可管理过滤模板，按钮说明请参见表
1-32。
1

## Page 98

表1-32 过滤模板按钮说明
按钮 说明 操作方法
搜索模板 根据模板名称、创建模板的用户名或者
备注搜索过滤模板。
1.
在“快速过滤”中的搜
索框输入模板的名称或
者用户名。
2. 单击 进行搜索。
共享/取消共
享
用户可共享或取消共享自定义的模板，
并可在“共享模板”中选择其他用户共
享的模板。
●
：表示该模板未被共享。
●
：表示该模板已被共享。
说明
管理员可对除预置模板外的所有模板进行
共享/取消共享，其他用户只可对自定义模
板进行共享/取消共享。
1.
在“快速过滤”中选择
需要操作的模板。
2.
单击模板名称后的相应
图标设置共享/取消共
享该模板。
关注/取消关
注
用户可关注或取消关注模板，关注后的
模板将在“关注模板”中显示。
●
：表示该模板未被关注。
●
：表示该模板已被关注。
说明
“预置模板”只支持关注/取消关注和设置/
取消缺省模板的操作。
1.
在“快速过滤”中选择
需要操作的模板。
2.
单击模板名称后的相应
图标关注/取消关注该
模板。
设置/取消缺
省模板
用户可为当前页面设置/取消缺省模
板，进入当前页面后，系统将按缺省模
板展示过滤后告警。
说明
显示为 的模板为缺省模板。
1.
在“快速过滤”中选择
需要操作的模板。
2.
单击模板后的 ，或
单击 选择“设置/取
消缺省模板”。
重命名 对过滤模板重命名。
说明
管理员可对除预置模板外的所有模板进行
重命名，其他用户只可对自定义模板重命
名。
1.
在“快速过滤”中选择
需要操作的模板。
2.
单击模板后的 。
3.
在弹出的菜单中选择
“重命名”。
4.
在弹出的对话框中输入
重命名后的模板名称。
修改备注 修改过滤模板的备注信息。
说明
管理员可修改除预置模板外所有模板的备
注，其他用户只可修改自定义模板的备
注。
1.
在“快速过滤”中选择
需要操作的模板。
2.
单击模板后的 。
3.
在弹出的菜单中选择
“修改备注”。
4.
在弹出的对话框中修改
备注信息。
1

## Page 99

按钮 说明 操作方法
删除 删除过滤模板。
说明
管理员可删除预置模板外的所有模板，其
他用户只可删除自定义模板。
1.在“快速过滤”中选择需要操作的模板。
2. 单击模板后的 。
3. 在弹出的菜单中选择
“删除”。
在新页签中打
开
打开一个新页签，并在新页签中按过滤
模板显示告警/事件列表。
1.
在“快速过滤”中选择
需要操作的模板。
2.
单击模板后的 ，或
单击 选择“在新页
签中打开”。
1.1.8 FAQs
介绍告警管理操作中常见的问题及解决办法。
1.1.8.1
当前告警界面操作技巧
操作技巧
介绍界面操作技巧，方便用户快捷操作和提升告警处理效率。
●
告警列表支持多行选中。您可以在键盘中按下Ctrl实现多行选中或者按下Shift实现
跨行连续选中。
●
告警列表支持快速复制告警信息。您可以将选中的一行或者多行，按下“Ctrl
+C”且提示复制成功后，在本地excel表格或者文本中按下“Ctrl+V”粘贴相应内
容。
●
设置不显示“操作”列时，在告警列表选中一行或者多行告警，鼠标在选中区域
移动时，您可以单击浮动菜单 并选择相应的功能操作告警。
说明
选中多行时，浮动菜单 不支持“设置规则”操作。
1.1.8.2
被屏蔽告警和事件是否可以批量导出
问题
被屏蔽告警和事件是否可以批量导出？
答案
如果“创建告警屏蔽规则”界面中“动作”选择将屏蔽后的告警“丢弃”，则无法批
量导出被屏蔽的告警。
1

## Page 100

如果“创建告警屏蔽规则”界面中“动作”选择将屏蔽后的告警“显示在“被屏蔽告
警”中”，则被屏蔽的告警可以在“被屏蔽告警”界面中批量导出。
在“创建事件屏蔽规则”界面中，“动作”只能为将屏蔽后的事件“丢弃”，故无法
批量导出被屏蔽的事件。
1.1.8.3
如何处理
Firefox
下停止告警声音不生效的问题
问题
如何处理Firefox下停止告警声音不生效的问题？
答案
执行停止告警声音操作后按F5刷新页面。
1.1.8.4
如何查看告警在
VMware
中的告警级别
问题
VMware的告警级别与告警管理系统上报的告警级别不相同，如何查看告警在VMware
中的告警级别？
答案
告警在VMware中的告警级别请参见表1-33。
表1-33 告警级别对应关系表
VMware ManageOne
严重 重要
警告 次要
正常 提示
1.1.8.5
为何告警管理系统上的告警比第三方系统多
问题
告警管理系统出现异常或与第三方系统对接异常时在第三方系统上清除的告警，恢复
正常后无法在告警管理系统上同步清除，导致告警管理系统的告警比第三方系统多。
答案
若告警管理系统出现异常或与第三方系统对接异常时清除了第三方系统上的告警，此
时无法同步清除告警管理系统上的相关告警。当异常恢复后，被清除的告警也无法在
告警管理系统上同步清除，导致告警管理系统上的告警比第三方系统多。此时可联系
运维人员手工清除告警管理系统上的相关告警。
1

## Page 101

1.1.8.6
为什么告警信息中的确认用户或清除用户显示为<系统>
问题
为什么告警信息中的确认用户或清除用户显示为 <系统>？
答案
当前告警经过告警满处理转入历史告警后，告警信息中的确认用户或清除用户会显示
为 <系统>。
当前告警经过自动确认规则被系统自动确认后，告警信息中的确认用户会显示为 <系
统>。
告警满处理规则和自动确认规则的处理机制请参见表1-34。
表1-34 告警处理机制
机制 描述
告警满处理规
则
为了避免因当前告警过多影响系统性能，告警管理功能提供了告警
满处理规则。当数据库中的当前告警数量达到上限阈值时，按以下
规则将部分告警转为历史告警，直至告警数量恢复到上限阈值的
90%。
●
按照先后顺序依次将“已清除告警”、“已确认未清除的不可自
动清除告警”、“已确认未清除的可自动清除告警”及“未清除
未确认告警”转为历史告警。
●
按照时间顺序优先将较早发生的告警转为历史告警。
●
分布式场景下，网元分区后上报的告警满处理时，依次将所在节
点的告警按照数量由高到低的顺序转为历史告警，上报告警越多
的节点转历史优先级越高。例如网元分别接入到A、B节点，A节
点接入的网元告警量大，会优先将A节点的告警进行满处理，上
报告警量少的网元节点B不做处理。
自动确认规则 系统将根据自动确认规则，将符合条件的未确认已清除告警进行自
动确认。
1.1.8.7
为什么告警信息中的清除用户显示为<网元>
问题
为什么告警信息中的清除用户显示为 <网元>？
答案
故障恢复之后自动清除的告警，清除用户会显示为 <网元>。
1

## Page 102

1.1.8.8
如何屏蔽指定告警
问题
如何屏蔽指定告警？
答案
拥有“设置屏蔽规则”操作权限的用户，可在屏蔽规则中配置需屏蔽的告警。此处以
屏蔽“License即将过期”告警为例。
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“屏蔽规则”。
步骤3 在“屏蔽规则”页面中，单击“创建” ，选择“告警屏蔽规则”。
步骤4 在“基本信息”区域中，设置规则的名称、描述信息、是否启用规则。
步骤5 在“条件”区域中，“告警”选择“指定告警”，单击“增加告警”。
步骤6 在弹出的“增加告警”对话框左侧“可选”区域中，输入“License即将过期”，单击
。
步骤7 在搜索结果中选择需屏蔽的告警，单击 放入“已选”列表中，单击“确定”完成
指定告警的选择。
步骤8 在创建屏蔽规则界面中，单击“确定”完成屏蔽规则的创建。
----结束
1.1.8.9
为什么告警上报会延时
问题
为什么告警上报会延时？
答案
用户可能在“闪断/振荡规则”中设置了相关的闪断策略。此为正常现象，不影响操
作，无需处理。
闪断策略：用户可设置“闪断周期”为30秒，当规则中配置的告警产生时，若在30秒
内该告警恢复，则丢弃或屏蔽该告警；若在30秒内该告警没有恢复，则上报该告警至
告警管理系统。
1.1.8.10
如何自定义当前告警或历史告警的显示列信息
问题
在查看当前告警或历史告警列表时，如何自定义告警的显示列信息？
1

## Page 103

答案
单击当前告警或历史告警页面的 可自定义显示列信息。
步骤1 进入告警查看页面。
●
查看当前告警
在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。
●
查看历史告警
在运维面主菜单中选择“业务监控
>
告警监控
>
历史告警”。
步骤2 单击告警列表右上方的 按钮。
步骤3 在弹出的对话框中，在“选择显示的列”中选择需要显示的列，单击 。
步骤4 单击“确定”。
----结束
1.1.8.11
为什么按网元时间查询告警时部分告警查询不到
问题
为什么按网元时间查询告警时部分告警查询不到？
答案
以时间为过滤条件（如最近发生时间、清除时间等）查询告警，如果设置的时间模式
为“按网元时间”，且设置的查询时间在夏令时跳变的时间段内，可能会无法查询出
部分满足条件的告警。
下面以“清除时间”过滤条件为例进行说明：
● 服务器所在时区在当地时间3月6日2：00进入夏令时。
●
过滤条件中清除时间设置为3月6日1:30到3月6日2:10。
服务器所在时区3月6日2：00进入夏令时，进入夏令时后时间显示为3月6日3:00，故
2:00至3：00之间为夏令时跳变的时间段。此时用户要查询清除时间在1：30到2：10
的告警，由于2:00到2:10在夏令时跳变时间段内，所以该时间段内的告警查询不到。
1.1.8.12
为什么查询或转储告警的结果中包含不在查询时间范围内的告警
问题
为什么查询或转储告警的结果中包含不在查询时间范围内的告警？
答案
时间本地化功能是指支持将告警的产生、清除等时间显示为当前系统的本地时间。告
警管理服务器处理的一切业务时所使用的时间都是格林威治标准时间，不受时区和夏
令时的影响。告警管理系统向服务器提交处理任务时，服务器会自动将系统的时间转
换为标准时间。因此受时区、夏令时的影响，由服务器处理的、与时间相关的业务，
1

## Page 104

如果其处理时间范围包含夏令时跳变的时间段，其处理结果可能与系统界面看到的时
间不一致。
假设：
●
告警管理系统当前所在时区为西二区。
●
西二区在当地时间3月25日2:00进入夏令时。
●
当前的格林威治标准时间为3月25日4:30。
●
一条告警在西二区当地时间3月25日1:50产生。
●
在告警管理系统上查询发生时间范围为3月25日2:00～4:00的告警。
●
在告警管理系统上转储发生时间范围为3月25日2:00～4:00的告警。
根据以上假设，有以下现象：
●
当前的格林威治标准时间为3月25日4:30，对应西二区的非夏令时时间为3月25日
2:30，由于西二区在3月25日2:00进入夏令时，所以西二区的夏令时时间为3月25
日3:30，系统上显示的时间为3月25日3:30。
● 一条告警在西二区当地时间3月25日1:50产生，该告警的产生时间对应格林威治标
准时间为3月25日3:50，由于时间本地化功能，该告警在系统上显示的时间为3月
25日1:50。因此在系统上查询发生时间范围为3月25日2:00～4:00的告警，转换为
标准时间为3月25日3:00～5:00，能够查询到该告警；在系统上转储发生时间范围
为3月25日2:00～4:00的告警，转换为标准时间为3月25日3:00～5:00，转储的结
果中包含该告警。
1.1.8.13
为什么使用
Chrome
浏览器查看当前告警页面无法听到告警提示音
问题
为什么使用Chrome浏览器查看当前告警页面无法听到告警提示音？
答案
Chrome浏览器66及以上版本默认不支持网站自动播放功能。在用户没有明确要求开始
播放的情况下，不会自动播放视频或音频。该问题可通过以下两种方法解决：
●
用户与网页进行交互。例如在页面任意处进行单击操作；或选择“业务监控
>
告
警监控
>
当前告警”重新进入当前告警页面，浏览器会认为用户已与网页进行了
交互。
●
将当前网址加入声音播放白名单中。
a.
在浏览器右上角单击“
>
设置”，打开“设置”页签。
b.
在“设置”页签中选择“高级
>
隐私和安全性
>
网站设置
>
声音”。（浏览
器版本不同，“声音”选项的位置也会有所差异，用户需要根据实际路径进
行选择。）
c.
在“声音”区域中，单击“允许”右侧的“添加”按钮。
d.
在弹出的对话框中，输入“https://运维面的客户端登录IP地址:31943”，并
单击“添加”。
1

## Page 105

1.1.8.14
如何处理
Firefox
浏览器下载
ZIP
类型文件慢的问题
问题
使用Firefox浏览器，下载ZIP类型文件速度慢。
答案
使用Firefox浏览器时，如果开启了“拦截危险的下载项”功能，下载来自不受信任网
站（如网站无安全证书、网站的安全证书已过期或非权威机构签发等）的ZIP类型文
件，Firefox浏览器会做安全控制及检查，导致文件下载慢。
可以通过如下方式处理：
●
等待Firefox浏览器完成对下载文件的安全检查。
●
使用其他的浏览器访问并下载文件。
●
在Firefox的安全设置中取消“拦截危险的下载项”功能，下载文件后再将该功能
开启。
1.1.8.15
为什么当前告警无法自动清除
问题
为什么当前告警无法自动清除？
答案
有以下两种可能原因：
●
该告警的清除类型为ADMC。
–
ADAC表示告警可自动清除，故障修复后，系统会自动检测到，并会上报对应
的清除告警。
–
ADMC表示告警需要手动清除，故障修复后，系统不会上报清除告警。
手动清除告警操作步骤：
a.
在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。
b.
选中一条或多条告警，单击告警列表右上方的“清除”按钮。
●
由于网元和CloudSOP之间通信异常，导致CloudSOP没有接收到清除告警，需要
在故障修复后手工同步告警。
手工同步告警操作步骤：
a.
在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
b.
在左侧导航树中选择“告警同步”。
c.
在“告警同步”页面中选择需要同步的告警源。
d.
在“时间范围”中选择具体的时间段，表示只同步该段时间内的告警。
e.
单击“执行同步”开始同步告警。
1

## Page 106

1.1.8.16
为什么告警已上报但是查询不到对应告警
问题
为什么告警已上报但是查询不到对应告警？
答案
可能有以下几种原因：
●
设置了过滤条件或过滤模板，该告警被过滤掉了。
a.
在“当前告警”页面或“历史告警”页面的左上方单击“过滤”，设置过滤
条件。
b.
单击“确定”。
●
该告警可能已被屏蔽，用户可在“屏蔽规则”中查看已存在的规则是否屏蔽了该
告警。
a.
在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
b.
在左侧导航树中选择“屏蔽规则”。
c.
在规则列表中单击规则名称，查看屏蔽条件是否包含该告警。
●
数据库中的当前告警达到容量上限，触发告警满处理，该告警被转为历史告警，
用户可在“业务监控
>
告警监控
>
历史告警”中查看是否包含该告警。
1.2
资源池告警
1.2.1 FusionSphere OpenStack
告警参考
1.2.1.1 ALM-6008
上传日志到
OBS
服务失败
告警解释
OpenStack周期（默认为300秒）检查上一次上传日志至OBS服务是否成功，当检查到
上传失败时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
6008
重要 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
1

## Page 107

参数名称 参数含义
附加信息
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
对系统的影响
日志无法上传至OBS服务，如果未设置本地备份，则会导致该次日志丢失。
可能原因
●
主机与OBS服务网络连接异常。
●
Apacheproxy服务状态异常。
●
日志配置文件中OBS服务IP、端口未正确设置。
●
OBS服务上指定的日志上传空间已满。
前提条件
● 已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
1

## Page 108

(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
Apacheproxy服务状态异常
步骤8 执行如下操作查看apacheproxy服务是否正常。
1.
执行如下命令，采用安全方式操作。
cpssafe
显示如下信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
please choose:[1|2|3]
2.
输入“1”，选择使用keystone v3鉴权。
显示如下信息：
Input command:
3.
执行如下命令，查看apacheproxy服务是否正常。
cps template-instance-list --service apacheproxy apacheproxy
在apacheproxy主备部署的情况下，回显如下类似信息：
在apacheproxy单实例部署的情况下，回显如下类似信息：
●
如服务状态显示为fault，执行步骤9。
●
如未显示为fault，执行步骤12。
步骤9 执行如下操作停止apacheproxy服务。
1.
执行如下命令，采用安全方式操作。
cpssafe
显示如下信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
please choose:[1|2|3]
2.
输入“1”，选择使用keystone v3鉴权。
显示如下信息：
Input command:
1

## Page 109

3.
运行如下命令停止apacheproxy服务。
cps host-template-instance-operate --service apacheproxy apacheproxy --
action stop
回显如下类似信息：
查看操作结果是否为success。
●
是，执行步骤10。
●
否，执行步骤17。
步骤10 执行如下操作启动apacheproxy服务。
1.
执行如下命令，采用安全方式操作。
cpssafe
显示如下信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
please choose:[1|2|3]
2.
输入“1”，选择使用keystone v3鉴权。
显示如下信息：
Input command:
3.
执行如下命令启动apacheproxy服务。
cps host-template-instance-operate --service apacheproxy apacheproxy --
action start
回显如下类似信息：
查看操作结果是否为success。
●
是，执行步骤11。
●
否，执行步骤17。
步骤11 执行如下操作查看apacheproxy服务是否正常。
1.
执行如下命令，采用安全方式操作。
cpssafe
显示如下信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
please choose:[1|2|3]
1

## Page 110

2.
输入“1”，选择使用keystone v3鉴权。
显示如下信息：
Input command:
3.
执行如下命令查看apacheproxy服务是否正常。
cps template-instance-list --service apacheproxy apacheproxy
在apacheproxy主备部署的情况下，回显如下类似信息：
在apacheproxy单实例部署的情况下，回显如下类似信息：
●
如未显示fault，执行步骤12。
●
如仍显示为fault，执行步骤17。
日志配置文件中OBS服务IP、端口未正确设置
步骤12 执行以下命令，获取配置的OBS信息，确认OBS日志服务地址是否正确。
log policy-get
42174775-2DA8-B93F-CF47-47902E7AA2B0:~ # log policy-get
+-----------------------------+---------------------------------+
| Property | Value |
+-----------------------------+---------------------------------+
| policy_gateway | |
| policy_s3_access_key | 92514a3e0b5a4acbb532aba9638 |
| policy_s3_export_begin | 2 |
| policy_s3_export_end | 3 |
| policy_s3_host | s3.dc1.domainname.com:5443 |
| policy_s3_operate_bucket | |
| policy_s3_operate_lifecycle | 4 |
| policy_s3_region | |
| policy_s3_run_bucket | |
| policy_s3_run_lifecycle | 90 |
| policy_s3_scheme | |
| policy_s3_secret_key | 3d99c09e38614b31930e349ec638 |
+-----------------------------+---------------------------------+
●
是，请执行步骤14。
●
否，请执行步骤13。
步骤13 执行如下命令重新设置OBS服务地址(policy_s3_host)，AK(policy_s3_access_key)/
SK(policy_s3_secret_key)等信息。
1.
执行如下命令，采用安全方式操作。
cpssafe
显示如下信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
please choose:[1|2|3]
1

## Page 111

2.
输入“1”，选择使用keystone v3鉴权。
显示如下信息：
Input command:
3. 执行如下命令重新设置OBS服务地址(policy_s3_host)，
AK(policy_s3_access_key)/SK(policy_s3_secret_key)等信息。
log policy-set --parameter policy_s3_access_key=ACCESS_KEY
policy_s3_secret_key=SECRET_KEY policy_s3_host=S3_HOST
查看是否回显如下类似信息：
+----------------------+----------------------------------+
| Property | Value |
+----------------------+----------------------------------+
| policy_s3_access_key | 92514a3e0b5a4acbb532aba957a9d66f |
| policy_s3_host | s3.dc1.domainname.com:5443 |
| policy_s3_secret_key | 3d99c09e38614b31930e349ec63842a3 |
+----------------------+----------------------------------+
●
是，执行步骤14。
●
否，执行步骤17。
步骤14 执行如下操作手动触发日志上传。
1.
执行如下命令，采用安全方式操作。
cpssafe
显示如下信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
please choose:[1|2|3]
2.
输入“1”，选择使用keystone v3鉴权。
显示如下信息：
Input command:
3.
执行如下命令手动触发日志上传。
log log-flush --host
主机ID
步骤15 等待5分钟，执行如下操作查看各组件的日志上传状态。
1.
执行如下命令，采用安全方式操作。
cpssafe
显示如下信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
please choose:[1|2|3]
2.
输入“1”，选择使用keystone v3鉴权。
显示如下信息：
Input command:
3.
执行如下命令查看各组件的日志上传状态。
log log-state-get --host 主机ID
●
状态字段显示为上传时间，执行步骤16。
●
存在状态字段显示为“log flushing”，重新执行步骤15。
1

## Page 112

●
存在状态字段显示为“not
flushed
yet”，转步骤17。
步骤16 等待1分钟查看告警是否恢复。
● 是，处理完毕。
●
否，执行步骤17。
步骤17 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.2 ALM-6010 NTP
服务器与外部时钟源时间差超过阈值
告警解释
在配置外部时钟源之后，ntp-server（NTP服务器）会周期性（默认为2min）检查主
ntp-server所在节点与外部时钟源的时间差（如果存在多个外部时钟源，则逐一检
查），当任意一个时间差超过阈值时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
6010
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
Region：产生告警的region名。
●
Object：产生告警的服务。
附加信息
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
本端地址：NTP客户端ip。
●
对端地址：外部时钟源ip。
●
阈值：ntp-server和外部时钟源间可缓慢同步的最大时
差。
1

## Page 113

对系统的影响
如果本地主ntp-server所在节点与外部时钟源时间差超过阈值，则不与外部时钟源进行
时间同步。
可能原因
●
本地主ntp-server所在节点时间被修改。
●
外部时钟源时间发生跳变。
●
第一次跟外部时钟源对接时，用户没有触发强制同步操作。
●
配置了多个外部时钟源，ntp-server和某个外部时钟源时差超过阈值。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维”，进入“日常维护”。
步骤3 稍等2分钟，在“时间同步”标签下，提示由“系统时间状态查询中”变为“系统时间
异常”，如下图所示。请根据界面提示查看详情，获取上报告警主机所对应的时间
差。
步骤4 选择“配置”，进入“系统”。打开“NTP”标签，查看已配置的外部时钟源信息，
如下图所示。
步骤5 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
1

## Page 114

说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤7 执行以下命令，防止系统超时退出。
TMOUT=0
步骤8 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤9 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤10 执行如下命令，获取ntp-server部署情况，包含节点id信息，回显结果中runsonhost属
性的值。
cps template-instance-list --service ntp ntp-server
回显如下类似信息：
+------------+----------------+--------+------------+----------------+
| instanceid | componenttype | status |runsonhost |omip |
+------------+----------------+--------+------------+----------------+
| 1 | ntp-server | active | Mgmt1 |10.38.82.84 |
| 0 | ntp-server | standby| Mgmt3 |10.38.82.136 |
+------------+----------------+--------+------------+----------------+
说明
回显信息数目取决于ntp-server的部署方式，status显示active字段的即为主NTP Server所在的
节点。
步骤11 根据获取到的IP信息，登录主ntp-server部署所在节点，用户名与密码参照步骤5～步
骤6。
步骤12 执行以下命令，确认是否和每台服务器之间的系统时间差都小于阈值。
ntpdate -d
外部时钟源IP
42174775-2DA8-B93F-CF47-47902E7AA2B0:~ # ntpdate -d 192.168.35.202
24 Jul 19:11:52 ntpdate[5469]: ntpdate 4.2.6p5@1.2349-o Thu Dec 20 00:00:00 UTC 2018 (1)
1

## Page 115

Looking for host 192.168.35.202 and service ntp
host found : 192.168.35.202
transmit(192.168.35.202)
receive(192.168.35.202)
transmit(192.168.35.202)
receive(192.168.35.202)
transmit(192.168.35.202)
receive(192.168.35.202)
transmit(192.168.35.202)
receive(192.168.35.202)
server 192.168.35.202, port 123
stratum 11, precision -24, leap 00, trust 000
refid [192.168.35.202], delay 0.02592, dispersion 0.00005
transmitted 4, in filter 4
reference time: e0e2bb54.e30f606d Wed, Jul 24 2019 19:11:16.886
originate timestamp: e0e2bb7f.e6f1a121 Wed, Jul 24 2019 19:11:59.902
transmit timestamp: e0e2bb7f.0a6cb785 Wed, Jul 24 2019 19:11:59.040
filter delay: 0.02679 0.02612 0.02629 0.02592
0.00000 0.00000 0.00000 0.00000
filter offset: 0.861150 0.860937 0.860968 0.861003
0.000000 0.000000 0.000000 0.000000
delay 0.02592, dispersion 0.00005
offset 0.861003
24 Jul 19:11:59 ntpdate[5469]: step time server 192.168.35.202 offset 0.861003 sec
●
是，请联系技术支持工程师协助解决。
●
否，执行步骤13。
步骤13 检查是否存在不准确的时钟源。
●
是，移除不准确的外部时钟源服务器配置，并执行步骤14。
●
否，请联系技术支持工程师协助解决。
步骤14 再次执行步骤3，查看提示是否由“系统时间状态查询中”变为“当前系统时间正
常”，如图所示。
●
是，执行步骤15。
●
否，请联系技术支持工程师协助解决。
步骤15 等待5分钟～10分钟，查看告警是否清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 116

1.2.1.3 ALM-6014 DNS
服务器连接中断
告警解释
OpenStack周期（默认为1分钟）采集DNS Server对外连接状态，当连接中断时产生此
告警。
告警属性
告警ID 告警级别 可自动清除
6014
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务名称
附加信息
●
区域名：产生告警的域名
●
对端地址：产生告警的DNS服务器的IP地址
对系统的影响
如果DNS Server对外连接中断，就无法访问外部的域名服务器，导致跨AZ的域名解析
失败。
可能原因
●
网络故障。
●
外部域名服务器故障。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
1

## Page 117

说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤5 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤6 执行如下操作获取外部域名服务器地址。
cps template-params-show --service dns dns-server
返回结果：
+----------+------------------------------------------+
| Property | Value |
+----------+------------------------------------------+
| address | /az1.dc1.domainname.com/192.168.211.10 |
| network | [{"ip": "192.168.211.222", "systeminterf |
| | ace": "external_om", "mask": "24", "gat |
| | eway": "192.168.211.1"}] |
| server | /#/192.168.222.230#53@external_om |
+----------+------------------------------------------+
返回结果中的192.168.222.230就是外部域名服务器对应的ip地址。
步骤7 执行如下命令，检查与外部域名服务器之间的网络是否正常。
ping
外部域名服务器地址
●
能够ping通，执行8。
●
不能ping通，执行步骤10。
步骤8 检查使用外部DNS服务器是否使用bind套件实现。
1

## Page 118

●
是，执行步骤9。
●
否，执行步骤11。
步骤9 在zone配置文件中，增加“com”域配置。
例如：
zone "com" in
{
type master;
file "named.empty";
};
处理完毕。
步骤10 联系网络管理员排查网络故障。网络故障消除后，检查告警是否恢复。
●
是，执行结束。
●
否，执行步骤11。
步骤11 联系第三方DNS服务器管理人员，确认DNS是否存在故障。
●
是，执行步骤12。
●
否，执行步骤12。
步骤12 联系第三方DNS服务器管理人员消除第三方DNS服务器故障。DNS故障消除后，检查
告警是否恢复。
●
是，执行结束。
● 否，执行步骤13。
步骤13 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
如果恢复第三方DNS服务器之后，由于DNS缓存，导致FusionSphere OpenStack系统
DNS解析功能未恢复，请参考3.10 如何清理DNS缓存章节清理FusionSphere
OpenStack系统中的DNS缓存。
1.2.1.4 ALM-6015 NTP
服务器与外部时钟源网络故障或外部时钟源故障
告警解释
在配置外部时钟源之后，ntp-server（NTP服务器）会周期性（默认为2min）检查主
ntp-server所在节点与外部时钟源的连接状态，当与所有外部时钟源出现网络故障或者
外部时钟源本身故障，且持续时间超过30分钟后，产生此告警。当任意一个外部时钟
源故障恢复或者网络故障恢复后，该告警消除。
1

## Page 119

告警属性
告警ID 告警级别 可自动清除
6015 重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
Region：产生告警的region名。
●
Object：产生告警的服务。
附加信息
●
主机ID：产生告警的主机ID。
● 主机名：产生告警的主机名。
●
本端地址：NTP客户端ip。
●
对端地址：外部时钟源ip。
对系统的影响
如果本地主ntp-server所在节点与外部时钟源网络故障或者外部时钟源故障，则不与外
部时钟源进行时间同步。
可能原因
●
本地ntp与外部时钟源连接网络故障。
●
外部时钟源未启动或者故障。
●
外部时钟源所在机器防火墙不允许ntpd访问。
●
配置外部时钟源时，外部时钟源和所选的网络平面不在同一网段下，且未配置
NTP网关。
说明
如果ManageOne运维面上，存在多个此告警，且资源标识相同，但对象类型不一致，需要将对
象类型为host的告警手动清除。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
1

## Page 120

步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“组件”页签的组件列表中，“全部服务”选择“ntp”，“全部组件”选择“ntp-
server”。单击“搜索”，记录“组件状态”为“active”的主机ID。
步骤4 在“概要”界面，根据获取到的“active”的主机ID，在“管理IP地址”一栏获得
“active”的主机的管理IP地址。
步骤5 选择“配置 > 系统 > NTP”，进入NTP配置页面。在“网络平面”一栏获取“外出网
口”信息，在“外部NTP（IP/域名）”获取“外部时钟源”信息。
说明
外部时钟源可能配置了多个，请全部记录。
步骤6 判断“NTP网关”和“外部NTP（IP/域名）”是否在同一网段下。
●
是，执行步骤9。
●
否，执行步骤7。
步骤7 重新配置“NTP网关”、“NTP客户端IP”和“NTP子网掩码”，并单击“提交”。
步骤8 等待5分钟～10分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤9。
步骤9 使用PuTTY，通过步骤4中获取到的IP地址，登录主ntp-server部署所在节点。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤10 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤11 执行以下命令，防止系统超时退出。
TMOUT=0
步骤12 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
1

## Page 121

步骤13 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤14 执行以下命令，根据步骤5中获取的信息，确定主ntp-server节点与外部时钟源之间网
络是否畅通。
ping
外部时钟源
-I
外出网口
●
是，执行步骤15。
●
否，请先排查并修复网络问题，网络问题修复后，等待5-10分钟，查看该告警是
否清除，清除则处理完成，未清除请执行步骤15继续排查。
说明
如果存在多个外部时钟源，则对这些时钟源依次确认，必须保证至少一个时钟源畅通。
IPV4场景使用ping，IPV6场景使用ping6。
步骤15 登录外部时钟源，执行命令service
ntpd
status，查看外部时钟源是否正常。
●
是，状态为“Active:
active
(running)”，执行步骤16。
●
否，状态为“Active:
inactive
(dead)”，执行命令service
ntpd
start启动外部
ntpd服务器，修复外部时钟源故障或设置其它外部时钟源，执行步骤17。
说明
命令service
ntpd
status仅适用于排查linux系统的外部时钟源，其它服务器类型需要根据
服务器自身使用说明书，确保外部时钟源正常。
步骤16 查看防火墙是否允许ntpd及ntpdate端口访问。
●
是，执行步骤17。
●
否，修改防火墙配置，执行步骤17。
说明
ntpd使用的端口是123，ntpdate使用的端口是124。
步骤17 切换回主ntp-server部署所在节点，执行以下命令，检测外部时钟源是否可用。
ntpdate -d
外部时钟源ip
42174775-2DA8-B93F-CF47-47902E7AA2B0:~ # ntpdate -d 172.28.15.127
16 Jul 15:41:04 ntpdate[11708]: ntpdate 4.2.6p5@1.2349-o Thu Dec 20 00:00:00 UTC 2018 (1)
Looking for host 172.28.15.127 and service ntp
host found : 172.28.15.127
transmit(172.28.15.127)
receive(172.28.15.127)
transmit(172.28.15.127)
receive(172.28.15.127)
transmit(172.28.15.127)
receive(172.28.15.127)
transmit(172.28.15.127)
receive(172.28.15.127)
server 172.28.15.127, port 123
stratum 11, precision -24, leap 00, trust 000
refid [172.28.15.127], delay 0.02600, dispersion 0.00008
transmitted 4, in filter 4
reference time: e0d80014.4e9ed783 Tue, Jul 16 2019 15:49:40.307
originate timestamp: e0d80021.d92d4d44 Tue, Jul 16 2019 15:49:53.848
transmit timestamp: e0d7fe16.32e552fc Tue, Jul 16 2019 15:41:10.198
1

## Page 122

filter delay: 0.02612 0.02635 0.02600 0.02661
0.00000 0.00000 0.00000 0.00000
filter offset: 523.6492 523.6490 523.6492 523.6489
0.000000 0.000000 0.000000 0.000000
delay 0.02600, dispersion 0.00008
offset 523.649214
16 Jul 15:41:10 ntpdate[11708]: step time server 172.28.15.127 offset 523.649214 sec
说明
回显信息中最后一行有类似“step
time server 172.28.15.127 offset 523.649214
sec”信息，
即offset后有具体时差，则外部时钟源可用。
●
是，执行步骤18。
●
否，执行步骤22。
步骤18 执行以下命令，检查外部时钟源是否支持V3版本。
ntpdate -o 3 -d
外部时钟源ip
●
是，执行步骤20。
●
否，执行步骤19。
说明
回显信息中最后一行有类似“step
time server 172.28.15.127 offset 523.649214
sec”信息，
即offset后有具体时差，则外部时钟源支持V3版本。
步骤19 执行以下命令，更改ntp-server配置项。等待1~2分钟后，执行步骤20。
cps template-params-update --service ntp ntp-server --parameter
ntp_protocol_version=4
cps commit
步骤20 执行以下命令，检测外部时钟源是否对接正常。
● IPV4
环境执行：ntpq
-4p
–
是，执行步骤21。
–
否，执行步骤22。
●
IPV6环境执行：ntpq
-6p
–
是，执行步骤21。
–
否，执行步骤22。
说明
以IPV4环境为例，回显信息中外部时钟源IP前有“*”则表示对接成功。
42174775-2DA8-B93F-CF47-47902E7AA2B0:~ # ntpq -4p
remote refid st t when poll reach delay offset jitter
==============================================================================
LOCAL(0) .LOCL. 5 l 8 16 3 0.000 0.000 0.000
*10.12.53.250 LOCAL(0) 11 u 7 16 3 0.620 15392.4 0.098
步骤21 等待5分钟～10分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤22。
步骤22 收集信息，并联系技术支持工程师协助解决。
1

## Page 123

说明
收集信息的方式如下：
1.
在ManageOne运维面，选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”界
面。
2.
查找此告警，并展开此告警信息，单击“告警帮助”选项卡，再单击“告警帮助辅助处理工
具”的链接，进入链接后收集信息。
收集信息时，参考如下说明，配置参数信息：
– csn：自动获取流水号。
– password：输入dc_admin密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
–
start_time和end_time：非必选参数，如果不填写或者填写的时间区间小于1小时，则
默认收集最近1天的日志，如果填写的时间区间大于等于1小时，则按照填写的时间段
收集。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.5 ALM-6016
日志服务连接
OBS
失败
告警解释
OpenStack周期（默认为300秒）检查一次连接OBS日志服务是否成功，当检查到连接
失败时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
6016
重要 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
附加信息
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
1

## Page 124

对系统的影响
日志服务连接OBS失败，将导致上传日志至OBS服务失败。
可能原因
●
主机与OBS日志服务网络连接异常。
●
Apacheproxy服务状态异常。
●
日志配置文件中OBS服务IP、端口未正确设置。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
1

## Page 125

Apacheproxy服务状态异常
步骤8 执行如下操作查看ApacheProxy服务是否正常。
1.
执行如下命令，采用安全方式操作。
cpssafe
显示如下信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
please choose:[1|2|3]
2.
输入2，选择使用cps鉴权。
显示如下信息：
Input command:
3.
执行如下命令，查看ApacheProxy服务是否正常。
cps template-instance-list --service apacheproxy apacheproxy
在ApacheProxy主备部署的情况下，回显如下类似信息：
在ApacheProxy单实例部署的情况下，回显如下类似信息：
●
如服务状态显示为fault，转步骤9。
●
如未显示fault，则转步骤12。
步骤9 执行如下命令停止ApacheProxy服务。
cps host-template-instance-operate --service apacheproxy apacheproxy --
action stop
回显如下类似信息：
+-------------+--------------------------------------+---------+---------+
| template | runsonhost | action | result |
+-------------+--------------------------------------+---------+---------+
| apacheproxy | 14038F38-1DD2-11B2-8330-000000821800 | stop | success |
| apacheproxy | 13AED8EE-1DD2-11B2-9BCD-000000821800 | stop | success |
+-------------+--------------------------------------+---------+---------+
查看操作结果是否为success。
●
是，执行步骤10。
●
否，执行步骤15。
步骤10 执行如下命令启动ApacheProxy服务。
cps host-template-instance-operate --service apacheproxy apacheproxy --
action start
1

## Page 126

回显如下类似信息：
+-------------+--------------------------------------+---------+---------+
| template | runsonhost | action | result |
+-------------+--------------------------------------+---------+---------+
| apacheproxy | 14038F38-1DD2-11B2-8330-000000821800 | start | success |
| apacheproxy | 13AED8EE-1DD2-11B2-9BCD-000000821800 | start | success |
+-------------+--------------------------------------+---------+---------+
查看操作结果是否为success。
●
是，执行步骤11。
●
否，执行步骤15。
步骤11 执行如下操作查看ApacheProxy服务是否正常。
cps template-instance-list --service apacheproxy apacheproxy
在ApacheProxy主备部署的情况下，回显如下类似信息：
在ApacheProxy单实例部署的情况下，回显如下类似信息：
●
如未显示fault，执行步骤12。
●
如仍显示为fault，转步骤15。
日志配置文件中OBS服务IP、端口未正确设置
步骤12 执行以下命令，获取配置的OBS信息，确认OBS日志服务地址是否正确。
log policy-get
42174775-2DA8-B93F-CF47-47902E7AA2B0:~ # log policy-get
+-----------------------------+---------------------------------+
| Property | Value |
+-----------------------------+---------------------------------+
| policy_gateway | |
| policy_s3_access_key | 92514a3e0b5a4acbb532aba9638 |
| policy_s3_export_begin | 2 |
| policy_s3_export_end | 3 |
| policy_s3_host | s3.dc1.domainname.com:5443 |
| policy_s3_operate_bucket | |
| policy_s3_operate_lifecycle | 4 |
| policy_s3_region | |
| policy_s3_run_bucket | |
| policy_s3_run_lifecycle | 90 |
| policy_s3_scheme | |
| policy_s3_secret_key | XXXXXX |
+-----------------------------+---------------------------------+
●
是，请执行步骤14。
●
否，请执行步骤13。
1

## Page 127

步骤13 执行如下操作重新设置OBS日志服务地址(policy_s3_host)。
log policy-set --parameter policy_s3_host=S3_HOST
查看是否回显如下类似信息：
+----------------+----------------------------+
| Property | Value |
+----------------+----------------------------+
| policy_s3_host | s3.dc1.domainname.com:5443 |
+----------------+----------------------------+
●
是，执行步骤14。
●
否，执行步骤15。
步骤14 等待5分钟看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤15。
步骤15 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.6 ALM-6017
主机状态异常
告警解释
OpenStack周期（默认为60s）检查所有的主机状态，如果存在状态不正常的主机，产
生此告警。
告警属性
告警ID 告警级别 可自动清除
6017 重要 删除主机场景需要手动清
除，其他场景可自动清除
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
1

## Page 128

参数名称 参数含义
附加信息
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
本端地址：告警发送节点的地址。
● 对端地址：产生告警的主机地址。
●
故障原因：产生故障的原因。
对系统的影响
该主机不能提供服务。
可能原因
●
硬件故障导致主机无法使用。
●
硬件设备掉电，导致写磁盘文件的IO丢失或者写错扇区。
●
主机磁盘损坏或RAID卡未配置电池。
●
网络规划错误出现异常PXE接入的主机。
●
cps-client进程进入D状态。
● 在Region Type I的分布式裸金属场景下，SDI节点所在裸金属服务器下电。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 确认当前主机状态是否正常。
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
在“概要”页面，查看告警附加信息中的“主机ID”对应的“状态”是否为“正
常”。
–
是，手动清除告警，处理完毕。
–
否，执行步骤2，排查下一个可能原因。
步骤2 确认当前系统部署的场景是否为Region
Type
I场景。
●
是，执行步骤3。
● 否，执行步骤5。
步骤3 检查告警节点是否为分布式裸金属场景的SDI节点。
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
1

## Page 129

2.
在“概要”页面，查看告警附加信息中的“主机ID”对应的“节点类型”是否为
“SDI节点的主机”。
–
是，获取状态异常主机节点的BMC IP地址，执行步骤4。
–
否，执行步骤5，排查下一个可能原因。
步骤4 排查SDI节点是否正常下电，导致主机状态异常。
1.
登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
2.
在Service OM界面，选择“服务列表
>
资源
>
裸金属资源
>
裸金属服务器”。
3.
在“裸金属服务器”页签右上角搜索栏，下拉选择搜索方式为“BMC IP地址”，
输入SDI节点BMC IP地址，单击搜索按钮，查看节点“电源状态”是否为“下
电”。
–
是，排查是否为如下几种情况。如果是，属于正常现象，请忽略或手动屏蔽
告警。否则，执行步骤5，排查下一个可能原因。
▪
裸金属服务器扩容后下电。
▪
裸金属服务器上下电，重启操作。
▪
裸金属服务器下发完成后，重启操作系统。
▪
裸金属服务器实例上下电、重启操作。
–
否，执行步骤5，排查下一个可能原因。
步骤5 检查是否其他环境主机连入此环境。
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
在“概要”页面，查看是否存在“误接入的主机”列表。
–
是，执行步骤6。
–
否，执行步骤7，排查下一个可能原因。
步骤6 删除误接入的主机，具体请参照2.4.1.2.7 AZ内误接入主机的处理方法。
手动清除告警，处理完毕。
步骤7 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“BMC IP地
址”一栏获得主机的BMC IP地址，查看BMC IP地址是否为空。
●
是，说明PXE主机失败，执行步骤24。
●
否，执行步骤8。
步骤8 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤9 在“服务列表
>
资源
>
裸金属资源
>
裸金属服务器”页面，检查是否存在裸金属服务
器BMC IP地址和主机BMC IP地址一致的情况。
●
是，登录FusionSphere OpenStack安装部署界面，在“概要”页面或“运维
>
扩
容”，选择该主机，单击“删除”。然后手动清除告警，处理完毕。
●
否，继续步骤10。
1

## Page 130

步骤10 检查主机网络是否故障。
1. 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
–
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
– External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP
参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，
在对应节点下该帐户的默认密码。
2.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
3.
执行以下命令，防止系统超时退出。
TMOUT=0
4.
执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
5.
输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号
的密码。
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
6.
执行以下命令，获取告警所在主机ID对应的manageip。
cps host-list
7.
执行以下命令，通过ping命令查看是能否和manageip互通。
ping manageip
回显如下：
65BA1CEB-573F-574C-B9F0-EE7F9AFC6ECE:~ # ping 172.28.0.8
PING 172.28.0.8 (172.28.0.8) 56(84) bytes of data.
From 172.28.0.2 icmp_seq=1 Destination Host Unreachable
From 172.28.0.2 icmp_seq=2 Destination Host Unreachable
From 172.28.0.2 icmp_seq=3 Destination Host Unreachable
From 172.28.0.2 icmp_seq=4 Destination Host Unreachable
From 172.28.0.2 icmp_seq=5 Destination Host Unreachable
From 172.28.0.2 icmp_seq=6 Destination Host Unreachable
From 172.28.0.2 icmp_seq=7 Destination Host Unreachable
From 172.28.0.2 icmp_seq=8 Destination Host Unreachable
^C
--- 172.28.0.8 ping statistics ---
9 packets transmitted, 0 received, +8 errors, 100% packet loss, time 8002ms
若如图所示表明ping不通manageip，请先恢复主机的网络连接。
恢复网络后查看告警是否恢复。
–
是，处理完毕。
1

## Page 131

–
否，执行步骤11。
步骤11 执行以下命令，检查cps-client组件进程状态是否进入D状态。
ps -aux|grep cpsclient.py |grep -v grep|awk '{print $8}'
若命令输出显示的状态为D或者D+，则说明cps-client进程进入D状态。
说明
进程进入D状态（不可中断睡眠状态）通常是在等待IO，比如磁盘IO，网络IO，内存不足，其他
外设IO等。
●
是，执行步骤12后，可跳过步骤13~步骤14，直接执行步骤15。
●
否，执行步骤12。
步骤12 登录BMC服务器界面，地址：https://BMC IP地址。单击“远程控制”，选择集成远
程控制台的方式后，进入远程虚拟控制台界面。
步骤13 查看主机操作系统是否进入了维护模式。
如图1-9所示，表示已经进入维护模式。
图1-9 维护模式
●
是，执行步骤14。
●
否，执行步骤15。
步骤14 输入root密码登录系统，对最后报错的分区（如图1-9中的分区/dev/mapper/cpsVG-
log）进行手动fsck修复操作。
假设待fsck修复的磁盘分区为/dev/sda5，其修复操作如下所示。
1. 使用umount命令将磁盘分区卸载掉。
命令示例如下：
umount /dev/sda5
2.
使用fsck命令对磁盘分区进行修复。
命令示例如下：
fsck /dev/sda5
命令示例回显如下所示，再次执行如上命令检查fsck修复的结果是否成功。
1

## Page 132

# fsck
/dev/sda5 fsck from util-linux 2.19.1 e2fsck 1.41.9 (22-Aug-2009)
/dev/sda5: recovering journal /dev/sda5 contains a file system with errors, check forced.
Pass 1: Checking inodes, blocks, and sizes
Pass 2: Checking directory structure Directory inode 8193, block 0, offset 24: directory corrupted
Salvage<y>? yes
Pass 3: Checking directory connectivity
Pass 4: Checking reference counts
Pass 5: Checking group summary information
/dev/sda5: ***** FILE SYSTEM WAS MODIFIED *****
/dev/sda5: 13/131072 files (0.0% non-contiguous), 17206/524112 blocks
# fsck
/dev/sda5 fsck from util-linux 2.19.1 e2fsck 1.41.9 (22-Aug-2009)
/dev/sda5: clean, 13/131072 files, 17206/524112 blocks
步骤15 在远程虚拟控制台界面上方，单击“电源控制
>
强制重启”按钮，重启故障主机。
主机是否可以正常启动。
●
是，执行步骤18。
● 否，执行步骤16。
步骤16 检查主机硬件是否故障，并参考《华为云Stack
8.1.0
运维指南》中“更换主机及配
件”相关章节处理。
检查主机硬盘是否故障，如果故障，请更换硬盘。检查主机其他硬件是否故障，如果
故障，请更换相应部件或直接更换整机。
排除主机硬件故障后，执行步骤17。
步骤17 在远程虚拟控制台界面上方，单击“电源控制
>
强制重启”按钮，重启故障主机。
主机是否可以正常启动。
●
是，执行步骤18。
●
否，执行步骤20。
步骤18 在远程虚拟控制台执行命令检测主机硬盘是否存在坏道。
badblocks -b block_size(Byte) -s disk
“block_size(Byte)”表示检测硬盘时分块的大小，单位为字节；“disk”表示硬盘的
设备名，可通过fdisk -l命令查看。
例如：
badblocks -b 4096 -s /dev/sda
●
是，请参考《华为云Stack
8.1.0
运维指南》中“更换主机及配件”相关章节，更
换硬盘，执行步骤19。
●
否，执行步骤19。
步骤19 等待故障主机启动后，再等待一分钟，查看告警是否恢复。
● 是，处理完毕。
●
否，执行步骤20。
步骤20 通过以下命令查看故障主机是否存在分区未挂载成功。
1.
登录故障主机。
a. 使用PuTTY，通过告警主机IP（即附加信息中的对端地址）登录故障主机。
默认帐号：fsp。
1

## Page 133

系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
b.
执行su
-
root命令切换到root用户。
2.
执行以下命令查看故障主机是否存在分区未挂载成功。
cps-env-check --mount-status
–
如果回显如下，则说明分区挂载成功，执行步骤24。
linux-XJgKSf:~ # cps-env-check --mount-status
=========== [BEGIN]check device mounting status ========================
Checking /dev/cpsVG/backup mount on /opt/backup success
Checking /dev/cpsVG/repo mount on /etc/huawei/fusionsphere/repo success
Checking /dev/cpsVG/zookeeper mount on /opt/fusionplatform/data/zookeeper success
Checking /dev/cpsVG/upgrade mount on /opt/fusionplatform/data/upgrade success
Checking /dev/cpsVG/ceilometer-data mount on /var/ceilometer success
Checking /dev/cpsVG/image-cache mount on /opt/HUAWEI/image_cache success
Checking /dev/cpsVG/swift mount on /opt/HUAWEI/swift success
Checking /dev/cpsVG/rabbitmq mount on /opt/fusionplatform/data/rabbitmq success
Checking /dev/cpsVG/database mount on /opt/fusionplatform/data/gaussdb_data success
Checking /dev/cpsVG/image mount on /opt/HUAWEI/image success
Checking /dev/mapper/cpsVG-bak_rootfs mount on /opt/HUAWEI/bak_rootfs success
=========== [END]check device mounting status ==========================
–
如果回显如下，则说明存在分区挂载失败，记录分区名和挂载目录，执行步
骤21。
linux-XJgKSf:~ # cps-env-check --mount-status
=========== [BEGIN]check device mounting status ========================
Checking /dev/cpsVG/backup mount on /opt/backup success
Checking /dev/cpsVG/repo mount on /etc/huawei/fusionsphere/repo success
Checking /dev/cpsVG/zookeeper mount on /opt/fusionplatform/data/zookeeper success
Checking /dev/cpsVG/upgrade mount on /opt/fusionplatform/data/upgrade success
Checking /dev/cpsVG/ceilometer-data mount on /var/ceilometer success
Checking /dev/cpsVG/image-cache mount on /opt/HUAWEI/image_cache success
Checking /dev/cpsVG/swift mount on /opt/HUAWEI/swift success
Checking /dev/cpsVG/rabbitmq mount on /opt/fusionplatform/data/rabbitmq success
Checking /dev/cpsVG/database mount on /opt/fusionplatform/data/gaussdb_data success
Checking /dev/cpsVG/image mount on /opt/HUAWEI/image success
Checking /dev/mapper/cpsVG-bak_rootfs mount on /opt/HUAWEI/bak_rootfs failed
=========== [END]check device mounting status ==========================
–
如果回显如下，则说明未返回任何分区挂载信息，执行步骤24。
linux-XJgKSf:~ # cps-env-check --mount-status
=========== [BEGIN]check device mounting status ========================
=========== [END]check device mounting status ==========================
步骤21 主机系统正在运行，分区无法挂载。执行命令手动挂载分区，确认是否会挂载失败。
其中xxx为分区名，/mnt为主机上的挂载目录。
mount xxx /mnt
●
是，如下回显，则表示分区文件系统已损坏，执行步骤22进行修复。
●
否，执行步骤23。
1

## Page 134

步骤22 执行命令修复文件系统。
1.
执行以下命令查询文件系统类型。
df -T
linux-XJgKSf:~ # df -T
Filesystem Type 1K-blocks Used Available Use% Mounted on
/dev/mapper/cpsVG-rootfs ext4 8191416 4159476 3596128 54% /
devtmpfs devtmpfs 65828552 0 65828552 0% /dev
tmpfs tmpfs 65837592 92 65837500 1% /dev/shm
tmpfs tmpfs 65837592 83800 65753792 1% /run
tmpfs tmpfs 65837592 0 65837592 0% /sys/fs/cgroup
/dev/mapper/cpsVG-data ext4 499656 6012 456948 2% /opt/fusionplatform/data
/dev/mapper/cpsVG-fsp ext4 999320 16516 913992 2% /home/fsp
/dev/sda1 ext4 480660 73043 378280 17% /boot
/dev/mapper/cpsVG-log ext4 20511312 279076 19167276 2% /var/log
回显如上所示，则表明示例分区使用ext4文件系统类型。
2.
执行以下命令修复文件系统。
fsck.ext4 xxx
xxx为无法挂载的分区。若分区使用ext4以外的其他文件系统类型，使用fsck的其
他文件系统修复命令，如ext3文件系统使用fsck.ext3。
–
如果自动修复成功，执行步骤23。
–
否则，执行步骤24。
步骤23 等待一分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤24。
步骤24 收集信息，并联系技术支持工程师协助解决。
说明
收集信息的方式如下：
1.
在ManageOne运维面，选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”界
面。
2.
查找此告警，并展开此告警信息，单击“告警帮助”选项卡，再单击“告警帮助辅助处理工
具”的链接，进入链接后收集信息。
收集信息时，参考如下说明，配置参数信息：
– csn：自动获取流水号。
– password：输入dc_admin密码。
– start_time和end_time：非必选参数，如果不填写或者填写的时间区间小于1小时，则
默认收集最近1天的日志，如果填写的时间区间大于等于1小时，则按照填写的时间段
收集。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 135

1.2.1.7 ALM-6018
主机
CPU
占用率超过阈值
告警解释
OpenStack周期（默认为300s）检测主机CPU占用率，当检测到主机CPU占用率大于
等于告警阈值时，系统产生此告警。
说明
系统默认告警阈值的偏移量为5%，且系统默认的告警阈值如下：
●
重要：主机CPU占用率≥90%
●
次要：80%≤主机CPU占用率＜90%
告警属性
告警ID 告警级别 可自动清除
6018
重要/次要 是
告警参数
参数名称 参数含义
定位信息 主机 ID：产生告警的主机ID。
附加信息
●
告警阈值：Minor：80%-90%，Major：>=90%，表示
告警阈值。
●
主机名：产生告警的主机名。
●
已使用：当前主机CPU占用率。
对系统的影响
可能会造成系统运行速度慢。
可能原因
主机业务繁忙负载过重。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
1

## Page 136

具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“节点类型”
列，查看当前主机节点类型是否为控制节点。
●
是，执行步骤5。
●
否，执行步骤3。
步骤3 迁移该主机上的虚拟机到其他主机，具体操作请参见《华为云Stack
8.1.0
运维指南》
中的“迁移虚拟机”。
如果无主机可迁移，执行步骤5。
步骤4 等待3分钟~4分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤5。
步骤5 收集信息，并联系技术支持工程师协助解决。
说明
收集信息的方式如下：
1. 在ManageOne运维面，选择“集中监控 > 告警管理 > 当前告警”，进入“当前告警”界
面。
2.
查找此告警，并展开此告警信息，单击“告警帮助”选项卡，再单击“告警帮助辅助处理工
具”的链接，进入链接后收集信息。
收集信息时，参考如下说明，配置参数信息：
–
csn：自动获取流水号。
–
password：输入dc_admin密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
–
start_time和end_time：非必选参数，如果不填写或者填写的时间区间小于1小时，则
默认收集最近1天的日志，如果填写的时间区间大于等于1小时，则按照填写的时间段
收集。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.8 ALM-6019
主机内存占用率超过阈值
告警解释
OpenStack周期（默认为300s）检测主机内存占用率，当检测到主机内存占用率大于
等于系统设置的告警阈值（默认为99%）时，系统产生此告警。
1

## Page 137

说明
支持自定义主机内存告警阈值，请在Service OM管理页面的告警设置中调整阈值。
告警属性
告警ID 告警级别 可自动清除
6019
次要 是
告警参数
参数名称 参数含义
定位信息 主机 ID：产生告警的主机ID。
附加信息
●
告警阈值：Minor：99%-100%，表示告警阈值。
●
主机名：产生告警的主机名。
●
内存总量：主机内存的大小。
●
已使用：当前主机内存占用率。
对系统的影响
可能会造成系统运行速度慢。
可能原因
主机业务繁忙负载过重。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“节点类型”
列，查看当前主机节点类型是否为控制节点。
●
是，执行步骤5。
●
否，执行3。
步骤3 迁移该主机上的虚拟机到其他主机。
具体操作请参见《华为云Stack
8.1.0
运维指南》中的“迁移虚拟机”。
如果无主机可迁移，执行步骤5。
步骤4 等待3分钟~4分钟，查看告警是否恢复。
●
是，处理完毕。
1

## Page 138

●
否，执行步骤5。
步骤5 收集信息，并联系技术支持工程师协助解决。
说明
收集信息的方式如下：
1.
在ManageOne运维面，选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”界
面。
2.
查找此告警，并展开此告警信息，单击“告警帮助”选项卡，再单击“告警帮助辅助处理工
具”的链接，进入链接后收集信息。
收集信息时，参考如下说明，配置参数信息：
–
csn：自动获取流水号。
–
password：输入dc_admin密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
–
start_time和end_time：非必选参数，如果不填写或者填写的时间区间小于1小时，则
默认收集最近1天的日志，如果填写的时间区间大于等于1小时，则按照填写的时间段
收集。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.9 ALM-6020
主机逻辑磁盘占用率超过阈值
告警解释
OpenStack周期（默认为300s）检测主机逻辑磁盘占用率，当检测到主机逻辑磁盘占
用率大于等于系统设置的告警阈值时，系统产生此告警。
说明
系统默认告警阈值的偏移量为5%，且系统默认的告警阈值如下：
●
紧急：主机逻辑磁盘占用率≥95%
●
重要：85%≤主机逻辑磁盘占用率＜95%
告警属性
告警ID 告警级别 可自动清除
6020
紧急/重要 是
1

## Page 139

告警参数
参数名称 参数含义
定位信息
●
主机 ID：产生告警的主机ID。
●
逻辑磁盘：告警主机上产生告警的逻辑磁盘名称。
附加信息
●
告警阈值：Major：85%-95%，Critical：>=95%，表示
告警阈值。
●
主机名：产生告警的主机名。
●
逻辑磁盘：产生告警的逻辑磁盘名称。
●
总容量：告警的逻辑磁盘的大小。
● 逻辑磁盘路径：告警的逻辑磁盘的挂载点。
●
已使用：当前告警逻辑磁盘使用率。
对系统的影响
可能会造成系统的性能下降，并且无法存储系统新产生的数据。
当根分区满时，系统业务将无法正常处理。
当swift分区满时，会造成注册镜像业务失败。
可能原因
主机逻辑磁盘上存储的文件占用空间过大。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2 使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
1

## Page 140

su - root
步骤5 进入告警磁盘所在目录，删除用户自己拷入的文件。
然后根据目录用途选择进一步处理方法。（各分区占用率可通过命令df -h查看。）
●
日志分区（“/var/log”）被占满，执行步骤6。
●
“/opt/HUAWEI/image”分区被占满，执行步骤9。
●
“/opt/HUAWEI/image_cache”被占满，执行步骤11。
●
“/opt/HUAWEI/swift”分区被占满，执行步骤13。
●
根分区（“/”）被占满，执行步骤14。
●
数据库分区“/opt/fusionplatform/data/gaussdb_data”，执行以下命令判断是
否是数据库主节点，其中“$HOSTNAME”是本节点的主机ID：
cps host-template-instance-list $HOSTNAME |grep gaussdb
如果有显示"active"，则表示是数据库主节点，执行步骤18。
●
其他分区，执行步骤17。
步骤6 执行cd /var/log命令切换到日志分区目录，然后执行以下命令查看大容量的日志文
件。
du -ah --max-depth=4|sort -rn|grep -v K |grep -v 0
该命令按照大小列出大于1MB的日志文件。
步骤7 通过以下两种方式（任选其一）清除查询到的大文件。
说明
如果需要提前备份待删除的日志文件，可将日志文件拷贝到“/home/fsp”目录，然后通过
WinSCP工具访问主机将日志文件拷贝到本地。
●
执行以下命令将日志文件的内容清空（日志文件不被删除）：
> /var/log/filepath
“filepath”为上一步列出的大于1MB的日志文件的文件路径，例如“./
fusionsphere/component/swift-proxy.log”。
使用该方法不会造成分区空间不能回收的现象，但是该命令只针对一条日志文
件，而不能删除某个组件的整个日志目录。
●
使用rm命令手动删除某目录下不再需要用于定位问题的转储日志文件。
但是可能造成空间无法回收的问题，需要通过以下方式处理：
如果删除后通过命令df -h查询发现日志空间仍未释放，需要手动查询并重启日志
对应的服务：
查询日志对应服务：lsof
| grep allfilepath
“allfilepath”为所删除的日志文件（或日志文件目录）的完整文件路径，例如
“/var/log/fusionsphere/component/swift-proxy.log”。
–
若有回显：
回显中第一个字段即为该日志对应的服务。
重启该主机上对应服务：service
service restart
–
若无回显，则无需处理。
步骤8 执行如下命令，重新加载日志服务。
service syslog reload
1

## Page 141

步骤9 在Service OM界面，查询本地盘虚拟机，并手动清除无用的本地盘虚拟机。
等待3分钟~4分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤10。
步骤10 在FusionSphere OpenStack安装部署界面的“配置
>
磁盘”页面，扩容image的分
区。
扩容成功后，执行步骤17。
步骤11 “/opt/HUAWEI/image_cache”被占满时，后续是否需要在当前节点上使用新镜像创
建卷或虚拟机。
●
是，执行步骤12。
●
否，当前告警不影响业务，处理完毕。
说明
已经被用来创建过卷或虚拟机的镜像，再次被用来创卷或创虚拟机时，当前告警不影响创建。
步骤12 在FusionSphere OpenStack安装部署界面的“配置
>
磁盘”页面，扩容image-cache
的分区。
扩容成功后，执行步骤17。
步骤13 通过以下两种方式，增加swift分区可用空间。
●
在Service OM界面，单击“资源
>
镜像资源
>
镜像列表”，选择不使用的镜像，
单击“删除”，释放swift空间。
●
参考《华为云Stack
8.1.0
扩容指南》中“扩容业务存储资源”章节，扩容swift的
分区。
扩容成功后，执行步骤17。
步骤14 执行df -h命令查看磁盘分区占用情况，判断“/home/fsp”是否独立挂载分区。
●
是，执行步骤19。
●
否，执行步骤15。
步骤15 执行cd /home/fsp命令切换目录，然后执行以下命令查看大容量文件。
du -ah --max-depth=4|sort -rn|grep -v K
该命令按照大小列出大于1MB的文件。
●
若存在大文件，执行步骤16。
●
若不存在，执行步骤19。
步骤16 使用rm命令手动删除上一步列出的路径下大于1MB的大文件。
说明
删除前需判断文件是否安全，以免误删文件。
执行df -h查询根分区占用率是否释放到85%以下。
●
是，执行步骤17。
●
否，执行步骤19。
1

## Page 142

步骤17 等待3分钟~4分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤19。
步骤18 执行以下命令检测keystone数据库中的token表是否过大，如果过大则会分批清理过期
token。
nohup python /etc/gaussdb/gaussdb/db_occupation_checker.py
$CLEAN_TOKENS &
其中“$CLEAN_TOKENS”是选择初始清理token的数量（输入范围10000-50000，推
荐初始输入20000）。
由于清理token可能耗时较长，该脚本在后台运行，可以在/var/log/fusionsphere/
component/db_occupation_checker/db_occupation_checker.log日志中查看清理任务
进展：
●
若打印"The
user having most tokens is
"，则提示申请token最多的keystone帐
户。
●
若打印"Start
to clean expired
tokens..."，则提示开始清理token。
●
等待打印"Vacuum
tokens
successfully..."，则表示清理过期token完成。
说明
清理token完成不能保证立即释放token所占用的磁盘空间，但不会影响新token的申请。
如果日志打印如下提示，请执行步骤19。
●
若打印"The
'base' directory is not one of the large files(dir) in gaussdb partition, please
contact technical staff to check other
files."，提示数据库表物理文件所在的目录（base）
不是磁盘占用最大的文件
●
若打印"The
largest file(base)'s size (kb) is more smaller than total partition size (kb),
please contact technical
staff."，提示数据库表物理文件所在的目录（base）小于整个分区
大小的70%
●
若打印"Keytone
database is not the largest database, please contact technical staff to
check the other
database:"，提示keystone不是磁盘占用最大的数据库
●
若打印"The
token table is not the largest table, please contact technical staff to check
the other
table"，提示keystone数据库中token表不是占用磁盘最大的数据库
步骤19 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.10 ALM-6021
主机网口状态异常
告警解释
Openstack周期检测主机被用户注册的物理网口和bond的状态，当检测到主机的网口
或bond异常时，系统产生此告警。
1

## Page 143

告警属性
告警ID 告警级别 可自动清除
6021
重要 是
告警参数
参数名称 参数含义
定位信息
●
主机：产生告警的主机ID
● 网口名： 产生告警的网卡名称
附加信息
●
主机ID：产生告警的主机ID
●
主机名：产生告警的主机名称
●
BMC_IP：产生告警的主机BMC IP地址
●
聚合模式：产生告警网卡的聚合模式
●
聚合名：产生告警网卡的聚合名称
对系统的影响
会影响该网口所在网络平面和外部通信的可靠性，可能导致该网口所在主机与其他相
连设备通信中断。
可能原因
●
主机某一个网口未被用户注册。
●
主机某一个网口被禁用。
●
网线松动或损坏。
●
主机某一个网口或者网卡故障。
●
主机某一个网口所连交换机端口故障。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 查看所有“物理网口”标签页是否都存在告警定位信息中的“网口名”。
1

## Page 144

1.
选择“配置”，进入“网络”，单击“网口映射配置”。
检查“物理网口”标签页是否存在告警定位信息中的“网口名”，如下图所示。
– 是，执行步骤2.2。
– 否，执行步骤3。
2. 选择“配置”，进入“OpenStack”，单击“Cinder”，单击“配置存储网络平
面”。
检查“物理网口”标签页是否存在告警定位信息中的“网口名”，如下图所示。
–
是，执行步骤2.3。
–
否，执行步骤3。
3.
选择“配置”，进入“OpenStack”，单击“Neutron”，单击“配置Tunnel
Bearing网络平面”。
检查“物理网口”标签页是否存在告警定位信息中的“网口名”，如下图所示。
1

## Page 145

–
是，手动清除告警，处理完毕。
–
否，执行步骤3。
步骤3 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤4 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤5 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤6 执行命令cat
/usr/bin/ports_info |python -m
json.tool，查看告警定位信息中网口
名的相关信息。
1.
查看回显中bond_info信息，确认告警网口是否组了bond。
–
是，执行步骤6.2，获取bond名对应的mappingtype。如下回显中nic0 和nic1
组了bond，bond名为trunk0。
–
否，执行步骤6.2，获取网卡名对应的mappingtype。
"bond_info": [
{
"bond_mode": "nobond",
"name": "trunk0",
"slaves": [
"nic0",
"nic1"
]
}
]
2.
查看回显中ovs信息，确认网口或者bond所属的mappingtype。
–
mapping类型为ovs，或者mapping类型为hardware-veb且"pf_tag":
"false"
，执行步骤6.3。
–
其他类型，执行步骤9。
"ovs": [
{
"interface": "trunk0",
"mappingtype": "ovs",
1

## Page 146

"name": "physnet1",
"om_vlan": ""
},
{
"interface": "nic2",
"mappingtype": "ovs",
"name": "evs_net",
"om_vlan": ""
},
{
"interface": "nic3",
"mappingtype": "hardware-veb",
"mtu": "1800",
"name": "physnet2",
"om_vlan": "1598",
"pf_tag": "false",
"promisc": "false",
"reserve_vf": "false",
"trusted": "true",
"vf_num": "61"
}
]
3.
查看回显中Logic-phyMapInfo信息，确认网口名对应的故障网口。
"Logic-phyMapInfo": {
"nic0": "eth0",
"nic1": "eth1",
"nic2": "eth2",
"nic3": "eth3",
"nic4": "eth4",
"nic5": "eth5",
"nic6": "eth6",
"nic7": "eth7"
},
步骤7 执行ifconfig eth*（其中，eth*为故障网口，比如eth0），查看网口是否被禁用（查看
回显信息中是否有“UP”字段，有则表明没有被禁用）。
●
是，执行步骤8。
●
否，执行步骤9。
步骤8 执行ifconfig
eth*
up命令，使得网口启动，等待1分钟~2分钟，看告警是否恢复。
● 是，处理完毕。
●
否，执行步骤9。
步骤9 查看网线是否松动或损坏。
●
是，更换网线，执行步骤10。
●
否，执行步骤11。
步骤10 等待1分钟~2分钟，看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤11。
步骤11 参考《华为云Stack
8.1.0
运维指南》中“更换主机及配件”相关章节，更换对应的网
卡，等待1分钟~2分钟，看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤12。
步骤12 收集信息，并联系技术支持工程师协助解决。
1

## Page 147

说明
收集信息的方式如下：
1.
在ManageOne运维面，选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”界
面。
2.
查找此告警，并展开此告警信息，单击“告警帮助”选项卡，再单击“告警帮助辅助处理工
具”的链接，进入链接后收集信息。
收集信息时，参考如下说明，配置参数信息：
–
csn：自动获取流水号。
–
password：输入dc_admin密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
–
start_time和end_time：非必选参数，如果不填写或者填写的时间区间小于1小时，则
默认收集最近1天的日志，如果填写的时间区间大于等于1小时，则按照填写的时间段
收集。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.11 ALM-6022
主机与
NTP
服务器心跳状态异常
告警解释
ntp-client会周期性（默认为2min）检查本节点与主ntp-server所在节点的连接状态，
当节点间出现网络故障或者主ntp-server出现故障时，且持续时间超过30分钟后，产生
此告警。当节点间网络故障修复或者主ntp-server故障修复时，该告警消除。
告警属性
告警ID 告警级别 可自动清除
6022
重要 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
1

## Page 148

参数名称 参数含义
附加信息
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
本端地址：主机管理ip。
● 对端地址：ntp-server浮动ip。
对系统的影响
●
如果ntp-client与主ntp-server所在节点网络故障或者主ntp-server故障时，则该
ntp-client所在节点不与内部主ntp-server进行时间同步。
●
可能导致合法的token未超过有效期不可用或超过有效期却可用。
● 可能导致时间不同步节点服务不可用。
●
可能导致系统数据采样不正确。
●
可能导致数据丢失。
可能原因
●
主ntp-server浮动ip未配置或被删除。
●
主ntp-server进程故障。
●
内部网络故障。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
1

## Page 149

步骤4 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤5 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤6 执行以下操作，获取ntp-server部署情况。
cps template-instance-list --service ntp ntp-server
回显如下类似信息：
+------------+---------------+---------+--------------------------------------+---------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+---------------+
| 0 | ntp-server | active | 304BA4EF-98F8-8F94-E811-852B82CB59EF | 192.168.3.176 |
| 1 | ntp-server | standby | 6A7554E9-410C-61A7-E811-6D0CD8E2B1D4 | 192.168.3.118 |
+------------+---------------+---------+--------------------------------------+---------------+
说明
回显信息数目取决于ntp-server的部署方式，status显示active字段的即为主NTP Server所在的
节点。
步骤7 根据获取到的ip信息，登录主ntp-server部署所在节点，用户名与密码参照步骤1～步
骤2。
步骤8 在主ntp-server所在节点，执行以下命令。
ip addr show |grep brcps:ntp
回显如下类似信息：
inet 172.28.1.37/16 scope global secondary brcps:ntp-s
浮动ip是否配置。
●
是，执行步骤9。
●
否，执行步骤10。
步骤9 执行以下命令，查看主ntp-server进程状态。
ps -ef|grep ntp |grep -v grep
回显信息类似如下：
root 5832 1 0 Aug03 ? 00:00:27 /usr/bin/python /usr/local/bin/ntp-client/ntp_client/ntpclient.py -
s 172.31.9.37
root 22843 1 0 01:33 ? 00:00:00 /usr/sbin/ntpd -4 -c /usr/local/bin/ntp-server/conf/ntp.conf
cps 22851 1 0 01:33 ? 00:00:10 python /usr/local/bin/ntp-server/ntp_server/ntpserver.py
进程是否存在。
1

## Page 150

●
是，执行步骤13。
●
否，执行步骤10。
步骤10 执行如下命令，停止主ntp-server进程。
cps host-template-instance-operate --service ntp --action stop ntp-server --
host
NTP主机ID
回显类似信息如下：
+------------+--------------------------------------+---------+
| template | runsonhost | result |
+------------+--------------------------------------+---------+
| ntp-server | CCCC8175-8F78-0000-1000-1DD200005020 | success |
+------------+--------------------------------------+---------+
是否停止进程成功。
●
是，执行步骤11。
●
否，执行步骤13。
说明
NTP主机ID指的是主ntp-server节点id，即runsonhost的参数值。
步骤11 执行如下命令，启动主ntp-server进程。
cps host-template-instance-operate --service ntp --action start ntp-server --
host
NTP主机ID
回显类似信息如下：
+------------+--------------------------------------+---------+
| template | runsonhost | result |
+------------+--------------------------------------+---------+
| ntp-server | CCCC8175-8F78-0000-1000-1DD200005020 | success |
+------------+--------------------------------------+---------+
是否启动进程成功。
●
是，执行步骤12。
●
否，执行步骤13。
说明
NTP主机ID指的是主ntp-server节点id，即runsonhost的参数值。
步骤12 等待5分钟～10分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤13。
步骤13 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 151

参考信息
无。
1.2.1.12 ALM-6023
主机存储链路中断
告警解释
当OpenStack周期内（默认为5分钟）检测到主机和IPSAN之间有存储链路故障时，系
统产生此告警。
说明
本告警仅支持华为磁阵。
告警属性
告警ID 告警级别 可自动清除
6023
重要 是
告警参数
参数名称 参数含义
定位信息 主机ID：存储链路异常的主机ID
附加信息 主机ID：存储链路异常的主机ID
主机名：存储链路异常的主机名
异常ip：故障的存储链路IP
对系统的影响
当主机与IP SAN之间部分存储链路出现故障时，会对虚拟机业务的可靠性和性能产生
影响。主机与IP SAN之间的所有存储链路中断时，会导致该主机上的虚拟机业务中
断。
可能原因
主机和IP SAN之间网络通信故障。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
1

## Page 152

处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 在告警“附加信息”获取故障的存储链路IP，在主机上ping故障IP是否能通。
●
是，执行步骤6。
●
否，执行步骤5。
步骤5 联系环境管理人员检查并恢复网络。
步骤6 网络恢复之后，等待4～5分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤7。
步骤7 收集信息，并联系技术支持工程师协助解决。
说明
收集信息的方式如下：
1.
在ManageOne运维面，选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”界
面。
2.
查找此告警，并展开此告警信息，单击“告警帮助”选项卡，再单击“告警帮助辅助处理工
具”的链接，进入链接后收集信息。
收集信息时，参考如下说明，配置参数信息：
–
csn：自动获取流水号。
–
password：输入dc_admin密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
–
start_time和end_time：非必选参数，如果不填写或者填写的时间区间小于1小时，则
默认收集最近1天的日志，如果填写的时间区间大于等于1小时，则按照填写的时间段
收集。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 153

1.2.1.13 ALM-6024
存储资源管理链路中断或认证失败
告警解释
当OpenStack周期内（默认为5分钟）检测到主机和存储设备之间有管理链路故障时，
系统产生此告警。
OpenStack每两个周期（默认即为10分钟）进行一次存储管理用户名和密码验证，当
检测到后端存储用户名密码不正确时系统产生此告警。
说明
本告警仅支持华为磁阵。
告警属性
告警ID 告警级别 可自动清除
6024
重要 是
告警参数
参数名称 参数含义
定位信息
●
主机ID：存储链路异常的主机ID
●
对象：产生告警的具体对象
附加信息
●
主机ID：存储链路异常的主机ID
●
主机名：存储链路异常的主机名
对系统的影响
当存储资源的管理链路出现故障时，会引起涉及该存储资源的部分业务操作中断。当
存储资源的管理用户名和密码配置错误时，该存储资源将无法使用。当磁阵存储密码
过期时，会在迁移虚拟机时导致虚拟机故障且会造成业务中断。
可能原因
●
网络异常。
●
SAN故障。
●
存储管理用户名或密码配置错误。
●
磁阵会话数达到上限。
●
对接帐户被锁。
说明
当OpenStack使用同一帐户对接一套后端存储的多个存储池，若对接其中一个存储池时密
码错误的次数达到上限（默认3次），导致该帐户被锁，则使用此帐户对接的所有存储池都
会上报此告警。此时，仅需定位出现对接密码错误的存储池，并输入正确密码重新对接，
则相关告警会自动清除，具体方法请参见本告警处理步骤。
1

## Page 154

前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 根据告警的定位信息，选择对应的处理步骤。
●
如果定位信息中告警对象是设备管理IP，表示存储资源管理链路中断，请参考步
骤2处理。
●
如果定位信息中告警对象是后端存储名称，表示后端存储连接认证失败，排查一
下可能原因：
存储管理用户名或密码配置错误或密码过期，请参考步骤12处理。
● 如果定位信息未上报上述信息，可能是磁阵会话数达到上限，请参考步骤13处
理。
步骤2 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤3 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤4 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤5 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤6 执行以下命令，防止系统超时退出。
TMOUT=0
步骤7 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤8 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
1

## Page 155

步骤9 在告警“对象”字段中获取故障的存储资源管理IP，执行如下命令，检查故障存储资
源的管理IP能否ping通。
●
当故障存储资源的管理IP地址为IPv4地址时，命令如下：
ping
故障存储资源的管理IP
●
当故障存储资源的管理IP地址为IPv6地址时，命令如下：
ping6
故障存储资源的管理IP
说明
如果对接华为V3及以上系列存储，则需通过curl命令检查REST URL是否正常。
●
当故障存储资源的管理IP地址为IPv4地址时，命令如下：
curl -i -k
https://故障存储资源的管理IP地址:8088/deviceManager/rest
●
当故障存储资源的管理IP地址为IPv6地址时，命令如下：
curl -g -i -k
https://[故障存储资源的管理IP地址]:8088/deviceManager/rest
通过curl命令检查REST URL是否正常时，如果无返回信息，或者返回信息为http消息头，且错误
码为503/404之类，则代表到存储资源的链路不通。否则，返回html格式的信息，代表到存储资
源的链路正常。
●
是，执行步骤11。
●
否，执行步骤10。
步骤10 联系环境管理人员检查并恢复网络。网络恢复之后，等待4～5分钟，查看告警是否恢
复。
●
是，处理完毕。
●
否，执行步骤11。
步骤11 跟用户确认登录磁阵密码是否做过变更。
●
是，执行步骤12。
●
否，请联系技术支持工程师协助解决。
步骤12 请参照《华为云Stack
8.1.0
帐户一览表》“B类（FusionSphere OpenStack）”页签
的“附录”进行处理，等待4～5分钟，查看告警是否恢复。
●
是，结束操作。
●
否，则可能是SAN存储故障，请联系技术支持工程师协助解决。
步骤13 根据步骤9中获取故障的存储资源管理IP，使用PuTTY工具以admin帐户登录磁阵。
● 如果登录失败，并提示系统已达最大连接数拒绝连接，则可确认磁阵会话数已达
到上限，请联系技术支持工程师协助解决。
●
如果登录成功，执行如下操作。
a.
执行如下命令，查询当前系统最大连接数（默认为32）。
show user_session number
b.
执行如下命令，查询已经建立连接的用户。
change user_mode current_mode user_mode=developer
minisystem
om_show_omm_info.sh -q
c.
确认已经建立连接的用户数是否接近当前系统最大连接数，
▪
是，请与客户确认修改磁阵会话的最大连接数，可执行以下命令修改磁
阵的最大连接数为256。
1

## Page 156

change user_session number max_number=256
▪
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.14 ALM-6025
存储使用率超过阈值
告警解释
OpenStack周期（默认为5分钟）检测存储使用占用率，当检测到存储使用占用率大于
等于系统预设置的告警阈值时，系统产生此告警。
说明
●
系统默认告警阈值的偏移量为5%，且系统默认的告警阈值如下：
●
紧急：存储占用率≥95%
●
重要：90%≤存储占用率<95%
●
次要：85%≤存储占用率<90%
●
提示：80%≤存储占用率<85%
●
本告警仅针对FusionSphere OpenStack本身所使用的存储，只支持华为磁阵、华为分布式块
存储或vCenter中的存储是否上报阈值告警请关注各自管理软件。
告警属性
告警ID 告警级别 可自动清除
6025
紧急/重要/次要/提示 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务
●
域名：产生告警的后端存储所属Region
●
后端存储：产生告警的后端存储名称
1

## Page 157

参数名称 参数含义
附加信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
●
阈值：存储使用率阈值
● 已使用容量：产生告警的后端存储的容量使用率
●
域名：产生告警的后端存储所属Region
●
后端存储：产生告警的后端存储名称
对系统的影响
存储的使用率过高会影响存储的性能，当出现存储不足时，系统将无存储资源可用。
可能原因
存储资源使用过多，资源不足。
处理步骤
步骤1 通过告警定位信息，获取后端存储名称，对相应的存储池扩容。根据存储类型，分别
参考对应的文档进行扩容。
●
若是华为分布式块存储，请参考《FusionStorage
8.0.1
块存储扩缩容指导书》，
对存储池进行扩容。
●
若是华为SAN存储，请参考《华为云Stack
8.1.0
扩容指南》，对存储池进行扩
容。
步骤2 当存储的使用率低于80%时，告警是否恢复。
●
是，处理完成。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.15 ALM-6026
主机光纤通道中断
告警解释
OpenStack周期(默认300秒)检测本机的光纤通道的状态，如果光纤通道不通，则产生
告警。
1

## Page 158

告警属性
告警ID 告警级别 可自动清除
6026
重要 是
告警参数
参数名称 参数含义
定位信息 产生告警的主机ID。
附加信息
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
异常详情：故障信息。
对系统的影响
光纤通道出现故障时，会对存储业务的可靠性或功能产生影响。
可能原因
光纤松动或光纤网口故障。
处理步骤
步骤1 从告警信息中获取故障主机的ID信息。
步骤2 登录故障主机，切换到root帐户，检查FC光纤通道状态。
1.
进入“/sys/class/fc_host”目录，该目录下为host信息，每个host对应一个光口。
例如，主机有一块HBA卡，HBA卡存在两个光口，host目录下会有两个host分别
对应这两个光口。
2. 分别进入到hostX目录下，检查该hostX对应光口的WWN和状态信息。
1

## Page 159

port_name：文件记录的WWN。
port_state：端口状态。
Online：在线。
Offline:
离线。
说明
如果某个host的状态为“Offline”，可能的原因有该光口故障或未连接光纤等，可尝试重
新插拔光纤，更换光纤或者HBA卡。
3.
进入到该hostX的device目录，以“rport”字段起始命名的文件夹为本hostX识别
到的远端端口。
本例中主机光口“host6”识别到1个远端端口，即表示主机光口“host6”到远端
端口“rport-6:0-0”的一条路径。
4.
进入到该远端端口目录下的如下子目录，可查看该远端端口的详细信息。
1

## Page 160

说明
–
如果某个host的状态为“Offline”，可能的原因有该光口故障或未连接光纤等，可尝试
重新插拔光纤，更换光纤或者检查存储光口。
–
当roles类型为“FCP Target”时，代表该远端端口为存储端口，此链路即为一条存储链
路。如“FCP Target”类型的端口状态故障时，代表本条存储链路故障。
–
当roles类型不是“FCP Target”时，此远端端口非存储端口，此链路也不是存储链路。
当此类端口的状态异常时，不代表存储链路异常，对存储正常使用无影响。
步骤3 根据实验室主机对照表查询故障主机所在的机房。
步骤4 到机房查看故障主机的光纤是否松动或损坏。
●
是，插入或更换光纤，执行步骤5。
须知
插入或更换光纤时，请保证操作前后光纤口的对应位置和数量保持一致；如果光
纤口位置发生交换或减少了光纤口数量，执行步骤5之前，需要重启上报告警的主
机，否则告警无法自动清除。
●
否，执行步骤6。
步骤5 等待1分钟~2分钟，看告警是否恢复。
●
是，需要根据主机上虚拟机的实际状况，判断是否需要采取重启，防止误重启导
致业务短时中断。如需重启，进入Service OM界面，选择“服务列表
>
资源
>
计
算资源
>
虚拟机”，虚拟机所在行，选择“更多
>
强制重启”。重启成功，处理
完毕。
●
否，执行步骤6。
步骤6 联系运维人员，排查是否网络问题。
●
是，联系运维人员解决网络问题，执行步骤7。
●
否，执行步骤8。
步骤7 等待1分钟~2分钟，看告警是否恢复。
●
是，需要根据主机上虚拟机的实际状况，判断是否需要采取重启，防止误重启导
致业务短时中断。如需重启，进入Service OM界面，选择“服务列表
>
资源
>
计
1

## Page 161

算资源
>
虚拟机”，虚拟机所在行，选择“更多
>
强制重启”。重启成功，处理
完毕。
●
否，执行步骤8。
步骤8 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.16 ALM-6027
网口自协商速率没有达到服务器网口最大速率的一半
告警解释
OpenStack会60秒周期检测服务器的所有网口速率，对于任一支持自协商的网口，当
检测到其实际速率没有达到网口的最大速率一半时，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
6027
重要 是
告警参数
参数名称 参数含义
名称 告警的名称。
对象ID 产生告警对象的ID。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的ID，比如：主机ID。如果是业务模块产生的告
警，则表示的是业务模块的ID，比如：Openstack OM。
对象类型 产生告警的对象的类型，比如：host（代表主机），heart
beat（代表心跳检测系统）。
对象名称 产生告警的对象的名称。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的名称，比如：主机名。如果是业务模块产生的
告警，则表示的是业务模块的名称，比如：Openstack
OM。
部件类型 产生告警的部件的类型，比如：Openstack、Openstack
OM。
1

## Page 162

参数名称 参数含义
部件名称 产生告警的部件的名称。
定位信息 产生告警的对象的具体信息，一般用key=value,key=value
方式。比如：host=*****,portName=###，表示：****主机
上的###端口产生此告警。
附加信息 产生告警的一些扩展信息，一般用key=value,key=value方
式。比如：Threshold=70,current_value=75，标识产生告
警的原因是阈值为70，而当前值为75。
产生时间 告警产生的时间。
清除时间 告警清除的时间。
清除类型 告警清除的方式，告警清除的类型包括手工清除和自动清
除。
清除用户 手工清除告警的用户名称，自动清除告警时此参数为空。
清除用户ID 手工清除告警的用户ID，自动清除告警时此参数为空。
清除来源 手动清除告警时，清除告警的来源（租户侧视图或管理侧视
图）。
流水号 此条告警信息产生的顺序编号。
对系统的影响
会影响该网口所在网络平面和外部通信的可靠性，可能导致该网口所在服务器与其他
相连设备通信中断。
可能原因
●
该网口没有开启自协商开关。
●
对端网口没有开启自协商开关。
● 对端网口支持的网口速率规格较低。
●
和服务器某一个网口相连的网线松动。
● 和服务器某一个网口相连的网线损坏。
●
和某一个网口相连交换机的网线松动或损坏。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
1

## Page 163

具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用ssh命令登录故障主机。
su - fsp
ssh
fsp@主机External OM平面IP地址
按照提示输入系统私钥密码。如果已生成并替换了新的公私钥文件，请输入新私钥密
码。或者直接按“Enter”后按照提示输入fsp用户的密码登录。
登录后，还需要执行su
-
root命令切换到root用户。
步骤4 执行命令ethtool eth*，其中eth*为故障的网口，命令查询所在网口的自协商开关是否
打开。
●
关闭（即Auto-negotiation字段为“off”），执行步骤5。
●
打开（即Auto-negotiation字段为“on”），执行步骤7。
步骤5 执行命令ethtool
-s eth* autoneg
on，确认是否可以打开网卡的自协商开关（其中
eth*为故障的网口）。
●
是，执行步骤6。
●
否，命令执行报错，执行步骤18。
步骤6 等待1分钟~2分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤7。
步骤7 联系运维人员，查看对端网口是否开启自协商协议。
●
否，执行步骤8。
●
是，执行步骤9。
步骤8 联系运维人员，打开对端网口自协商开关，等待1分钟~2分钟，观察告警是否恢复。
● 是，处理完毕。
● 否，执行步骤9。
步骤9 执行命令ethtool eth*， 其中eth*为故障的网口，查询所在网口的"Supported
link
modes"，其中最大值就是该网口最大速率，单位Mb/s。联系运维人员，查看对端网口
速率规格是否小于该网口最大速率规格的一半。
●
是，执行步骤10。
●
否，执行步骤18。
步骤10 参考《华为云Stack
8.1.0
运维指南》中“更换主机及配件”相关章节，更换对端网
卡，使其网口速率大于或等于本端最大速率规格的一半，等待1分钟~2分钟，查看告警
是否恢复。
●
是，处理完毕。
●
否，执行步骤11。
步骤11 该网口的网线连接是否松动。
1

## Page 164

●
是，执行步骤12。
●
否，执行步骤13。
步骤12 重新拔插网线，等待2分钟～3分钟，告警是否清除。
●
是，处理完毕。
●
否，执行步骤13。
步骤13 与该网口相连的交换机的网口指示灯是否正常。
指示灯亮或闪烁表示连接正常，灭表示网络连接异常。
●
是，执行步骤18。
●
否，执行步骤14。
步骤14 与该网口相连的交换机的网线连接是否松动。
●
是，执行步骤15。
●
否，执行步骤16。
步骤15 重新拔插网线，等待2分钟～3分钟，告警是否清除。
●
是，处理完毕。
●
否，执行步骤16。
步骤16 服务器和交换机相连的网线可能损坏，更换网线。等待2分钟～3分钟，告警是否清
除。
●
是，处理完毕。
●
否，执行步骤17。
步骤17 服务器网口或网卡可能故障，请联系硬件维护人员更换网卡。等待2分钟～3分钟，告
警是否清除。
●
是，处理完毕。
●
否，执行步骤18。
步骤18 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.17 ALM-6028
本地
NTP
客户端与本地
NTP
服务器时间差超过
60
秒
告警解释
ntp-client（NTP客户端）会周期性（默认为2min）检查本节点与主ntp-server（NTP
服务器）所在节点的时间差，当时间差超过60s时，产生此告警。当时间差修复后，告
警消除。
1

## Page 165

告警属性
告警ID 告警级别 可自动清除
6028 重要 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
附加信息
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
本端地址：主机管理ip。
●
对端地址：ntp-server浮动ip。
对系统的影响
●
如果ntp-client所在节点与本地主ntp-server所在节点时间差超过60s，则不进行时
间同步。
●
可能导致合法的token未超过有效期不可用或超过有效期却可用。
●
可能导致时间不同步节点服务不可用。
●
可能导致系统数据采样不正确。
●
可能导致数据丢失。
可能原因
●
本地主ntp-server所在节点时间被修改。
●
ntp-client所在节点时间被修改。
●
备ntp-server所在节点与主ntp-server长期网络不通时间未同步，且ntp-client所在
节点与本地主ntp-server时间同步，此时触发主备倒换。
●
ntp-client所在节点与主ntp-server长期网络不通后恢复网络。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维”，进入“日常维护”。
说明
强制时间同步是高危操作，操作前请慎重考虑，操作时需先停止系统服务，然后进行时间同步，
同步成功后再重启业务，该动作建议在业务部署前或者业务稳态时执行，否则可能会严重影响业
务。该命令不支持远程使用。
1

## Page 166

步骤3 稍等2分钟，在“时间同步”标签下，提示由“系统时间状态查询中”变为“系统时间
异常”，如图所示。
步骤4 按提示，单击右侧红色图标 ，弹出提示窗，稍等2分钟,提示窗列出时钟异常单板。
步骤5 选择需要同步时间的单板，在提示窗中单击“同步修复”。
须知
●
强制时间同步过程中管理面会中断10-15分钟，导致业务发放失败。
●
选择多台节点进行同步，存在已有业务流量中断风险，建议依次对单台节点进行时
间同步操作，待单台主机时间同步成功，且主机上组件都是正常状态，继续同步下
一台节点。请按照如下方式判断组件是否正常：
依次单击“运维
>
组件维护
>
主机”，选择同步的主机，查看组件，确认不存在状
态为fault的组件。
●
请根据实际业务判断是否要执行该操作以及选择合适的同步方式。
说明
强制时间同步是高危操作，操作前请慎重考虑，该动作建议在业务部署前或者业务稳态时执行，
否则可能会严重影响业务。强制时间同步过程中会重启主机上除了ntp-server，ntp-client，dns-
server，cps-monitor，haproxy服务外的所有服务，因此该命令不支持远程登录使用。
成功对接外部时钟源且时间已同步一致之后，后续如果没有人为修改主ntp-server所在节点时
间，产生了此告警，需要排查外部时钟源时间跳变根因，时间强制同步只是规避手段。例如存在
多个外部时钟源，且外部时钟源间存在60s以上时差，则需要移除不准确的外部时钟源，单纯通
过强制时间同步无法消除告警。
步骤6 等待5分钟～10分钟，在“时间同步”标签下，提示变为“系统时间正常”，表示时间
同步成功。
1

## Page 167

若提示“同步时间异常”，表示主机强制时间同步异常。
按提示，单击右侧红色图标 ，弹出提示窗，稍等2分钟,提示窗列出同步时钟失败单
板。如图所示。
是否有主机强制时间同步异常。
●
是，参考1.2.3.1.1 如何处理强制时间同步失败进行处理。
●
否，执行步骤7。
步骤7 等待5分钟～10分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤8。
步骤8 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.18 ALM-6029
服务自动备份失败
告警解释
backup-server定时（默认每天凌晨3点）下发自动备份命令，如果某服务自动备份失
败，则上报该服务的备份组件失败告警。
1

## Page 168

告警属性
告警ID 告警级别 可自动清除
6029
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的服务。
附加信息 云服务：产生告警的云服务。
对系统的影响
系统无法完成备份，影响系统的可靠性。
可能原因
● 网络故障。
●
备份分区空间不足。
处理步骤
步骤1 登录FusionSphere OpenStack控制节点，具体请参见3.5 使用PuTTY登录
FusionSphere
OpenStack节点。
步骤2 执行以下命令，查看告警服务的备份结果。
backup progress-get --service all --detail
说明
命令中all可以替换为单独的服务，如cps。若命令为all，则显示所有服务的备份结果详情。
回显信息分为TOTAL部分和DETAIL部分。
备份结果从回显信息TOTAL部分的“result”列数据中获取。
TOTAL:
+---------+---------------------+---------------------+---------+----------+---------+
| service | start time | end time | result | progress | message |
+---------+---------------------+---------------------+---------+----------+---------+
| cbs | 2019-04-22 03:00:01 | 2019-04-22 03:00:23 | SUCCESS | 100% | |
| cps | 2019-04-22 03:00:01 | 2019-04-22 03:00:32 | SUCCESS | 100% | |
| gaussdb | 2019-04-22 03:00:01 | 2019-04-22 03:00:39 | SUCCESS | 100% | |
+---------+---------------------+---------------------+---------+----------+---------+
●
result为“DOING”，等待一段时间（如5分钟），重复执行该命令。
●
result为“SUCCESS”，告警将会自动恢复，处理完成。
●
result为“FAILED”，查看回显信息中“message”是否为“Upload
backup file
to third-party server
failed”。
1

## Page 169

–
是，说明备份包上传第三方服务器失败，需要排查第三方服务器连接是否正
常。排查故障后，执行步骤8。
– 否，执行步骤3。
步骤3 在备份结果的详细信息中，查看errorcode。
errorcode从回显信息DETAIL部分的“errorcode”列数据中获取。
DETAIL:
+---------+--------------------------------------+---------+----------+-----------+----------+
| service | id | result | progress | errorcode | errormsg |
+---------+--------------------------------------+---------+----------+-----------+----------+
| cbs | 564D82B5-14CD-7C60-6A1E-CAC910608867 | SUCCESS | 100% | 0 | |
| | 564D07D8-2D85-67F8-4B84-04E55FEEE592 | IGNORE | 100% | 0 | |
| cps | 564D49B9-5C36-9768-FA51-54102E5A6044 | SUCCESS | 100% | 0 | |
| | 564D82B5-14CD-7C60-6A1E-CAC910608867 | IGNORE | 100% | 0 | |
| | 564D07D8-2D85-67F8-4B84-04E55FEEE592 | IGNORE | 100% | 0 | |
| gaussdb | 564D49B9-5C36-9768-FA51-54102E5A6044 | SUCCESS | 100% | 0 | |
| | 564D07D8-2D85-67F8-4B84-04E55FEEE592 | IGNORE | 100% | 0 | |
+---------+--------------------------------------+---------+----------+-----------+----------+
●
errorcode为20007，执行步骤4。
●
errorcode为10004、10005、10006、20001、30002，执行步骤6。
●
errorcode为50002，查看service的取值。
–
如果service为gaussdb，执行步骤7。
–
如果service为其他组件，执行步骤9。
●
其他errorcode，执行步骤9。
步骤4 执行如下命令，获取备份分区目录（默认为/opt/backup/backupfile）下的无用备份
包。
ll /opt/backup/backupfile/service_name
说明
命令中service_name表示故障服务，如cps等，可从步骤3中“service”列获取。
步骤5 清理磁盘空间，执行如下命令，删除步骤4中获取的无用备份包。
backup package-delete --package package_name
删除完成后，执行步骤8。
步骤6 在备份结果的详细信息中查看备份失败的主机ID/虚拟机ID，登录到相应的主机/虚拟
机，排查网络故障。
排查完毕后，执行步骤8。
步骤7 执行如下命令，查看备份失败的节点的gaussdb组件状态是否为fault。
cps template-instance-list --service gaussdb gaussdb
●
是，请参考1.2.3.1.11 gaussdb组件故障处理章节处理。
处理结束后，且gaussdb组件状态恢复正常，执行步骤8。
●
否，执行步骤9。
步骤8 可选: 执行如下命令，手动对故障服务执行备份操作。
backup execute --service service_name
等待约30分钟，查看告警是否清除。
1

## Page 170

●
是，处理完成。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.19 ALM-6030 IP
冲突故障
告警解释
OpenStack周期（默认为60s）对所有主机上的ip进行检查，如果ip和其他节点存在冲
突的情况，则上报本host的IP故障告警。
告警属性
告警ID 告警级别 可自动清除
6030
重要 删除节点场景需要手动清
除，其他场景可自动清除
告警参数
参数名称 参数含义
定位信息 产生告警的主机ID。
附加信息
●
异常信息：
–
ip：冲突ip。
–
port：冲突端口。
–
mac：冲突mac。
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
对系统的影响
该ip涉及的服务不能正常工作。
1

## Page 171

可能原因
环境上存在多套控制节点。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 先检查是否其他环境主机连入此环境。
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
在“概要”页面，查看是否存在“误接入的主机”列表。
–
是，执行步骤2。
–
否，执行步骤3，排查下一个可能原因。
步骤2 删除误接入的主机，具体请参照2.4.1.2.7 AZ内误接入主机的处理方法章节。
手动清除告警，处理完毕。
步骤3 根据告警对象和附加信息找出存在ip冲突告警的所有主机hostid列表和冲突的ip。
●
记录下上报告警的多台host的hostid及冲突的ip，执行步骤4。
●
如果只有一台主机上报了ip冲突告警，请联系技术支持协助解决。
步骤4 在FusionSphere OpenStack安装部署界面的“概要”页面，根据告警附加信息中的
“主机ID”或“主机名”，在“管理IP地址”一栏获得主机的管理IP地址。
步骤5 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤7 执行以下命令，防止系统超时退出。
TMOUT=0
步骤8 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
1

## Page 172

步骤9 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤10 根据步骤4~步骤9，逐个ssh方式登录到上报告警的多个主机，根据IP地址类型，执行
对应的命令，查看当前环境上的所有冲突的IP信息。其中，$ipaddress为冲突的ip。
●
IPv4地址，请执行ip
addr show | grep 'inet '| grep '$ipaddress/'
●
IPv6地址，请执行ip
addr show |grep '$ipaddress' -C 5
举例如下：ip
addr show | grep 'inet '| grep '172.28.8.12/'
输出结果类似如下：
inet 172.28.8.12/20 scope global
secondary brcps:novcprox
步骤11 根据每台机器上查询出来冲突IP的对应网口名，判断是否属于此范围：brcps、
brcps:cps-s、brcps:zk-server、brcps:cbs-s。
●
是，执行步骤12。
●
否，请联系技术支持工程师协助解决。
步骤12 根据之前步骤的分析，对于存在冲突的主机，分析这个主机是否属于本AZ（根据用户
的规划排查是否属于本AZ，无法区分，请联系技术支持工程师协助解决）。
●
如果所有的主机都属于本AZ，则执行步骤13。
●
如果存在不属于本AZ的主机，则对该主机进行下电，如果是要扩容的主机请重新
pxe处理。
步骤13 登录到交换机后台，根据实际组网情况，执行命令display
mac-address | in
XXX，追
踪冲突mac来源。其中，XXX表示要过滤的关键字，一般使用mac地址过滤（如果不支
持该命令，具体命令需参考对应的交换机运维手册）。
是否通过该命令找到mac来源。
●
是，对该主机重新隔离vlan网络或删除冲突ip。
●
否，技术支持工程师协助解决。
举例如下：display
mac-address | in 9041
输出结果类似如下（mac地址48:57:02:cd:90:41变形成4857-02cd-9041）：
-------------------------------------------------------------------------------
MAC Address VLAN/VSI/BD Learned-From Type Age
-------------------------------------------------------------------------------
4857-02cd-9041 2622/-/- 10GE1/0/48 dynamic 340134
4857-02cd-9041 2623/-/- 10GE1/0/48 dynamic 107068
-------------------------------------------------------------------------------
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 173

1.2.1.20 ALM-6031
上传日志到
FTP
服务器失败
告警解释
OpenStack周期上传日志到FTP服务器，当上传失败时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
6031
重要 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
附加信息
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
对系统的影响
日志无法上传至FTP服务器，如果未设置本地备份，则会导致该次日志丢失。
可能原因
●
主机与FTP服务器网络连接异常。
●
Apacheproxy服务状态异常。
●
日志配置文件中FTP服务器IP、端口未正确设置。
●
没有权限上传FTP服务器。
●
FTP服务器上指定的日志上传空间已满。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
1

## Page 174

说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 导入环境变量，具体操作请参见3.1 导入环境变量，使用CPS鉴权方式。
Apacheproxy服务状态异常
步骤5 执行如下操作查看apacheproxy服务是否正常。
cps template-instance-list --service apacheproxy apacheproxy
回显如下类似信息：
+------------+---------------+---------+--------------------------------------+---------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+---------------+
| 0 | apacheproxy | active | 304BA4EF-98F8-8F94-E811-852B82CB59EF | 192.168.3.176 |
| 1 | apacheproxy | standby | 6A7554E9-410C-61A7-E811-6D0CD8E2B1D4 | 192.168.3.118 |
+------------+---------------+---------+--------------------------------------+---------------+
●
如有服务状态显示为fault，执行步骤6。
●
如服务状态显示为active和standby，执行步骤9。
步骤6 执行如下命令停止apacheproxy服务。
cps host-template-instance-operate --service apacheproxy apacheproxy --
action stop
回显如下类似信息：
+-------------+--------------------------------------+---------+
| template | runsonhost | result |
+-------------+--------------------------------------+---------+
| apacheproxy | D4B110B6-919D-0000-1000-1DD2000016E0 | success |
| apacheproxy | CCCC8175-8F6C-0000-1000-1DD200002250 | success |
+-------------+--------------------------------------+---------+
查看操作结果是否为success。
●
是，执行步骤7。
●
否，执行步骤13。
步骤7 执行如下命令启动apacheproxy服务。
cps host-template-instance-operate --service apacheproxy apacheproxy --
action start
在apacheproxy主备部署的情况下，回显如下类似信息：
1

## Page 175

+-------------+--------------------------------------+---------+
| template | runsonhost | result |
+-------------+--------------------------------------+---------+
| apacheproxy | D4B110B6-919D-0000-1000-1DD2000016E0 | success |
| apacheproxy | CCCC8175-8F6C-0000-1000-1DD200002250 | success |
+-------------+--------------------------------------+---------+
查看操作结果是否为success。
● 是，执行步骤8。
●
否，执行步骤13。
步骤8 执行如下命令查看apacheproxy服务是否正常。
cps template-instance-list --service apacheproxy apacheproxy
回显如下类似信息：
+------------+---------------+---------+--------------------------------------+---------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+---------------+
| 0 | apacheproxy | active | 304BA4EF-98F8-8F94-E811-852B82CB59EF | 192.168.3.176 |
| 1 | apacheproxy | standby | 6A7554E9-410C-61A7-E811-6D0CD8E2B1D4 | 192.168.3.118 |
+------------+---------------+---------+--------------------------------------+---------------+
●
如显示没有服务fault，执行步骤9。
●
如仍有服务显示为fault，执行步骤13。
日志配置文件中FTP服务器IP、端口未正确设置
步骤9 执行如下命令查看FTP服务器配置信息。
log ftp-policy-get
查看是否回显如下类似信息：
+-------------------------+------------------------------------------------+
| Property | Value |
+-------------------------+------------------------------------------------+
| ftp_enable | True |
| ftp_ip | 10.137.17.38 |
| ftp_password | XXXXXX |
| ftp_path | root |
| ftp_port | 2121 |
| ftp_schema | FTPS |
| ftp_username | admin |
| policy_ftp_export_begin | 4 |
| policy_ftp_export_end | 5 |
+-------------------------+------------------------------------------------+
●
是，核对回显信息中的FTP服务器信息是否与实际使用的一致：
–
是，执行步骤11。
–
否，执行步骤10。
●
否，执行步骤13。
步骤10 执行如下命令重新设置FTP服务器地址(ftp_ip)，用户名(ftp_username)，端口
(ftp_port)等信息。
log ftp-policy-set --parameter ftp_ip=IP ftp_username=USERNAME
ftp_port=PORT
查看是否回显如下类似信息：
+--------------+--------------+
| Property | Value |
1

## Page 176

+--------------+--------------+
| ftp_ip | 10.137.17.38 |
| ftp_port | 2121 |
| ftp_username | admin |
+--------------+--------------+
●
是，执行步骤11。
●
否，执行步骤13。
没有权限上传FTP服务器/FTP服务器上指定的日志上传空间已满
步骤11 执行如下操作查看FTP服务器是否可用。
1.
查看对应的端口是否在FTP服务器上开启。
2.
检查使用的用户是否有足够的权限。
3.
检查FTP服务器对应路径下的空间是否足够。
步骤12 等待下次自动触发上传FTP，查看告警是否恢复。自动触发周期大约24小时。
●
是，处理完毕。
●
否，执行步骤13。
步骤13 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.21 ALM-6033 I
层服务
CPU
占用率超过阈值
告警解释
告警采集模块监测IaaS层服务的CPU使用率状态，如果检测到CPU占用率超过阈值，且
持续时长达到阈值，则系统产生此告警。
说明
系统默认告警阈值的偏移量为5%，且系统默认的告警阈值如下：
●
重要：I层CPU占用率≥90%
●
次要：80%≤I层CPU占用率＜90%
告警属性
告警ID 告警级别 可自动清除
6033
重要/次要 是
1

## Page 177

告警参数
参数名称 参数含义
定位信息 host：产生告警的主机ID。
附加信息
● 告警阈值：告警阈值信息
●
主机名：产生告警的主机名。
●
已使用：当前I层服务CPU占用率。
对系统的影响
此告警产生时，系统IaaS层服务的CPU占用率过高，可能会影响组件服务质量。
可能原因
●
资源隔离配置的IaaS层预留CPU核数较少。
●
存在人为启动的非OpenStack进程。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机名”，查看当前告警主机是控制节点
还是计算节点。
●
控制节点，执行步骤3。
●
计算节点，执行步骤4。
步骤3 选择“配置”，进入“资源隔离”，查看“资源组配置”中FusionSphere
OpenStack
隔离的vCPU个数的取值是否较少，标准取值如下表所示。
档位
FusionSphere
OpenStack隔离的
vCPU个数
FusionSphere OpenStack
隔离的内存(GB)
50PM, 500VM 14 53
100PM, 1000VM 18 78
200PM, 2000VM 24 135
500PM, 5000VM 30 135
1000PM, 10000VM 52 170
4000PM（2000KVM
+2000BMS）, 40000VM（及更
大档位）
52 170
1

## Page 178

●
是，适当增加取值，请等待界面提示生效后，执行步骤6。
说明
通常修改vcpu数值并提交后需要重启主机生效。
●
否，执行步骤5。
步骤4 选择“配置”，进入“资源隔离”，查看主机是否在资源组内。
●
是，执行步骤5。
●
否，手工分组将主机加入对应的分组，执行步骤6。
步骤5 检查BMC上是否有硬件告警。
●
是，参考《华为云Stack
8.1.0
运维指南》中“管理节点”章节， 根据告警类型
进行处理，执行步骤6。
●
否，执行步骤7。
步骤6 等待10分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤7。
步骤7 收集信息，并联系技术支持工程师协助解决。
说明
收集信息的方式如下：
1.
在ManageOne运维面，选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”界
面。
2.
查找此告警，并展开此告警信息，单击“告警帮助”选项卡，再单击“告警帮助辅助处理工
具”的链接，进入链接后收集信息。
收集信息时，参考如下说明，配置参数信息：
–
csn：自动获取流水号。
–
password：输入dc_admin密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
–
start_time和end_time：非必选参数，如果不填写或者填写的时间区间小于1小时，则
默认收集最近1天的日志，如果填写的时间区间大于等于1小时，则按照填写的时间段
收集。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 179

1.2.1.22 ALM-6034 I
层服务内存占用率超过阈值
告警解释
告警采集模块监测IaaS层服务的内存使用率状态，如果检测到内存占用率超过阈值，
且持续时长达到阈值，则系统产生此告警。
说明
系统默认告警阈值的偏移量为5%，且系统默认的告警阈值如下：
●
重要：I层服务内存占用率≥90%
● 次要：80%≤I层服务内存占用率＜90%
告警属性
告警ID 告警级别 可自动清除
6034
重要/次要 是
告警参数
参数名称 参数含义
定位信息 host：产生告警的主机ID。
附加信息
●
告警阈值：告警阈值信息。
●
主机名：产生告警的主机名。
●
内存总量：当前I层服务内存的总大小。
●
已使用：当前I层服务内存占用率。
对系统的影响
此告警产生时，系统IaaS层服务的内存占用率过高，可能会影响组件服务质量。
可能原因
●
资源隔离配置中的IaaS层服务内存预留过小。
●
IaaS层服务的进程异常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机名”，查看当前告警主机是控制节点
还是计算节点。
1

## Page 180

●
计算节点，执行步骤3。
●
控制节点，执行步骤4。
步骤3 选择“配置”，进入“资源隔离”，查看主机是否在资源组内。
●
是，执行步骤5。
●
否，手工分组将主机加入对应的分组，执行步骤6。
步骤4 选择“配置”，进入“资源隔离”，查看“资源组配置”中“FusionSphere
OpenStack隔离的内存”的取值是否较少，标准取值如下表所示。
档位
FusionSphere
OpenStack隔离的
vCPU个数
FusionSphere OpenStack
隔离的内存(GB)
50PM, 500VM 14 53
100PM, 1000VM 18 78
200PM, 2000VM 24 135
500PM, 5000VM 30 135
1000PM, 10000VM 52 170
4000PM（2000KVM
+2000BMS）, 40000VM（及更
大档位）
52 170
●
是，适当增加取值，执行步骤6。
●
否，执行步骤5。
步骤5 检查BMC上是否有硬件告警。
●
是，参考《华为云Stack
8.1.0
运维指南》中“管理节点”章节， 根据告警类型
进行处理，执行步骤6。
●
否，执行步骤7。
步骤6 等待3~4分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤7。
步骤7 收集信息，并联系技术支持工程师协助解决。
1

## Page 181

说明
收集信息的方式如下：
1.
在ManageOne运维面，选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”界
面。
2.
查找此告警，并展开此告警信息，单击“告警帮助”选项卡，再单击“告警帮助辅助处理工
具”的链接，进入链接后收集信息。
收集信息时，参考如下说明，配置参数信息：
–
csn：自动获取流水号。
–
password：输入dc_admin密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
–
start_time和end_time：非必选参数，如果不填写或者填写的时间区间小于1小时，则
默认收集最近1天的日志，如果填写的时间区间大于等于1小时，则按照填写的时间段
收集。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.23 ALM-6038
主机磁盘占用率超过阈值
告警解释
OpenStack按300秒周期检测主机磁盘占用率（即主机的所有逻辑分区的使用量总和占
所有逻辑分区总量的百分比）。当检测到主机磁盘占用率大于等于系统设置的告警阈
值时，系统产生此告警。
说明
●
系统默认告警阈值的偏移量为5%，且系统默认的告警阈值如下：
●
紧急：主机磁盘占用率≥95%
●
重要：85%≤主机磁盘占用率＜95%
●
本告警与1.2.1.9
ALM-6020
主机逻辑磁盘占用率超过阈值告警的区别在于，ALM-6020针对
主机上的各个逻辑分区分别做检测，若单个逻辑分区的使用率达到设置的阈值，则上报告
警。而本告警针对所有逻辑分区的总量做检测，当主机的所有逻辑分区的使用量总和占所有
逻辑分区总量的百分比达到阈值时，才上报告警。
告警属性
告警ID 告警级别 可自动清除
6038
紧急/重要 是
1

## Page 182

告警参数
参数名称 参数含义
定位信息 host_id：产生告警的主机ID。
附加信息
●
告警阈值：Major：85~95%，Critical：>= 95%，表示
告警阈值。
●
主机名：产生告警的主机名。
●
已使用：当前磁盘占用率。
对系统的影响
●
可能会造成系统的性能下降，并且无法存储系统新产生的数据。
●
当某些分区（如根分区）满时，系统业务将无法正常处理。
可能原因
主机逻辑磁盘上存储的文件总量占用空间过大。
处理步骤
步骤1 在告警定位信息中获取主机ID。
步骤2 在告警界面查看该主机ID是否存在6020告警。
●
是，执行步骤3。
●
否，执行步骤5。
步骤3 参考1.2.1.9
ALM-6020
主机逻辑磁盘占用率超过阈值章节，清除6020告警。
步骤4 待6020告警清除完成后，等待4~5分钟，查看6038告警是否恢复。
●
是，处理完毕。
●
否，执行步骤5。
步骤5 收集信息，并联系技术支持工程师协助解决。
1

## Page 183

说明
收集信息的方式如下：
1.
在ManageOne运维面，选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”界
面。
2.
查找此告警，并展开此告警信息，单击“告警帮助”选项卡，再单击“告警帮助辅助处理工
具”的链接，进入链接后收集信息。
收集信息时，参考如下说明，配置参数信息：
–
csn：自动获取流水号。
–
password：输入dc_admin密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
–
start_time和end_time：非必选参数，如果不填写或者填写的时间区间小于1小时，则
默认收集最近1天的日志，如果填写的时间区间大于等于1小时，则按照填写的时间段
收集。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.24 ALM-6039
主机虚拟化域内存占用率超过阈值
告警解释
OpenStack按60秒周期检测主机内存占用率，当检测到主机内存占用率大于系统设置
的告警阈值时，系统产生此告警。
说明
●
系统默认告警阈值的偏移量为5%，且系统默认的告警阈值如下：
●
紧急：90%≤主机虚拟化域内存占用率
●
重要：80%≤主机虚拟化域内存占用率<90%
●
自定义主机内存告警阈值，请在Service OM界面的“告警设置”中调整阈值。
告警属性
告警ID 告警级别 可自动清除
6039
紧急/重要 是
1

## Page 184

告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID
附加信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
●
主机 ID：产生告警的主机ID
●
主机名：产生告警的主机名称
●
复用内存总量：主机的内存总量
●
复用内存已使用量：主机的内存使用量
●
阈值：主机的内存告警阈值
对系统的影响
造成已有虚拟机故障。
可能原因
●
主机虚拟化域内存占用率告警阈值的设置过低。
●
主机上虚拟机负载过重。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
– 默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 选择“集中监控
>
资源监控
>
云服务”。
在“云服务”页面，单击OpenStack云服务，例如“OpenStack_cn-global-22”。
步骤3 在对应的云服务页面，选择“监控视图
>
nova”,展开nova-compute微服务，例如
“nova-compute_cn-global-22”,单击对应的微服务实例。
步骤4 单击“查看详情”。
在弹出的“阈值告警配置详情”对话框中，单击“主机虚拟化域内存占用率告警”列
的修改，查看阈值条件设置是否过低。
●
是，执行步骤5。
1

## Page 185

●
否，执行步骤6。
步骤5 在“阈值配置”区域，配置阈值。
步骤6 等待3分钟～4分钟，告警是否清除。
●
是，处理完毕。
●
否，执行步骤7。
步骤7 迁移该主机上的虚拟机到其他主机，具体操作请参见《华为云Stack
8.1.0
运维指南》
中的“迁移虚拟机”。
如果无主机可迁移，执行步骤9。
步骤8 等待3分钟～4分钟，告警是否清除。
●
是，处理完毕。
● 否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.25 ALM-6040
主机虚拟化域
CPU
占用率超过阈值
告警解释
告警采集模块周期性（默认5分钟）监测主机虚拟化域CPU（主机上扣除I层资源占用后
给虚拟机使用的CPU）的使用率状态，如果检测到CPU占用率超过阈值，且持续时长
超过十分钟，则系统产生此告警。
说明
系统默认告警阈值的偏移量为5%，且系统默认的告警阈值如下：
●
重要：主机虚拟化域CPU占用率≥90%
●
次要：80%≤主机虚拟化域CPU占用率＜90%
告警属性
告警ID 告警级别 可自动清除
6040
重要/次要 是
1

## Page 186

告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
附加信息
●
告警阈值：告警阈值信息。
● 主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
已使用：当前主机虚拟化域CPU占用率。
对系统的影响
主机虚拟化域的CPU占用率过高，可能会导致虚拟机卡顿。
可能原因
主机上发放的虚拟机过多，或主机上虚拟机CPU负载过重，导致主机虚拟化域整体
CPU占用率过高。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 选择“服务列表
>
资源
>
计算资源
>
主机”，进入主机列表页面。根据告警附加信息
中的主机ID进行搜索，找到对应的主机，进入主机详情页面。
步骤3 在主机详情页面，单击“虚拟机”页签，查看主机上运行的虚拟机列表。
步骤4 在ManageOne运维面，选择“集中监控
>
资源监控
>
云资源
>
计算
>
弹性云服务
器”，查看步骤3中找到的对应虚拟机的CPU使用率。
步骤5 迁移该主机上CPU使用率较高的虚拟机到其他主机，具体操作请参见《华为云Stack
8.1.0
运维指南》中的“迁移虚拟机”。
步骤6 等待10分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，继续执行步骤5，直到主机CPU占用率恢复正常。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 187

1.2.1.26 ALM-6041
主机存在非法内存占用
告警解释
告警采集模块周期（默认300秒）监测虚拟化域和主机实际小页内存剩余量信息，如果
检测到虚拟化域剩余量比主机实际剩余量超出1GB，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
6041
重要 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
附加信息
●
主机 ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
虚拟化域剩余内存：可分配给虚拟机的剩余小页内存。
●
主机实际剩余内存：当前主机实际小页内存剩余量。
对系统的影响
可能造成OpenStack还有剩余内存，但虚拟机发放失败。
可能原因
主机上存在未知应用或插件占用了主机内存。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
1

## Page 188

步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 排查是否主动在主机上运行了不相关的进程。
执行以下命令，获取内存占用率降序排列的进程。
pids=`ps -ewwf |grep -v grep |grep 'nova\|cinder\|glance\|neutron\|keystone\|
swift\|dsware\|cps\|ceilometer\|gaussdb\|info-collect\|FusionStorage' | awk
'{print $2}'|tr "\n" "|"|sed -e 's/,$/\n/'` && top -M -n 1| grep -Ev ${pids}qemu-
kvm
top - 17:46:52 up 6 days, 19:07, 2 users, load average: 40.11, 39.42, 38.70
Tasks: 2091 total, 6 running, 2084 sleeping, 0 stopped, 1 zombie
%Cpu(s): 22.4 us, 10.3 sy, 0.0 ni, 66.3 id, 0.1 wa, 0.5 hi, 0.4 si, 0.0 st
MiB Mem : 450676.2 total, 206238.6 free, 215346.6 used, 29091.1 buff/cache
MiB Swap: 0.0 total, 0.0 free, 0.0 used. 232461.5 avail Mem
PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+
COMMAND
65425 opensta+ 20 0 20.9g 4.5g 17360 S 5.0 1.0 119:38.95
java
12601 opensta+ 20 0 12.9g 2.5g 17008 S 0.0 0.6 153:39.36
java
97337 opensta+ 20 0 19.6g 2.3g 17416 S 0.0 0.5 8:59.65
java
78218 root 17 -3 6457932 700016 17332 S 0.0 0.2 42:13.07
java
74390 omm 20 0 12.4g 479420 12932 S 0.0 0.1 15:29.00
java
20560 rabbitmq 20 0 22.8g 411876 6816 S 5.0 0.1 1257:11
beam.smp
30733 eds 17 -3 8509876 279376 13680 S 5.0 0.1 271:09.59 ccdb_server
对于返回结果中可疑进程，可以使用以下命令查询进程详情，关闭不相关进程。
ps -ef |grep -v grep |grep PID
例如，ps
-ef |grep -v grep |grep 65425
步骤7 排查是否存在主动运行的第三方进程。
●
是，关闭所有主动运行的第三方进程，执行步骤8。
●
否，执行步骤8。
步骤8 等待5分钟，查看告警是否恢复。
1

## Page 189

●
是，处理完毕。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.27 ALM-6042
主机实际要求资源隔离超过当前配置
告警解释
告警采集模块周期（默认300秒）监测主机的OpenStack资源隔离信息，包含CPU和内
存，如果检测到主机当前OpenStack资源隔离配置小于实际要求的资源隔离配置，系
统产生此告警。
告警属性
告警ID 告警级别 可自动清除
6042
重要/紧急 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
附加信息
●
阈值：告警阈值信息，
● 云服务：产生告警的云服务
●
服务：产生告警的服务
●
主机 ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
主机当前OpenStack资源隔离：主机目前分配的资源隔离
配置。
●
主机要求OpenStack资源隔离：根据主机上虚拟机数量计
算出的资源隔离最小值。
对系统的影响
可能影响OpenStack管理进程和虚拟机的正常运行。
1

## Page 190

可能原因
主机上虚拟机数量超过规划的虚拟机数量。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“配置
>
资源隔离”界面，根据告警附加信息中的“主机ID”或“主机名”，在
“计算组”中确定该计算节点所属资源隔离分组，查看“资源组配置”中的内存配置
和vCPU配置与告警附加信息"主机当前OpenStack资源隔离"是否一致。
●
是，执行步骤3。
●
否，执行步骤11。
步骤3 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤4 选择“服务列表
>
资源
>
计算资源
>
主机”，进入主机列表页面。根据告警附加信息
中的主机ID进行搜索，找到对应的主机，进入主机详情页面。
步骤5 在主机详情页面，单击“虚拟机”页签，查看主机上运行的虚拟机列表，计算主机上
虚拟机数量。
说明
计算资源隔离的虚拟机数量不包含开启关机释放资源并关机的虚拟机。
步骤6 参考表表1 计算节点OpenStack资源隔离与虚拟机数量的关系，判断主机实际要求资
源隔离与告警附加信息“主机要求OpenStack资源隔离”是否一致。
● 是，执行步骤11。
●
否，执行步骤7。
表1-35 计算节点OpenStack资源隔离与虚拟机数量的关系
虚拟机数量
CPU
内存（MB）
1-10 6 4608
11-20 8 7168
21-30 10 9728
31-40 12 12288
41-50 14 14848
51-60 16 17408
61-70 18 19968
71-80 20 22528
81-90 22 25088
1

## Page 191

虚拟机数量
CPU
内存（MB）
91-100 24 27648
步骤7 处理告警，有如下三种方法。
●
方法一：迁移虚拟机。执行步骤8。
●
方法二：配置主机组关机释放资源功能，关闭虚拟机。执行步骤9。
●
方法三：调整资源隔离。执行步骤10。
步骤8 迁移该主机上虚拟机到其他主机，将虚拟机数量降低到当前资源隔离最大支持的数
量。具体迁移操作请参见《华为云Stack
8.1.0
运维指南》中的“迁移虚拟机”。当前
资源隔离最大支持的虚拟机数量参考表表1 计算节点OpenStack资源隔离与虚拟机数
量的关系。
查看告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤11。
步骤9 配置主机组关机释放资源功能，并关闭超出数量的虚拟机。
1.
在ServiceOM页面选择“服务列表
>
资源
>
计算资源
>
主机组”，进入主机组列
表页面。
2.
单击主机组名称，进入“配置”页面。
3.
单击“编辑自定义标签”，增加关机释放资源标签，具体操作请参考《华为云
Stack 8.1.0
运维指南》"中的“创建主机组”。若已配置请跳过。
4.
关闭超出数量的虚拟机，将运行中虚拟机数量降低到当前资源隔离最大支持的数
量。
查看告警是否自动清除。
–
是，处理完毕。
–
否，执行步骤11。
步骤10 调整OpenStack资源隔离。
注意
调整资源隔离属于高危操作，需要征得客户同意。
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
进入“配置
>
资源隔离”子界面，根据告警附加信息中的“主机ID”，在“计算
组”中查找该计算节点所属资源隔离分组。
3.
将本组中所有主机上所有虚拟机迁移到其他主机，具体操作请参见《华为云Stack
8.1.0
运维指南》中的“迁移虚拟机”。
4.
在“资源组配置”>“启用FusionSphere OpenStack资源隔离”下配置“内存配
置”和“vCPU配置”。
1

## Page 192

说明
请依据表表1-35，根据业务规划的发放虚拟机数量，调整OpenStack资源隔离。
5.
单击右上角提交按钮 ，等待本页面主机的“配置状态”为“已生效”。
6.
查看告警是否自动清除。
–
是，处理完毕。
–
否，执行步骤11。
步骤11 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.28 ALM-70100
虚拟机审计告警
告警解释
当执行系统审计时发现存在非正常状态的虚拟机或CPS主机已删除，主机的nova-
compute服务残留，或nova数据库有大于一小时未提交事务时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
70100
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务名称
●
服务：产生告警的服务名称
附加信息 详细信息：告警的详细信息
IP地址/URL/域名 产生告警的主机IP地址或者URL地址或者域名
对系统的影响
此告警产生时，系统中存在不正常状态的虚拟机，影响系统对虚拟机的管理。
1

## Page 193

可能原因
系统中存在不正常状态的虚拟机。
说明
请在告警的详细信息中获取引发告警的具体审计问题，并参考处理步骤完成相应问题的处理。
处理步骤
步骤1 获取告警详情中“附加信息”参数中的“详细信息”取值，并判断取值是否在表1-36
范围内。
表1-36 详细信息与异常类型的对应关系
详细信息 异常类型
audit_orphan_vms
野虚拟机
audit_invalid_vms
假虚拟机
audit_stucking_vms
中间态虚拟机
● 是，执行步骤2。
●
否，执行步骤4。
步骤2 参考《华为云Stack
8.1.0
产品文档》中“虚拟机审计”章节，处理异常项。
步骤3 处理完成后，等待五分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤9。
步骤4 参考表1-37，获取对应的审计报告名称。
表1-37 详细信息与审计报告、异常类型的对应关系
详细信息 审计报告
audit_host_changed_vms host_changed_vm.csv
audit_diff_state_vms diff_state_vm.csv
audit_stucking_migrations cold_stuck.csv
audit_diff_property_vms diff_property_vm.csv
audit_nova_service_cleaned nova_service_cleaned.csv
nova_idle_transaction nova_idle_transactions.csv
步骤5 确定当前环境部署的场景，获取审计报告。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“收集审计报告”章节。
1

## Page 194

步骤6 确定当前环境部署的场景，获取对应的“审计结果定位”章节。查找对应审计报告名
称的处理方式，并按之处理审计项。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“审计结果定位”章节。
步骤7 根据当前环境部署的场景，获取对应的“手动审计”章节，重新触发系统审计。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“手动审计”章节。
步骤8 查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.29 ALM-70101
虚拟机操作系统故障告警
告警解释
虚拟机内部操作系统异常，或虚拟机长时间没有向外部的watchdog服务发送心跳信号
时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
70101 紧急 若弹性云服务器的软件狗
告警策略设置为“不重启
弹性云服务器”，则告警
必须手动清除，其他场景
可自动清除。
告警参数
参数名称 参数含义
定位信息
●
虚拟机ID：产生告警的虚拟机ID
●
租户ID：产生告警虚拟机所属租户
1

## Page 195

参数名称 参数含义
附加信息
●
事件ID：告警的事件ID
●
可用分区名：告警虚拟机的可用分区
●
租户名：告警虚拟机所属租户
● 虚拟机名：告警虚拟机的名称
●
主机名：告警虚拟机的主机名
●
主机ID：告警虚拟机的主机ID
对系统的影响
虚拟机操作系统故障，虚拟机内部业务已不可用。虚拟机可能已被自动重启。
可能原因
●
虚拟机操作系统或虚拟机内部软件bug，导致panic，事件ID为0或9。
●
虚拟机内部没有安装向外部的watchdog服务发送心跳信号的软件或该软件卡住，
事件ID为1。
●
虚拟机qemu进程异常终止，事件ID为3。
●
CGP虚拟机内部关机，事件ID为12。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 选择“服务列表
>
资源
>
计算资源
>
虚拟机”，显示虚拟机列表界面，选中要处理的
虚拟机，单击“VNC登录”。查看虚拟机是否已被自动重启。
●
windows系统查看重启日志：
a.
按 windows键
+
R，打开“运行”窗口，执行命令 eventvwr。
b.
在事件查看器中， 选择“windows日志
>
系统
>
筛选当前日志”，在弹出的
“筛选当前日志”界面， 输入“1074”（1074，表示重启），单击“确定”，
筛选重启日志。
●
linux系统执行命令：last reboot查看重启日志。
步骤3 确认虚拟机是否有自动重启日志，执行对应步骤。
1

## Page 196

●
是，执行步骤5。
●
否，执行步骤4。
步骤4 手动重启虚拟机。在Service OM界面关闭虚拟机然后重新启动虚拟机，查看虚拟机是
否能被重新启动。
●
是，执行步骤5。
● 否，执行步骤6。
步骤5 手动清除告警，等待10分钟查看告警是否再次产生。
●
是，可能是由于虚拟机内部开启了watchdog服务，并且没有开启相应的喂狗程序
发送心跳信号，执行步骤12。
●
否，处理完毕。
步骤6 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤7 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤8 执行以下命令，防止系统超时退出。
TMOUT=0
步骤9 导入环境变量，具体操作请参见3.1 导入环境变量
步骤10 若一直无法重新启动虚拟机，在FusionSphere Openstack后台，查看是否有qemu进程
处于D状态。
1.
执行
nova show
虚拟机ID
| grep host
，获取虚拟机所在主机ID。
2.
执行命令
cps host-list | grep
主机ID，获取主机管理面IP。
3.
执行命令
su fsp
，切换为fsp用户。
4.
执行命令ssh fsp@管理面IP，切换至虚拟机所在主机。
5.
执行命令TMOUT=0，防止系统超时退出。
6. 3.1
导入环境变量。
7.
执行ps
aux | grep qemu | grep
虚拟机ID ，查看是否有qemu进程处于D状态。
–
是，重启主机，然后执行步骤11。
说明
重启主机会影响该主机上运行的虚拟机的服务，建议在重启主机前先将该主机上正常
运行的虚拟机迁移至其他主机。
–
否，执行步骤12。
1

## Page 197

步骤11 手动清除告警，等待10分钟查看告警是否再次产生。
●
是，执行步骤12。
●
否，处理完毕。
步骤12 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
参考信息
无。
1.2.1.30 ALM-70102
虚拟机
ERROR
状态告警
告警解释
虚拟机状态变为ERROR后4分钟左右，将产生此告警。
告警属性
告警ID 告警级别 可自动清除
70102
紧急 是
告警参数
参数名称 参数含义
定位信息
●
虚拟机ID：产生告警的虚拟机ID
●
租户ID：产生告警虚拟机所属租户
附加信息
●
可用分区名：告警虚拟机的可用分区
●
租户名：告警虚拟机所属租户
●
虚拟机名：告警虚拟机的名称
●
主机名：告警虚拟机的主机名
●
主机ID：告警虚拟机的主机ID
对系统的影响
如果虚拟机为HA（High Availability）类型虚拟机，ERROR状态会触发虚拟机的重调
度。如果为非HA的虚拟机，虚拟机会保持ERROR状态，不会自动恢复。
1

## Page 198

可能原因
●
虚拟机在运行时，在主机上异常停止（虚拟机非自主关机、或进程消失），管理
程序尝试恢复虚拟机失败，将虚拟机状态变为ERROR。
●
在数据库或消息队列服务不稳定的情况下，重启主机，虚拟机也需要重启，重启
过程中可能因连接不到数据库或消息队列，将虚拟机状态变为ERROR。
●
HA类型虚拟机在运行时，所在主机异常下电、或者管理网络中断，触发虚拟机重
调度时，重建失败，虚拟机状态变为ERROR。
●
HA类型虚拟机状态变为ERROR后（比如上述原因），一直无法重建成功，或者在
主机上重建时异常中断（管理程序异常、主机异常），卡在ERROR状态+rebuild...
任务状态，无法再次触发重建。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 选择“服务列表
>
资源
>
计算资源
>
虚拟机”，显示虚拟机列表页面，查看虚拟机
“电源状态”是否为已停止或者运行中。
●
是，执行步骤12。
●
否，执行步骤3。
步骤3 单击虚拟机名称，进入虚拟机概要页面，查看虚拟机“任务状态”字段是否为空。
●
是，执行步骤4。
●
否，执行步骤6。
步骤4 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤5 选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面，查看是否还存在
如下告警：
● 1.2.1.10 ALM-6021 主机网口状态异常
● 1.2.1.12 ALM-6023
主机存储链路中断
● 1.2.1.15 ALM-6026
主机光纤通道中断
如果存在，则应根据对应的告警帮助处理告警，然后执行步骤12。否则，执行步骤6。
1

## Page 199

步骤6 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤7 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤8 执行以下命令，防止系统超时退出。
TMOUT=0
步骤9 导入环境变量，具体操作请参见3.1 导入环境变量
步骤10 重启ceilometer-agent-central服务，等待5分钟再次观察告警是否自动清除。
cps host-template-instance-operate --service ceilometer ceilometer-agent-
central --action stop
cps host-template-instance-operate --service ceilometer ceilometer-agent-
central --action start
● 告警已自动清除，处理完毕。
●
告警无法自动清除，执行步骤11。
步骤11 参考《华为云Stack
8.1.0
产品文档》中“虚拟机审计”章节处理。
步骤12 选择“服务列表
>
资源
>
计算资源
>
虚拟机”，在显示的虚拟机列表界面，单击“更
多
>
虚拟机状态
>
停止”，停止虚拟机，等待虚拟机“电源状态”变成已停止。启动
虚拟机。
●
成功，处理完毕。
●
失败，请联系华为技术支持工程师。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 200

1.2.1.31 ALM-70105
异构
VMware
虚拟机卷数据残留告警
告警解释
当vCenter处理挂卷比较慢的时候或其他异常场景，导致虚拟机挂卷超时可能会产生虚
拟机的卷数据残留，这个时候会触发该告警（该告警目前只针对异构对接VMware场景
的虚拟机）。
告警属性
告警ID 告警级别 可自动清除
70105
重要 否
告警参数
参数名称 参数含义
定位信息
●
虚拟机ID：产生告警的虚拟机ID
●
卷ID：产生告警的虚拟机使用的卷ID
●
bdm数据ID：产生告警的卷的bdm数据ID
附加信息
●
详细信息：告警的详细信息
● 主机名：产生告警的主机名称
●
主机ID：产生告警的主机ID
●
可用分区：产生告警的可用分区
对系统的影响
虚拟机卷数据残留会影响对用户的数据展示，可能会影响相关数据的统计。
可能原因
●
vCenter内部挂卷时间太长导致并发给同一个虚拟机挂多个卷的时候，挂卷超时导
致数据残留。
●
其他挂卷异常场景也有可能会导致此类数据残留。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 查看告警信息，获取虚拟机id（instance_id），卷id（volume_id）和bdm数据id
（bdm_id）。
1

## Page 201

步骤2 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤4 执行以下命令，防止系统超时退出。
TMOUT=0
步骤5 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤6 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤7 执行命令cinder
list --all|grep
volume_id，查看该卷是否存在。
●
是，执行步骤8。
●
否，执行步骤9。
步骤8 执行命令cinder
show
volume_id，查看该卷的状态status字段是否在中间态
（attaching、detaching等状态）。
●
是，清除告警，处理完毕。
●
否，执行步骤9。
步骤9 登录nova数据库。
1.
执行命令cps
template-instance-list --service gaussdb
gaussdb，获取active
节点的管理面ip。
2.
执行命令su fsp，切换为fsp用户。
3.
执行命令ssh fsp@管理面ip，切换至管理面IP。
4.
执行命令su
gaussdba -c '/opt/gaussdb/app/bin/gsql
nova'，切换到nova数据
库。
1

## Page 202

步骤10 执行如下命令，查询结果是否有数据返回。其中，这里的bdm_id请从告警定位信息中
“bdm数据ID”获取。
select * from block_device_mapping where id=bdm_id and deleted=0;
●
是，执行步骤11。
●
否，清除告警，处理完毕。
步骤11 查看返回结果中的connection_info字段是否有值。
●
是，清除告警，处理完毕。
●
否，执行步骤12。
步骤12 执行\q退出数据库。
步骤13 请联系技术工程师确认是否需要执行delete__bdm_byid.sh脚本执行清理操作。
----结束
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
参考信息
无。
1.2.1.32 ALM-70106
虚拟机
HA
中间态告警
告警解释
虚拟机HA长时间（默认两个小时以上）卡在中间态，存在无法自动恢复的风险，则上
报告警。
告警属性
告警ID 告警级别 可自动清除
70106 重要 由nova-api的配置项
instance_rebuild_timeo
ut_clear决定，默认为
True，表示会自动清除。
告警参数
参数名称 参数含义
定位信息
●
虚拟机ID：产生告警的虚拟机ID
●
租户ID：产生告警虚拟机所属租户ID
1

## Page 203

参数名称 参数含义
附加信息
●
可用分区名：告警虚拟机所在可用分区的名称
●
虚拟机名：产生告警的虚拟机名称
●
主机名：告警虚拟机所在主机的名称
● 主机ID：告警虚拟机所在主机的ID
对系统的影响
涉及虚拟机无法自愈。
可能原因
● rabbitmq 服务丢失消息。
●
主机管理网络异常。
●
nova-compute服务重启。
●
配置的HA中间态超时时间过短。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
1

## Page 204

please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤5 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤6 执行命令
nova show
虚拟机ID
| grep
task_state，查看虚拟机任务状态是否为
“rebuilding”、“rebuild_block_device_mapping”、“rebuild_spawning”、
“rescheduling”之一。
●
是，执行步骤7。
●
否，HA过程中误报，手动恢复告警并结束处理。
步骤7 参考《华为云Stack
8.1.0
产品文档》中“虚拟机审计”章节处理。
步骤8 处理是否成功。
●
执行成功，完成操作。
●
执行失败，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.33 ALM-70107
虚拟机发生
HA
告警解释
当虚拟机HA被触发时产生此告警。
●
后续当虚拟机恢复到稳态（已运行或者已停止）时，该告警会自动消除。
●
如果环境已无空闲资源，或者由于虚拟机亲和性设置导致无主机执行HA时，此告
警无法自动消除，需先恢复环境后，手动/后续自动清除此告警。
告警属性
告警ID 告警级别 可自动清除
70107
重要 是
1

## Page 205

告警参数
参数名称 参数含义
定位信息
●
虚拟机ID：产生告警的虚拟机ID
●
租户ID：产生告警虚拟机所属租户ID
附加信息
●
可用分区名：告警虚拟机所在可用分区的名称
●
虚拟机名：产生告警的虚拟机名称
●
主机名：告警虚拟机所在主机的名称
● 主机ID：告警虚拟机所在主机的ID
对系统的影响
标示FusionSphere系统已触发虚拟机HA，后续FusionSphere系统将尝试在本地/异地
重新恢复虚拟机。
可能原因
虚拟机所在主机异常，例如管理面故障，网络断连等。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 选择“服务列表
>
资源
>
计算资源
>
虚拟机”。
步骤3 定位到该虚拟机，获取虚拟机对应的“主机ID”。
步骤4 单击“主机”页面，查看虚拟机所在主机是否为故障状态。
●
是，执行下面步骤恢复主机：
a.
尝试重启主机，重启后若主机还无法恢复，参考《华为云Stack
8.1.0
运维指
南》“更换主机”，进行恢复主机。
b.
恢复主机后，此时需要等待10分钟，观察虚拟机是否已恢复，如果虚拟机恢
复，任务结束。
c.
若因亲和性规则，虚拟机HA无法调度到主机，转到步骤5，手动进行虚拟机
冷迁移，恢复虚拟机。
●
否，执行步骤6。
步骤5 进入“虚拟机”页面，单击虚拟机名称，进入虚拟机“概要”页面，在右上角选择
“更多
>
冷迁移”，弹出“警告”对话框，单击“确认”。
说明
指定主机进行迁移可能会打破主机组亲和性规则，请确认选择符合条件的目标主机。
步骤6 如果告警仍然不能清除，请联系技术支持工程师协助解决。
----结束
1

## Page 206

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.34 ALM-70108
虚拟机目录文件异常
告警解释
OpenStack按5分钟周期检测虚拟机的目录文件，当虚拟机已经在其它主机上稳定运行
或者已经被删除，并且底层不存在该虚拟机，而主机上仍然存在该虚拟机的目录文件
时，或者虚拟机所在的主机上虚拟机的相关文件有丢失，则产生此告警。
告警属性
告警ID 告警级别 可自动清除
70108
紧急 是
告警参数
参数名称 参数含义
定位信息 虚拟机ID：产生告警的虚拟机ID
附加信息
●
详细信息：告警的详细信息
●
主机名：告警所在主机的名称
● 主机ID：告警所在主机的ID
对系统的影响
●
虚拟机残留文件会占用主机磁盘空间，可能造成资源不足，影响虚拟机正常创
建。
●
虚拟机文件丢失会导致虚拟机关机后无法启动。
可能原因
●
虚拟机删除过程中服务异常或者进程发生重启。
●
虚拟机resize或者resize-revert过程中发生错误或者虚拟机被删除。
●
虚拟机文件被误删除。
前提条件
已获取fsp、root用户的密码
1

## Page 207

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 导入环境变量，具体操作请参见3.1 导入环境变量
步骤5 查看告警中“附加信息”中的“详细信息”，查看是否有“lost files”字样。
●
是，执行步骤6。
●
否，执行步骤9。
步骤6 执行命令nova
list --all-t | grep
虚拟机ID，确认虚拟机是否存在。
说明
虚拟机ID从告警定位信息中获取。
●
是，执行步骤7，查看虚拟机是否停止。
●
否，执行步骤9。
步骤7 执行命令nova
list --all-t | grep
虚拟机ID
| grep
SHUTOFF，查看是否有返回值。
●
是，说明虚拟机已停止，执行nova
reset-state
虚拟机ID --active，重置虚拟机
状态为active后，再执行步骤8。
●
否，执行步骤8。
步骤8 请参照《华为云Stack
8.1.0
运维指南》中的“异地重建虚拟机”章节，在其它主机上
重建虚拟机，执行步骤16。
步骤9 查看虚拟机是否在告警主机上存在。
1.
在告警附加信息中，获取告警所在主机id。
2.
执行命令cps
host-list | grep
主机id，获取主机的管理面IP。
3.
执行命令su fsp，切换为fsp用户。
4.
执行命令ssh fsp@管理面ip，切换到管理面IP。
1

## Page 208

5.
重复执行步骤2~步骤4。
6.
执行runsafe命令进入安全模式。
7. 按照提示输入命令，查看虚拟机是否在告警主机上存在：
nova_virsh_cmd virsh-list-uuid | grep
虚拟机ID
回显信息中是否包含指定的虚拟机。
–
是，执行命令nova
show
虚拟机ID
| grep
instance_name，获取虚拟机底
层名称（比如instance-00000070）。然后执行命令virsh
undefine
虚拟机
底层名称，删除与虚拟机关联的文件，执行步骤16。
– 否，执行步骤10。
步骤10 执行runsafe命令进入安全模式，按照提示输入命令：
nova show 虚拟机ID
回显信息中输出如下信息，表示可以查询到虚拟机，执行步骤11。
+--------------------------------------+----------------------------------------------------------+
| Property | Value |
+--------------------------------------+----------------------------------------------------------+
| OS-DCF:diskConfig | MANUAL |
| OS-EXT-AZ:availability_zone | az1.dc1 |
| OS-EXT-SRV-ATTR:host | 253B9B3A-EC06-117B-8567-000000821800 |
回显信息中输出“ERROR
(CommandError): No server with a name or ID of
'虚拟机
ID'
exists.”，执行步骤14。
步骤11 虚拟机详情信息中，查看虚拟机状态是否正常。
字段“OS-EXT-STS:vm_state ”是否为active，“OS-EXT-STS:power_state”电源状态
是否为1，“OS-EXT-STS:task_state”任务状态是否为“-”。
●
是，执行步骤12。
●
否，请联系技术支持工程师协助解决。
步骤12 虚拟机详情信息中，查看虚拟机所属主机是否和产生告警主机一致。
字段“OS-EXT-SRV-ATTR:host”是虚拟机所属主机。
●
是，执行步骤13。
●
否，执行步骤14。
步骤13 登录虚拟机所属主机。执行如下命令查看虚拟机目录是否存在：
ls
/opt/HUAWEI/image/instances/虚拟机ID
回显信息中是否包含“No
such file or
directory”。
●
是，请联系技术支持工程师协助解决。
●
否，执行步骤14。
步骤14 登录产生虚拟机目录文件异常告警的主机(注意不是虚拟机所属的主机)，执行如下命
令，查看虚拟机残留文件：
ls /opt/HUAWEI/image/instances/ | grep
虚拟机ID
回显信息是否为空。
1

## Page 209

●
是，执行步骤16。
●
否，执行步骤15。
步骤15 将回显信息里以虚拟机ID或者虚拟机ID_resize命名的虚拟机残留文件清理。
1.
执行命令cd /opt/HUAWEI/image/instances，切换到残留文件目录。
2.
执行命令ll
| grep
residual_instance_file_name，确认残留文件。
3.
执行命令rm
-rf
residual_instance_file_name，删除残留文件。
说明
residual_instance_file_name为步骤14回显信息中的虚拟机残留文件名，即以虚拟机ID或
者虚拟机ID_resize命名的文件。
步骤16 手动清除告警，任务结束。
----结束
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
参考信息
无。
1.2.1.35 ALM-70109
虚拟机
BDM
残留审计告警
告警解释
当执行系统审计时发现虚拟机挂载卷时分配盘符超时失败，产生此告警。
告警属性
告警ID 告警级别 可自动清除
70109
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务名
●
服务：产生告警的服务名
附加信息 详细信息：告警的详细信息
对系统的影响
此告警产生时，系统中存在虚拟机挂载卷时因分配盘符超时导致虚拟机的BDM残留，
影响系统对虚拟机的管理。
1

## Page 210

可能原因
虚拟机挂卷时分配盘符超时失败。
说明
请在告警的详细信息中获取引发告警的具体审计问题，并参考处理步骤完成相应问题的处理。
处理步骤
步骤1 获取告警详情中“附加信息”参数中的“详细信息”取值，并参考表1-38，获取对应
的审计报告名称。
表1-38 详细信息与审计报告的对应关系
详细信息 审计报告
audit_invalid_bdms invalid_bdms.csv
步骤2 确定当前环境部署的场景，获取审计报告。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“收集审计报告”章节。
步骤3 确定当前环境部署的场景，获取对应的“审计结果定位”章节。查找对应审计报告名
称的处理方式，并按之处理审计项。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“审计结果定位”章节。
步骤4 根据当前环境部署的场景，获取对应的“手动审计”章节，重新触发系统审计。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“手动审计”章节。
步骤5 查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤6。
步骤6 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.36 ALM-70111
本地盘
ERROR
状态告警
告警解释
OpenStack按1小时周期检测本地直通盘状态，当本地直通盘状态故障，则产生此告
警。
1

## Page 211

告警属性
告警ID 告警级别 可自动清除
70111
紧急 否
告警参数
参数名称 参数含义
定位信息
●
主机ID：产生告警的主机ID
●
pci地址：本地盘pci地址
附加信息
●
主机ID：产生告警的主机ID
●
本地盘：产生告警的本地盘
●
虚拟机id：产生告警的虚拟机id
●
主机名：产生告警的主机名称
对系统的影响
如果此本地直通盘已经被分配给了虚拟机，则影响虚拟机使用。
可能原因
硬盘故障。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 登录产生告警的主机。
先用帐号“fsp”登录，然后使用“su
-
root”切换到帐号“root”。
步骤2 导入环境变量，具体操作请参见3.1 导入环境变量
步骤3 产生告警的本地盘是否是华为ES3000系列NVME SSD磁盘。
●
是，执行步骤4。
●
否，执行步骤5。
步骤4 执行以下命令，查看SSD设备的控制器健康状态（以“nvme0”为例）。
hioadm info -d nvme0
nvme0是产生告警的本地盘。
1

## Page 212

系统回显信息中的“device status”项取值表示SSD设备的控制器健康状态。
“healthy”表示设备健康状态正常。执行步骤6。
“warning”表示设备存在异常。执行步骤7。
步骤5 执行以下命令，查看本地直通盘健康状态。
smartctl -H /dev/sda
/dev/sda是产生告警的本地盘。
系统回显信息中的“SMART
Health
Status”项取值表示本地直通盘的健康状态。
“OK”或者“PASSED”表示设备健康状态正常。执行步骤6。
“FAILED”表示设备存在异常。执行步骤7。
步骤6 在ManageOne运维界面上，选择“集中监控
>
告警管理
>
当前告警”，手动清除告
警，任务结束。
步骤7 建议更换本地直通盘，更换完成后，在ManageOne运维界面上手动清除告警。
----结束
告警清除
此告警修复后，需要在ManageOne运维界面上手工清除此告警。
参考信息
无。
1.2.1.37 ALM-70112 IB
网卡故障
告警解释
OpenStack按1小时周期检测IB网卡，当IB网卡状态故障，则产生此告警。
告警属性
告警ID 告警级别 可自动清除
70112
紧急 是
告警参数
参数名称 参数含义
定位信息
●
主机ID：产生告警的主机ID
●
vendorID：产生告警的网卡供应商编码，默认1b53
●
productID：产生告警的网卡产品编码，默认1014
1

## Page 213

参数名称 参数含义
附加信息
●
服务名：产生告警的服务名称，默认为neutron
●
微服务名：产生告警的微服务名称，默认为VPC
●
虚拟机ID：产生告警的虚拟机ID
对系统的影响
如果此IB网卡已经被分配给了虚拟机，则影响虚拟机使用。
可能原因
IB网卡故障。
处理步骤
步骤1 查看告警详细信息中是否有虚拟机ID。
●
是，执行步骤2。
●
否，执行步骤3。
步骤2 通知用户，迁移虚拟机。
具体操作请参见《华为云Stack 8.1.0 运维指南》中的“迁移虚拟机”。
虚拟机迁移完成后，执行步骤4。
步骤3 参考《华为云Stack
8.1.0
运维指南》“计算节点（KVM）
>
更换网卡”章节，更换IB
网卡。
步骤4 等待5分钟，查看告警是否清除。
●
是，处理完毕。
●
否，联系技术支持工程师协助处理。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.38 ALM-70113 NVME SSD
盘或卡故障
告警解释
OpenStack周期检查主机上NVME SSD盘或卡的健康状态，当检查到盘或卡的状态不
健康时，系统就产生此告警。
1

## Page 214

告警属性
告警ID 告警级别 可自动清除
70113
紧急 是
告警参数
参数名称 参数含义
定位信息
●
主机ID：产生告警的主机ID
●
pci地址：产生告警的SSD卡的pci地址
●
异常类型：告警的异常类型
附加信息
●
主机ID：告警虚拟机所在主机ID
●
本地NvmeSSD盘：告警虚拟机使用的NvmeSSD盘
●
虚拟机id：产生告警的虚拟机ID
对系统的影响
会影响当前盘或卡上虚拟机的业务，如果进行更换故障盘或卡，则影响当前主机上所
有虚拟机的业务。
可能原因
NVME
SSD盘或卡硬件故障。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 打开告警详情查看主机ID和PCI地址。
步骤3 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
1

## Page 215

说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 查询NVME SSD盘或卡对应的系统槽位。
1.
执行命令cps
host-list | grep
主机ID，获取主机的管理面IP。
2.
执行命令su fsp，切换为fsp用户。
3.
执行命令ssh fsp@管理面ip，切换至管理面IP。
4.
重复执行步骤4~步骤5。
5.
执行命令
ls
/sys/bus/pci/slots/，获取所有的系统槽位号。
6.
重复执行如下命令，直到回显信息与步骤2中获取的PCI地址一致。此时$slot的取
值，就是NVME SSD盘或卡对应的系统槽位。
cat /sys/bus/pci/slots/$slot/address
说明
–
命令中$slot为系统槽位号，取值依次从步骤6.5获取。
–
理论上，步骤6.5中获取的系统槽位号和服务器表面的槽位号是一致的。
步骤7 通知该主机上所有租户关闭虚拟机进行更换硬盘操作，故障虚拟机数据丢失，其他虚
拟机数据不丢失。
步骤8 待所有虚拟机都关闭后，执行如下命令安全移除盘或卡。
echo 0 > /sys/bus/pci/slots/$slot/power
步骤9 观察NVMe
PCIe
固态硬盘指示灯，如果NVMe
PCIe
固态硬盘Fault指示灯处于慢闪状
态（0.5Hz/s），表示该硬盘允许拔出。
步骤10 下电主机，更换同等规格（包括磁盘规格、磁盘类型、安装槽位等）的盘或卡，具体
请参考《华为云Stack
8.1.0
运维指南》“虚拟机NVMe SSD直通盘更换”章节。
步骤11 上电主机，待所有虚拟机启动完毕，通知所有租户虚拟机可用。
----结束
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
1

## Page 216

参考信息
无。
1.2.1.39 ALM-70127
主机组内
NVMe SSD
大盘使用率超过阈值
告警解释
OpenStack周期性（默认5分钟）检测主机组内NVMe SSD大盘使用率，当检测到
NVMe
SSD大盘占用个数达到主机组内所有NVMe SSD大盘总个数的85%时，系统产
生此告警。
当检测到NVMe SSD大盘占用率降低到70%时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
70127
提示 是
告警参数
参数名称 参数含义
定位信息
●
主机组ID：NVMe SSD大盘所在主机组ID
●
SSD卡类型：NVMe SSD大盘类型
附加信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
●
总量：NVMe SSD大盘总量
●
使用量：NVMe SSD大盘使用量
●
阈值：NVMe SSD大盘阈值
对系统的影响
可能会造成之后创建NVMe SSD大盘虚拟机时，由于NVMe SSD大盘资源不够而创建
失败。
可能原因
主机组内NVMe SSD大盘使用率过高。
处理步骤
步骤1 在服务器上新增与原有NVMe SSD大盘类型相同的NVMe SSD盘或NVMe SSD卡进行
扩容，或者释放掉多余的占用大盘的虚拟机以释放大盘资源。
请参考《华为云Stack
8.1.0
资源发放指南》“计算服务
>
弹性云服务器
>
超高I/O型
云服务器配置方案”进行NVMe SSD配置。
1

## Page 217

步骤2 当释放大盘资源或者扩容完毕后，NVMe SSD大盘使用率低于70%时，告警是否恢
复。
●
是，处理完成。
●
否，执行步骤3。
步骤3 如果上述操作出现问题，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.40 ALM-70128
主机组内
NVMe SSD
小盘使用率超过阈值
告警解释
OpenStack周期性（默认5分钟）检测主机组内NVMe SSD小盘使用率，当检测到
NVMe
SSD小盘占用个数达到主机组内所有NVMe SSD小盘总个数的85%时，系统产
生此告警。
当检测到主机组内NVMe SSD小盘使用率降低到70%时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
70128
提示 是
告警参数
参数名称 参数含义
定位信息
●
主机组ID：NVMe SSD小盘所在主机组ID
● SSD卡类型：产生告警的SSD卡类型
附加信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
●
总量：NVMe SSD小盘总量
●
使用量：NVMe SSD小盘使用量
●
阈值：NVMe SSD小盘阈值
1

## Page 218

对系统的影响
可能会造成之后创建NVMe SSD小盘虚拟机时，由于NVMe SSD小盘资源不够而创建
失败。
可能原因
主机组内NVMe SSD小盘使用率过高。
处理步骤
步骤1 新增同类型的NVMe SSD小盘，进行NVMe SSD配置，或者释放掉多余的占用小盘的
虚拟机以释放小盘资源。
请参考《华为云Stack
8.1.0
资源发放指南》“计算服务
>
弹性云服务器
>
超高I/O型
云服务器配置方案”进行NVMe SSD配置。
步骤2 当释放NVMe SSD小盘资源或者新增完毕后，NVMe SSD小盘使用率低于70%时，告
警是否恢复。
●
是，处理完毕。
●
否，执行步骤3。
步骤3 如果上述操作出现问题，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.41 ALM-70129
主机组内
GPU
使用率超过阈值
告警解释
OpenStack周期性（默认5分钟）检测主机组内GPU使用率，当检测到GPU使用个数达
到主机组内GPU总个数的85%时，系统产生此告警。
当检测到GPU使用个数降低到主机组内GPU总个数的70%时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
70129
提示 是
1

## Page 219

告警参数
参数名称 参数含义
定位信息
●
主机组ID：gpu所在主机组ID
●
gpu类型：gpu类型
附加信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
●
主机组名称：gpu所在的主机组名称
●
gpu总量：gpu的总个数
●
gpu使用量：已使用的gpu个数
●
阈值：gpu个数阈值
对系统的影响
可能会造成之后创建GPU虚拟机时，由于GPU资源不够而创建失败。
可能原因
主机组内GPU使用率过高。
处理步骤
步骤1 通过告警信息得到GPU卡类型，建议新增相应类型的GPU卡。
请参考《华为云Stack
8.1.0
资源发放指南》“GPU加速型云服务器配置方案”章节，
进行GPU配置。
步骤2 当GPU使用率低于70%时，告警是否恢复。
●
是，处理完毕。
●
否，执行步骤3。
步骤3 如果上述操作出现问题，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.42 ALM-70130
虚拟机
HA
失败
告警解释
当虚拟机HA失败时，系统产生此告警。
1

## Page 220

●
后续当虚拟机恢复到稳态（已运行或者已停止）时，该告警会自动消除。
●
如果环境已无空闲资源，或者由于虚拟机亲和性设置导致无主机执行HA时，此告
警无法自动消除，需先恢复环境后，手动/后续自动清除此告警。
告警属性
告警ID 告警级别 可自动清除
70130
重要 是
告警参数
参数名称 参数含义
定位信息
●
虚拟机ID：产生告警的虚拟机ID
●
租户ID：告警虚拟机所在租户ID
附加信息
●
可用分区名：告警虚拟机所在可用分区名称
●
虚拟机名：告警虚拟机的名称
●
主机名：告警虚拟机所在主机名称
●
主机ID：告警虚拟机所在主机ID
对系统的影响
表示FusionSphere系统已触发虚拟机HA，但是HA恢复虚拟机失败，后续
FusionSphere系统将尝试在本地/异地重新恢复虚拟机。
可能原因
●
环境已无空闲资源，导致虚拟机HA时无可用主机。
●
虚拟机存在亲和性设置，导致虚拟机HA时无法选择到主机。
处理步骤
步骤1 查看该告警是否已经自动清除。
该告警一般会在虚拟机HA恢复后自动清除。
●
是，结束处理。
●
否，长时间未清除，可能是系统当前无可用主机来执行HA，转到步骤2。
步骤2 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤3 在Service OM界面，选择“服务列表
>
资源
>
计算资源
>
主机”。
步骤4 查看虚拟机所在主机是否为下电状态或者Service OM上是否有主机类告警。
1

## Page 221

●
是，先排除故障，尝试拉起主机，待10分钟后观察虚拟机是否已恢复?
–
主机无法恢复，建议参考《华为云Stack
8.1.0
运维指南》中“更换主机及配
件”相关章节。
–
主机已恢复，因亲和性规则，虚拟机无法自动HA恢复的场景，需要手动指定
合适的主机做冷迁移，转到步骤5。
–
虚拟机已恢复，结束处理。
●
否，转到步骤6。
步骤5 进入“虚拟机”页面，单击虚拟机名称，进入虚拟机“概要”页面，在右上角选择
“更多
>
冷迁移”，弹出“警告”对话框，单击“确认”。
说明
指定主机进行迁移可能会打破主机组亲和性规则，请确认选择符合条件的目标主机。
步骤6 如果告警仍然不能清除，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.43 ALM-70131
主机组
CPU
分配率超过阈值
告警解释
OpenStack周期性（默认5分钟）检测主机组CPU分配率（CPU已分配个数占主机组内
CPU总个数的百分比），当检测到主机组CPU分配率大于等于告警阈值（默认为
85%）时，系统产生此告警。
当检测到主机组CPU分配率小于告警恢复阈值（默认为70%）时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
70131
重要 是
告警参数
参数名称 参数含义
定位信息 主机组ID：产生告警的主机组ID
1

## Page 222

参数名称 参数含义
附加信息
●
云服务：产生告警的云服务名称
●
服务：产生告警的服务名称
●
主机组名称：产生告警的主机组名称
● cpu总量：产生告警的主机组cpu总量
●
cpu使用量：产生告警的主机组cpu使用量
●
cpu复用比：产生告警的主机组cpu复用比
●
cpu门限量：产生告警的主机组cpu门限量
对系统的影响
主机组CPU分配率过高，导致该主机组内虚拟机创建失败或者HA失败。
可能原因
主机组总体资源过少、虚拟机个数过多或者存在故障主机。
处理步骤
步骤1 通过告警信息得到该主机组内总CPU资源、已分配CPU资源以及上报告警的门限值，
通过以下方式清除告警：
● 清理CPU资源，通过删除多余虚拟机方式进行清理。
●
扩容该主机组，增加该主机组中总的CPU资源，例如，通过往该主机组中增加空
闲主机 。
●
参考《华为云Stack
8.1.0
运维指南》“更换主机”，修复主机组中存在的故障主
机。
步骤2 查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤3。
步骤3 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 223

1.2.1.44 ALM-70132
主机组内存分配率超过阈值
告警解释
OpenStack周期性（默认5分钟）检测主机组内存分配率（内存已分配数占主机组内存
总数的百分比），当检测到主机组内存分配率大于等于告警阈值（默认为85%）时，
系统产生此告警。
当检测到主机组内存分配率小于告警恢复阈值（默认为70%）时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
70132
重要 是
告警参数
参数名称 参数含义
定位信息
●
主机组ID：产生告警的主机组ID
附加信息
●
云服务：产生告警的云服务名称
●
服务：产生告警的服务名称
●
主机组名称：产生告警的主机组名称
●
内存总量：产生告警的主机组内存总量
●
内存使用量：产生告警的主机组内存使用量
●
内存复用比：产生告警的主机组内存复用比
●
内存门限量：产生告警的主机组内存门限量
对系统的影响
主机组内存分配率过高，导致该主机组内虚拟机创建失败或者HA失败。
可能原因
主机组总体资源过少、虚拟机个数过多或者存在故障主机。
处理步骤
步骤1 通过告警详细信息，获取主机组名称、内存总量、内存使用量、内存门限量。
步骤2 在Service OM界面，单击“服务列表
>
资源
>
计算资源
>
主机”，获取告警的主机
名称。
步骤3 通过以下三种方式，增加主机组总内存资源，使得主机组总内存使用率低于告警恢复
阈值，告警自动清除：
1

## Page 224

●
通过删除多余虚拟机方式，进行内存资源清理。
●
参考《华为云Stack
8.1.0
运维指南》“主机配置管理”，增加该主机组中主机，
从而增加该主机组中主机的内存资源。
●
参考《华为云Stack
8.1.0
运维指南》“更换主机”，修复主机组中存在的故障主
机。
步骤4 若告警仍未清除，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.45 ALM-70135
内存复用率超过阈值告警
告警解释
主机开启内存复用后，系统周期性（默认为5分钟）检查内存复用率，如果主机内存复
用率超过默认的告警阈值（默认为120%），则会上报此告警。
说明
主机内存复用率计算方法如下：
主机内存复用率=（已使用内存 - 虚拟机预留内存 - 已使用大页内存）/（主机物理内存 - I层预
留内存 - 大页内存）
其中，虚拟机预留内存 = 虚拟机规格 * 内存预留率。
内存预留率可以在FusionSphere OpenStack安装部署界面进行配置调整，默认为20%。
直通类型虚拟机（GPU直通、SSD直通、SRIOV直通、PF直通、FPGA直通、NVDIMM直通）和
大页内存虚拟机不支持内存复用，内存预留率为100%。
告警属性
告警ID 告警级别 可自动清除
70135
重要 是
告警参数
参数名称 参数含义
定位信息
●
主机 ID：产生告警的主机ID
1

## Page 225

参数名称 参数含义
附加信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
●
主机 ID：产生告警的主机ID
● 主机名：产生告警的主机名称
●
复用内存总量：主机的复用内存总量
●
复用内存已使用量：主机的复用内存已使用量
●
内存复用率：主机的内存复用率
●
阈值：主机的内存复用告警阈值
对系统的影响
可能会造成主机上运行的虚拟机的性能下降。
可能原因
主机上运行的虚拟机个数过多。
处理步骤
步骤1 将该主机上的部分虚拟机迁移到其他主机上，降低该主机内存复用率。
具体操作请参见《华为云Stack
8.1.0
运维指南》中的“迁移虚拟机”。
步骤2 等待约5分钟后，查看告警是否自动清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.46 ALM-70201 DHCP-agent
管理的
network
数量超过阈值
告警解释
当DHCP-agent管理的network数量大于系统设定值（默认为300）的85%时，系统产
生此告警。
1

## Page 226

告警属性
告警ID 告警级别 可自动清除
70201
重要 是
告警参数
参数名称 参数含义
定位信息
●
主机ID：产生告警的主机ID
●
云服务：服务类型，固定值为VPC
附加信息
●
云服务：产生告警的云服务，固定值为VPC
●
服务：产生告警的服务，固定值为DHCP
●
主机名：产生告警的主机名称
●
异常信息：Networks
Exceeds Limitation on a DHCP
agent
对系统的影响
●
可能导致该DHCP-agent对应主机的内存占用过高，影响该主机其他业务正常运
行。
●
如果当前系统中所有DHCP-agent管理的network数量都已经大于系统设定值（默
认为300）时，则系统中会存在部分network没有绑定到DHCP-agent上，使用这
些network创建的虚拟机无法通过neutron提供的dhcp功能来自动获取ip地址。
可能原因
● AZ内创建的network数量过多。
●
手动或自动触发了DHCP重调度，导致特定DHCP-agent管理的network过多。
●
节点存在冗余neutron命名空间。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
1

## Page 227

步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 查看系统中network和DHCP-agent数量。
1.
执行命令neutron
agent-list | grep neutron-dhcp-agent | grep
$host_id，在
agent列表中可以查找已部署的DHCP-agent。
说明
$host_id为告警参数定位信息中的主机ID。
2.
执行命令neutron
net-list-on-dhcp-agent
$dhcp_agent_id，查看某个DHCP-
agent管理的所有network。其中，$dhcp_agent_id为步骤8.1查询的id。
3.
统计部署的agent和每个agent绑定network数量，判断是否DHCP-agent部署不
足。
若数量过多，可借助Linux的wc命令等辅助统计数量。
–
执行命令neutron
agent-list | grep neutron-dhcp-agent | wc
-l，统计
DHCP-agent数量。
–
执行命令neutron
net-list-on-dhcp-agent $dhcp_agent_id | wc -l
，统计
DHCP-agent绑定的网络数量，查询的结果减去4就是该DHCP-agent绑定的
网络数量。
4.
分别执行以下两条命令，查看系统内未绑定到DHCP-agent的network。
net_id=`neutron net-list | awk '{print $2}'`
for i in $net_id;do if [ "$i" != "id" ];then c=`neutron dhcp-agent-list-
hosting-net $i | awk '{print $6}' | tr "\n" " "`; if [ "$c" = " " ];then echo
unbonded network_id is $i;fi;fi;done
1

## Page 228

步骤9 根据部署场景，判断是否为分布式DHCP。
●
是，执行步骤11。
●
否，执行步骤10。
判断方式如下：
● Region Type
I默认为分布式DHCP。
步骤10 根据network和DHCP-agent数量关系，判断是否因为DHCP-agent部署不足导致了本
次告警的触发。
判断方法：在步骤8.3的查询结果中，如果DHCP-agent平均绑定的网络个数，即步骤
8.3的所有的DHCP-agent绑定的网络数量和除以步骤8.3中DHCP-agent个数的结果超
过了系统设定值（默认为300）的85%，则DHCP-agent部署不足。
●
是，增加AZ内的DHCP角色，根据未绑定到DHCP-agent的network的数量，确定
需要扩容的DHCP-agent个数，并手动将超过阈值的DHCP-agent管理的network
重调度到新扩容的DHCP-agent中。
●
否，手动将超过阈值的DHCP-agent管理的network重调度到其他负荷较低的
DHCP-agent中,注意在重调度过程中不要下发业务。
重调度示例：
a.
执行命令：neutron
dhcp-agent-network-remove $dhcp_agent_id
$network_id，将该network从旧的DHCP-agent移除。其中，$network_id为
步骤8.2中查询的id。
b.
执行命令neutron
dhcp-agent-network-add $dhcp_agent_id
$network_id，将该network绑定到新的DHCP-agent。
c.
执行命令neutron
dhcp-agent-list-hosting-net
$network_id，查询重调度
是否成功。
步骤11 根据network和DHCP-agent数量关系，判断是否因为DHCP-agent部署不足导致了本
次告警的触发。
判断方法：在步骤8.3的查询结果中，如果DHCP-agent平均绑定的网络个数，即步骤
8.3的所有的DHCP-agent绑定的网络数量和除以步骤8.3中DHCP-agent个数的结果超
过了系统设定值（默认为300）的85%，则DHCP-agent部署不足。
●
是，扩容主机，并在Service OM界面，将上报告警所在主机的虚拟机迁移到新的
主机上。
●
否，手动在Service OM界面，将上报告警所在主机的虚拟机迁移到指定的没有超
阈值的主机上。
说明
热迁移虚拟机会造成短暂的业务闪断。
步骤12 重调度DHCP-agent可能会导致命名空间残留，根据当前环境部署的场景，获取对应的
“手动审计”章节，重新触发对冗余neutron命名空间（dhcp命名空间和router命名空
间）的审计。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“手动审计”章节。
步骤13 审计结束后查看审计报告，如果存在冗余命名空间，请参考“处理冗余neutron命名空
间”章节进行处理。
1

## Page 229

●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“处理冗余neutron命名空
间”章节。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.47 ALM-70203
主机上虚拟端口上线处理异常
告警解释
虚拟机端口上线时，网络设置失败产生此告警。
告警属性
告警ID 告警级别 可自动清除
70203
重要 是
告警参数
参数名称 参数含义
定位信息
●
主机ID：产生告警的主机ID。
●
端口信息：产生告警的组件名/触发动作/端口类型。
附加信息
●
端口列表：产生告警的虚拟端口列表。
●
失败原因：Virtual
Interfaces Fail to Be Brought
Online，表示虚拟端口上线失败。
对系统的影响
虚拟机对应端口的网络不通。
可能原因
●
Rabbitmq故障，后端agent通过rpc获取端口信息异常，导致无法正常下发端口网
络配置。
●
其它场景：neutron-server内部系统异常，如数据库表项更新/删除并发操作，或
第三方driver处理异常等，后端agent查询或更新端口信息失败，引起端口上线失
败。
1

## Page 230

前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 参考1.2.1.84
ALM-73401
rabbitmq服务故障，检查rabbitmq是否正常，如果
rabbitmq正常（或恢复正常），则执行步骤2处理，否则执行步骤7。
步骤2 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤4 执行以下命令，防止系统超时退出。
TMOUT=0
步骤5
3.1
导入环境变量。
步骤6 根据告警详细信息获取到虚拟机端口uuid，并通过命令行更新port属性触发端口上线
处理（示例如下）。等待告警清除，若5分钟告警清除则结束，否则执行步骤7。
neutron port-update port_uuid --admin-state-up False
//中断该端口网络通信
neutron port-update port_uuid --admin-state-up True
//恢复该端口网络通信
步骤7 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 231

1.2.1.48 ALM-70251
聚合网口状态异常
告警解释
配置网络分组中的bond时，如果bond的从属网口状态异常则产生此告警。
告警属性
告警ID 告警级别 可自动清除
70251
重要 是
告警参数
参数名称 参数含义
定位信息
●
主机ID：产生告警的主机ID
●
聚合网口名：产生告警的bond名称
附加信息
●
详细信息：
聚合网口名：产生告警的bond名称
●
主机ID：产生告警的主机ID
●
主机名：产生告警的主机名称
对系统的影响
bond的模式，包括主备、负载均衡，无法完全生效。
可能原因
在节点中生效的bond，如果只存在一个从属网口，或者从属网口中存在非法网口造成
bond功能无法全部生效，产生该告警。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
1

## Page 232

说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤5 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤6 根据告警详细信息选择处理步骤。
●
告警信息显示bond的从属网口只有1个且不存在unknown的网口，执行步骤7。
●
告警信息显示bond的从属网口大于1个且存在unknown的网口，执行步骤8。
●
告警信息显示bond的从属网口大于1个且不存在unknown的网口，执行步骤12。
步骤7 bond下只有一个从属网口，需要增加bond的从属网口数量，有如下两种处理方式：
●
主机上未运行业务时，登录FusionSphere OpenStack安装部署界面，选择“配置
>
网络
>
网口映射配置”页面，根据告警定位信息中的“主机ID”，找到告警主
机所在的主机组。删除聚合网口bond，选择可用的空闲nic网口，重新创建
bond。
●
主机上存在业务时，切换到PuTTY执行以下命令，更新bond的从属网口：
说明
解除注册有风险，需谨慎操作。确保该网卡没有被使用。
cps hostcfg-item-update --item bond --bond-name trunk_name --slaves
nic_name_1,nic_name_2,... --type network group_name
cps commit
其中， trunk_name从告警信息中获取，nic_name可通过“cat
/usr/bin/
ports_info |python -mjson.tool|grep
eth”查看，group_name可通过cps
hostcfg-list --type
network命令查看分组名称。
1

## Page 233

例如：
cps-hostcfg-item-update --item bond --bond-name trunk1 --slaves
nic3,nic4 --type network group1
cps commit
执行成功后，执行步骤15。
步骤8 登录FusionSphere OpenStack安装部署界面，选择“配置
>
网络
>
网口映射配置”页
面，根据告警定位信息中的“主机ID”，找到告警主机所在的主机组。切换到
PuTTY，通过cli命令查询告警bond从属口的option属性是否是AUTO_PXE。
cps hostcfg-show --type network 主机组
●
如果unknown的从属网口属于AUTO_PXE类型，执行步骤9。
●
如果unknown的从属网口不属于AUTO_PXE类型，执行步骤10。
步骤9 在主机上规划一张物理网卡，适配给unknown的从属网口：
1.
切换到PuTTY，执行命令cat
/usr/bin/ports_info |python -mjson.tool|grep
eth，确认该eth口是否注册为nic口。
–
是，该物理网卡已经被主机所在的网络分组注册，执行步骤9.2。
–
否，该物理网卡还没有被主机所在的网络分组注册，执行步骤11。
2.
执行以下命令从网络分组中解除注册：
cps hostcfg-item-delete --item nic --nic-name nic_name --type network
group_name
cps commit
其中，group_name可通过cps
hostcfg-list --type
network命令查看分组名称，
nic名称可通过“cat
/usr/bin/ports_info |python -mjson.tool|grep
eth”查看。
例如：
cps hostcfg-item-delete --item nic --nic-name nic3 --type network group1
cps commit
处理完毕，执行步骤11。
步骤10 替换bond从属网口中为unknown的网口，有如下两种处理方式：
●
主机上未运行业务时，登录FusionSphere OpenStack安装部署界面，选择“配置
>
网络
>
网口映射配置”页面，根据告警定位信息中的“主机ID”，找到告警主
机所在的主机组。删除聚合网口bond，重新创建同名聚合网口bond，新bond中
需使用其他正常网口替换异常网口。
●
主机上存在业务时，切换到PuTTY执行以下命令，更新bond的从属网口：
cps hostcfg-item-update --item bond --bond-name trunk_name --slaves
nic1,nic2,... --type network group_name
cps commit
其中，trunk_name从告警信息中获取，nic_name可通过“cat
/usr/bin/
ports_info |python -mjson.tool|grep
eth”查看，group_name可通过cps
hostcfg-list --type
network命令查看分组名称。
例如：
cps hostcfg-item-update --item bond --bond-name trunk1 --slaves
nic3,nic4 --type network group1
cps commit
1

## Page 234

执行成功后，执行步骤15。
步骤11 配置交换机使规划的物理网卡与PXE网口处于同交叉平面内（二层互通）。
执行成功后，执行步骤15。
步骤12 查看告警中附加信息。
●
如果提示status
is
down，执行步骤13。
●
如果提示aggregator
id
mismatch，执行步骤14。
步骤13 由于告警上报有查重功能，附加信息中状态异常网卡和正常网卡，参考1.2.1.10
ALM-6021
主机网口状态异常处理步骤一并排查修复。
执行成功后，执行步骤15。
步骤14 登录聚合网口对端主机或者交换机，检查trunk设置是否正确。
●
如果配置错误，请修改配置正确后，执行步骤15。
●
如果配置正确，请执行步骤16。
步骤15 等待5分钟时间，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤16。
步骤16 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.49 ALM-70300
卷审计告警
告警解释
当执行系统审计时发现存在非正常状态的卷时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
70300
重要 是
1

## Page 235

告警参数
参数名称 参数含义
定位信息
●
服务名：产生告警的服务名
附加信息
●
详细信息： 卷审计产生告警的详细信息
对系统的影响
此告警产生时，系统中存在状态不正常的卷，影响系统对卷的管理，上报的不同审计
项影响不同，具体请参见“审计结果定位”章节。
可能原因
系统中存在状态不正常的卷。
说明
请在告警的详细信息中获取引发告警的具体审计问题，并参考处理步骤完成相应问题的处理。
处理步骤
步骤1 获取告警详情中“附加信息”参数中的“详细信息”取值，并判断取值是否在表1-39
范围内。
表1-39 详细信息与异常类型的对应关系
详细信息 异常类型
VolumeAttachmentAudit
挂载信息不一致卷
wildVolumeAudit
野卷
fakeVolumeAudit
假卷
●
是，执行步骤2。
●
否，执行步骤4。
步骤2 参考《华为云Stack
8.1.0
产品文档》中“卷审计”章节，处理异常项。
步骤3 处理完成后，等待五分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤9。
步骤4 获取告警详情中“附加信息”参数中的“详细信息”取值，此取值加.csv后缀，即为对
应的审计报告名称。
步骤5 确定当前环境部署的场景，获取审计报告。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“收集审计报告”章节。
1

## Page 236

步骤6 根据当前环境部署的场景，获取对应的“审计结果定位”章节。查找对应审计报告名
称的处理方式，并按之处理审计项。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“审计结果定位”章节。
步骤7 根据当前环境部署的场景，获取对应的“手动审计”章节，重新触发系统审计。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“手动审计”章节。
步骤8 查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.50 ALM-70310
快照审计告警
告警解释
当执行系统审计时发现存在非正常状态的快照时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
70310
重要 是
告警参数
参数名称 参数含义
定位信息 服务名：产生告警的服务名
附加信息 详细信息：快照审计产生告警的详细信息
对系统的影响
此告警产生时，系统中存在状态不正常的快照，影响系统对快照的管理。
●
野快照的影响：OpenStack上查询不到对应的快照，占用后端存储空间。
●
假快照的影响：OpenStack系统中快照不可以用，占用系统资源。
1

## Page 237

●
中间状态快照的影响：OpenStack系统中快照不可以用，占用系统资源。
可能原因
●
系统中存在野快照。
●
系统中存在假快照。
●
系统中存在快照处于中间状态。
说明
请在告警的详细信息中获取引发告警的具体审计问题，并参考处理步骤完成相应问题的处理。
处理步骤
步骤1 获取告警详情中“附加信息”参数中的“详细信息”取值，并判断取值是否在表1-40
范围内。
表1-40 详细信息与异常类型的对应关系
详细信息 异常类型
fakeSnapshotAudit.csv
假卷快照
●
是，执行步骤2。
● 否，执行步骤4。
步骤2 参考《华为云Stack
8.1.0
产品文档》中“快照审计”章节，处理异常项。
步骤3 处理完成后，等待五分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤9。
步骤4 获取告警详情中“附加信息”参数中的“详细信息”取值，此取值加.csv后缀，即为对
应的审计报告名称。
步骤5 确定当前环境部署的场景，获取审计报告。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“收集审计报告”章节。
步骤6 根据当前环境部署的场景，获取对应的“审计结果定位”章节。查找对应审计报告名
称的处理方式，并按之处理审计项。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“审计结果定位”章节。
步骤7 根据当前环境部署的场景，获取对应的“手动审计”章节，重新触发系统审计。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》中“手动审计”章节。
步骤8 查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
1

## Page 238

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.51 ALM-70400
镜像审计告警
告警解释
当执行系统审计时发现存在非正常状态的镜像时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
70400
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
附加信息
●
云服务：产生告警的云服务
●
详细信息：告警的详细信息
对系统的影响
此告警产生时，系统中存在不正常状态的镜像。影响系统对镜像的管理。
●
queued状态镜像不占用系统资源，但是镜像不可用。
●
saving状态镜像会有残留的镜像文件，占用存储系统的空间。
可能原因
系统存在处于中间状态的镜像。
处理步骤
步骤1 根据告警详情中“附加信息”参数中的“详细信息”取值，并获取异常审计项所属的
类型及异常个数。
1

## Page 239

表1-41 详细信息与审计报告的对应关系
详细信息 审计报告
audit_stucking_images
中间态镜像
步骤2 参考《华为云Stack
8.1.0
产品文档》中“镜像审计”章节，处理异常项。
步骤3 处理完成后，等待五分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤4。
步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.52 ALM-70401
镜像完整性校验失败
告警解释
创建虚拟机或创建镜像卷时，需要先下载镜像。下载后需要对镜像进行完整性校验，
如果校验失败，则产生此告警。
告警属性
告警ID 告警级别 可自动清除
70401
重要 是
告警参数
参数名称 参数含义
定位信息 镜像uuid：产生告警的镜像uuid
附加信息
●
镜像名称：产生告警的镜像名称
●
证书uuid：镜像对应的证书uuid
●
证书名称：镜像对应的证书名称
1

## Page 240

对系统的影响
此告警产生时，创建虚拟机或系统卷失败。
可能原因
镜像被非法篡改。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 选择“集中监控
>
告警管理
>
当前告警”，获取告警参数中的镜像uuid。
步骤3 登录FusionSphere OpenStack管理控制台，执行如下命令，查看镜像详情。（其中
uuid为获取的镜像uuid）
glance image-show uuid
+-----------------------+----------------------------------------------------------------------------------+
| Property | Value |
+-----------------------+----------------------------------------------------------------------------------+
| __admin_encrypted | false |
| __image_source_type | glance |
| __imagetype | gold |
| __isregistered | true |
| __os_bit | 64 |
| __os_type | Linux |
| __os_version | CentOS 7.4 64bit |
| __platform | CentOS |
| __quick_start | False |
| __support_kvm | true |
| __support_live_resize | False |
| __support_static_ip | False |
| __system_encrypted | false |
| __virtual_size | 400 |
| architecture | x86_64 |
| checksum | fbad5d955c8bba0fcda230e5d45b74b7 |
| cloudinit | False |
| container_format | bare |
| created_at | 2020-11-28T04:14:35Z |
| describe | |
| direct_url | swift+https://service
%3Aswift:1%235NqNH6VnoiQEyUvLhqT6ze19YI7CHlCEowkVr1TFD80%3D |
| | @identity.az0.dc0.domainname.com:443/identity-admin/v3/glance/e002d1a2-b26b- |
| | 4e53-bd66-0435a9402f72 |
| disk_format | qcow2 |
| file_format | qcow2 |
| file_name | **.qcow2 |
| hw_disk_bus | virtio |
| hw_firmware_type | bios |
| id | e002d1a2-b26b-4e53-bd66-0435a9402f72 |
| is_auto_config | false |
| locations | [{"url": "swift+https://service
1

## Page 241

%3Aswift:1%235NqNH6VnoiQEyUvLhqT6ze19YI7CHlCEowkV |
| | r1TFD80%3D@identity.az0.dc0.domainname.com:443/identity-admin/v3/glance/e002d1a2 |
| | -b26b-4e53-bd66-0435a9402f72", "metadata": {}}] |
| min_disk | 400 |
| min_ram | 0 |
| name | image_x86 |
| ori_disk_format | qcow2 |
| owner | 75e17d223f9c4c3794eb9e9b937346fc |
| protected | True |
| size | 50339840 |
| status | active |
| tags | [] |
| updated_at | 2020-11-28T04:14:37Z |
| virtual_env_type | FusionCompute |
| virtual_size | None |
| visibility | public |
+-----------------------+----------------------------------------------------------------------------------+
步骤4 查看3回显的status值
●
如果status值不是active，请跳至步骤7执行。
●
如果status值是active，请继续。
步骤5 执行如下命令下载该镜像文件，其中uuid为获取的镜像uuid，file指定的下载镜像文件
路径可以自行修改。
glance image-download uuid --file /opt/HUAWEI/image/imagename.qcow2 --
progress
步骤6 保存该文件之后，执行如下命令删除下载的镜像文件以释放服务器资源，其中文件路
径为5指定的镜像文件路径。
rm -rf /opt/HUAWEI/image/imagename.qcow2
步骤7 选择“资源
>
镜像资源
>
镜像列表”界面，定位到镜像所在行，单击“删除”，删除
镜像。
步骤8 检查告警是否消除。
●
是，任务结束。
●
否，技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.53 ALM-70402
整机快照残留
告警解释
当执行系统审计，发现残留整机快照时，产生此告警。
1

## Page 242

告警属性
告警ID 告警级别 可自动清除
70402
次要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
附加信息
●
云服务：产生告警的云服务
●
详细信息：告警的详细信息
对系统的影响
残留的整机快照的镜像文件会占用存储系统的空间。
可能原因
●
用户在后台手动删掉了整机快照对应的虚拟机。
●
其它未知错误导致的整机快照残留。
处理步骤
步骤1 参考《华为云Stack
8.1.0
产品文档》中“收集审计报告”章节，获取审计报告。
步骤2 参考《华为云Stack
8.1.0
产品文档》中“处理残留整机快照”章节，处理残留的整机
快照。
步骤3 参考《华为云Stack
8.1.0
产品文档》中“手动审计”章节，重新触发系统审计。
步骤4 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤5 在ManageOne运维面的“集中监控
>
告警管理
>
当前告警”界面，查看告警是否清
除。
●
是，处理完毕。
●
否，请联系华为技术支持工程师。
----结束
1

## Page 243

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.54 ALM-73005
残留
LUN
告警
告警解释
当系统周期（默认为1小时）检查到共享存储中存在残留LUN时，会产生此告警。
当人工清除共享存储上残留LUN时，告警会自动恢复。
告警属性
告警ID 告警级别 可自动清除
73005
提示 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID
附加信息
●
磁阵IP：共享存储管理面IP
●
存储池名称：产生告警的存储池名称
●
LUN名称列表：残留LUN的名称列表，多个LUN间以&分
割
对系统的影响
对系统功能无影响，残留LUN会占用共享存储的存储空间。
可能原因
控制主机管理组件磁盘配置对接共享存储，重新PXE控制主机前，管理员未及时清理共
享存储上该主机使用的LUN。
处理步骤
步骤1 登录共享存储，查找告警中的LUN。以华为OceanStor V3系列为例，在“资源分配
>
LUN”中，查看LUN的描述信息是否以告警定位信息中主机ID为前缀。
●
是，清理该残留LUN，具体操作请参见存储对应型号的产品文档。清理完成后，
执行步骤2。
1

## Page 244

●
否，执行步骤3。
步骤2 等1小时后，查看告警是否自动恢复。
●
是，处理完毕。
●
否，执行步骤3。
步骤3 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.55 ALM-73008
虚拟网络资源审计告警
告警解释
当执行系统审计时发现虚拟网络资源存在异常时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
73008
重要 是
告警参数
参数名称 参数含义
定位信息
● 云服务：产生告警的云服务
●
服务：产生告警的服务
●
审计名称：
–
info-collect-server：产生告警的审计项为dhcp名空间
资源冗余
–
neutron：产生告警的审计项为存在野port资源
附加信息 详细信息：
● redundant_dhcpns_count
xxx：产生告警的冗余dhcp名
空间个数
● Wild_ports
xxx：产生告警的野port
1

## Page 245

对系统的影响
此告警产生时，系统中存在状态不正常的虚拟网络资源，影响系统对虚拟网络资源的
管理。
可能原因
●
系统中存在冗余的neutron命名空间（包括dhcp命名空间或router命名空间）。
●
系统中存在虚拟网络野端口。
说明
请在告警的详细信息中获取引发告警的具体审计问题，并参考处理步骤完成相应问题的处理。
处理步骤
步骤1 获取告警详情中“附加信息”参数中的“详细信息”取值，并参考表1-42，获取异常
审计项所属的类型及异常个数。
表1-42 详细信息与异常类型的对应关系
详细信息 异常类型
wild_ports
虚拟网络野端口
步骤2 参考《华为云Stack
8.1.0
产品文档》中“虚拟网络审计”章节，处理异常项。
步骤3 处理完成后，等待五分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤4。
步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.56 ALM-73010
文件系统故障告警
告警解释
文件系统产生只读故障时，系统产生此告警。
说明
目前支持ext3, ext4文件系统。
1

## Page 246

告警属性
告警ID 告警级别 可自动清除
73010
重要 系统分区重启后可自动清
除，其余需要手动清除。
须知
本文提到的告警“自动清除”，都需要重启服务器。如果文件系统故障没有被完全修
复，告警会再度上报。
告警参数
参数名称 参数含义
定位信息
●
主机 ID：产生告警的主机ID。
●
磁盘：异常文件的名称。
附加信息
●
异常信息：告警异常信息。
●
主机 ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
主机IP：产生告警的主机OMIP。
对系统的影响
●
根分区只读会导致该服务器上大部分服务进程异常，虚拟机出现严重故障。
日志分区会被错误日志填满，日志无法及时转储，部分日志可能丢失。
●
/var/log分区只读会导致日志写入，日志转储等相关操作失败。
可能原因
●
服务器异常掉电，导致写磁盘文件的IO丢失或者写错扇区。
●
服务器磁盘或者RAID卡硬件损坏或未配置电池。
●
磁盘驱动版本与硬件不匹配。
● 若为非本地存储，主机与存储之间连接断开。
●
磁盘数据损坏。
须知
在执行以下步骤过程中，如发现命令执行失败，可能由于根分区被损坏，请联系技术
支持工程师协助解决。
1

## Page 247

前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 执行以下命令，查看是否可以获取上报告警的磁盘分区在主机上的设备号，如253:2。
ll /sys/dev/block/ | grep -w xxx$ | awk '{print $9}'
xxx为上报告警的磁盘分区，如dm-12、sda1等。
●
是，执行步骤9。
●
否，磁盘已经不存在，远端存储已经被卸载，可以手动清除告警，处理完毕。
步骤9 执行以下命令获取上报告警分区所属的物理磁盘符。
lsblk
1

## Page 248

例如，步骤8获取的设备号为253:2，则所属的物理磁盘符为sda
,
如图所示：
步骤10 执行如下命令，确认上报告警的分区是否为本地存储。
lsscsi -t | grep -w xxx
xxx为步骤9获取的物理磁盘符。确认回显的第三列字符串是否以"fc:"（FCSAN）或者
"iqn."（IPSAN）开头。
●
是，说明是远端存储，执行步骤16。
●
否，说明有可能是本地存储，也可能是华为多路径存储或者华为分布式块存储，
执行步骤11。
步骤11 执行如下命令，查看回显中是否包含VBS fileIO。
lsscsi | grep -w xxx
xxx为步骤9获取的物理磁盘符。
●
是，说明是华为分布式块存储，执行步骤16。
●
否，说明可能是本地存储或者华为多路径存储，执行步骤12。
步骤12 执行如下命令，查看回显信息中是否可以看到xxx磁盘。
upadmin show vlun | grep -w xxx
●
是，说明是华为多路径存储，执行步骤16。
●
否，无xxx磁盘信息，或者提示command
not
found，说明服务器未安装华为多
路径包，说明是本地存储，执行步骤13。
步骤13 执行命令last reboot，检查上报告警后主机是否已重启。
●
是，执行步骤14。
● 否，执行步骤15。
步骤14 查看告警是否清除。
1

## Page 249

●
是，说明是系统分区故障，可自动清除，处理完毕。
●
否，说明是非系统分区故障，执行步骤20查看文件系统是否正常。
–
是，手动清除告警，并执行步骤21。
–
否，继续定位执行步骤15。
步骤15 检查磁盘或RAID卡是否损坏。
在对应节点的BMC上检查是否有对应的硬件告警。
●
是，参考《华为云Stack
8.1.0
运维指南》中“管理节点”章节， 更换告警的磁
盘或RAID卡。如果告警依然没有恢复，执行步骤19。
●
否，执行步骤19。
步骤16
swift
xfs格式分区只读检测与修复。
1. swift
xfs格式分区只读检测。
执行如下命令，检查swift分区是否正常。
ll /opt/HUAWEI/swift
ls: cannot access /opt/HUAWEI/swift: Input/output error
–
若回显包含“Input/output error”，则swift分区处于只读状态，继续执行修
复操作步骤16.2。
–
若回显显示文件列表，则分区正常，执行步骤17。
2. Swift
xfs格式分区只读修复，如存在命令执行失败，请联系技术支持工程师协助
解决。
a.
执行如下命令，检查swift的挂载目录。
cat /proc/mounts | grep swift
/dev/mapper/extend_vg-swift /opt/HUAWEI/swift xfs rw,relatime,attr2,inode64,noquota 0 0
在本例中，分区为/dev/mapper/extend_vg-swift，挂载路径为/opt/
HUAWEI/swift。
b.
执行如下命令，停止swift-store服务。
cps host-template-instance-operate --service swift swift-store --
action stop --host 主机ID
主机ID可以从告警的附加信息上获取。
c. 执行如下命令，去挂载swift分区，如去挂载成功则无回显。
umount /opt/HUAWEI/swift
d. 执行如下命令，修复分区。
xfs_repair /dev/mapper/extend_vg-swift
Phase 7 - verify and correct link counts...
done
e.
执行如下命令，挂载分区。
mount /dev/mapper/extend_vg-swift /opt/HUAWEI/swift
f.
执行如下命令，启动swift-store服务。
cps host-template-instance-operate --service swift swift-store --
action start --host
主机ID
主机ID可以从告警的附加信息上获取。
步骤17 extX格式分区只读检测与修复（以rabbitmq为例）。
1

## Page 250

1.
extX格式分区只读检测。
执行如下命令，检查分区是否只读。
cat /proc/mounts | grep rabbitmq
/dev/mapper/cpsVG-rabbitmq /opt/fusionplatform/data/rabbitmq ext4 ro,nodev,relatime,stripe=64 0 0
在本例中，rabbitmq分区为/dev/mapper/cpsVG-rabbitmq，挂载路径为/opt/
fusionplatform/data/rabbitmq。
–
若ext4分区处于“ro”状态，则该分区处于只读状态，继续执行修复操作步
骤17.2。
–
若为其他情况，执行步骤18。
2.
extX格式分区只读修复，如存在命令执行失败，请联系技术支持工程师协助解
决。
a.
执行如下命令，停止rabbitmq服务。
cps host-template-instance-operate --service rabbitmq rabbitmq --
action stop --host
主机ID
主机ID可以从告警的附加信息上获取。
b.
执行如下命令，去挂载分区，如去挂载成功则无回显。
umount /opt/fusionplatform/data/rabbitmq
c.
执行如下命令，修复分区。
fsck.ext4 /dev/mapper/cpsVG-rabbitmq
e2fsck 1.45.6 (20-Mar-2020)
/dev/mapper/cpsVG-rabbitmq: clean, 10/262144 files, 36938/1048576 blocks
说明
如果前面只读检测分区的文件系统格式是ext3，请使用ext3相关的修复命令：
fsck.ext3 /dev/mapper/cpsVG-rabbitmq
d. 执行如下命令，挂载分区。
mount /dev/mapper/cpsVG-rabbitmq /opt/fusionplatform/data/
rabbitmq
e. 执行如下命令，启动rabbitmq服务。
cps host-template-instance-operate --service rabbitmq rabbitmq --
action start --host 主机ID
主机ID可以从告警的附加信息上获取。
步骤18 在FusionSphere Openstack安装部署界面，查看rabbitmq与其他组件是否已恢复正常
运行，如图所示。
1

## Page 251

●
是，手动清除告警并结束。
●
否，执行步骤19。
步骤19 对故障主机重做操作系统并重建虚拟机。系统恢复后在/etc/fstab中默认加载磁盘的相
关告警会自动清除；其他磁盘告警请重启，并执行步骤20。如无法修复，请联系技术
支持工程师协助解决。
步骤20 手动确认文件系统是否正常。
1.
执行df -h，查看是否可以找到告警信息中故障磁盘（比如“/dev/sda1”）的挂
载点（比如“/boot/efi”）。
–
是，执行步骤20.3。
–
否，执行步骤20.2。
2.
执行ll /dev/mapper，找到对应磁盘的映射（比如“cpsVG-image”），再执行
df
-h查找挂载点（比如“/opt/HUAWEI/image”）。
3.
执行touch /挂载点/测试文件名，对挂载点执行写文件操作，比如touch
/opt/
HUAWEI/image/test，其中test是新增测试的文件名。
–
命令执行正常，说明文件系统恢复正常，需要手动清除告警，并执行命令
rm
/挂载点/测试文件名，删除上一步创建的文件，比如rm
/opt/HUAWEI/
image/test，其中test是步骤20.3中的测试写文件操作的新增文件名，并执行
步骤21。
–
命令执行失败，说明执行失败故障没有恢复，继续执行步骤19，如仍然无法
修复，请联系技术支持工程师协助解决。
步骤21 重启主机，观察告警是否重现。
●
是，可能是罕见文件系统故障，需要专业分析，请联系技术支持工程师协助解
决。
●
否，处理完毕。
----结束
1

## Page 252

告警清除
不涉及。
参考信息
无。
1.2.1.57 ALM-73011
关键进程异常告警
告警解释
系统周期（默认9秒）检测关键进程，当监控的进程或服务状态异常时，系统产生此告
警。
告警属性
告警ID 告警级别 可自动清除
73011
重要 是
告警参数
参数名称 参数含义
定位信息
●
主机 ID：产生告警的主机ID。
●
异常进程名称：异常进程的名称。
附加信息
●
异常信息：告警异常信息。
●
主机 ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
主机IP：产生告警的OMIP。
对系统的影响
此告警产生时，可能导致系统异常，可能导致业务功能异常。
可能原因
●
进程异常终止。
●
服务异常。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
1

## Page 253

处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 执行以下命令切换目录。
cd /etc/sysmonitor/process
步骤9 根据告警信息中的异常进程或服务作为关键字，通过cat命令查看相关配置文件中配置
的“RECOVER_COMMAND”，尝试恢复异常的进程或服务。
例如hirmd服务出现告警时，根据告警信息中提示的主机名登录该主机，进入“/etc/
sysmonitor/process/”目录，以hirmd为关键字找到对应的配置文件为hirmd-
monitor。该文件中“RECOVER_COMMAND”字段为“service
hirmd
restart”，可
执行如下命令恢复hirmd服务进程。
service hirmd restart
步骤10 根据告警信息中的异常进程或服务作为关键字，通过cat命令查看相关配置文件中配置
的“MONITOR_COMMAND”，查看进程或服务是否恢复正常。
1

## Page 254

例如hirmd服务MONITOR_COMMAND字段为“/usr/bin/serviceStatusCheck
-s
hirmd -b /usr/bin/hirmd -n hirmd -p
/var/run/hirmd.pid”，可执行如下命令查看
hirmd服务状态是否恢复正常。
/usr/bin/serviceStatusCheck -s hirmd -b /usr/bin/hirmd -n hirmd -p /var/run/
hirmd.pid
再通过执行如下命令查看进程或服务是否正常。
echo $?
●
如果“echo $?”返回的值为“0”，表示进程或服务恢复正常，执行完毕。
●
如果“echo $?”返回的值为非“0”，表示进程或服务异常，执行步骤11。
步骤11 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.58 ALM-73012
磁盘分区
inode
资源不足告警
告警解释
系统按周期检测磁盘分区inode使用率，当磁盘分区inode使用率大于等于告警阈值
（默认为90%）时，系统产生告警。当磁盘inode使用率小于告警阈值（默认为
80%），告警恢复。
告警属性
告警ID 告警级别 可自动清除
73012
重要 是
告警参数
参数名称 参数含义
定位信息
●
主机 ID：产生告警的主机ID。
● 异常磁盘分区目录：异常磁盘名称。
1

## Page 255

参数名称 参数含义
附加信息
●
异常信息：告警的异常信息。
说明
● disk partition=%s：表示为磁盘分区挂载目录，如/var/log
等。
● inode
usage=%d：表示为磁盘当前inode使用率。
● alarm: %d%：表示告警阈值，值为90%。
● resume:
%d%：表示恢复阈值，值为80%。
●
主机 ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
主机IP：产生告警的主机OMIP。
对系统的影响
●
如果是根分区满可能导致系统运行异常。
●
如果是其它分区满会导致无法创建文件等。
可能原因
磁盘inode利用率过高。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
1

## Page 256

步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 执行cd ${PATH}命令进入告警详细信息中所报磁盘分区，如果能确定该分区下哪些文
件可以删除，执行rm ${FILE_NAME}命令按需删除以释放inode。
●
PATH：告警附加信息中disk partition的值。
●
FILE_NAME：PATH目录下，获取的待删除文件的名称。
说明
建议删除对应磁盘分区下的人为放置的大文件，或者未清理的日志文件以释放inode。
告警是否自动清除。
●
是，任务结束。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.59 ALM-73013
存储磁盘
I/O
时延过大告警
告警解释
对于本地磁盘：每5秒中读取一次本地磁盘的I/O时延并保存，每5分钟读取这5分钟内
计算的I/O时延平均值，如果该平均值有超过一半（30次以上）大于用户配置的IO延时
阈值（默认为100ms），则系统产生告警。当有一半及以上小于等于阈值时，告警恢
复。注，不对NVME盘做IO时延监控。
对于多路径磁盘：每分钟读取一次多路径磁盘的I/O读写量，当某一个磁盘I/O量连续5
次小于同一多路径设备中I/O量最大磁盘的2%，则系统产生此告警，当某一个磁盘I/O
量大于等于同一多路径设备中I/O量最大磁盘的2%，告警恢复。
1

## Page 257

告警属性
告警ID 告警级别 可自动清除
73013
重要 是
告警参数
参数名称 参数含义
定位信息
●
主机 ID：产生告警的主机ID。
●
磁盘名称：异常磁盘的名称。
附加信息
●
异常信息：告警的异常信息。
●
主机 ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
主机IP：产生告警的主机OMIP。
对系统的影响
●
导致处理磁盘I/O读写占用的CPU利用率过高。
●
CPU处理业务速度较慢。
可能原因
●
硬件原因导致磁盘I/O读写响应过慢。
●
没有组raid导致性能问题，或者raid卡驱动等有问题。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
1

## Page 258

步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 使用smart工具自检，确认是否为硬件问题。
1.
从上报告警信息中获取磁盘名${DIVICE}。
2. 执行命令smartctl -i /dev/${DIVICE}查看硬件是否支持SMART。
–
如果命令回显输出：SMART
support is:
Enabled，表示支持smart。执行步
骤8.3触发samrt自检。
–
如果命令回显输出：SMART
support is: Disabled
或 Unavailable，表示不支
持smart。
不支持smart的情况，一般是因为配置的raid卡不支持，此时需要使用对应
raid卡厂商的检查工具。
3.
触发smart自检。执行smartctl
-t long
/dev/${DEVICE}命令，后台检测硬件，
消耗时间较长。
4.
执行smartctl
-l selftest
/dev/${DEVICE}查看自检结果，回显中最近一次结果排
在前面。
●
状态为“Completed”则说明结果正常，则可认为磁盘暂时无严重问题。
●
如果报error，且出现多次慢盘场景，建议联系硬盘厂家或更换硬盘。
步骤9 请联系技术支持工程师协助解决。
----结束
1

## Page 259

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.60 ALM-73014
系统文件完整性异常
告警解释
按6小时周期定时执行系统文件完整性检查，当检测到系统关键文件被更改，系统产生
此告警。
当系统关键文档恢复正常时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
73014
重要 是
告警参数
参数名称 参数含义
定位信息 主机 ID：产生告警的主机ID。
附加信息
●
异常信息：告警的异常信息。
●
主机 ID：产生告警的主机ID。
● 主机名：产生告警的主机名。
●
主机IP：产生告警的主机OMIP。
对系统的影响
系统关键文件被更改，可能导致系统异常。
可能原因
●
人为误操作。
●
正常更改。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
1

## Page 260

处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 执行命令cd /opt/osfilecheck/result/切换目录。
步骤9 通过cat命令，查看该目录下的结果文件，确认是否有文件被修改的提示，如found
differences between database and
filesystem。
●
是，显示有文件被更改，如下所示，确认相关文件是否被正常更改。
linux-YWZjqI:/var/log # cat /opt/osfilecheck/result/*
AIDE 0.15.1 found differences between database and filesystem!!
Start timestamp: 2019-11-18 19:06:19
Summary:
Total number of files: 10
Added files: 0
Removed files: 0
Changed files: 1
---------------------------------------------------
Changed files:
---------------------------------------------------
changed: /etc/fstab
---------------------------------------------------
Detailed information about changes:
---------------------------------------------------
1

## Page 261

File: /etc/fstab
SHA256 : VcKP3J6dEPwjV02DTm6QMGeM82zwV6dE , +Q6WVcCCm0HaiEf21pOeSa/nW0lqQYDK
–
是，执行osfilecheck -u命令更新文件完整性检查数据库，然后执行步骤
10。
说明
如果更改是升级引入的，或者是为了解决问题或者优化性能等引入的，则认为是正常
更改，其余情况认为是误操作更改。
–
若为误操作更改，则从安装相同版本的其他主机上拷贝正常的文件替换被修
改文件，然后执行步骤10。
●
否，执行步骤10。
步骤10 执行osfilecheck -c命令进行文件完整性检查，查看“/opt/osfilecheck/result/”目录
下的结果文件，确认是否有文件被修改的提示，如found
differences between
database and
filesystem。
●
是，执行步骤11。
●
否，手动清除告警，或者等待6小时后告警会自动清除（本告警按6小时周期定时
执行系统文件完整性检查），处理完毕。
步骤11 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
参考信息
无。
1.2.1.61 ALM-73015
大页内存不足
告警解释
collect-alarm会周期性（默认为300s）检查当前生效的大页内存和用户配置的期望大
页内存值的差异，当生效的大页内存值小于用户配置的期望值，产生此告警。
告警属性
告警ID 告警级别 可自动清除
73015
紧急 是
告警参数
参数名称 参数含义
定位信息 主机 ID：产生告警的主机ID。
1

## Page 262

参数名称 参数含义
附加信息
●
异常信息：大页内存不足。
●
主机 ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
对系统的影响
●
可能导致部分业务虚拟机无法正常启动。
●
可能导致无法创建新的大页虚拟机。
可能原因
内存故障，主机的总内存减少。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 进入“配置
>
内核参数”，观察所有主机组的“配置状态”中是否存在“配置失
败”。
●
是，执行步骤3。
●
否，执行步骤6。
步骤3 单击“大页内存页数”的配置框，会弹出大页内存数量可配置的范围，比较可配置的
最大值是否小于已配置的大页内存页数。
●
是，执行步骤4。
● 否，执行步骤6。
步骤4 勾选“启用自动大页内存”，或者将“大页内存页数”配置为FusionSphere
OpenStack安装部署界面上提示的可配最大值。配置之后，单击提交。提交后，如果
“配置状态”中显示“重启后生效”，请按提示重启对应的主机。重复执行步骤3-步
骤4，检查所有“配置失败”的主机组。
步骤5 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“BMC IP地
址”一栏获得主机的BMC地址。
步骤6 登录BMC，观察“告警与事件”中“当前告警”页面中是否存在检查主机硬件内存相
关故障告警。
●
是，执行步骤7。
●
否，执行步骤10。
步骤7 主机下电，参照《华为云Stack
8.1.0
运维指南》中“更换内存”更换新内存，再启动
主机。
步骤8 登录主机，确认正常重启成功。
先用帐号“fsp”登录，然后使用“su
-
root”切换到帐号“root”。
1

## Page 263

步骤9 等待5分钟~10分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤10。
步骤10 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.62 ALM-73016 CPU
主频异常
告警解释
按15分钟周期检测主机CPU主频，连续五次检测到主机CPU当前主频超出硬件支持的
最大值或者低于最小值，系统产生此告警；当主机CPU主频恢复到正常范围时，系统
产生恢复告警。
告警属性
告警ID 告警级别 可自动清除
73016
重要 是
告警参数
参数名称 参数含义
定位信息 主机
ID
：产生告警的主机ID。
附加信息
●
异常信息：告警的异常信息。
●
主机 ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
主机IP：产生告警的主机OMIP。
对系统的影响
●
CPU主频过低可能导致系统性能严重下降，业务功能受影响。
●
CPU主频过高，可能会损坏CPU。
1

## Page 264

可能原因
CPU硬件出现故障。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 分别执行以下命令，查询系统的最大频率和最小频率。
cat /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_max_freq
cat /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_min_freq
步骤6 执行以下命令，查询/sys/devices/system/cpu目录下CPU的个数。
ls /sys/devices/system/cpu
根据查询结果，针对每个CPU执行如下命令，获取对应CPU的当前频率，例如通过如
下命令获取cpu8的当前频率。
cat /sys/devices/system/cpu/cpu8/cpufreq/cpuinfo_cur_freq
步骤7 根据查询结果，确认是否所有CPU当前频率cpuinfo_cur_freq的数值都在最小频率
cpuinfo_min_freq和最大频率cpuinfo_max_freq范围内。
●
是，执行步骤9。
●
否，执行步骤8。
1

## Page 265

步骤8 检查是否是CPU硬件故障。
●
是，更换硬件设备，再次执行步骤7。
●
否，执行步骤9。
步骤9 由于频率可能存在动态变化情况，重复执行至少5次如下命令，确认cpuX 的当前频率
是否在系统最小频率和最大频率范围内。
cat /sys/devices/system/cpu/cpuX/cpufreq/cpuinfo_cur_freq
●
是，执行步骤10。
●
否，执行步骤11。
步骤10 等待15~30分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤11。
步骤11 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.63 ALM-73017
主机系统用户密码过期预警
告警解释
系统每日凌晨1点检测fsp用户密码过期状态，当fsp用户密码剩余的有效天数在到期预
警天数内时，则系统会上报本告警。
以默认配置为例，fsp用户密码默认有效期为90天，默认到期预警天数为15天，如距离
上一次修改密码的天数超过75天，则剩余有效天数小于15天，该用户密码在过期预警
时间内，系统上报本告警。
告警属性
告警ID 告警级别 可自动清除
73017
次要 是
1

## Page 266

告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
用户名：fsp。
附加信息
●
详细信息：The
host OS password will
expire。
●
密码过期时间：所有主机密码中最近的过期时间。
对系统的影响
fsp用户密码即将过期，如密码过期，使用该用户登录主机后台需要修改密码，否则无
法登录。
可能原因
fsp用户密码即将过期。
处理步骤
步骤1 在ManageOne运维面，选择“日常运维
>
集中配置
>
密码管理”，修改fsp密码，具
体请参见《华为云Stack
8.1.0
运维指南》“安全管理
>
账户管理
>
修改账户密码
>
通过密码管理修改账户密码
>
修改密码”章节。
步骤2 判断是否需要修改密码周期。
●
是，执行步骤3。
●
否，执行步骤6。
步骤3 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤4 进入“配置
>
系统”界面，单击“主机密码管理”。
步骤5 单击“密码周期”后的“修改”，修改“密码有效期”，然后单击“提交”完成修改
后，执行步骤6。
步骤6 等待3~5分钟，查看告警是否清除。
●
是，处理结束。
1

## Page 267

●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.64 ALM-73018 swap
分区
I/O
时延过大
告警解释
对于主机上的swap分区，系统每2秒读取一次本地磁盘的I/O时延并保存，每100s内读
取50次I/O时延的值。如果连续50次内有35次I/O延时的值大于100ms，则系统产生告
警。
告警属性
告警ID 告警级别 可自动清除
73018
重要 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
磁盘：异常磁盘的名称。
附加信息
●
异常信息：告警的异常信息。
●
主机 ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
主机IP：产生告警的主机OMIP。
对系统的影响
●
处理磁盘I/O读写占用的CPU利用率过高。
●
CPU处理业务速度较慢。
●
对于非全预占虚拟机，虚拟机内部内存性能下降，用户体验降低。
说明
全预占虚拟机：虚拟机的内存是预先分配的。
非全预占虚拟机：虚拟机的内存是使用时再分配的。
1

## Page 268

可能原因
●
硬件原因导致磁盘I/O读写响应过慢。
●
主机内存实际使用率超分，导致频繁使用交换分区。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 进入“配置
>
磁盘”界面，单击对应主机所在的主机组。在“逻辑磁盘”区域单击
，配置swap分区，建议选择独立使用的卷组。
在“扩容存储”区域单击 ，提交修改。
步骤3 等待30分钟后，查看告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤4。
步骤4 将该主机上的部分虚拟机迁移到其他主机上，降低该主机内存复用率。
具体操作请参见《华为云Stack
8.1.0
运维指南》中的“迁移虚拟机”。
步骤5 等待告警是否自动清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.65 ALM-73019
主机进程数异常
告警解释
OpenStack按照60秒周期检测主机的系统进程数，当主机的系统进程数量大于等于告
警阈值（系统最大进程数的90%与/etc/sysmonitor/pscnt配置文件配置的告警值中的
最大值）时，系统产生此告警。当系统进程数小于恢复阈值（系统最大进程数的80%
与/etc/sysmonitor/pscnt配置文件配置的恢复值中的最大值）时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
73019
次要 是
1

## Page 269

告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
附加信息
●
异常信息：告警的异常信息。
●
主机 ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
主机IP：产生告警的主机OMIP。
对系统的影响
进程数过高，系统可能无法创建新的进程，从而影响服务运行或无法登录进行问题定
位处理。
可能原因
系统异常。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
1

## Page 270

步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 执行以下命令，查看当前系统中目前有多少个进程。
ps -xH | sed '1d' | wc -l
control-242:/home/fsp # ps -xH | sed '1d' | wc -l
1230
步骤9 执行以下命令，查看/etc/sysmonitor/pscnt配置文件中配置的告警上限。
cat /etc/sysmonitor/pscnt
control-242:/home/fsp # cat /etc/sysmonitor/pscnt
# number of processes(include threads) when alarm occur
ALARM="1600"
# number of processes(include threads) when alarm resume
RESUME="1500"
# monitor period(second)
PERIOD="60"
# process count usage alarm percent
ALARM_RATIO="90"
# process count usage resume percent
RESUME_RATIO="80"
步骤10 执行以下命令，查看当前系统的最大进程数（示例中为32768，不同的机器该值不
同）。
cat /proc/sys/kernel/pid_max
control-242:/home/fsp # cat /proc/sys/kernel/pid_max
98304
步骤11 确认当前系统进程个数是否已经超过了/etc/sysmonitor/pscnt配置文件中配置的告警
上限与系统最大进程数的90%中的最大值。
●
是，执行步骤12。
●
否，执行步骤15。
步骤12 执行以下命令，查看具体的进程。
ps -aux
control-242:/home/fsp # # ps -aux
USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND
root 1 1.4 0.0 184364 22268 ? Ss 14:41 1:53 /usr/lib/systemd/systemd --switched-root --
1

## Page 271

system --deserialize 18
root 2 0.0 0.0 0 0 ? S 14:41 0:00 [kthreadd]
root 3 0.0 0.0 0 0 ? I< 14:41 0:00 [rcu_gp]
root 4 0.0 0.0 0 0 ? I< 14:41 0:00 [rcu_par_gp]
root 6 0.0 0.0 0 0 ? I< 14:41 0:00 [kworker/0:0H-kblockd]
root 9 0.0 0.0 0 0 ? I< 14:41 0:00 [mm_percpu_wq]
步骤13 查看是否出现不需要的进程，或者重复的进程。
●
是，使用kill
-9
PID命令来将指定pid的进程杀死，或使用pkill xxname命令将指
定名字的进程杀死，或者使用killall xxname命令将所有的同名进程杀死。
其中，PID为步骤12中给出的进程PID号，xxname为步骤12中给出的
COMMAND。
● 否，或者用户无法判断识别异常进程，执行步骤15。
步骤14 待系统进程数满足告警恢复阈值后，等待1~2分钟，查看告警是否恢复。
●
是，处理完毕。
● 否，执行步骤15。
步骤15 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.66 ALM-73102
虚拟网络端口错包率超过告警阈值告警
告警解释
OpenStack按300秒周期检查虚拟网络端口（OVS端口和EVS端口）的错包率，当虚拟
网络端口的错包率大于等于告警阈值时，系统会产生此告警。
当虚拟网络端口的错包率小于5%时，系统会恢复此告警。
说明
系统默认的告警阈值如下：
●
重要：虚拟网络端口错包率≥10%
●
次要：5%≤虚拟网络端口错包率＜10%
告警属性
告警ID 告警级别 可自动清除
73102
重要/次要 是
1

## Page 272

告警参数
参数名称 参数含义
名称 告警的名称。
对象ID 产生告警对象的ID。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的ID，比如：主机ID。如果是业务模块产生的告
警，则表示的是业务模块的ID，比如：Openstack OM。
对象类型 产生告警的对象的类型，比如：host（代表主机），heart
beat（代表心跳检测系统）。
对象名称 产生告警的对象的名称。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的名称，比如：主机名。如果是业务模块产生的
告警，则表示的是业务模块的名称，比如：Openstack
OM。
部件类型 产生告警的部件的类型，比如：Openstack、Openstack
OM。
部件名称 产生告警的部件的名称。
定位信息 产生告警的对象的具体信息，一般用key=value,key=value
方式。比如：host=*****,portName=###，表示：****主机
上的###端口产生此告警。
附加信息 产生告警的一些扩展信息，一般用key=value,key=value方
式。比如：Threshold=70,current_value=75，标识产生告
警的原因是阈值为70，而当前值为75。
产生时间 告警产生的时间。
清除时间 告警清除的时间。
清除类型 告警清除的方式，告警清除的类型包括手工清除和自动清
除。
清除用户 手工清除告警的用户名称，自动清除告警时此参数为空。
清除用户ID 手工清除告警的用户ID，自动清除告警时此参数为空。
清除来源 手动清除告警时，清除告警的来源（租户侧视图或管理侧视
图）。
流水号 此条告警信息产生的顺序编号。
对系统的影响
可能会导致业务层丢包。
可能原因
OVS网桥上物理端口收到或发送错误报文。
1

## Page 273

前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 执行以下命令，查看虚拟网络监控告警日志，并通过搜索关键字段“vport
pkt error
overturn
happened”来获取错包率超过阈值的虚拟网络端口。
vim /var/log/sysmonitor/unetwork_alarm.log
步骤9 执行如下命令确认错包的端口是否存在。
ovs-vsctl list interface port_name
port_name为具体的端口名。
例如端口名为tap0，执行命令回显如下所示。
1

## Page 274

●
如果回显有类似如下内容的返回，说明端口存在，执行步骤10。
图1-10 端口存在
●
如果回显有类似如下内容的返回，说明端口不存在，请手动清除告警。
图1-11 端口不存在
步骤10 执行如下命令，返回端口的所属网桥。
ovs-vsctl iface-to-br port_name
例如端口名为tap0，执行命令后回显如下所示，表示端口tap0属于网桥br0。
图1-12 端口所属网桥
步骤11 判断网桥为内核态还是用户态。
假如端口属于网桥br0，执行如下命令，根据返回结果中的datapath_type字段，判断
网桥是内核态还是用户态。
ovs-vsctl list br br0
●
图1-13中datapath_type字段如果为dpdk，则该网桥为用户态网桥，执行步骤
13。
●
图1-13中datapath_type字段如果不是dpdk，则该网桥为内核态网桥，执行步骤
12。
1

## Page 275

图1-13 datapath_type字段
步骤12 如果是内核态网桥端口，使用tcpdump抓取端口的收发包，使用wireshark等网络分析
工具分析收发的数据包是否正常。
如果无法分析，请执行步骤14。
步骤13 如果是用户态网桥端口，执行EVS获取端口的收发数据包，分析数据包是否正常。
步骤14 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.67 ALM-73104 OVS/EVS
卡死
告警解释
当ovs-vswitchd进程存在但出现异常卡死的状态系统会上报此类告警。
告警属性
告警ID 告警级别 可自动清除
73104
重要 是
告警参数
参数名称 参数含义
名称 告警的名称。
1

## Page 276

参数名称 参数含义
对象ID 产生告警对象的ID。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的ID，比如：主机ID。如果是业务模块产生的告
警，则表示的是业务模块的ID，比如：Openstack OM。
对象类型 产生告警的对象的类型，比如：host（代表主机），heart
beat（代表心跳检测系统）。
对象名称 产生告警的对象的名称。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的名称，比如：主机名。如果是业务模块产生的
告警，则表示的是业务模块的名称，比如：Openstack
OM。
部件类型 产生告警的部件的类型，比如：Openstack、Openstack
OM。
部件名称 产生告警的部件的名称。
定位信息 产生告警的对象的具体信息，一般用key=value,key=value
方式。比如：host=*****,portName=###，表示：****主机
上的###端口产生此告警。
附加信息 产生告警的一些扩展信息，一般用key=value,key=value方
式。比如：Threshold=70,current_value=75，标识产生告
警的原因是阈值为70，而当前值为75。
产生时间 告警产生的时间。
清除时间 告警清除的时间。
清除类型 告警清除的方式，告警清除的类型包括手工清除和自动清
除。
清除用户 手工清除告警的用户名称，自动清除告警时此参数为空。
清除用户ID 手工清除告警的用户ID，自动清除告警时此参数为空。
清除来源 手动清除告警时，清除告警的来源（租户侧视图或管理侧视
图）。
流水号 此条告警信息产生的顺序编号。
对系统的影响
影响进程所在主机的软交换，导致数据面不通。
可能原因
系统异常、进程自身异常。
1

## Page 277

前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 执行如下命令查看ovs进程是否处于D状态或T状态。
cat /proc/`pidof ovs-vswitchd`/status | grep State
●
是，请使用"service
openvswitch
restart"命令重启ovs服务，再执行步骤9。
须知
重启openvswitch服务可能会造成系统已有业务中断。
1

## Page 278

●
否，执行步骤10。
步骤9 一段时间后告警是否恢复。
●
是，任务结束。
●
否，执行步骤10。
步骤10 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.68 ALM-73107
虚拟机发生反复重启故障
告警解释
当系统检测到单个虚拟机在10分钟内重启次数不小于5次时，系统产生此告警。
当单个虚拟机在5分钟内重启次数不大于1次时，清除告警。
告警属性
告警ID 告警级别 可自动清除
73107
紧急 是
告警参数
参数名称 参数含义
定位信息 虚拟机ID：产生告警的虚拟机ID。
附加信息
●
异常信息：产生告警的异常信息。
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名称。
●
虚拟机名：产生告警的虚拟机名称。
●
主机IP：产生告警的主机IP。
对系统的影响
影响该虚拟机上运行的业务。
1

## Page 279

可能原因
●
告警虚拟机所在的计算节点与存储平面网络链接断开。
●
虚拟机镜像损坏。
●
用户行为，频繁重启虚拟机。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 从告警的附加信息中，获取产生告警的主机IP、虚拟机名或虚拟机ID。
步骤2 通过ping命令检查告警服务器是否与存储面管理ip网络链接断开。
●
是，执行步骤3。
●
否，执行步骤5。
步骤3 参考ALM-6023 主机存储链路中断，修复计算节点与存储平面的网络链接。
步骤4 等待5分钟，告警是否清除。
●
是，任务结束。
●
否，执行步骤5。
步骤5 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤6 选择“服务列表
>
资源
>
计算资源
>
虚拟机”。
步骤7 单击“VNC登录”，通过vnc登录虚拟机，观察虚拟机是否蓝屏或者黑屏，出现蓝屏或
者黑屏说明该虚拟机镜像已损坏。
●
是，执行步骤16。
●
否，执行步骤8。
步骤8 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤9 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
1

## Page 280

步骤10 执行以下命令，防止系统超时退出。
TMOUT=0
步骤11 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤12 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤13 执行nova instance-action-list命令，获取虚拟机操作记录，查看是否是用户频繁重
启虚拟机。
●
是，执行步骤14。
●
否，服务器异常，执行步骤16。
步骤14 等待用户不再频繁重启虚拟机，执行步骤15。
步骤15 等待5分钟，确认告警是否自动消除。
●
是，任务结束。
●
否，执行步骤16。
步骤16 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.69 ALM-73108
虚拟机
Watchdog
异常告警
告警解释
当虚拟机Watchdog对应的IPMI模拟进程退出或进程状态异常时，系统产生此告警。
1

## Page 281

告警属性
告警ID 告警级别 可自动清除
73108
次要 是
告警参数
参数名称 参数含义
定位信息 虚拟机ID：异常虚拟机的UUID。
附加信息
●
异常信息：表示虚拟机异常的具体信息，包括虚拟机名
称和uuid。
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
虚拟机名：异常虚拟机在UVP层的名称。
●
主机IP：产生告警的主机IP。
对系统的影响
虚拟机内部卡死之后无法正常上报Watchdog超时事件。
可能原因
●
虚拟机开启Watchdog功能之后，对应的IPMI模拟进程退出。
●
虚拟机开启Watchdog功能之后，对应的IPMI模拟进程为T或者Z状态。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 获取告警附加信息中的主机IP。
步骤2 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2 使用PuTTY通过公私钥对认证方式登录节点。
步骤3 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
1

## Page 282

步骤4 执行如下命令，重启vBMC_agentd服务，等待10秒钟确认告警是否自动消除。
systemctl restart vBMC_agentd
●
是，执行完毕。
●
否，执行步骤5。
步骤5 执行如下命令，重启sysmonitor服务，等待10秒钟确认告警是否自动消除。
systemctl restart sysmonitor
●
是，执行完毕。
●
否，执行步骤6。
步骤6 执行如下命令，查看告警对应的虚拟机状态是否为Active。
nova_virsh_cmd virsh-instance-state VMName
其中VMName为告警对象ID，比如nova_virsh_cmd
virsh-instance-state
instance-00000050。
●
是，执行步骤7。
●
否，请手动清除告警。
步骤7 执行如下命令，关闭虚拟机。
nova_virsh_cmd virsh-instance-shutdown VMName
等命令返回success时，说明虚拟机关闭。
步骤8 执行如下命令，启动虚拟机。
virsh start VMName
等命令返回类似Domain
instance-00000126
started信息时，说明虚拟机启动。
步骤9 待虚拟机启动后等待10秒钟，确认告警是否自动消除。
●
是，处理完毕。
● 否，执行步骤10。
步骤10 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 283

1.2.1.70 ALM-73109 UVP
关键进程内存占用率超过阈值告警
告警解释
按5秒周期检测虚拟化关键进程内存使用值，当虚拟化关键进程内存使用值大于等于告
警设置的阈值，系统产生此告警。当虚拟化关键进程内存使用值小于恢复阈值时，告
警恢复。
告警属性
告警ID 告警级别 可自动清除
73109
次要 是
告警参数
参数名称 参数含义
名称 告警的名称。
对象ID 产生告警对象的ID。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的ID，比如：主机ID。如果是业务模块产生的告
警，则表示的是业务模块的ID，比如：Openstack OM。
对象类型 产生告警的对象的类型，比如：host（代表主机），heart
beat（代表心跳检测系统）。
对象名称 产生告警的对象的名称。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的名称，比如：主机名。如果是业务模块产生的
告警，则表示的是业务模块的名称，比如：Openstack
OM。
部件类型 产生告警的部件的类型，比如：Openstack、Openstack
OM。
部件名称 产生告警的部件的名称。
定位信息 产生告警的对象的具体信息，一般用key=value,key=value
方式。比如：host=*****,portName=###，表示：****主机
上的###端口产生此告警。
附加信息 产生告警的一些扩展信息，一般用key=value,key=value方
式。比如：Threshold=70,current_value=75，标识产生告
警的原因是阈值为70，而当前值为75。
产生时间 告警产生的时间。
清除时间 告警清除的时间。
清除类型 告警清除的方式，告警清除的类型包括手工清除和自动清
除。
1

## Page 284

参数名称 参数含义
清除用户 手工清除告警的用户名称，自动清除告警时此参数为空。
清除用户ID 手工清除告警的用户ID，自动清除告警时此参数为空。
清除来源 手动清除告警时，清除告警的来源（租户侧视图或管理侧视
图）。
流水号 此条告警信息产生的顺序编号。
对系统的影响
虚拟化平台可用内存减少，甚至内存不足。
可能原因
虚拟化管理进程内存泄露。
处理步骤
步骤1 通过告警对象确定异常进程名称。
●
如果进程名称为libvirtd、hirmd、vBMC_agentd、UVPHostd、virtlogd、
systemd-journal、dbus-daemon、rsyslogd、sysalarm、sysmonitor、
getosstat，请执行步骤2。
●
如果进程名称为systemd，请执行步骤3。
● 如果进程名称为ovs-vswitchd、ovsdb-server，请执行步骤4。
●
如果进程名称为虚拟机名称，请执行步骤5。
步骤2 通过PuTTY登录主机，并切换至root用户，执行如下命令，重启进程对应的服务（等待
30秒钟确认告警是否自动消除）。
systemctl restart ${SERVER_NAME}
说明
${SERVER_NAME}为进程对应的服务名称。
以下几个进程名称对应的${SERVER_NAME}需要重新指定：
● 进程systemd-journal对应的服务名为systemd-journald；
● 进程dbus-daemon对应服务名为dbus；
● 进程rsyslogd对应的服务名为rsyslog。
●
是，执行完毕。
●
否，请执行步骤6。
步骤3 通过PuTTY登录主机，并切换至root用户，执行如下命令，重新加载systemd（等待30
秒钟确认告警是否自动消除）。
systemctl daemon-reload
●
是，执行完毕。
●
否，请执行步骤6。
1

## Page 285

步骤4 执行uvplog
-o host -t
hyp命令，收集回显目录中日志，并请联系技术支持工程师协
助解决。
9D62E7B7-3E6E-9547-BC1C-DA663841C466:/home/fsp # uvplog -o host -t hyp
/var/log/os-log-all/
步骤5 收集/var/log/libvirt/目录下的日志，并请联系技术支持工程师协助解决。
步骤6 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.71 ALM-73110
虚拟网络关键资源不足
告警解释
当虚拟网络关键资源（软交换使用的内存、缓存、流表、MAC表）不足时，系统会上
报此告警。
告警属性
告警ID 告警级别 可自动清除
73110
重要 是
告警参数
参数名称 参数含义
名称 告警的名称。
对象ID 产生告警对象的ID。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的ID，比如：主机ID。如果是业务模块产生的告
警，则表示的是业务模块的ID，比如：Openstack OM。
对象类型 产生告警的对象的类型，比如：host（代表主机），heart
beat（代表心跳检测系统）。
对象名称 产生告警的对象的名称。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的名称，比如：主机名。如果是业务模块产生的
告警，则表示的是业务模块的名称，比如：Openstack
OM。
1

## Page 286

参数名称 参数含义
部件类型 产生告警的部件的类型，比如：Openstack、Openstack
OM。
部件名称 产生告警的部件的名称。
定位信息 产生告警的对象的具体信息，一般用key=value,key=value
方式。比如：host=*****,portName=###，表示：****主机
上的###端口产生此告警。
附加信息 产生告警的一些扩展信息，一般用key=value,key=value方
式。比如：Threshold=70,current_value=75，标识产生告
警的原因是阈值为70，而当前值为75。
产生时间 告警产生的时间。
清除时间 告警清除的时间。
清除类型 告警清除的方式，告警清除的类型包括手工清除和自动清
除。
清除用户 手工清除告警的用户名称，自动清除告警时此参数为空。
清除用户ID 手工清除告警的用户ID，自动清除告警时此参数为空。
清除来源 手动清除告警时，清除告警的来源（租户侧视图或管理侧视
图）。
流水号 此条告警信息产生的顺序编号。
对系统的影响
●
软交换数据面异常导致租户网络数据丢包 。
●
影响系统业务发放。
可能原因
●
如果使用EVS，配置的EVS内存大小不足。
●
业务发放超系统规模。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
1

## Page 287

步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 确认问题节点虚拟机数量是否超规格。
●
是，减少虚拟机数量，请根据实际情况进行删除或迁移操作。操作完成后，执行
步骤9。
●
否，请执行步骤10。
步骤9 确认告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤11。
步骤10 执行以下命令，查看回显信息中的“heap_totalsz_bytes
:
X”，确认X是否为0。
ovs-appctl vhostagent/memory-show
●
是，说明告警误报，无需处理。
●
否，执行步骤11。
步骤11 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 288

参考信息
无。
1.2.1.72 ALM-73111
主机连接跟踪表超过阈值告警
告警解释
主机服务能够接受的连接数是有限的，如果系统连接数高于系统设置的最大连接数后
会产生此告警。
告警属性
告警ID 告警级别 可自动清除
73111
次要 是
告警参数
参数名称 参数含义
名称 告警的名称。
对象ID 产生告警对象的ID。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的ID，比如：主机ID。如果是业务模块产生的告
警，则表示的是业务模块的ID，比如：Openstack OM。
对象类型 产生告警的对象的类型，比如：host（代表主机），heart
beat（代表心跳检测系统）。
对象名称 产生告警的对象的名称。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的名称，比如：主机名。如果是业务模块产生的
告警，则表示的是业务模块的名称，比如：Openstack
OM。
部件类型 产生告警的部件的类型，比如：Openstack、Openstack
OM。
部件名称 产生告警的部件的名称。
定位信息 产生告警的对象的具体信息，一般用key=value,key=value
方式。比如：host=*****,portName=###，表示：****主机
上的###端口产生此告警。
附加信息 产生告警的一些扩展信息，一般用key=value,key=value方
式。比如：Threshold=70,current_value=75，标识产生告
警的原因是阈值为70，而当前值为75。
产生时间 告警产生的时间。
清除时间 告警清除的时间。
1

## Page 289

参数名称 参数含义
清除类型 告警清除的方式，告警清除的类型包括手工清除和自动清
除。
清除用户 手工清除告警的用户名称，自动清除告警时此参数为空。
清除用户ID 手工清除告警的用户ID，自动清除告警时此参数为空。
清除来源 手动清除告警时，清除告警的来源（租户侧视图或管理侧视
图）。
流水号 此条告警信息产生的顺序编号。
对系统的影响
此告警产生时，系统实时连接数接近最大连接数，而还未到达上限，则对系统无影
响。如果连接数继续增加，达到上限，则主机无法继续接受新连接访问，用户数据面
和系统控制面会受影响。
可能原因
针对Linux连接跟踪表：
●
业务超系统规格。
●
系统遭受攻击。
处理步骤
步骤1 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤2 执行如下命令确认实时的连接跟踪总数（命令回显中标出的值）是否已达到系统设置
的最大值500W。
dev_connlimit get all
图1 命令回显
●
是，执行步骤3。
●
否，请手动清除告警。
1

## Page 290

步骤3 确认系统主机和虚拟机数量是否超规格。
●
是，请根据实际情况下电某些主机或者对虚拟机进行迁移或删除等操作，执行上
述操作直到当前连接跟踪数小于系统阈值500W(可通过步骤2的命令查询当前连接
跟踪数)，告警若仍未消除，执行步骤4。
●
否，执行步骤4。
步骤4 请联系华为技术支持处理。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.73 ALM-73112
虚拟机网卡异常
告警解释
系统周期性检测正在运行中虚拟机的网卡状态，当检测到虚拟机网卡异常时，系统产
生此告警。
告警属性
告警ID 告警级别 可自动清除
73112
次要 是
告警参数
参数名称 参数含义
定位信息
●
主机 ID：产生告警的虚拟机所在主机ID
●
虚拟机网卡：产生告警的虚拟机网卡名称
附加信息
●
异常信息：产生告警的虚拟机网卡异常信息
●
主机 ID：产生告警的虚拟机所在主机ID
● 主机名：产生告警的虚拟机所在主机名称
●
主机IP：产生告警的虚拟机所在主机IP
对系统的影响
虚拟机对应异常网卡的网络通信异常。
1

## Page 291

可能原因
●
误操作导致虚拟机网卡后端设备状态为down。
●
误操作导致虚拟机网卡后端设备被删除。
前提条件
● 已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤5 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤6 执行命令nova
list --all-t | grep
虚拟机ID，查看是否有回显。
说明
虚拟机ID：告警附加信息中UUID的取值。
1

## Page 292

●
是，执行步骤7。
●
否，查看页面告警列表是否存在1.2.1.28
ALM-70100
虚拟机审计告警。
–
是，参考1.2.1.28
ALM-70100
虚拟机审计告警处理完成后，执行步骤8。
–
否，执行步骤9。
步骤7 执行命令nova
live-migration
虚拟机ID 主机ID，将该虚拟机迁移到其他主机上。
说明
主机ID： 一个可用的主机ID，此主机的资源需要满足该虚拟机的规格。注意该主机ID并不是告
警详情中的主机ID，具体获取方式如下。
1.
执行命令cps host-list，获取所有的主机ID。
2.
执行命令nova
hypervisor-show
主机ID，确认该主机资源是否满足。
步骤8 等待3分钟~5分钟，查看告警是否自动清除。
●
是，任务结束。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.74 ALM-73201 HAProxy
代理服务不可用
告警解释
HAProxy每60s对后端代理服务进程心跳检测，返回失败，系统产生报警，提示对应服
务不可用。
告警属性
告警ID 告警级别 可自动清除
73201
重要 是
告警参数
参数名称 参数含义
定位信息
●
服务故障：HAProxy
Backend Services Fault
●
云服务：服务类型，固定值为VPC
1

## Page 293

参数名称 参数含义
附加信息 服务名：产生告警的服务名称
对系统的影响
HAProxy代理的后端服务不可用，对应服务的功能不可用。
可能原因
●
后端服务进程异常。
●
后端服务网络中断。
处理步骤
步骤1 先检查是否有如下故障，如果有，请先排查如下故障：
1.2.1.76 ALM-73203
组件故障
步骤2 查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤3。
步骤3 登录FusionSphere OpenStack控制节点，具体请参见3.5 使用PuTTY登录
FusionSphere
OpenStack节点。
步骤4 获取告警附加信息中的“服务名”，执行以下命令，获取服务的任意一个URL。
openstack endpoint list|grep
服务名
| 7d78994bf9a44254a5d6c0b969b72a8d | az0.dc0 | fusionnetwork | oam | True | public | https://
oam.az0.dc0.domainname.com:443 |
| 2bac8194206745b8b7f234d596db45eb | az0.dc0 | fusionnetwork | oam | True | admin | https://
oam.az0.dc0.domainname.com:443 |
| 77f9847477b24b0fab319f945e4b7249 | az0.dc0 | fusionnetwork | oam | True |internal | https://
oam.localdomain.com:8200 |
步骤5 执行以下命令，查看请求返回码是否为500、502、503。
curl -ik -X GET
服务URL
●
是，说明服务有异常，执行步骤6。
●
否，执行步骤7。
步骤6 重启组件所有实例。
1.
执行以下命令，停止组件。
cps host-template-instance-operate --service
服务 组件
--action stop
服务和组件的取值，请根据告警附加信息中的“服务名”，并参考表1-43获取。
1

## Page 294

表1-43 服务、组件参数取值对应关系
服务名（告警附加信息中获
取）
服务 组件
image glance glance
nova-novncproxy nova nova-novncproxy
network neutron neutron-server
oam fusionnetwork oam-network-server
object-store swift swift-proxy
backup-package backup backup-server
volume cinder cinder-volume
identity keystone keystone
log log log-server
cps cps cps-server
compute nova nova-api
info-collect collect info-collect-server
upg upg upg-server
backup backup backup-server
drextend drextend drextend-api
baremetal-consoleproxy nova ironic-console-proxy
2.
执行以下命令，查询状态。
cps template-instance-list --service
服务 组件
status为fault后，再执行6.3。
3.
执行以下命令，启动组件。
cps host-template-instance-operate --service
服务 组件
--action start
4.
执行以下命令，查询状态。
cps template-instance-list --service
服务 组件
查看组件状态是否变为active、standby。
–
是，查看告警是否清除。
▪
是，处理完毕。
▪
否，执行步骤7。
–
否，执行步骤7。
步骤7 请联系技术支持工程师协助解决。
----结束
1

## Page 295

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.75 ALM-73202
管理节点发生主备倒换
告警解释
服务的主备状态发生变化，由备变成主的时候产生此告警。
告警属性
告警ID 告警级别 可自动清除
73202
提示 否
告警参数
参数名称 参数含义
定位信息
●
服务名：产生告警的服务名。
●
主机ID：产生告警的主机ID。
附加信息
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
倒换时间：产生告警的时间。
对系统的影响
此告警只是用于记录服务由备转化成主的告警，用于提示用户。
可能原因
●
主服务故障，触发备服务升主。
●
维护命令停止了主服务，触发备服务升主。
●
主服务所在节点故障，触发备服务升主。
处理步骤
此告警只是用于记录服务由备转化成主，用于提示用户，一般手动清除即可，不需再
做额外操作。
1

## Page 296

说明
如需排查处理触发事件的原因，请先排查是否上报如下故障：1.2.1.6
ALM-6017
主机状态异常
或1.2.1.76
ALM-73203
组件故障，或者是否用户手动触发命令停止主服务，如果非以上问题，
请联系技术支持工程师协助解决。
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
参考信息
无。
1.2.1.76 ALM-73203
组件故障
告警解释
OpenStack周期（默认为90s）检查每台主机上的组件状态，如果该主机存在状态不正
常的组件，产生此告警。如果在主机改造或者配置变更过程中上报此告警且很快告警
自动恢复，可以忽略。
告警属性
告警ID 告警级别 可自动清除
73203
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
主机ID：产生告警的主机ID。
附加信息
●
详细信息：
– component
fault：组件故障。
–
host：产生告警的主机ID。
–
components：产生告警的组件名称。
● 主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
对系统的影响
如果主机上存在状态不正常的组件，则该主机不能正常的承载业务。
1

## Page 297

可能原因
●
系统资源不够，导致组件进程退出。
●
组件内部故障，组件无法工作。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 检查是否有如下告警上报。
是，请根据告警对应的参考章节处理，全部处理完成后，执行步骤2。否则，执行步骤
3。
● 1.2.1.2 ALM-6010
NTP服务器与外部时钟源时间差超过阈值
● 1.2.1.4 ALM-6015 NTP服务器与外部时钟源网络故障或外部时钟源故障
● 1.2.1.6 ALM-6017
主机状态异常
● 1.2.1.11 ALM-6022
主机与NTP服务器心跳状态异常
● 1.2.1.17 ALM-6028
本地NTP客户端与本地NTP服务器时间差超过60秒
● 1.2.1.56 ALM-73010
文件系统故障告警
● 1.2.1.84 ALM-73401
rabbitmq服务故障
步骤2 等待5分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤3。
步骤3 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
检查系统资源
步骤5 执行以下命令，查看是否系统资源不够。
grep -i 'out of memory' /var/log/messages |grep -v grep
回显如下所示：
1

## Page 298

2019-01-03T21:09:41.543181+08:00|err|kernel[-]|[63624.912407] Memory cgroup out of memory: Kill
process 26511 (java) score 51 or sacrifice child
查看回显结果是否包含out of memory：
●
是 ，则表明系统资源不够，执行步骤8。
●
否，执行步骤6。
检查组件内部故障
步骤6 根据告警附加信息中的components参数获取到当前故障的组件名称，查看是否包含在
如下组件中。
是，参考如下故障处理方法处理完成后，执行步骤7。否则，执行步骤8。
●
gaussdb组件故障处理方法：1.2.3.1.11 gaussdb组件故障处理
●
keystone组件故障处理方法：1.2.3.1.12 keystone组件故障处理
●
rabbitmq组件故障处理方法：1.2.3.1.13 rabbitmq组件故障处理
●
nova-compute组件故障处理方法：1.2.3.1.2 nova-compute组件故障处理
●
nova-api组件故障处理方法：1.2.3.1.3 nova-api组件故障处理
●
nova-scheduler组件故障处理方法：1.2.3.1.4 nova-scheduler组件故障处理
● nova-conductor组件故障处理方法：1.2.3.1.5 nova-conductor组件故障处理
●
vmware-nova-compute组件故障处理方法：1.2.3.1.6
vmware-nova-compute
组件故障处理
●
memcache组件故障处理方法：1.2.3.1.7 memcache组件故障处理
●
cinder-volume组件故障处理方法：1.2.3.1.8 cinder-volume组件故障处理
●
nova-compute-ironic组件故障处理方法：1.2.3.1.9 nova-compute-ironic组件故
障处理
●
glance组件故障处理方法：1.2.3.1.10 glance组件故障处理
●
neutron-server组件故障处理方法：1.2.3.1.14 neutron-server组件故障处理
●
neutron-l3-service-agent组件故障处理方法：1.2.3.1.15
neutron-l3-service-
agent组件故障处理
●
neutron-vrouter组件故障处理方法：1.2.3.1.16 neutron-vrouter组件故障处理
●
neutron-l3-nat-agent组件故障处理方法：1.2.3.1.18 neutron-l3-nat-agent组件
故障处理
●
neutron-cascading-proxy组件故障处理方法：1.2.3.1.19
neutron-cascading-
proxy组件故障处理
●
neutron-openvswitch-agent组件故障处理方法：1.2.3.1.20
neutron-
openvswitch-agent组件故障处理
●
neutron-garbage-collector组件故障处理方法：1.2.3.1.21
neutron-garbage-
collector组件故障处理
● neutron-dvr-compute-agent组件故障处理方法：1.2.3.1.22 neutron-dvr-
compute-agent组件故障处理
●
neutron-dhcp-agent组件故障处理方法：1.2.3.1.23 neutron-dhcp-agent组件故
障处理
●
neutron-metadata-agent组件故障处理方法：1.2.3.1.24
neutron-metadata-
agent组件故障处理
1

## Page 299

●
neutron-sriov-nic-agent组件故障处理方法：1.2.3.1.34
neutron-sriov-nic-
agent组件故障处理
●
neutron-evs-agent组件故障处理方法：1.2.3.1.35 neutron-evs-agent组件故障
处理
●
neutron-vc-vswitch-agent组件故障处理方法：1.2.3.1.25
neutron-vc-vswitch-
agent组件故障处理
●
neutron-l3-agent组件故障处理方法：1.2.3.1.27 neutron-l3-agent组件故障处
理
●
neutron-ipv6-vrouter组件故障处理：1.2.3.1.17 neutron-ipv6-vrouter组件故障
处理
●
neutron-elb-proxy组件故障处理：1.2.3.1.26 neutron-elb-proxy组件故障处理
●
neutron-nat-gw-dataplane组件故障处理：1.2.3.1.28
neutron-nat-gw-
dataplane组件故障处理
● neutron-nat-gw-data-agent组件故障处理：1.2.3.1.29 neutron-nat-gw-data-
agent组件故障处理
●
neutron-ipv6-service-agent组件故障处理：1.2.3.1.30
neutron-ipv6-service-
agent组件故障处理
●
neutron-ngfw-agent组件故障处理：1.2.3.1.31 neutron-ngfw-agent组件故障
处理
●
neutron-fw-proxy组件故障处理：1.2.3.1.32 neutron-fw-proxy组件故障处理
●
neutron-ngfw-vpn-agent组件故障处理：1.2.3.1.33
neutron-ngfw-vpn-agent
组件故障处理
●
ceilometer-agent-compute组件故障处理方法：1.2.3.1.36
ceilometer-agent-
compute组件故障处理
●
ceilometer-agent-hardware组件故障处理方法：1.2.3.1.37
ceilometer-agent-
hardware组件故障处理
●
ceilometer-collector组件故障处理方法：1.2.3.1.38 ceilometer-collector组件故
障处理
●
ce1800v组件故障处理方法：1.2.3.1.39 ce1800v组件故障处理
●
pecado-controller组件故障处理方法：1.2.3.1.40 pecado-controller组件故障处
理
●
redis组件故障处理方法：1.2.3.1.41 redis组件故障处理
●
device-manager组件故障处理方法：1.2.3.1.42 device-manager组件故障处理
●
bgp-broker组件故障处理方法：1.2.3.1.43 bgp-broker组件故障处理
●
neutron-bm-switch-agent组件故障处理方法：1.2.3.1.44
neutron-bm-switch-
agent组件故障处理
步骤7 等待5分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤8。
步骤8 收集信息，并联系技术支持工程师协助解决。
1

## Page 300

说明
收集信息的方式如下：
1.
在ManageOne运维面，选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”界
面。
2.
查找此告警，并展开此告警信息，单击“告警帮助”选项卡，再单击“告警帮助辅助处理工
具”的链接，进入链接后收集信息。
收集信息时，参考如下说明，配置参数信息：
–
csn：自动获取流水号。
–
password：输入dc_admin密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
–
start_time和end_time：非必选参数，如果不填写或者填写的时间区间小于1小时，则
默认收集最近1天的日志，如果填写的时间区间大于等于1小时，则按照填写的时间段
收集。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.77 ALM-73204
主机版本不一致告警
告警解释
OpenStack周期（默认为300s）检查每台主机版本状态，如果该主机版本与系统版本
不一致，产生此告警。
说明
主机版本不一致包括主机所安装的系统的内部版本号，以及PXE安装主机时为主机设置的系统时
间戳。
因此，即使两套系统使用同一个内部版本号的系统安装了主机，主机也不能在两套系统之间随意
混用。
告警属性
告警ID 告警级别 可自动清除
73204
重要 不同场景不同，删除节点
场景需要手动清除
1

## Page 301

告警参数
参数名称 参数含义
定位信息 产生告警的主机ID。
附加信息
●
第一个参数：
–
alarmInfo：告警详情。
–
hostosversion：产生告警的主机的os版本。
–
hosttimetag：产生告警的主机时间戳。
–
sysosversion：产生告警的主机上系统的os版本。
–
systimetag：产生告警的主机上系统的时间戳。
●
第二个参数：产生告警的主机ID。
●
第三个参数：产生告警的主机名。
对系统的影响
主机版本不一致可能导致主机故障，进而导致组件异常。
可能原因
●
其他环境主机连入此环境。
●
非首节点的主机在PXE安装未成功时，重启了该主机，并且主机之前安装过其他版
本的OpenStack主机操作系统。
●
部分主机处于下电或故障状态时，对系统进行了升级或安装了补丁。
处理步骤
步骤1 先检查是否其他环境主机连入此环境。
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
在“概要”页面，查看是否存在“误接入的主机”列表。
–
是，执行步骤2。
–
否，执行步骤3，排查下一个可能原因。
步骤2 删除误接入的主机，具体请参照2.4.1.2.7 AZ内误接入主机的处理方法章节。
手动清除告警，处理完毕。
步骤3 排查是否非首节点的主机在PXE安装未成功时，重启了该主机，并且主机之前安装过其
他版本的OpenStack主机操作系统。
根据环境规划信息判断该主机是否规划内主机。
●
是，执行步骤4。
●
否，执行步骤5，排查下一个可能原因。
1

## Page 302

步骤4 重新通过PXE安装该主机即可。主机安装成功后，告警自动清除。
处理完毕。
步骤5 排查是否部分主机处于下电或故障状态时，对系统进行了升级或安装了补丁。
●
是，执行步骤6。
●
否，执行步骤7。
步骤6 按主机状态选择处理方法。
●
主机未故障可继续使用，迁移该主机上的虚拟机到其他主机，具体操作请参见
《华为云Stack
8.1.0
运维指南》中的“异地重建虚拟机”。可重新参考《华为云
Stack 8.1.0
软件安装指南》中“手动PXE方式安装主机”安装主机。主机安装成
功后，告警自动清除。
●
主机故障，请参照《华为云Stack
8.1.0
运维指南》中“更换主机”更换主机。更
换成功后，然后手动清除告警。
处理完毕。
步骤7 如果存在其他问题无法处理，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.78 ALM-73205 Iaas
层资源配置不一致告警
告警解释
用户在进行Iaas层的资源隔离或者角色配置后，如果主机节点上的资源配置不生效，
产生此告警。
告警属性
告警ID 告警级别 可自动清除
73205 重要 是
告警参数
参数名称 参数含义
定位信息 主机名：产生告警的主机名称。
1

## Page 303

参数名称 参数含义
附加信息
●
第一个参数：产生告警的主机ID。
●
第二个参数：产生告警的主机名。
●
第三个参数：资源配置不一样故障详情。
对系统的影响
主机上资源配置和生效不一致。
可能原因
主机上存在野虚拟机。
处理步骤
步骤1 根据当前环境部署的场景，获取对应的“手动审计”章节，重新触发系统审计。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》的“手动审计”章节。
步骤2 参考“收集审计报告”章节，获取野虚拟机审计报告。
从审计报告中获取uuid、hyper_vm_name、host_id。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》的“收集审计报告”章节。
步骤3 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤4 选择“集中监控
>
告警管理
>
当前告警”，查看“Iaas层资源配置不一致告警”的告
警信息，获取告警对象host_id。
步骤5 参考“处理野虚拟机”章节，清理系统中的野虚拟机。
●
KVM虚拟化：参考《华为云Stack
8.1.0
产品文档》的“虚拟机审计”章节。
步骤6 清理完野虚拟机之后，执行以下命令。
cps commit
步骤7 在ManageOne运维面的“集中监控
>
告警管理
>
当前告警”界面，查看“Iaas层资
源配置不一致告警”的告警是否被清除。
●
是，告警处理结束。
●
否，请联系技术支持工程师协助解决。
----结束
1

## Page 304

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.79 ALM-73207
主机名重复
告警解释
告警采集模块监控（600s检查周期）发现系统中主机的主机名重复时，系统产生此告
警。
告警属性
告警ID 告警级别 可自动清除
73207
次要 是
告警参数
参数名称 参数含义
定位信息 主机 ID：产生告警的主机ID。
附加信息
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
重复主机ID列表：重复的主机名列表。
对系统的影响
此告警产生时，不会导致系统异常，主机名重复影响用户体验。
可能原因
镜像安装设置相同主机名。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 进入“概要”界面，双击想要修改的重复的主机名，进行修改。
步骤3 等待10~20分钟后，告警是否清除：
1

## Page 305

●
是，告警处理结束。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.80 ALM-73208
对接外部仲裁服务异常
告警解释
当管理面双活配置中的仲裁服务异常时，发出告警。
告警属性
告警ID 告警级别 可自动清除
73208
重要 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
附加信息
●
主机名：产生告警的主机名。
●
本端地址：告警发送节点的地址。
●
对端地址：产生告警的主机地址。
●
错误信息：告警相关的错误信息。
对系统的影响
仲裁服务不可用，本站点配对的zookeeper会自动停止服务。
如果还有其他节点的zookeeper服务故障，会导致zookeeper断链，继而引发整体服务
不可用。
可能原因
●
仲裁服务参数有误。附加信息为“params_error”。
●
仲裁服务有一半（含）以上不可连通。附加信息为失效的服务器IP地址。
1

## Page 306

前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 检查仲裁服务器的参数配置是否有误。
1.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
–
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
– External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP
参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，
在对应节点下该帐户的默认密码。
2.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
3.
执行以下命令，防止系统超时退出。
TMOUT=0
4.
执行以下命令，导入环境变量。具体操作请参见3.1 导入环境变量，使用CPS鉴权
方式。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
5.
执行以下命令，获取仲裁服务器对应的规则组名；
cps hostcfg-list --type site
回显如下类似信息：
056919C0-3730-11E5-807B-027C1B9697E0:/home/fsp # cps hostcfg-list --type site
+------+---------+---------------------------------------------+------------------+
| type | name | hosts | metadata |
+------+---------+---------------------------------------------+------------------+
| site | default | hostid: | |
| | | | |
| site | dc001 | hostid:056919C0-3730-11E5-807B-027C1B9697E0 | grouptype:compute, |
| | | | cpufamily:x86_64 |
| | | | |
| site | dc002 | hostid:CCD8C060-360D-11E5-9941-167D1B9697E0 | grouptype:compute, |
| | | | cpufamily:x86_64 |
| | | | |
+------+---------+---------------------------------------------+------------------+
6.
执行以下命令，获取仲裁服务器配置的参数，检查该参数是否与实际规划的参数
一致。
cps hostcfg-show --type site site_rule_name
1

## Page 307

site_rule_name为步骤1.5中获取的规则组名。
–
是，执行步骤2。
–
否，重新配置FusionSphere OpenStack对接仲裁服务。
步骤2 检查是否存在如下告警，如果有，请先根据对应告警的处理指导消除告警。
● ALM-2000266
节点系统时钟跳变超过一分钟
● ALM-2001106
Etcd服务状态异常
● ALM-2002101
Monitor进程异常
● ALM-2002302
Monitor与对端站点通信异常
● ALM-2002501
站点网络状态异常
● ALM-2001107
第三方站点异常
步骤3 检查仲裁服务是否失效，执行以下操作。
●
登录仲裁服务虚拟机，检查仲裁服务是否正常。
a.
根据 步骤1.6FusionSphere OpenStack对接仲裁服务ip，登录云平台仲裁服
务节点。
使用PuTTY工具，以“arbiter”用户登录节点。
执行如下命令，并按提示输入“root”用户的密码，切换到“root”用户。
sudo su - root
执行以下命令，防止PuTTY超时退出。
TMOUT=0
b.
检查仲裁服务是否正常。
执行以下命令，检查仲裁服务是否正常。
systemctl status arbitration-etcd
回显如下，仲裁服务正常运行，若非正常，执行步骤5。
[arbiter@ASVM01 ~]$ systemctl status arbitration-etcd
arbitration-etcd.service - ArbitrationService etcd daemon
Loaded: loaded (/usr/lib/systemd/system/arbitration-etcd.service; enabled)
Active: active (running) since Fri 2018-04-13 21:47:40 CST; 3 days ago
Process: 6791 ExecStop=/bin/sh /opt/arbitration-etcd/script/service.sh stop (code=exited,
status=0/SUCCESS)
Process: 6850 ExecStart=/bin/sh /opt/arbitration-etcd/script/service.sh start (code=exited,
status=0/SUCCESS)
Main PID: 6985 (etcd)
CGroup: /system.slice/arbitration-etcd.service
6985 /opt/arbitration-etcd/foss/2.2.4/etcd -name arbitration-etcd1 -data-dir /opt/arbitration-
etcd/arbitration-etcd1 -cert-file=/opt/arbitration-etcd/keystore/server.crt -key-file=/opt/arbitr...
● 登录OpenStack控制节点，检查告警主机与仲裁服务虚拟机的连通情况。
a. 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
1

## Page 308

说明
▪
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请
参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
▪
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD
Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工
具生成的IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP
地址。
▪
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
b.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
c.
执行以下命令，防止系统超时退出。
TMOUT=0
d.
执行以下命令，导入环境变量。具体操作请参见3.1 导入环境变量，使用CPS
鉴权方式。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
e.
执行以下命令，检查告警主机与仲裁服务虚拟机的连通情况。
cps-etcdCheck
回显如下，即表示情况正常。若非正常，执行步骤5。
slot4:/opt/arbitration-etcd/foss/2.2.4 # cps-etcdCheck
============ read etcd configuer ============
total etcd servers is 1
ip is: 172.28.0.2
============ 1. checking etcd health ============
result: healthy etcd server num is 1
check healthy passed!
============2. checking read value ============
result: read from etcd succ!
dc001 = ok
dc002 = ok
all status = ok read value passed!
====================================
all tests passed!
步骤4 查看告警是否恢复。
●
是，告警处理结束。
●
否，执行步骤5。
步骤5 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 309

参考信息
无。
1.2.1.81 ALM-73209 zookeeper
健康检查告警
告警解释
Openstack周期（默认为24小时）检查所有zookeeper的数据是否一致，如果存在不一
致的数据，产生该告警。
告警属性
告警ID 告警级别 可自动清除
73209
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的服务名称。
附加信息
●
故障zookeeper的ip列表：产生告警的zookeeper的ip列
表。
●
详细信息：
– XX has diff data with leader XX :
zookeeper的数据
不一致。
– XX has diff path with leader XX
：zookeeper的路径
数据不一致。
对系统的影响
生效的配置数据与用户的预期不一致。
可能原因
双活容灾场景出现过主站点网络隔离。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
1

## Page 310

处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 执行以下命令，导入环境变量。具体操作请参见3.1 导入环境变量，使用CPS鉴权方
式。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤5 执行如下命令cps zookeeper-data-check，查看命令查询结果。
● 回显如下所示：
+------------+--------------------------+
| result | data |
+------------+--------------------------+
| consistent | diff_data:{}, |
| | diff_path:{}, |
| | leader:[u'172.28.8.123'] |
+------------+--------------------------+
查看回显结果是否包含consistent ：
●
是 ，则表明则说明zookeeper数据是一致的，可手动消除该告警或者待下次告警
检查周期，告警会自动消除。
●
否，执行步骤6。
步骤6 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
1

## Page 311

参考信息
无。
1.2.1.82 ALM-73210
未配置管理数据备份至第三方服务器
告警解释
如果备份服务的备份策略中未配置第三方备份服务器，则上报该告警。
告警属性
告警ID 告警级别 可自动清除
73210
紧急 是
告警参数
参数名称 参数含义
定位信息 云服务：产生告警的云服务。
附加信息 云服务：产生告警的云服务。
对系统的影响
系统无法完成远端备份。若控制节点备份分区故障，本地备份包将丢失，系统将无法
通过备份包进行恢复。
可能原因
未配置第三方备份服务器。
处理步骤
步骤1 参考《华为云Stack
8.1.0
运维指南》“备份数据
>
备份管理”，配置第三方备份服务
器。配置完成后观察告警是否自动清除。
●
是，处理完毕。
●
否，等待30分钟，如果告警没有自动清除，请联系技术支持工程师协助解决。
说明
多region场景，请分别配置每个region的备份服务器。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 312

参考信息
无。
1.2.1.83 ALM-73302
存在网络未配置
VLAN
探测平面
告警解释
目前版本通过VLAN探测平面保证HA虚拟机可靠性，在不配置时虚拟机触发HA可能存
在脑裂风险。
告警属性
告警ID 告警级别 可自动清除
73302
次要 是
告警参数
参数名称 参数含义
定位信息
●
物理网络平面：产生告警的物理网络平面
● 云服务：产生告警的云服务
●
服务：产生告警的服务
附加信息 异常信息：告警的异常信息
对系统的影响
使用该网络的虚拟机在HA时存在脑裂风险。
可能原因
●
虚拟机使用了未配置HA探测VLAN的物理网络，在HA过程中存在脑裂风险。
●
物理网络平面配置探测VLAN后，在主机上创建对应端口时出现异常。
处理步骤
步骤1 按照告警的详细信息，获取“物理网络平面”参数值。
步骤2 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤3 依次进入“配置
>
网络
>
物理网络配置”，查看告警信息中的物理网络是否配置了探
测VLAN。
●
是，执行步骤7。
1

## Page 313

●
否，执行步骤4。
步骤4 现网网络规划该网络是否需要配置探测VLAN。
●
是，执行步骤5。
●
否，单击对应行修改图标弹出修改物理网络窗口，勾选“探测VLAN未配置不产生
告警”后提交。然后执行步骤6。
步骤5 请参考《华为云Stack
8.1.0
运维指南》“手动调整物理网络平面映射关系”章节中
“配置管理与业务网络平面”部分，配置探测VLAN。
配置是否成功。
●
执行成功，执行步骤6。
●
执行失败，执行步骤7。
步骤6 等待5分钟，查看告警是否被自动清除。
● 是，处理完毕。
●
否，执行步骤7。
步骤7 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.84 ALM-73401 rabbitmq
服务故障
告警解释
rabbitmq进程可以运行，但内部出现了异常，不能正常对外提供服务或者某个队列连
续三次发送消息失败。
说明
紧急：rabbitmq进程可以运行，但内部出现了异常，不能正常对外提供服务。
重要：某个队列连续三次发送消息失败。
告警属性
告警ID 告警级别 可自动清除
73401
紧急/重要 紧急可自动清除，重要需
要手动清除
1

## Page 314

告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的组件名称。
●
实例名：产生告警的服务所在的实例名。
附加信息
●
主机名：产生告警的主机名。
●
主机ID：产生告警的主机ID。
●
详情：告警的详细信息。
对系统的影响
此告警产生，部分业务将无法收发消息，进而造成业务无法正常进行。
可能原因
●
主备rabbitmq节点在相近时刻发生了多次重启。
●
网络频繁重连导致某一队列发送消息失败。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 请先排查是否存在1.2.1.129
ALM-1507002
RabbitMQ资源使用率超过阈值告警。
●
是，请参考1.2.1.129
ALM-1507002
RabbitMQ资源使用率超过阈值章节处理，
执行步骤2。
●
否，执行步骤8。
步骤2 查看告警级别，选择对应的处理方式。
●
如果是紧急告警，等待10分钟，查看告警是否清除。
–
是，处理完毕。
–
否，执行步骤3。
●
如果是重要告警，手动清除该告警，并等待10分钟，查看告警是否重新上报。
–
是，执行步骤3。
–
否，处理完毕。
步骤3 查看告警参数中附加信息是否存在以下信息“Failed to publish message to topic
XXX”，其中XXX为rabbitmq消息队列名。
●
是，记录告警参数中定位信息的内容，如happen
on
(['xxx.xxx.xxx.xxx'])，其中
xxx.xxx.xxx.xxx为rabbitmq节点ip，然后执行步骤4。
1

## Page 315

●
否，执行步骤8。
步骤4 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤5 执行以下命令，跳转到rabbitmq所在节点。
ssh
fsp@xxx.xxx.xxx.xxx，其中xxx.xxx.xxx.xxx为步骤3中获取的rabbitmq的ip。
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤7 查询可疑进程数量。
执行命令：/usr/local/lib/rabbitmq/sbin/rabbitmqctl
eval
'rabbit_diagnostics:maybe_stuck().' |grep
XXX，其中XXX为步骤3中rabbitmq消息
队列名。并查看返回结果。
回显如下类似信息：
<<"q-agent-notifier-update_fanout_af5c781c060d4c2dbcd16abbf38857c4">>}}},
●
如果回显中出现XXX队列名，执行步骤15。
●
如果查询无结果，执行步骤8。
步骤8 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤9 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤10 执行以下命令，防止系统超时退出。
TMOUT=0
步骤11 导入环境变量，具体操作请参见3.1 导入环境变量
1

## Page 316

步骤12 获取组件信息。
●
如果在告警台出现该告警。可在告警信息的附加信息中，获取发生故障的主机名
称。例如主机名=XXX。
● 如果在FusionSphere OpenStack安装部署界面，执行“运维 > 系统检查”时，在
检查rabbitmq服务状态的结果中提示参见该文档。可在检查结果中获取发生故障
的主机名字。例如‘location’:{‘XXX’}，则主机名为XXX。
运行命令：cps
host-template-instance-list XXX | grep rabbitmq
从执行结果
中得到AAA.BBB的组件信息，例如rabbitmq.rabbitmq。
步骤13 查询可疑进程数量。
重复执行步骤8~步骤10，登录到步骤12中查询到的主机。
执行命令：/usr/local/lib/rabbitmq/sbin/rabbitmqctl
eval
'rabbit_diagnostics:maybe_stuck().'，并查看返回结果。
回显如下类似信息：
There are 1122 processes.
Investigated 0 processes this round, 5000ms
to go.
……
Investigated 0 processes this round, 500ms
to go.
Found 0 suspicious processes.
ok
●
如果回显中出现类似"Found
XXX suspicious
processes."的提示信息，请重复执行
该命令3次，查看是否每次都能出现该提示信息。
–
是，执行步骤14。
–
否，执行步骤15。
●
如果命令超过1分钟未执行完成或者回显中未出现类似"Found
XXX suspicious
processes."的提示信息，请执行步骤15。
步骤14 查看告警级别，选择对应的处理方式。
● 如果是紧急告警，等待10分钟，查看告警是否清除。
–
是，处理完毕。
–
否，执行步骤15。
●
如果是重要告警，手动清除该告警，并等待10分钟，查看告警是否重新上报。
–
是，执行步骤15。
– 否，处理完毕。
步骤15 请联系技术支持工程师协助解决。
----结束
告警清除
不涉及。
参考信息
无。
1

## Page 317

1.2.1.85 ALM-73403 gaussdb
主备数据不同步
告警解释
gaussdb主备机间会周期性（1min）检查数据同步状态，如果连续3min数据不能正常
同步，产生此告警。同步状态正常，告警消除。
告警属性
告警ID 告警级别 可自动清除
73403
紧急 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的组件名称。
附加信息
●
详细信息：sync_abnormal
●
本端地址：本端同步IP地址
●
对端地址：对端同步IP地址
对系统的影响
此告警产生，gaussdb数据不能进行同步，进而造成数据丢失。
可能原因
●
数据库所在主机下电。
●
使用非正常数据库的启停命令操作数据库。
●
网络故障。
●
备节点gaussdb分区占满。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 通过告警的定位信息，获取产生告警的组件名，定位信息中的服务即为组件名。
步骤2 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
1

## Page 318

说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤4 执行以下命令，防止系统超时退出。
TMOUT=0
步骤5 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤6 输入“2”，选择使用CPS鉴权，按照提示输入“CPS_USERNAME”的用户名和密码。
用户帐户：cps_admin
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“cps_admin”帐户对应的默认密码。
检查数据库所在主机是否被下电及网络是否正常
步骤7 执行以下命令，获取产生告警的服务名。
cps template-list | grep
组件名
5F0B42C1-EFD0-C685-E811-16AD2A2D1793:/home/fsp # cps template-list | grep gaussdb
| gaussdb_keystone | gaussdb_keystone | DataBase for Keystone service. |
| gaussdb_cinder | gaussdb_cinder | DataBase for Cinder service. |
| gaussdb_nova | gaussdb_nova | DataBase for Nova service. |
| gaussdb_neutron | gaussdb_neutron | DataBase for Neutron service. |
| gaussdb | gaussdb | DataBase for OpenStack service. |
说明
如上方回显为例，第一列为服务名，第二列为组件名，根据组件名获取对应的服务名。只有当
gaussdb分库部署后，查询的信息中才包括gaussdb_keystone、gaussdb_cinder、
gaussdb_nova、gaussdb_neutron信息。
步骤8 执行以下命令查看数据库所在主机。
cps template-instance-list --service
服务名 组件名
步骤9 执行以下命令，检查主机状态是否正常。
cps host-list | grep fault
1

## Page 319

回显信息中的ID是否包含步骤8中回显的ID。
●
是，执行步骤10排查主机故障原因。
●
否，执行步骤11。
步骤10 检查主机是否被下电。
●
是，上电该主机。等待主机正常上电后，执行步骤18。
●
否，执行步骤11继续排查。
步骤11 执行以下命令检查网络状态是否正常。
●
IPV4环境执行:
ping manageip
●
IPV6环境执行:
ping6 manageip
manageip是否可以ping通。
●
是，执行步骤16。
●
否，则说明故障节点网络不可达，需要先排查网络问题后，执行步骤18。
说明
manageip:
故障gaussdb所在节点的manageip。
检查备节点磁盘分区是否占满
步骤12 执行以下命令获取gaussdb备节点manageip。
cps template-instance-list --service
服务名 组件名
| grep standby
步骤13 使用PuTTY，登录gaussdb备节点manageip。
步骤14 执行以下命令，查看gaussdb分区是否占满。
df -h
A68692F3-DE60-11B4-E811-FC323C32F17C:~ # df -h
Filesystem Size Used Avail Use% Mounted on
/dev/mapper/cpsVG-rootfs 7.8G 5.2G 2.2G 71% /
devtmpfs 220G 4.0K 220G 1% /dev
tmpfs 220G 92K 220G 1% /dev/shm
tmpfs 220G 77M 220G 1% /run
tmpfs 220G 0 220G 0% /sys/fs/cgroup
/dev/mapper/cpsVG-fsp 976M 4.1M 905M 1% /home/fsp
/dev/mapper/cpsVG-data 488M 15M 438M 4% /opt/fusionplatform/data
/dev/mapper/cpsVG-log 20G 990M 18G 6% /var/log
/dev/sda2 471M 72M 371M 17% /boot
/dev/sda1 493M 152K 493M 1% /boot/efi
/dev/mapper/cpsVG-backup 20G 45M 19G 1% /opt/backup
/dev/mapper/cpsVG-repo 20G 45M 19G 1% /opt/fusionplatform/data/fusionsphere/repo
/dev/mapper/cpsVG-database 20G 1.4G 18G 8% /opt/fusionplatform/data/gaussdb_data
/dev/mapper/cpsVG-zookeeper 4.8G 121M 4.5G 3% /opt/fusionplatform/data/zookeeper
tmpfs 44G 0 44G 0% /run/user/1002
/dev/mapper/cpsVG-upgrade 3.4G 15M 3.2G 1% /opt/fusionplatform/data/upgrade
/dev/mapper/cpsVG-image 276G 9.4G 255G 4% /opt/HUAWEI/image
/dev/mapper/cpsVG-image--cache 50G 8.9G 39G 19% /opt/HUAWEI/image_cache
/dev/mapper/cpsVG-rabbitmq 3.9G 19M 3.6G 1% /opt/fusionplatform/data/rabbitmq
tmpfs 44G 0 44G 0% /run/user/2001
tmpfs 44G 0 44G 0% /run/user/1008
tmpfs 44G 0 44G 0% /run/user/0
/dev/mapper/zk_vol_1 59G 400M 56G 1% /opt/dsware/agent/zk/data
/dev/mapper/extend_vg-ceilometer--data 118G 1.8G 110G 2% /var/ceilometer
/dev/mapper/extend_vg-swift 500G 57G 444G 12% /opt/HUAWEI/swift
1

## Page 320

说明
查询回显信息中/opt/fusionplatform/data/gaussdb_data的Use%的值，当为100%时，即为
占满。
●
是，按照2.4.1.4.2 数据库状态异常处理中的“主机磁盘空间占满”部分处理。
●
否，执行步骤16。
步骤15 等待1分钟~3分钟，查看告警台，确认告警恢复。
●
告警恢复，处理完毕。
●
告警不恢复，执行步骤16。
检查是否使用非正常数据库的启停命令操作数据库
步骤16 执行以下命令将故障的数据库停止。
cps host-template-instance-operate --service
服务名 组件名
--action stop --
host HOSTID
●
执行成功，执行步骤17。
●
执行失败，间隔1分钟，重新执行；如果3次尝试都失败，执行步骤19。
说明
HOSTID:
故障gaussdb所在的节点ID。
步骤17 执行如下操作将故障的数据库启动。
cps host-template-instance-operate --service
服务名 组件名
--action start --
host HOSTID
●
执行成功，执行步骤18。
●
执行失败，间隔1分钟，重新执行；如果3次尝试都失败，执行步骤19。
步骤18 等待1分钟~3分钟，查看告警台，确认告警恢复。
●
告警恢复，处理完毕。
●
告警不恢复，执行步骤19。
步骤19 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.86 ALM-73404
检测到
gaussdb
恶意访问
告警解释
周期性(60s)检查gaussdb日志中是否包含特定关键字，日志中出现这些关键字意味着
gaussdb有可能正在遭受外部的恶意访问，需要维护人员确认并采取相应措施。
1

## Page 321

告警属性
告警ID 告警级别 可自动清除
73404 重要 否
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的服务。
●
主机ID：产生告警的主机ID。
附加信息
●
详细信息：告警的详细信息。
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
对系统的影响
此告警产生意味着gaussdb有可能正在遭受外部的恶意访问。
可能原因
●
某些正常场景下的告警。
–
gaussdb备份恢复导致的告警。
–
配置错误等异常场景导致的告警。
●
gaussdb正在遭受外部的恶意访问。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
1

## Page 322

系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
检查是否为正常场景下的告警
步骤8 执行如下命令，进入到gaussdb日志目录：
cd /var/log/fusionsphere/component/gaussdb/
步骤9 在gaussdb日志中寻找告警检测到的关键字，关键字从告警附加信息字段中获取，这里
以"permission denied"为例：
执行命令：zgrep
"permission denied" *
在日志中查找关键字。
步骤10 根据查找到的关键字打印时间点，进一步确认是否当时gaussdb正在遭受外部恶意访
问。
●
是，执行步骤12，上报系统安全风险，采取相应措施。
●
否，执行步骤11。
步骤11 将告警手动清理。
处理完毕。
步骤12 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
参考信息
无。
1

## Page 323

1.2.1.87 ALM-73405 gaussdb
连接数超过阈值
告警解释
gaussdb服务端连接数是有限的，如果组件连接数据库达到最大连接数的90%，会产生
此告警；当连接数据库的连接数降低到最大连接数的85%，告警恢复。
告警属性
告警ID 告警级别 可自动清除
73405
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的组件名称。
附加信息
●
详细信息：告警的详细信息。
●
主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
阈值：连接数的使用阈值。
对系统的影响
此告警产生时，gaussdb连接数接近最大连接数，而未到达上限，则对系统无影响。如
果连接数继续增加，达到上限，则组件无法申请到新连接访问数据库。
可能原因
●
业务下发超过规格。
●
连接数设置不满足规格要求。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 确认是否正在进行大量业务操作。
●
是，执行步骤2。
●
否，执行步骤3。
1

## Page 324

步骤2 待业务量减少后，等待1分钟~3分钟，查看告警台，确认告警恢复。
●
告警恢复，执行步骤3。
●
告警不恢复，执行步骤11。
步骤3 业务量增加的情况下，是否频繁出现连接数达到阈值告警。
●
否，完毕退出。
●
是，执行步骤4，请适度调整gaussdb最大连接数大小满足业务需求。
步骤4 从告警附加信息中，获取上报的告警阈值、当前连接数、总连接数、当前连接数的使
用率。从告警定位信息“服务”中，获取产生告警的组件名。
步骤5 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤7 执行以下命令，防止系统超时退出。
TMOUT=0
步骤8 导入环境变量，具体操作请参见3.1 导入环境变量
步骤9 执行以下命令，获取产生告警的服务名。
cps template-list | grep
组件名
564D7942-B752-7955-C0B0-B762D66E841D:/etc/keystone/domains # cps template-list | grep gaussdb
| gaussdb_keystone | gaussdb_keystone | DataBase for Keystone service. |
| gaussdb_cinder | gaussdb_cinder | DataBase for Cinder service. |
| gaussdb_nova | gaussdb_nova | DataBase for Nova service. |
| gaussdb_neutron | gaussdb_neutron | DataBase for Neutron service. |
| gaussdb | gaussdb | DataBase for OpenStack service. |
说明
如上方回显为例，第一列为服务名，第二列为组件名，根据组件名获取对应的服务名。
步骤10 执行以下命令，更改数据库配置项。
cps template-params-update --service
服务名 组件名
--parameter
database_max_connections=number;
然后执行：cps
commit
1

## Page 325

说明
number表示openstack组件连接gaussdb的总连接数，取值范围为800~5000。请根据步骤4中获
取的连接数相关信息，适当增大总连接数的数值，使“当前连接数
/
总连接数
<
阈值*（100%
-
偏移量）”，偏移量默认为5%。
执行结果：
●
修改成功，完毕退出。
●
修改失败，执行步骤11。
步骤11 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.88 ALM-73410 UVP
关键进程
CPU
占用率超过阈值
告警解释
当UVP关键进程的CPU使用率超过配置的阈值，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
73410
次要 是
告警参数
参数名称 参数含义
名称 告警的名称。
对象ID 产生告警对象的ID。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的ID，比如：主机ID。如果是业务模块产生的告
警，则表示的是业务模块的ID，比如：Openstack OM。
对象类型 产生告警的对象的类型，比如：host（代表主机），heart
beat（代表心跳检测系统）。
1

## Page 326

参数名称 参数含义
对象名称 产生告警的对象的名称。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的名称，比如：主机名。如果是业务模块产生的
告警，则表示的是业务模块的名称，比如：Openstack
OM。
部件类型 产生告警的部件的类型，比如：Openstack、Openstack
OM。
部件名称 产生告警的部件的名称。
定位信息 产生告警的对象的具体信息，一般用key=value,key=value
方式。比如：host=*****,portName=###，表示：****主机
上的###端口产生此告警。
附加信息 产生告警的一些扩展信息，一般用key=value,key=value方
式。比如：Threshold=70,current_value=75，标识产生告
警的原因是阈值为70，而当前值为75。
产生时间 告警产生的时间。
清除时间 告警清除的时间。
清除类型 告警清除的方式，告警清除的类型包括手工清除和自动清
除。
清除用户 手工清除告警的用户名称，自动清除告警时此参数为空。
清除用户ID 手工清除告警的用户ID，自动清除告警时此参数为空。
清除来源 手动清除告警时，清除告警的来源（租户侧视图或管理侧视
图）。
流水号 此条告警信息产生的顺序编号。
对系统的影响
UVP管理开销增加，导致UVP管理性能下降。
可能原因
UVP管理进程任务繁忙。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
1

## Page 327

处理步骤
步骤1 告警是否自动清除。
●
是，任务结束。
●
否，执行步骤2。
步骤2 使用“PuTTY”登录FusionSphere OpenStack控制节点。
以“fsp”用户，通过反向代理IP地址登录。
步骤3 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤4 执行以下命令，防止系统超时退出。
TMOUT=0
步骤5
3.1
导入环境变量。
步骤6 执行cps host-list命令查看告警详细信息中所报主机对应的管理IP地址。
步骤7 执行以下命令跳转到异常服务所在主机。
su - fsp
ssh fsp@HOST_MANAGE_IP
按照提示输入系统私钥密码。如果已生成并替换了新的公私钥文件，请输入新私钥密
码。或者直接按“Enter”后按照提示输入fsp用户的密码登录。
以fsp用户登录后，通过su
-
root命令切换到root用户。
步骤8 通过告警拓展信息确定异常进程名称。
●
如果进程名称为libvirtd，执行步骤9。
●
如果进程名称为hirmd、vBMC_agentd、UVPHostd、virtlogd、systemd-
journal、dbus-daemon、rsyslogd、sysalarm、sysmonitor、getosstat，请执行
步骤10。
●
如果进程名称为systemd，请执行步骤11。
●
如果进程名称为ovs-vswitchd、ovsdb-server，请执行步骤12。
须知
ovs-vswitchd进程CPU占用率超过阈值时，会收集evs mac表项、端口绑核信息并
记录到关键进程监控日志/var/log/sysmonitor/process_monitor.log。
●
如果进程名称为虚拟机名称，请执步骤12。
步骤9 通过PuTTY登录主机，调用“virsh
event
--all”命令接收libvirtd服务事件，等待1分
钟，执行ctrl+c操作停止接收libvirtd服务事件，确认是否接收到超过15条事件。
●
是，请停止在该主机上执行虚拟机生命周期管理操作，然后再次重新执行该步
骤。
●
否，请执行步骤10。
1

## Page 328

步骤10 通过PuTTY登录主机，执行如下命令，重启进程对应的服务，等待30秒钟确认告警是
否自动消除。
systemctl restart ${SERVER_NAME}
说明
${SERVER_NAME}为进程对应的服务名称。
以下几个进程名称对应的${SERVER_NAME}需要重新指定：
●
进程systemd-journal对应的服务名为systemd-journald
●
进程dbus-daemon对应服务名为dbus
●
进程rsyslogd对应的服务名为rsyslog
● 是，执行完毕。
●
否，执行步骤13。
步骤11 通过PuTTY登录主机，执行如下命令，重新加载systemd（等待30秒钟确认告警是否自
动消除）。
systemctl daemon-reload
●
是，执行完毕。
●
否，执行步骤13。
步骤12 使用“uvplog
-o host -t
hyp”命令收集日志并联系技术支持。
步骤13 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.89 ALM-73411
数据库文件损坏
告警解释
数据库保存数据的文件损坏。
告警属性
告警ID 告警级别 可自动清除
73411
紧急 是
1

## Page 329

告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的组件名称。
●
主机ID：产生告警的主机ID。
附加信息
●
主机名：产生告警的主机名。
●
详情：告警的详细信息。
对系统的影响
此告警产生，损坏文件所属的数据表将无法访问，可能会导致业务失败。
可能原因
系统发生了异常掉电。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 导入环境变量，具体操作请参见3.1 导入环境变量
步骤5 获取上报告警的组件名及发生的节点id。
1

## Page 330

查看告警详情，获取告警定位信息，告警定位信息中的服务为组件名。并查看相同组
件名的该告警有几条。
因为文件损坏是跟节点相关的，如果在多个节点上都发生了损坏，则会有多条告警。
记录下告警发生的所有节点id。
步骤6 获取组件的部署及主备信息。
执行如下命令，获取组件的服务名。
cps template-list|grep
组件名 ，执行结果如下所示，其中第一列为服务名。
564D7942-B752-7955-C0B0-B762D66E841D:~ # cps template-list | grep gaussdb
| gaussdb_keystone | gaussdb_keystone | DataBase for Keystone service. |
| gaussdb | gaussdb | DataBase for OpenStack service. |
执行如下命令，获取组件的部署及主备信息。
cps template-instance-list --service
服务名 组件名
如下以gaussdb为例：
564D7942-B752-7955-C0B0-B762D66E841D:~ # cps template-instance-list --service gaussdb gaussdb
+------------+---------------+---------+--------------------------------------+-------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+-------------+
| 0 | gaussdb | active | 564D7942-B752-7955-C0B0-B762D66E841D | 192.168.35.54 |
| 1 | gaussdb | standby | 564DF71C-912D-7C7A-F209-BE12097BD7D4 | 192.168.35.36 |
+------------+---------------+---------+--------------------------------------+-------------+
步骤7 根据步骤5和步骤6的信息，确认属于下面哪种情况，并执行对应的处理。
●
数据文件损坏只发生在备数据库，执行步骤8。
●
数据文件损坏只发生在主数据库，执行步骤9。
●
数据文件损坏发生主数据库和备数据库，执行步骤10。
步骤8 重建备数据库。
1.
登录备数据库所在节点。
2.
导入环境变量，具体操作请参见3.1 导入环境变量。
3.
依次执行以下命令，检查是否需要导入证书相关环境变量。
cps template-params-show --service
服务名 组件名
| grep -E
"database_use_ssl|force_cert_check"
回显如下所示：
A074D328-D21D-B211-8FAE-001823E5F68B:~ # cps template-params-show --service gaussdb
gaussdb | grep -E "database_use_ssl|force_cert_check"
| database_use_ssl | true |
| force_cert_check | true |
根据回显信息，查看返回值是否都为true：
–
是，执行以下命令导入证书相关的环境变量：
export PGSSLCERT="/opt/fusionplatform/data/gaussdb_data/
client_cert/client.crt"
export PGSSLKEY="/opt/fusionplatform/data/gaussdb_data/
client_cert/client.key"
export PGSSLMODE="verify-ca"
export PGSSLROOTCERT="/opt/fusionplatform/data/gaussdb_data/
client_cert/ca.crt"
1

## Page 331

–
否，执行8.4。
4.
执行以下命令，进行数据库重建。
su gaussdba
gs_ctl build
命令成功执行如下所示：
[gaussdba@564DF71C-912D-7C7A-F209-BE12097BD7D4 root]$ gs_ctl build
could not change directory to "/root"
waiting for server to shut down.... done
server stopped
gs_ctl: connect to server, build started.
xlog start point: 0/17000020
gs_ctl: starting background WAL receiver
252775/252775 kB (100%), 1/1 tablespace
xlog end point: 0/1700CFD8
gs_ctl: waiting for background process to finish streaming...
gs_ctl: build completed.
server starting.... done
server started
判断重建是否成功。
–
是， 需重启本节点的数据库，执行步骤12。
–
否，请联系技术支持工程师协助解决。
步骤9 重建主数据库。
1.
登录主数据库所在节点。
2.
导入环境变量，具体操作请参见3.1 导入环境变量。
3.
执行以下命令，进行主备倒换。
cps host-template-instance-operate --service
服务名 组件名
--action swap
4.
等待1分钟~3分钟，执行以下命令，查询组件的主备状态，确认倒换是否成功。
cps template-instance-list --service
服务名 组件名
564D7942-B752-7955-C0B0-B762D66E841D:~ # cps template-instance-list --service gaussdb gaussdb
+------------+---------------+---------+--------------------------------------+-------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+-------------+
| 0 | gaussdb | active | 564D7942-B752-7955-C0B0-B762D66E841D | 192.168.35.54 |
| 1 | gaussdb | standby | 564DF71C-912D-7C7A-F209-BE12097BD7D4 | 192.168.35.36 |
+------------+---------------+---------+--------------------------------------+-------------+
说明
待原先的standby变为active，原先的active变为standby，即倒换成功。
由于倒换需要一定的时间，如果查询倒换没有完成，再等待一段时间查询倒换是否成功。
–
是， 执行9.5。
–
否，请联系技术支持工程师协助解决。
5.
依次执行以下命令，检查是否需要导入证书相关环境变量。
cps template-params-show --service
服务名 组件名
| grep -E
"database_use_ssl|force_cert_check"
回显如下所示：
A074D328-D21D-B211-8FAE-001823E5F68B:~ # cps template-params-show --service gaussdb
gaussdb | grep -E "database_use_ssl|force_cert_check"
| database_use_ssl | true |
| force_cert_check | true |
根据回显信息，查看返回值是否都为true：
1

## Page 332

–
是，执行以下命令导入证书相关的环境变量：
export PGSSLCERT="/opt/fusionplatform/data/gaussdb_data/
client_cert/client.crt"
export PGSSLKEY="/opt/fusionplatform/data/gaussdb_data/
client_cert/client.key"
export PGSSLMODE="verify-ca"
export PGSSLROOTCERT="/opt/fusionplatform/data/gaussdb_data/
client_cert/ca.crt"
–
否，执行9.6。
6.
执行以下命令，进行数据库重建。
su gaussdba
gs_ctl build
命令成功执行如下所示：
[gaussdba@564DF71C-912D-7C7A-F209-BE12097BD7D4 root]$ gs_ctl build
could not change directory to "/root"
waiting for server to shut down.... done
server stopped
gs_ctl: connect to server, build started.
xlog start point: 0/17000020
gs_ctl: starting background WAL receiver
252775/252775 kB (100%), 1/1 tablespace
xlog end point: 0/1700CFD8
gs_ctl: waiting for background process to finish streaming...
gs_ctl: build completed.
server starting.... done
server started
判断重建是否成功。
–
是， 需重启本节点的数据库，执行步骤12。
–
否，请联系技术支持工程师协助解决。
步骤10 修复主备数据库。
须知
由于主备数据库均异常，该修复操作会导致数据丢失，请谨慎操作，如有疑惑，请联
系技术支持工程师协助解决。
如果确认执行修复操作，修复完后建议执行系统审计操作。
1.
登录主数据库所在节点。
2.
找到发生损坏的database。
查看告警附加信息中的详情，找到存在文件损坏的database，可能会存在多个。
3.
执行以下命令，登录异常database，这里以nova database为例。
su gaussdba
gsql nova
说明
执行gsql nova命令时，会提示输入密码，如果修改过数据库密码，以实际密码为准。
4.
执行以下命令，打开数据表修复开关。
set zero_damaged_pages=on;
1

## Page 333

5.
执行以下命令，对异常数据表进行重构。
vacuum full;
该操作时间跟数据表的数据量大小有关，可能要数分钟至数十多分钟，请耐心等
待。
命令执行过程是否报error提示，导致重构中断。
– 否，执行10.6。
–
是，请联系技术支持工程师协助解决。
6.
如果有多个database发生损坏，对每一个database重复10.3~10.5。
7.
重建备数据库。
a.
登录备数据库所在节点。
b.
导入环境变量，具体操作请参见3.1 导入环境变量。
c.
依次执行以下命令，检查是否需要导入证书相关环境变量。
cps template-params-show --service 服务名 组件名 | grep -E
"database_use_ssl|force_cert_check"
回显如下所示：
A074D328-D21D-B211-8FAE-001823E5F68B:~ # cps template-params-show --service gaussdb
gaussdb | grep -E "database_use_ssl|force_cert_check"
| database_use_ssl | true |
| force_cert_check | true |
根据回显信息，查看返回值是否都为true：
▪
是，执行以下命令导入证书相关的环境变量：
export PGSSLCERT="/opt/fusionplatform/data/gaussdb_data/
client_cert/client.crt"
export PGSSLKEY="/opt/fusionplatform/data/gaussdb_data/
client_cert/client.key"
export PGSSLMODE="verify-ca"
export PGSSLROOTCERT="/opt/fusionplatform/data/
gaussdb_data/client_cert/ca.crt"
▪
否，执行10.7.d。
d.
执行以下命令，进行数据库重建。
su gaussdba
gs_ctl build
命令成功执行如下所示：
[gaussdba@564DF71C-912D-7C7A-F209-BE12097BD7D4 root]$ gs_ctl build
could not change directory to "/root"
waiting for server to shut down.... done
server stopped
gs_ctl: connect to server, build started.
xlog start point: 0/17000020
gs_ctl: starting background WAL receiver
252775/252775 kB (100%), 1/1 tablespace
xlog end point: 0/1700CFD8
gs_ctl: waiting for background process to finish streaming...
gs_ctl: build completed.
server starting.... done
server started
判断重建是否成功。
1

## Page 334

▪
是， 执行步骤11。
▪
否，请联系技术支持工程师协助解决。
步骤11 重启组件所有实例。
停止组件，cps
host-template-instance-operate --service
服务名 组件名
--action
stop
+----------+--------------------------------------+--------+---------+
| template | runsonhost | action | result |
+----------+--------------------------------------+--------+---------+
| gaussdb | 564D7942-B752-7955-C0B0-B762D66E841D | stop | success |
| gaussdb | 564DF71C-912D-7C7A-F209-BE12097BD7D4 | stop | success |
+----------+--------------------------------------+--------+---------+
查询状态，cps
template-instance-list --service
服务名 组件名，status为fault后，
再启动组件。
564D7942-B752-7955-C0B0-B762D66E841D:~ # cps template-instance-list --service gaussdb gaussdb
+------------+---------------+--------+--------------------------------------+-------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+--------+--------------------------------------+-------------+
| 0 | gaussdb | fault | 564D7942-B752-7955-C0B0-B762D66E841D | 192.168.35.54 |
| 1 | gaussdb | fault | 564DF71C-912D-7C7A-F209-BE12097BD7D4 | 192.168.35.36 |
+------------+---------------+--------+--------------------------------------+-------------+
启动组件，cps
host-template-instance-operate --service
服务名 组件名
--action
start
564D7942-B752-7955-C0B0-B762D66E841D:~ # cps host-template-instance-operate --service gaussdb
gaussdb --action start
+----------+--------------------------------------+--------+---------+
| template | runsonhost | action | result |
+----------+--------------------------------------+--------+---------+
| gaussdb | 564D7942-B752-7955-C0B0-B762D66E841D | start | success |
| gaussdb | 564DF71C-912D-7C7A-F209-BE12097BD7D4 | start | success |
+----------+--------------------------------------+--------+---------+
再查询状态，cps
template-instance-list --service
服务名 组件名，等待组件状态变
为active、standby。
所有组件实例是否都正常。
●
是，执行步骤13。
●
否，请联系技术支持工程师协助解决。
步骤12 重启组件单个实例。
停止组件，cps
host-template-instance-operate --service
服务名 组件名
--host
host_id --action stop
host_id需替换为实际的节点id。
564D7942-B752-7955-C0B0-B762D66E841D:~ # cps host-template-instance-operate --service gaussdb
gaussdb --action stop --host 564DF71C-912D-7C7A-F209-BE12097BD7D4
+----------+--------------------------------------+--------+---------+
| template | runsonhost | action | result |
+----------+--------------------------------------+--------+---------+
| gaussdb | 564DF71C-912D-7C7A-F209-BE12097BD7D4 | stop | success |
+----------+--------------------------------------+--------+---------+
查询组件状态，cps
template-instance-list --service
服务名 组件名，待被停止的实
例变为fault。
1

## Page 335

564D7942-B752-7955-C0B0-B762D66E841D:~ # cps template-instance-list --service gaussdb gaussdb
+------------+---------------+--------+--------------------------------------+-------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+--------+--------------------------------------+-------------+
| 0 | gaussdb | active | 564D7942-B752-7955-C0B0-B762D66E841D |192.168.35.54 |
| 1 | gaussdb | fault | 564DF71C-912D-7C7A-F209-BE12097BD7D4 |192.168.35.36 |
+------------+---------------+--------+--------------------------------------+-------------+
启动组件，cps
host-template-instance-operate --service
服务名 组件名
--host
host_id--action start
564D7942-B752-7955-C0B0-B762D66E841D:~ # cps host-template-instance-operate --service gaussdb
gaussdb --action start --host 564DF71C-912D-7C7A-F209-BE12097BD7D4
+----------+--------------------------------------+--------+---------+
| template | runsonhost | action | result |
+----------+--------------------------------------+--------+---------+
| gaussdb | 564DF71C-912D-7C7A-F209-BE12097BD7D4 | start | success |
+----------+--------------------------------------+--------+---------+
再查询状态，cps
template-instance-list --service
服务名 组件名，等待组件状态正
常。
组件状态是否正常。
●
是，执行步骤13。
●
否，请联系技术支持工程师协助解决。
步骤13 等待5分钟～10分钟，查看告警是否清除。
●
是，处理结束。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.90 ALM-73412
检测到
gaussdb
存在长事务
告警解释
gaussdb中事务执行时间如果过长（超过60分钟），比如事务未提交，则会产生告
警。长事务会自动清理，但是告警产生后，需要手动清理告警。
告警属性
告警ID 告警级别 可自动清除
73412
重要 否
1

## Page 336

告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的组件名称。
●
主机ID：产生告警的主机ID。
附加信息
●
详细信息：告警的详细信息。
●
主机名：产生告警的主机名。
●
云服务：产生告警的云服务。
●
微服务：产生告警的组件名称
对系统的影响
此告警产生时，gaussdb中存在长事务。如果长事务一直存在，可能会引起表膨胀和连
接占满，导致服务访问数据库异常。长事务系统会自动清理，需要排查系统是否受到
长事务影响。
可能原因
● 事务未提交。
●
操作系统负载高。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
1

## Page 337

TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 确认数据库访问地址。
执行命令：
cat /etc/gaussdb/gaussdb/fsp_gaussdb.ini | grep float_ip
查看执行结果：
●
若执行成功，则输出应类似
float_ip =
172.28.8.100，执行步骤9。
●
若执行失败，执行步骤12。
步骤9 登录数据库。
执行命令:
su - gaussdba -c "gsql dbname -U openstack -h host_ip -p 5432;"
执行完成后出现以下回显，请输入openstack访问数据库的密码。
Password for user openstack:
查看执行结果：
●
若显示 dbname=>，表示进入数据库命令行交互模式，执行成功。继续执行步骤
10。
●
若执行失败，执行步骤12。
说明
db_name为上报告警的数据库名称（附加信息中的详细信息中“[]”内的值）；host_ip为步骤8
中获得的float_ip值
步骤10 查询长事务具体信息。
执行命令:
select datname,pid,now()-xact_start AS
interval,query,usename,application_name,client_addr,client_hostname,client_p
ort,xact_start,query_start,state FROM pg_stat_activity WHERE state in ('idle
in transaction') AND now()-xact_start> interval '60 min' ORDER BY interval
DESC;
1

## Page 338

查看执行结果：
DATNAME | PID | INTERVAL | QUERY | ... | STATE
---------+-------+-----------------+--------------------+------ ... -----+---------------------
NOVA | 27530 | 01:20:24.877987 | start transaction; | ... | idle in transaction
(1 row)
说明
●
退出查询结果，输入q即可。
●
退出数据库，输入\q即可。
●
若输出无具体数据，即最后一行显示(0 row)，表示长事务已经自动清理完毕，请
手动清除告警，处理完毕。
● 若输出有具体数据，参考步骤11手动清理。
步骤11 如果确认需要手动清理长事务，通过执行处理步骤中步骤10，获取长事务PID，并依次
执行命令：
select pg_terminate_backend(pid);
查看执行结果：
NOVA=# select pg_terminate_backend(27530);
PG_TERMINATE_BACKEND
----------------------
t
(1 row)
●
若执行成功，则返回值为t，输出如上，处理完毕。
●
若执行失败，请联系技术支持工程师协助解决。
步骤12 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
参考信息
无。
1.2.1.91 ALM-1060047
后端存储虚拟容量使用率超过阈值
告警解释
OpenStack周期（默认为5分钟）检测存储占用率，当检测到虚拟存储容量占用率大于
85%时，系统产生此告警。
说明
● 本告警仅针对FusionSphere OpenStack本身所使用的存储，只支持华为磁阵、华为分布式块
存储或vCenter中的存储是否上报阈值告警请关注各自管理软件。
●
虚拟存储容量=物理容量*瘦分配比
1

## Page 339

告警属性
告警ID 告警级别 可自动清除
1060047
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务
●
域名：产生告警的后端存储所属Region
●
后端存储：产生告警的后端存储名称
附加信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务名
●
域名：产生告警的后端存储所属Region
●
后端存储：产生告警的后端存储名称
●
阈值：存储虚拟容量使用率阈值
●
使用率：产生告警的后端存储的实际虚拟容量使用率
对系统的影响
当虚拟存储使用率过高时，可能导致虚拟存储容量不足，系统无法使用该存储资源。
可能原因
●
瘦分配比设置过小，导致物理容量充足的情况下，虚拟容量不足。
●
后端存储物理容量不足。
处理步骤
步骤1 检查告警列表中是否存在1.2.1.14 ALM-6025 存储使用率超过阈值。
●
是，参考1.2.1.14
ALM-6025
存储使用率超过阈值处理。完成后执行步骤2。
●
否，执行步骤3。
步骤2 查看告警列表中，此告警是否恢复。
●
是，处理完成。
●
否，执行步骤3。
步骤3 通过告警定位信息，获取后端存储名称。
步骤4 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
1

## Page 340

步骤5 进入“配置
>
资源池管理” 页面。
步骤6 在资源池界面中单击 按钮，进入“集群管理”界面。
步骤7 根据上报告警的后端存储名称，单击 按钮，进入“配置存储集群”界面。
步骤8 适当调大该后端存储的瘦分比值，单击“提交”。
步骤9 等待4~5分钟，查看告警列表中，此告警是否恢复。
●
是，处理完成。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.92 ALM-1060049
挂载双活卷单边故障告警
告警解释
用户执行虚拟机迁移、虚拟机HA、虚拟机重启等操作后，自动发起挂载双活卷，挂载
过程中需要挂载本端卷和远端卷，当两个卷中的一个卷挂载失败时，触发单边故障告
警。
告警属性
告警ID 告警级别 可自动清除
1060049
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务
●
虚拟机ID：产生告警的虚拟机ID
附加信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务名
●
虚拟机名：产生告警的虚拟机名
●
被挂载的双活目标LUN：产生告警的双活目标LUN
ID
1

## Page 341

对系统的影响
无
可能原因
CSHA/VHA场景中，容灾恢复后未做重映射操作。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1
Region Type
I场景下，在告警附加信息中获取“虚拟机名”。
步骤2 登录OpenStack控制节点，获取虚拟机的Name。
1.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
–
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
– External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP
参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，
在对应节点下该帐户的默认密码。
2.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
3.
执行以下命令，防止系统超时退出。
TMOUT=0
4.
执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
5.
输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号
的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
6.
在执行命令nova
list --all-t | grep
虚拟机ID，查看该虚拟机详情，其中第二个字
段即是该虚拟机的Name。Region
Type
I场景下，虚拟机ID要参见告警附加信息
中的虚拟机名的UUID部分。
1

## Page 342

说明
也可执行命令nova
list
--all-t，从“Name”字段获取虚拟机的Name。
F6128CAC-5D50-898F-E811-173EEC1ABA81:~ # nova list --all-t | grep 69dab372-fdd8-4a01-b4cb-
deb24b2b32dc
| 69dab372-fdd8-4a01-b4cb-deb24b2b32dc | APIGW-PODLB-01 |
319c29f0410a461fb1274be6264e5c45 | ACTIVE | - | Running |
DMZ_Service=10.1.13.12; DMZ_Tenant=10.1.14.4 |
F6128CAC-5D50-898F-E811-173EEC1ABA81:~ # nova list --all-t
+---------+-----------+-------------+-----------+--------------+-------------+--------+
| ID | Name | Tenant ID | Status | Task State | Power State | Networks |
+---------+-----------+-------------+-----------+--------------+-------------+--------+
| 69dab372-fdd8-4a01-b4cb-deb24b2b32dc | APIGW-PODLB-01 |
319c29f0410a461fb1274be6264e5c45 | ACTIVE | - | Running |
DMZ_Service=10.1.13.12; DMZ_Tenant=10.1.14.4 |
步骤3 使用浏览器，登录ManageOne运维面，在“快速访问”页签单击“eReplication”，
登录eReplication。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
默认帐号：admin。
说明
若登录不成功，请使用以下登录地址、eReplication的帐号和密码登录eReplication：
– 登录地址：https://eReplication的IP地址:9443/src/login/view/login.html
eReplication节点的管理平面IP地址，可从导出的部署LLD中查询
eReplication_Server01参数获得。
– 默认帐号：admin
步骤4 登录eReplication后，依次查询所有双活实例中的虚拟机，找到目标虚拟机所在双活实
例。双活实例中的虚拟机名称即为步骤2.6中查询出来的虚拟机Name。
步骤5 单击目标双活实例右侧的“更多
>
重映射”，重新挂载并扫描故障已恢复的本端或远
端卷。查看后台任务执行状态，待重映射任务成功后，执行步骤6
步骤6 在ManageOne运维面的“集中监控
>
告警管理
>
当前告警”界面中查看告警，确认
告警是否恢复。
●
是，处理完成。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 343

1.2.1.93 ALM-1060050
后端存储证书异常
告警解释
用户对接后端存储，并且在对接时开启了“使用存储证书”开关。此时，若后端存储
设备证书发生变化，而且未在FusionSphere OpenStack上同步最新证书，则会出现该
告警。
告警属性
告警ID 告警级别 可自动清除
1060050
提示 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务
●
域名：产生告警的后端存储所属Region
●
后端存储：产生告警的后端存储名称
附加信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
●
可用分区：产生告警的后端存储所属可用分区
●
后端存储管理地址：产生告警的后端存储设备管理地址
对系统的影响
无
可能原因
用户对接后端存储，并且在对接时开启了“使用存储证书”开关，后端存储设备证书
进行了证书更换，但是未在FusionSphere OpenStack上同步最新证书。
处理步骤
步骤1 根据告警附加信息中的后端存储管理地址，访问后端存储设备，获取存储设备最新的
CA证书。
常用设备证书的手动获取方式如下，如果获取不到，请联系技术支持工程师协助解
决。
● OceanStor V3/OceanStor V5/Dorado
V3的CA证书
使用文件传输工具（如WinSCP），以admin帐户登录V3/V5阵列，将CA证书
（“cacert.pem”或“ca.crt”）拷贝到本地任意目录。不同的设备型号CA证书的
存放路径不同。如：若存储阵列版本是V300R006C10及其之后的版本，则CA证书
1

## Page 344

存放在阵列的“/OSM/coffer_data/omm/export_import”目录下。若是
V300R006C10之前的版本，则CA证书存放在阵列的“/OSM/export_import/”目
录下。
●
VMware的CA证书
使用浏览器登入VMware vCenter环境，下载证书压缩包至本地任意目录。下载
后，证书压缩包文件类型修改为“.zip”格式，修改完成后，打开证书压缩文件，
查找“*.0”格式文件，并修改其文件类型为“*.crt”格式。
● OceanStor
9000的对象存储服务的CA证书
请根据OceanStor 9000的具体版本，在support网站获取相应的资料，使用
OceanStor
9000自带的对象存储服务证书工具生成证书。比如，请参见
《OceanStor
9000 V300R006C00
安全维护》中“更换对象存储服务（兼容
Amazon
S3接口）的安全证书”章节的“异常处理”。
●
华为分布式块存储的CA证书
请根据华为分布式块存储的具体版本，在support网站获取相应的资料，使用华为
分布式块存储自带的对象存储服务证书工具生成证书。比如，请参见
《FusionStorage
8.0.1
块存储安全配置指南》中“安全配置”章节的“安全证书
管理”。
步骤2 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤3 选择“运维
>
证书管理
>
后端存储证书管理” 。
步骤4 根据告警定位信息中的后端存储名称，在“证书更新”里勾选对应的后端存储，单击
“后端存储证书”所在行的 ，选择步骤1中获取的有效文件，单击“打开”。
步骤5 单击“上传”，待证书上传成功后，单击“提交”。
步骤6 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
– 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤7 在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面，查看
告警列表中对应告警是否恢复。
●
是，处理完毕。
●
否，执行步骤8。
步骤8 请联系技术支持工程师协助解决。
----结束
1

## Page 345

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.94 ALM-1101315
主机组内本地直通盘使用率超过阈值
告警解释
OpenStack周期性（默认5分钟）检测主机组内本地直通盘使用率，当检测到本地直通
盘使用个数达到主机组内本地直通盘总个数的85%时，系统产生此告警。
当检测到本地直通盘使用个数降低到主机组内本地直通盘总个数的70%时，告警恢
复。
告警属性
告警ID 告警级别 可自动清除
1101315
提示 是
告警参数
参数名称 参数含义
定位信息 主机组ID：产生告警的主机组ID
附加信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
●
主机组名称：产生告警的主机组名称
●
总量：主机组内本地直通盘的总量
●
使用量：主机组内本地直通盘使用数量
●
阈值：主机组内本地直通盘的告警阈值
对系统的影响
可能会造成之后创建本地直通盘虚拟机时，由于本地直通盘资源不够而创建失败。
可能原因
主机组内本地直通盘使用率过高。
1

## Page 346

处理步骤
步骤1 通过告警信息得到本地直通盘类型，在服务器上新增与原有本地直通盘类型相同的本
地直通盘进行扩容，进行本地直通盘配置，或者释放掉多余的占用本地直通盘的虚拟
机以释放资源。
请参考《华为云Stack
8.1.0
资源发放指南》“密集存储型云服务器配置方案”章节，
进行本地直通盘配置。
步骤2 当本地直通盘使用率低于70%时，告警是否恢复。
●
是，处理完成。
●
否，执行步骤3。
步骤3 如果上述操作出现问题，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.95 ALM-1101317 MCS
主机组内本地盘使用率超过阈值
告警解释
OpensStack周期性（默认5分钟）检测主机组内本地盘使用率，当检测到本地盘使用
量达到主机组本地盘总量的85%时，系统产生此告警。
当检测到本地盘使用量降低到主机组内本地盘总量的70%以下时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
1101317
提示 是
告警参数
参数名称 参数含义
定位信息 主机组ID：产生告警的主机组ID
1

## Page 347

参数名称 参数含义
附加信息 云服务：产生告警的云服务
服务：产生告警的服务
主机组名称：产生告警的主机组名称
总量：主机组内本地盘的总量
使用量：主机组内本地盘使用量
阈值：主机组内本地盘的告警阈值
对系统的影响
本地盘资源不足，导致创建本地盘实例失败。
可能原因
主机组内本地盘使用量过高。
处理步骤
步骤1 查看当前告警信息。
1.
使用浏览器，登录ManageOne运维面。
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
默认帐号：admin。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
3.
单击目标告警所在行的 ，展开告警详情。
4.
查看告警详情中的“附加信息”字段。
记录“主机组名称”。
步骤2 扩容MCS计算节点以增加可用资源。
请参考《华为云Stack
8.1.0
技术中台与AI数据中台服务扩容指南》的“扩容管理规模
>
数据库服务
>
云数据库
GaussDB(for openGauss) >
扩容MCS节点”章节来扩容主
机组内本地盘存储资源。
步骤3 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤4 选择“服务列表
>
资源
>
计算资源
>
主机组”，进入主机组列表界面。
步骤5 选中要处理的主机组，在“概要”界面，查看主机组“磁盘（虚拟机根磁盘、临时磁
盘、交换盘）”资源使用情况，磁盘使用量低于70%时，告警是否恢复。
●
是，处理完成。
●
否，请联系技术支持工程师协助解决。
----结束
1

## Page 348

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.96 ALM-1101320 NPU
使用率超过阈值
告警解释
OpenStack周期性（默认5分钟）检测主机组内NPU使用率，当检测到NPU使用个数达
到主机组内NPU总个数的85%时，系统产生此告警。
当检测到NPU使用个数降低到主机组内NPU总个数的70%时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
1101320
提示 是
告警参数
参数名称 参数含义
定位信息
●
主机组ID：npu所在主机组ID
●
npu类型：npu类型
附加信息
●
服务：产生告警的服务
●
微服务：产生告警的微服务
●
主机组名称：npu所在的主机组名称
●
npu总量：npu的总个数
●
npu使用量：已使用的npu个数
●
阈值：npu个数阈值
对系统的影响
可能会造成之后创建NPU虚拟机时，由于NPU资源不够而创建失败。
可能原因
主机组内NPU使用率过高。
1

## Page 349

处理步骤
步骤1 通过告警信息得到NPU卡类型以及主机组信息，建议在主机组内增加同类型的NPU卡
进行扩容。
步骤2 当NPU使用率低于70%时，告警是否恢复。
●
是，处理完毕。
●
否，执行步骤3。
步骤3 如果上述操作出现问题，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.97 ALM-1101321
虚拟机存储链路未完全恢复
告警解释
如果虚拟机挂载的磁盘有多条存储链路，当主机存储故障后，所有链路未完全恢复，
则虚拟机启动时，系统产生此告警。
用户在计算节点确认链路恢复后，需要手动清除告警。
告警属性
告警ID 告警级别 可自动清除
1101321
重要 否
告警参数
参数名称 参数含义
定位信息 虚拟机ID：产生告警的虚拟机ID
附加信息
●
可用分区名：产生告警的可用分区名称
● 主机名：产生告警的虚拟机所在主机名称
●
主机ID：产生告警的虚拟机所在主机ID
●
虚拟机名：产生告警的虚拟机名称
●
LUN_WWN：未完全恢复的存储磁盘WWN编号
1

## Page 350

对系统的影响
可能会降低虚拟机运行的稳定性。
可能原因
虚拟机所在的主机存储链路出现异常，未完全恢复。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行命令upadmin
show
vlun，根据告警信息中的LUN_WWN，查看命令执行结果中
对应行的“No.
of
Paths”字段，查看显示的Paths数量是否与预期安装部署存储设备
上的链路数一致。
●
是，根据1.2.1.12
ALM-6023
主机存储链路中断处理告警，处理完毕后，执行步
骤6。
●
否，执行步骤7。
步骤6 手动清除告警后，查看告警是否继续上报。
●
是，执行步骤7。
●
否，处理完成。
步骤7 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
1

## Page 351

参考信息
无。
1.2.1.98 ALM-1126000
裸金属服务器电源状态未获取到
告警解释
OpenStack周期（默认为60s）检查每台裸金属服务器上的电源状态，如果该裸金属服
务器电源状态同步失败超过一定次数（默认3次），产生此告警。当管理员对该裸金属
执行退出维护态操作后，告警恢复。
告警属性
告警ID 告警级别 可自动清除
1126000
重要 是
告警参数
参数名称 参数含义
定位信息 裸金属服务器节点ID：产生告警的裸金属服务器节点ID
附加信息
●
主机IP：产生告警的主机IP
●
裸金属服务器BMC地址：产生告警的裸金属服务器BMC
IP地址
对系统的影响
此告警产生时，电源状态同步失败的裸金属服务器的电源操作将会失败。未发放的裸
金属服务器电源状态同步失败将导致其不能被发放。已发放的裸金属服务器将不能被
成功回收。
可能原因
●
裸金属管理服务ironic所在的控制节点与裸金属服务器BMC网络不通。
●
裸金属服务器的BMC用户名、密码、IP不正确。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 在Service OM界面，选择“服务列表
>
资源
>
裸金属资源
>
裸金属服务器”。
步骤3 在裸金属服务器界面右上角搜索栏，下拉选择搜索方式为“ID”。
步骤4 输入裸金属服务器节点ID，单击搜索按钮。
1

## Page 352

输入的ID值为告警参数中的“裸金属服务器节点ID”。
步骤5 查看搜索出的裸金属服务器ID的“维护模式”。
●
如果是“是”，执行步骤6。
●
如果是“否”，执行步骤8。
步骤6 检查告警附加信息中的主机IP是否与该裸金属服务器BMC网络IP互通。
●
如果互通，再检查该裸金属服务器的BMC用户名和密码是否正确。
–
否，请重新配置正确的BMC用户名和密码。
–
是，执行步骤7。
●
如果IP不通，请先排查物理网络问题，如果没有问题，执行步骤8。
步骤7 执行如下操作。
1.
在待退出维护态的裸金属服务器的“操作”列中，选择“更多
>
退出维护模
式”。
2.
一分钟后，单击刷新按钮，查看退出维护态的裸金属服务器电源状态是否变为
“上电”或“下电”。
–
如果“电源状态”状态为“上电”或“下电”，表示操作成功。否则执行步
骤8。
–
如果“电源状态”的状态为“未知状态”,表示操作失败，执行步骤8。
步骤8 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.99 ALM-1126001
裸金属服务器管理状态不可用
告警解释
当裸金属服务器进行发放、扩容、回收或者格式化时，如果管理状态进入deploy
failed、inspect failed、clean failed或者error时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
1126001 重要 是
1

## Page 353

告警参数
参数名称 参数含义
定位信息 裸金属服务器节点ID：产生告警的裸金属服务器节点ID
附加信息
●
主机IP：产生告警的主机IP
●
裸金属服务器BMC地址：产生告警的裸金属服务器BMC
IP地址
●
当前管理状态：产生告警的裸金属服务器节点的管理状
态
对系统的影响
此告警产生时，表示该裸金属服务器在发放、扩容、回收或者格式化过程中发生故
障，租户将不能再对该裸金属服务器进行重新发放。
可能原因
裸金属服务器在发放、扩容、回收或者格式化过程中，因为网络问题或者DB异常导致
其管理状态进入DEPLOY FAILED、INSPECT FAILED、CLEAN FAILED或者ERROR状
态。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 在Service OM界面，选择“服务列表
>
资源
>
裸金属资源
>
裸金属服务器”。
步骤3 在裸金属服务器界面右上角搜索栏，下拉选择搜索方式为“ID”。
步骤4 输入裸金属服务器节点ID，单击搜索按钮。
输入的ID值为告警参数中的“裸金属服务器节点ID”。
步骤5 搜索出的裸金属服务器ID的“管理状态”。
●
如果是“格式化失败”，执行步骤6。
●
如果是“部署失败”，执行步骤7。
●
如果是“扩容失败”，执行步骤8。
●
如果是“故障”，执行步骤9。
步骤6 单击搜索出的“裸金属服务器ID”，在裸金属服务器概览页面中查看“管理信息 > 最
后一次错误”以确定格式化失败的原因。
例如，“最后一次错误”中显示“failed
to open for writing: Read-only file
system”
则表示sdb硬盘只读，需去除硬盘的写保护。
●
根据“最后一次错误”内容排查定位原因，排查完后在裸金属服务器页面的操作
栏中单击“初始化”按钮，执行初始化操作，然后等待裸金属服务器状态变成
“可部署”。
告警恢复即处理完毕，否则执行步骤9。
1

## Page 354

●
如果“最后一次错误”中显示的内容不能帮助定位原因排查，执行步骤9。
步骤7 单击搜索出的“裸金属服务器ID”，在裸金属服务器概览页面中查看“管理信息
>
最
后一次错误”以确定部署失败的原因。
●
根据“最后一次错误”内容排查定位原因，排查完后重新发放裸金属服务器。
如果发放成功，需手动清除该条告警，否则执行步骤9。
●
如果“最后一次错误”中显示的内容不能帮助定位原因排查，执行步骤9。
步骤8 单击搜索出的“裸金属服务器ID”，在裸金属服务器概览页面中查看“管理信息
>
最
后一次错误”以确定扩容失败的原因。
●
根据“最后一次错误”内容排查定位原因，排查完后在裸金属服务器页面的操作
栏中选择“更多>硬件信息采集”，后等待裸金属服务器状态变成“待初始化”。
告警恢复即处理完毕，否则执行步骤9。
● 如果“最后一次错误”中显示的内容不能帮助定位原因排查，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.100 ALM-1126002
裸金属服务器审计告警
告警解释
当执行系统审计时发现非正常状态的裸金属服务器实例，产生此告警。当审计结果中
不存在非正常的裸金属服务器实例，该告警清除。
告警属性
告警ID 告警级别 可自动清除
1126002
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务名称，默认为OpenStack
●
服务：产生告警的服务名称，默认为ironic
附加信息
●
云服务：产生告警的微服务名称，默认为ironic
●
详细信息：裸金属服务器审计产生告警的详细信息
1

## Page 355

对系统的影响
此告警产生时，系统中存在不正常状态的裸金属服务器，影响系统对裸金属服务器的
管理。
可能原因
●
系统存在野物理服务器。
●
系统存在假物理服务器。
●
系统存在处于中间态的物理服务器。
说明
请在告警的详细信息中获取引发告警的具体审计问题，并参考处理步骤完成相应问题的处
理。
处理步骤
步骤1 获取告警详情中“附加信息”参数中的“详细信息”取值，获取异常审计项所属的类
型及异常个数。
表1-44 详细信息与异常类型的对应关系
详细信息 异常类型
invalid_ironic_instances
审计一致性裸金属服务器
stucking_ironic_instances
中间态裸金属服务器
步骤2 参考《华为云Stack
8.1.0
产品文档》的“裸金属服务器审计”章节，处理异常项。
步骤3 处理完成后，等待五分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤4。
步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 356

1.2.1.101 ALM-1200067 DHCP
服务不可用
告警解释
当主机上的DHCP组件对于所有或部分网络不能提供DHCP服务时，系统会产生此告
警。
告警属性
告警ID 告警级别 可自动清除
1200067
重要 是
告警参数
参数名称 参数含义
定位信息
●
区域名：产生告警的区域。
●
云服务：服务类型，固定值为VPC。
●
服务：产生告警的服务名称，默认为DHCP。
●
主机ID：产生告警的主机ID。
附加信息
●
云服务：服务类型，固定值为VPC。
●
服务：产生告警的服务名称，默认为DHCP。
●
主机名：产生告警的主机名称。
●
异常信息：产生告警的原因。
●
分区名：产生告警的分区。
对系统的影响
当网络归属的DHCP都无法提供服务后，会影响当前创建虚拟机的通信。已分配IP的虚
拟机续组IP失败，在租约到期后会影响虚拟机通信。
可能原因
●
DHCP对外提供服务的网络链路不通。
●
DHCP名空间端口状态DOWN。
●
缺少可提供服务的dnsmasq进程。
● DHCP
agent不正常。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
1

## Page 357

处理步骤
步骤1 登录告警上报主机。
1.
使用“PuTTY”登录FusionSphere OpenStack控制节点。
以“fsp”用户，通过反向代理IP地址登录。
2.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
3.
执行以下命令，防止系统超时退出。
TMOUT=0
4.
参考3.1 导入环境变量，选择使用cps鉴权，完成cps环境变量导入。
5.
执行cps host-list命令，查看告警定位信息中所报主机对应的管理IP地址。
6.
执行以下命令跳转到异常服务所在主机。
su - fsp
ssh
fsp@主机管理IP地址
说明
主机管理IP地址从步骤1.5获取。
按照提示输入系统私钥密码。如果已生成并替换了新的公私钥文件，请输入新私
钥密码。
或者直接按“Enter”后按照提示输入fsp用户的密码登录。以fsp用户登录后，通
过su
-
root命令切换到root用户。
7.
参考3.1 导入环境变量，选择使用keystone v3鉴权，完成openstack环境变量导
入。
步骤2 查看告警附加信息。
●
若附加信息中的“error_info”由“Network
network_id failed to ping IP from
the DHCP
namespace”语句组成，执行步骤3。
●
若附加信息中的“error_info”为“The
dnsmasq process(es) of network(s)
network_id does(do) not exist or
unavailable”，执行步骤4。
●
若附加信息中的“error_info”为“The
state of the DHCP agent is
abnormal”,
执行步骤5。
●
若附加信息中的“error_info”为“The
namespace's port state of network(s)
network_id is(are)
abnormal”，执行步骤6。
步骤3 获取步骤2中“error_info”的network_id，执行以下子步骤，处理完成后执行步骤7。
1.
检查dhcp-agent状态或者dhcp服务进程是否异常。
a.
在告警主机上，查询dhcp-agent是否正常。
执行命令neutron
dhcp-agent-list-hosting-net
network_id，如下表示
dhcp-agent正常。否则，执行步骤3.1.d。
1DAB63EF-98F8-6FA4-E811-E0270C10E39A:/home/fsp # neutron dhcp-agent-list-hosting-net
0b36c57d-7cb6-4c0b-9b6c-6e82aff63c9e
+--------------------------------------+--------------------------------------+----------------+-------+
| id | host | admin_state_up | alive |
+--------------------------------------+--------------------------------------+----------------+-------+
| 892eb110-ad9b-4d20-a1a0-f74152fb24f4 | 9056F629-D21D-B211-8607-0018E1C5D866 |
True | :-) |
| b38fc6cc-6097-4c1d-bba6-1134446a1f12 | 1DAB63EF-98F8-6FA4-E811-E0270C10E39A |
True | :-) |
+--------------------------------------+--------------------------------------+----------------+-------+
1

## Page 358

b.
执行命令cps
template-instance-list --service neutron neutron-dhcp-
agent，查询neutron-dhcp-agent服务是否正常，如下表示neutron-dhcp-
agent服务正常。否则，执行步骤3.1.d。
1DAB63EF-98F8-6FA4-E811-E0270C10E39A:/home/fsp # cps template-instance-list --service
neutron neutron-dhcp-agent
+----------------+--------------------+--------+--------------------------------------+------------+
| instanceid | componenttype | status | runsonhost | omip |
+----------------+--------------------+--------+--------------------------------------+------------+
| agt_0000000002 | neutron-dhcp-agent | active | 8A3E6C7A-3A1D-E811-8334-3CE824851997 |
10.24.3.121 |
| agt_0000000001 | neutron-dhcp-agent | active | 9056F629-D21D-B211-8607-0018E1C5D866 |
10.24.3.182 |
| agt_0000000000 | neutron-dhcp-agent | active | 1DAB63EF-98F8-6FA4-E811-E0270C10E39A |
10.24.3.168 |
+----------------+--------------------+--------+--------------------------------------+------------+
由步骤3.1.a和步骤3.1.b可见，正常情况下，网络绑定的主机是三个控制节点
其中的任意两个，状态都是:-)。
c.
使用命令ps
-ef | grep dnsmasq | grep
network_id，查看该网络的dhcp服
务进程是否存在。如下表示此进程存在。否则，执行步骤3.1.d。
1DAB63EF-98F8-6FA4-E811-E0270C10E39A:/home/fsp # ps -ef | grep dnsmasq | grep
0b36c57d-7cb6-4c0b-9b6c-6e82aff63c9e
opensta+ 42190 1 0 Jul25 ? 00:00:00 dnsmasq --no-hosts --no-resolv --strict-order --
except-interface=lo --pid-file=/var/lib/neutron/dhcp/
0b36c57d-7cb6-4c0b-9b6c-6e82aff63c9e/pid --dhcp-hostsfile=/var/lib/neutron/dhcp/
0b36c57d-7cb6-4c0b-9b6c-6e82aff63c9e/host --addn-hosts=/var/lib/neutron/dhcp/
0b36c57d-7cb6-4c0b-9b6c-6e82aff63c9e/addn_hosts --dhcp-optsfile=/var/lib/neutron/dhcp/
0b36c57d-7cb6-4c0b-9b6c-6e82aff63c9e/opts --dhcp-leasefile=/var/lib/neutron/dhcp/
0b36c57d-7cb6-4c0b-9b6c-6e82aff63c9e/leases --dhcp-match=set:ipxe,175 --dhcp-
userclass=set:ipxe,iPXE --enable-ra --ra-param=tapb811d934-31,0,0 --bind-interfaces --
interface=tapb811d934-31 --dhcp-range=set:tag0,10.24.8.0,static,infinite --dhcp-option-
force=option:mtu,1500 --dhcp-lease-max=256 --conf-file=/etc/neutron/dnsmasq.conf --
domain=openstacklocal --bind-mac-with-ip6
d.
如果有dhcp-agent状态异常或者dhcp服务进程异常，分别执行以下两条命
令，重启neutron-dhcp-agent组件。
cps host-template-instance-operate --service neutron neutron-dhcp-
agent --action stop
cps host-template-instance-operate --service neutron neutron-dhcp-
agent --action start
9098B929-D21D-B211-931F-0018E1C5D866:/home/fsp # cps host-template-instance-operate --
service neutron neutron-dhcp-agent --action stop
+--------------------+--------------------------------------+--------+---------+
| template | runsonhost | action | result |
+--------------------+--------------------------------------+--------+---------+
| neutron-dhcp-agent | 9098B929-D21D-B211-931F-0018E1C5D866 | stop | success |
+--------------------+--------------------------------------+--------+---------+
9098B929-D21D-B211-931F-0018E1C5D866:/home/fsp # cps host-template-instance-operate --
service neutron neutron-dhcp-agent --action start
+--------------------+--------------------------------------+--------+---------+
| template | runsonhost | action | result |
+--------------------+--------------------------------------+--------+---------+
| neutron-dhcp-agent | 9098B929-D21D-B211-931F-0018E1C5D866 | start | success |
+--------------------+--------------------------------------+--------+---------+
2.
查询网口是否放通vlan。
a.
执行如下命令。
neutron net-show network_id
B4B7CB29-D21D-B211-8F3E-0018E1C5D866:~ # neutron net-show b5e7b481-b07e-444c-a4aa-
ddc5a0316252
+---------------------------+--------------------------------------+
| Field | Value |
+---------------------------+--------------------------------------+
| admin_state_up | True |
1

## Page 359

| availability_zone_hints | |
| availability_zones | |
| created_at | 2018-07-24T09:48:10 |
| description | |
| id | b5e7b481-b07e-444c-a4aa-ddc5a0316252 |
| ipv4_address_scope | |
| ipv6_address_scope | |
| mtu | 1500 |
| name | network2198 |
| port_security_enabled | True |
| project_id | 363fc4cc17fe4ba58b5cc909dd476171 |
| provider:network_type | vlan |
| provider:physical_network | physnet1 |
| provider:segmentation_id | 2198 |
| qos_policy_id | |
| router:external | False |
| shared | False |
| status | ACTIVE |
| subnets | |
| tags | |
| tenant_id | 8ed209105d2547fba0e74b9dfbcaa859 |
| updated_at | 2018-07-24T09:48:10 |
+---------------------------+--------------------------------------+
b.
根据步骤3.2.a查询结果，获取需要放通的vlan号。
▪
对于“provider:network_type”为“vlan”，
“provider:segmentation_id”即为vlan号。
本例vlan号为2198。
▪
对于“provider:network_type”为“vxlan”且OpenStack对接SDN，交
换机上的vlan由SDN放通，执行步骤9。
▪
对于“provider:network_type”为“vxlan”且OpenStack未对接SDN，
执行如下命令，获取vlan号。
cps network-list | grep tunnel_bearing
本例vlan号为4003，如下所示。
B4B7CB29-D21D-B211-8F3E-0018E1C5D866:~ # cps network-list | grep tunnel_bearing
| tunnel_bearing | 1 | internal_auto | 172.28.48.0-172.28.63.255 | 172.28.48.0/20 | | 4003 | |
| tx_limit: | | System vm tunnel network. |
c.
根据步骤3.2.a查询结果，查询网络对应的nic口。
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne
方式）章节。
▪
对于“provider:network_type”为“vlan”，选择“配置
>
网络
>
网口
映射配置”，找到异常服务所在主机的主机组，查看
provider:physical_network对应的nic口。
如下图physnet1对应的nic口为nic0和nic1。
1

## Page 360

▪
对于“provider:network_type”为“vxlan”，选择“配置
> OpenStack
>
Neutron”，单击“配置Tunnel Bearing网络平面”，找到异常服务所
在主机的主机组，查看tunnel_bearing对应的nic口。
如下图tunnel_bearing对应nic0和nic1。
d.
执行如下命令，查询nic口对应的eth口。
cat /usr/bin/ports_info | python -mjson.tool
B4B7CB29-D21D-B211-8F3E-0018E1C5D866:~ # cat /usr/bin/ports_info | python -mjson.tool
{
"Logic-phyMapInfo": {
"nic0": "eth0",
"nic1": "eth1",
"nic2": "eth2",
"nic3": "eth3",
"nic4": "eth4",
"nic5": "eth5"
},
……
}
e.
查询本机eth口在交换机对应的网口上是否放通该vlan，如果没有放通，则需
要放通该vlan。
3.
查询网络绑定的port是否有残留。
a.
执行命令neutron
port-list --network-id network_id --device_owner
network:dhcp，获取port ID。
1

## Page 361

b.
执行命令neutron
port-show port
ID，查看该port属性。
1DAB63EF-98F8-6FA4-E811-E0270C10E39A:/home/fsp # neutron port-show
7d743220-0e3f-41e6-b7be-c93ff9445306
+-----------------------+--------------------------------------------------------------------------------------
+
| Field | Value |
+-----------------------+--------------------------------------------------------------------------------------
+
| admin_state_up | True |
| allowed_address_pairs | |
| binding:host_id | |
| binding:profile | {} |
| binding:vif_details | {} |
| binding:vif_type | unbound |
| binding:vnic_type | normal |
| created_at | 2019-07-30T02:15:03 |
| description | |
| device_id | reserved_dhcp_port |
| device_owner | network:dhcp |
| extra_dhcp_opts | |
| fixed_ips | {"subnet_id": "1c4fa5e5-d4d8-4671-bdd8-fc834282565f", "ip_address":
"192.168.2.226"} |
| id | 7d743220-0e3f-41e6-b7be-c93ff9445306 |
| mac_address | fa:16:3e:b0:c3:b4 |
| name | reserved_distributed_dhcp_port |
| network_id | e12cf0db-d28f-4e7c-ae0f-96516310869d |
| port_security_enabled | False |
| project_id | 8341fdc718b34ee699a7f25461983fda |
| qos_policy_id | |
| security_groups | |
| status | ACTIVE |
| tags | distributed |
| tenant_id | 8341fdc718b34ee699a7f25461983fda |
| updated_at | 2019-07-30T02:17:33 |
+-----------------------+--------------------------------------------------------------------------------------
+
当查询结果device_id的值为reserved_dhcp_port，表示该port为残留port，使
用neutron
port-delete port-id
命令删除该port。
步骤4 执行以下命令，根据步骤2中获取的“error_info”中的network_id，遍历检查
dnsmasq进程是否存在。
ps aux | grep -w dnsmasq | grep -v grep | grep -w network_id
●
若查询结果如下所示，进程状态显示为“T”，表示STOP，执行kill
-18
进程号。
本例中进程号为7605。完成后，执行步骤7。
B4B7CB29-D21D-B211-8F3E-0018E1C5D866:~ # ps aux | grep -w dnsmasq | grep -v grep | grep -w
82262c70-e8bf-491c-b289-730f60462741
opensta+ 7605 0.0 0.0 13964 940 ? T Jul24 0:00 dnsmasq --no-hosts --no-resolv --strict-
order --except-interface=lo --pid-file=/var/lib/neutron/dhcp/82262c70-e8bf-491c-
b289-730f60462741/pid --dhcp-hostsfile=/var/lib/neutron/dhcp/82262c70-e8bf-491c-
b289-730f60462741/host --addn-hosts=/var/lib/neutron/dhcp/82262c70-e8bf-491c-
b289-730f60462741/addn_hosts --dhcp-optsfile=/var/lib/neutron/dhcp/82262c70-e8bf-491c-
b289-730f60462741/opts --dhcp-leasefile=/var/lib/neutron/dhcp/82262c70-e8bf-491c-
b289-730f60462741/leases --dhcp-match=set:ipxe,175 --bind-interfaces --interface=tapc5f8ef1a-54 --
dhcp-range=set:tag0,10.7.8.0,static,2592000s --dhcp-option-force=option:mtu,1500 --dhcp-lease-
max=256 --conf-file=/etc/neutron/dnsmasq.conf --domain=openstacklocal
●
否则，执行步骤9。
步骤5 参考1.2.3.1.23 neutron-dhcp-agent组件故障处理章节，处理DHCP agent故障。完
成后，执行步骤7。
步骤6 执行以下命令，根据步骤2中获取的“error_info”中的network_id，查询名空间里
DOWN的端口。
ip netns exec qdhcp-network_id ifconfig -a
1

## Page 362

●
若查询结果如下所示，表示tapc0fa43d7-98状态为DOWN（如果端口是UP，
flags里有“UP”标记）。
70033389-3304-74BA-E811-93EBFEF7D209:~ # ip netns exec qdhcp-38f49e94-96f8-4faf-a728-580ce221fe80
ifconfig -a
lo: flags=73<UP,LOOPBACK,RUNNING> mtu 65536
inet 192.168.0.1 netmask 255.0.0.0
inet6 FC00::1 prefixlen 128 scopeid 0x10<host>
loop txqueuelen 1 (Local Loopback)
RX packets 2 bytes 688 (688.0 B)
RX errors 0 dropped 0 overruns 0 frame 0
TX packets 2 bytes 688 (688.0 B)
TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0
tapc0fa43d7-98: flags=2<BROADCAST> mtu 1500
inet 192.168.1.254 netmask 255.255.255.0 broadcast 192.168.1.255
ether fa:16:3e:50:32:7c txqueuelen 1000 (Ethernet)
RX packets 11055 bytes 765844 (747.8 KiB)
RX errors 0 dropped 4 overruns 0 frame 0
TX packets 10874 bytes 830188 (810.7 KiB)
TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0
执行以下命令将名空间里查询到的DOWN的端口设置为UP。
ip netns exec qdhcp-network_id ifconfig
端口
up
结果如下所示：
70033389-3304-74BA-E811-93EBFEF7D209:~ # ip netns exec qdhcp-38f49e94-96f8-4faf-a728-580ce221fe80
ifconfig tapc0fa43d7-98 up
步骤7 等待5分钟~6分钟，告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤8。
步骤8 告警error_info是否有更新。
●
是，执行步骤2。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.102 ALM-1200075
主机设备端口错包告警
告警解释
当主机设备端口（如果是Trunk口，则按照Trunk为单位）的错包率达到告警配置中配
置的百分比后，系统会产生此告警。
当错包率低于告警配置中配置的百分比后，告警自动清除。
1

## Page 363

告警属性
告警ID 告警级别 可自动清除
1200075
重要 是
告警参数
参数名称 参数含义
附加信息
●
指标名称：监控的指标名称
●
最近2个周期数据：最近2次的丢包率
●
告警生成条件：产生告警的条件
定位信息
●
区域：环境信息
● 实例名称：上报告警的实例名称
●
管理IP：告警节点的OM IP地址
●
网口：产生告警的网口名称
对系统的影响
引起主机设备端口数据丢包或者网络不通。
可能原因
主机设备端口收到或发送错误报文。
处理步骤
步骤1 使用PuTTY，通过告警定位信息中的“管理IP”登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
产品名称“FusionSphere Openstack”，节点类型“OpenStack节点”下fsp帐户的默
认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
产品名称“FusionSphere Openstack”，节点类型“OpenStack节点”下root帐户的
默认密码。
步骤3 根据告警信息中的端口名称，获取异常端口的名称（如果端口名称是ethx，表示端口
没有组bond）。通过
"ip link | grep
端口名称" 查看端口，查看回显信息是否为空。
1

## Page 364

●
是，说明异常端口是用户态网桥上的端口，执行步骤4。
●
否，说明异常端口是内核态网桥上的端口，执行步骤5。
步骤4 执行如下命令 ，观察crc相关计数是否增长。
ovs-appctl dpif-dpdk/dump-eth-xstat trunkx | grep -Ei "crc|NIC"
trunkx为告警trunk口
●
是，说明是物理链路问题，请联系华为技术支持工程师排查链路问题。
●
否，执行步骤6。
步骤5 如果该端口是Trunk口，执行如下操作观察crc相关计数是否增长。
1.
执行如下命令查询对应的设备口。
cat /proc/net/bonding/trunkx | grep eth
trunkx为告警trunk口。
2.
执行如下命令，观察crc相关计数是否增长。
ethtool -S ethx | grep -Ei "crc"
ethx为步骤步骤5.1中查询的设备名称或告警eth口。
–
是，说明是物理链路问题，请联系华为技术支持工程师排查链路问题。
–
否，执行步骤7。
步骤6 获取端口的收发数据包。
1.
执行如下命令使能用户态EVS报文探针功能。
ovs-appctl dpif-dpdk/component load packet_probe
2.
执行如下命令开始获取数据包。
ovs-appctl dpif-dpdk/component exec packet_probe start port_name -w
数
据包内容保存路径
1

## Page 365

记录该uuid，执行步骤6.3命令，需要该uuid。
3.
执行如下命令停止获取数据包。
ovs-appctl dpif-dpdk/component exec packet_probe stop port_name -uuid
获取数据包时得到的uuid
4. 执行如下命令关闭用户态EVS的获取数据包功能。
ovs-appctl dpif-dpdk/component unload packet_probe
步骤7 执行如下命令，使用tcpdump获取端口的收发包。
tcpdump -i port_name -w
数据包内容保存路径
说明
按Ctrl+C停止获取数据包。
步骤8 使用wireshark等网络分析工具分析收发的数据包中错误报文来源，排查并解决可能导
致错误报文的根源，查看告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.103 ALM-1200076
主机设备端口丢包告警
告警解释
当主机设备端口（如果是Trunk口，则按照Trunk为单位）的丢包率达到告警配置中配
置的百分比后，系统会产生此告警。
告警属性
告警ID 告警级别 可自动清除
1200076
重要 是
1

## Page 366

告警参数
参数名称 参数含义
附加信息
●
指标名称：监控的指标名称
●
最近2个周期数据：最近2次的丢包率
●
告警生成条件：产生告警的条件
定位信息
●
区域：环境信息
●
实例名称：上报告警的实例名称
●
管理IP：告警节点的OM IP地址
●
网口：产生告警的网口名称
对系统的影响
引起主机设备端口数据丢包或者网络不通。
可能原因
●
网络IO压力达到极限。
●
用于转发的CPU资源不足。
● 网络配置错误，无法正确转发。
处理步骤
步骤1 使用PuTTY，通过告警定位信息中的“管理IP”登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
产品名称“FusionSphere Openstack”，节点类型“OpenStack节点”下fsp帐户的默
认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
产品名称“FusionSphere Openstack”，节点类型“OpenStack节点”下root帐户的
默认密码。
步骤3 根据告警信息中的端口名称，获取异常端口的名称（如果端口名称是ethx，表示端口
没有组bond）。通过
"ip link | grep
端口名称" 查看端口，查看回显信息是否为空。
●
是，说明异常端口是用户态网桥上的端口，执行步骤4。
●
否，说明异常端口是内核态网桥上的端口，执行步骤5。
步骤4 执行如下命令查看端口状态。
ovs-vsctl get interface port_name link_state
1

## Page 367

●
如果连接不正常，请重新插拔网线。
●
如果连接正常，请执行如下命令收集具体丢包信息，执行步骤7。
执行命令
ovs-vsctl iface-to-br port_name
获取 bridge_name，
执行命令
ovs-ofctl dump-ports bridge_name port_name
收集具体丢包信息。
步骤5 执行如下命令检查端口链路状态是否正常。
ethtool port_name
●
如果图中Link detected为no，请重新插拔网线，检查端口。
●
如果图中Link detected为yes，执行步骤6。
步骤6 执行如下命令查看对应端口流量是否达到网卡支持的最大带宽。
sar -n DEV
1，命令回显如下所示：
●
如果端口流量已达到网卡支持的最大带宽，且流量为正常业务流量，请考虑更换
更大带宽的物理网卡或者通过组bond的方式提高uplink带宽。
●
如果端口流量未达到网卡支持的最大带宽，执行步骤7。
1

## Page 368

步骤7 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.104 ALM-1200077 Dpdk lacp bond
聚合失败
告警解释
当LACP模式的DPDK bond协商失败时，系统产生告警。
告警属性
告警ID 告警级别 可自动清除
1200077
重要 是
告警参数
参数名称 参数含义
名称 告警的名称。
对象ID 产生告警对象的ID。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的ID，比如：主机ID。如果是业务模块产生的告
警，则表示的是业务模块的ID，比如：Openstack OM。
对象类型 产生告警的对象的类型，比如：host（代表主机），heart
beat（代表心跳检测系统）。
对象名称 产生告警的对象的名称。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的名称，比如：主机名。如果是业务模块产生的
告警，则表示的是业务模块的名称，比如：Openstack
OM。
部件类型 产生告警的部件的类型，比如：Openstack、Openstack
OM。
部件名称 产生告警的部件的名称。
定位信息 产生告警的对象的具体信息，一般用key=value,key=value
方式。比如：host=*****,portName=###，表示：****主机
上的###端口产生此告警。
1

## Page 369

参数名称 参数含义
附加信息 产生告警的一些扩展信息，一般用key=value,key=value方
式。比如：Threshold=70,current_value=75，标识产生告
警的原因是阈值为70，而当前值为75。
产生时间 告警产生的时间。
清除时间 告警清除的时间。
清除类型 告警清除的方式，告警清除的类型包括手工清除和自动清
除。
清除用户 手工清除告警的用户名称，自动清除告警时此参数为空。
清除用户ID 手工清除告警的用户ID，自动清除告警时此参数为空。
清除来源 手动清除告警时，清除告警的来源（租户侧视图或管理侧视
图）。
流水号 此条告警信息产生的顺序编号。
对系统的影响
虚拟网络uplink端口网络业务中断。
可能原因
●
对端交换机配置错误。
●
主机网卡和光模块不匹配导致的链路不通。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
1

## Page 370

步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，查询网卡类型。
ovs-vsctl show
步骤6 根据告警附加信息中显示的bond名称，slave名称，获取异常的bond及slave信息。
●
如果步骤5中的查询的网卡类型为hwbond，请执行如下命令查看EVS或OVS-
DPDK网桥上的dpdk
lacp
bond端口lacp_status状态。
ovs-appctl hwoff/hwbond-show bond_name
●
如果步骤5中的查询的网卡类型为dpdkbond，请执行如下命令查看EVS或OVS-
DPDK网桥上的dpdk
lacp
bond端口lacp_status状态。
ovs-appctl dpdk-bond/show bond_name
●
如果lacp_status为active negotiated，请手动清除告警。
●
如果lacp_status为active configured，请执行步骤7。
●
如果lacp_status为active disabled，请执行步骤8。
步骤7 登录对端主机或者交换机检查trunk设置是否正确。
●
如果配置错误请修改配置正确后查看告警是否恢复。
●
如果配置正确，请执行步骤9。
步骤8 查看本端网卡硬件状态指示，如指示错误请尝试插拔网线或更换硬件（如光模块），
然后观察状态指示是否恢复正常。
1

## Page 371

●
如无法恢复，请联系硬件服务支持。
●
如指示恢复正常，请查看告警是否恢复，如告警不恢复，请执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.105 ALM-1200081
网络服务业务网卡异常告警
告警解释
当提供网络服务的网元虚拟机业务网卡异常（比如网卡被卸载等）时，系统产生此告
警。
告警属性
告警ID 告警级别 可自动清除
1200081
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务
● 主机ID：产生告警的主机ID
附加信息
●
主机名：产生告警的主机名称
●
详细信息：产生告警的详细信息
对系统的影响
网络服务对应的业务通信异常。
可能原因
人为操作卸载网络服务对应的网元虚拟机的业务网卡。
1

## Page 372

前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤7 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤8 执行以下命令重启主机。
reboot
步骤9 根据告警定位信息中的主机ID，执行以下命令查询主机上的网卡mac信息。
cps host-show
主机ID
| grep mac
步骤10 任选一个mac，执行以下命令查询对应的虚拟机名。
neutron port-list|grep -i MAC_ADDRESS
1

## Page 373

返回的结果中port名称是“xxx_port_虚拟机名”格式，提取虚拟机名，记为
VM_NAME。
controller1:/home/fsp # neutron port-list|grep -i FA:16:3E:5B:34:A7
| 2cd2dba2-dc1a-45c5-9519-922e48081769 | internal_base_port_vrouter_vm_az0_dc0_group1_0 |
fa:16:3e:5b:34:a7 |
步骤11 根据虚拟机名和告警附加信息里详细信息的服务名，确定PORT_NAME。
● 如果是“ENAT”，则PORT_NAME为enat_parent_port_VM_NAME
●
如果是“VROUTER”，则PORT_NAME为dpdk_parent_port_VM_NAME和
dc_port_VM_NAME
●
如果是“CVS”，则PORT_NAME为busi_parent_port_elbv3_cvs_VM_NAME_0
和
busi_parent_port_elbv3_cvs_VM_NAME_1
●
如果是“NGINX”，则PORT_NAME为
busi_parent_port_elbv3_nginx_VM_NAME
步骤12 执行以下命令，查看是否可以根据PORT_NAME查询到port信息，获取port_id。
neutron port-list|grep PORT_NAME
controller1:/home/fsp # neutron port-list|grep enat_parent_port_vrouter_vm_az0_dc0_group1_0
| 5b44b8c3-512c-44af-8ff5-822dec6ae17b | enat_parent_port_vrouter_vm_az0_dc0_group1_0 |
fa:16:3e:44:e7:c5 |
●
是，记录port id为SERVICE_PORT_ID，mac地址为SERVICE_MAC_ADDRESS，
再执行步骤13。
●
否，说明port被删掉，请执行步骤14。
步骤13 执行以下命令，查询port的device_id是否为空。
neutron port-show port_id |grep device_id
●
是，说明服务的业务网卡被卸载，请联系环境管理员确认是否有人为操作。如需
手动恢复，请跳转到步骤22继续执行。
●
否，请联系技术支持工程师协助解决。
步骤14 执行以下命令，查询虚拟机ID，记为VM_ID。
nova list --all-ten|grep VM_NAME
步骤15 执行以下命令，获取虚拟机的az。
nova show VM_ID | grep availability_zone
步骤16 根据获取的虚拟机az，执行以下命令获取Tunnel_Bearing平面网络信息。
neutron net-list -c id -c name -c tags |grep NetCluster_Tunnel_Bearing_Net |
grep AZ
获取网络id记为NET_ID。
步骤17 依次执行以下命令，创建网络服务父port。
export TOKEN=`openstack token issue | grep id | grep -v _id |awk '{print $4}'`
curl -X POST https://network.localdomain.com:8020/v2.0/ports.json -H "User-
Agent: python-neutronclient" -H "Content-Type: application/json" -H "Accept:
application/json" -H "X-Auth-Token: $TOKEN" -d '{"port": {"network_id":
"NET_ID", "fixed_ips": [], "name": "PORT_NAME", "admin_state_up": true}}' -k
其中PORT_NAME在步骤11中获取。
1

## Page 374

controller1:/home/fsp # export TOKEN=`openstack token issue | grep id | grep -v _id |awk '{print $4}'`
controller1:/home/fsp # curl -X POST https://network.localdomain.com:8020/v2.0/ports.json -H "User-Agent:
python-neutronclient" -H "Content-Type: application/json" -H "Accept: application/json" -H "X-Auth-Token:
$TOKEN" -d '{"port": {"network_id": "5c8550cf-ba9f-437c-b1e5-f8b248dd2621", "fixed_ips": [], "name":
"vrouter_parent_port_vrouter_vm_az0_dc0_group1_0", "admin_state_up": true}}' -k
{"port": {"allowed_address_pairs": [], "extra_dhcp_opts": [], "alias_id": null, "updated_at":
"2020-03-05T04:59:11", "device_owner": "", "binding:profile": {}, "port_security_enabled": true, "fixed_ips":
[], "id": "bd84cd81-5291-425d-bfec-6351e077d903", "security_groups": ["eedc7124-990e-42e8-9301-
f29ad8f8b76f"], "binding:vif_details": {}, "binding:vif_type": "unbound", "mac_address":
"fa:16:3e:16:05:2a", "project_id": "ffce606e3f4b43929dca87335aefcda1", "status": "DOWN",
"binding:host_id": "", "description": "", "tags": [], "device_id": "", "name":
"vrouter_parent_port_vrouter_vm_az0_dc0_group1_0", "admin_state_up": true, "network_id": "5c8550cf-
ba9f-437c-b1e5-f8b248dd2621", "tenant_id": "ffce606e3f4b43929dca87335aefcda1", "created_at":
"2020-03-05T04:59:11", "binding:vnic_type": "normal"}}
获取父port id，记为SERVICE_PORT_ID。获取mac_address，记为
SERVICE_MAC_ADDRESS。
步骤18 执行以下命令，查询关联的子port是否存在，其中PORT_NAME在步骤11中获取。
neutron port-list | grep PORT_NAME
●
是，获取子port id，记为SUB_PORT_ID，执行步骤19。
●
否，执行如下命令，创建子port。
curl -X POST https://network.localdomain.com:8020/v2.0/ports.json -H
"User-Agent: python-neutronclient" -H "Content-Type: application/json" -
H "Accept: application/json" -H "X-Auth-Token: $TOKEN" -d '{"port":
{"network_id": "NET_ID", "fixed_ips": [], "name": "PORT_NAME",
"admin_state_up": true}}' -k
获取子port id，记为SUB_PORT_ID，执行步骤19。
步骤19 执行以下命令，根据父port创建trunk，trunk名为trunk@SERVICE_PORT_ID的前11
位。
neutron trunk-create TRUNK_NAME --parent-port SERVICE_PORT_ID
controller1:/home/fsp # neutron trunk-create trunk@bd84cd81-52 --parent-port bd84cd81-5291-425d-
bfec-6351e077d903
+----------------+--------------------------------------+
| Field | Value |
+----------------+--------------------------------------+
| admin_state_up | UP |
| id | 940abdf3-b78f-4c44-a1d3-f970cbebec5d |
| name | trunk@bd84cd81-52 |
| port_id | bd84cd81-5291-425d-bfec-6351e077d903 |
| status | DOWN |
| sub_ports | |
| tenant_id | ffce606e3f4b43929dca87335aefcda1 |
+----------------+--------------------------------------+
获取id，记为TRUNK_ID。
步骤20 执行以下命令，获取NET_VLAN。
neutron net-show NET_ID | grep segmentation_id
步骤21 执行以下命令，在trunk口里添加子port。
neutron trunk-subport-add TRUNK_ID --subport
port=SUB_PORT_ID,segmentation-type=vlan,segmentation-id=NET_VLAN
步骤22 执行以下命令，重新加载被卸载的网卡。
1

## Page 375

nova interface-attach VM_ID --port-id SERVICE_PORT_ID
步骤23 执行以下命令重启告警节点。
reboot
步骤24 根据虚拟机名和告警附加信息里详细信息的服务名，选择对应操作。
●
如果告警服务是“ENAT”或者“VROUTER”，执行步骤25。
●
如果告警服务是“CVS”或者“NGINX”，执行步骤36。
步骤25 根据告警附件信息中的被卸载网卡PCI信息，执行以下命令。
cps hostcfg-show --type network VM_NAME | grep PCI -3
获取其中的name参数记为NIC_NAME
controller1:/home/fsp # cps hostcfg-show --type network vrouter_vm_az0_dc0_group1_0 |grep 0000:04:07.0
-3
| | name:slave3, |
| | mtu:9000, |
| | option:{dev_id: 0x0, |
| | PCISLOT: 0000:04:06.0} |
| | |
步骤26 在FusionSphere OpenStack安装部署界面，选择“配置
>
网络
>
网口映射配置”，找
到以虚拟机名称VM_NAME命名的主机组，进入界面。
●
如果是“ENAT”服务告警，找到网桥“enat-dpdk”，查看映射的网卡是否是
“未知网卡”颜色标记。
–
是，删除映射的网卡，单击“提交”。
–
否，执行步骤36。
●
如果是“VROUTER”服务告警，找到NIC_NAME对应的网桥“vrouter-dpdk”或
者“vrouter-dc”，删除映射的网卡，单击“提交”。
步骤27 在告警主机，依次执行以下命令，删除原网卡对应的nic信息。
cps hostcfg-item-delete --item nic --nic-name NIC_NAME --type network
VM_NAME
cps commit
步骤28 根据查到的网卡mac信息SERVICE_MAC_ADDRESS，执行以下命令查看新网卡名。
ifconfig | grep SERVICE_MAC_ADDRESS -3
获取网卡名ethx，记为ETH_NAME。
步骤29 根据获取的网卡名，执行以下命令查看新网卡的PCI信息，记为NEW_PCI。
ethtool -i ETH_NAME | grep bus-info
步骤30 依次执行以下命令，增加新网卡对应的nic信息。
cps hostcfg-item-add --item nic --nic
name=NIC_NAME,option=NEW_PCI,dev_id=0x0,mtu=9000 --type network
VM_NAME
cps commit
步骤31 在FusionSphere OpenStack安装部署界面，进入“配置
>
内核参数”界面，选择告警
主机对应的主机组，不勾选“启用自动大页内存”，单击“提交”。
1

## Page 376

步骤32 进入“配置
>
网络
>
网口映射配置”界面，选择以虚拟机名称VM_NAME命名的主机
组。
1.
添加网卡，并提交。
–
如果是“ENAT”服务告警，找到网桥“enat-dpdk”，把步骤29获取的
NEW_PCI的网卡添加进来，同时选择“平面类型”为“用户态OVS网桥”，
单击“提交”。
–
如果是“VROUTER”服务告警，找到NIC_NAME对应的网桥“vrouter-
dpdk”或者“vrouter-dc”，把步骤29获取的NEW_PCI的网卡添加进来，同
时选择“平面类型”为“用户态OVS网桥”，单击“提交”。
2.
确认该主机组除了“Nic1”外，其他网桥的slave网卡是否为“未知网口”的颜色
标记。
–
是，执行步骤33。
–
否，执行步骤34。
步骤33 删除并重新配置网卡。
1.
记录网桥和网卡的映射关系。
2.
删除“未知网卡”颜色标记的网卡，单击“提交”。
3.
在告警主机，执行以下命令，查询标记的网卡信息。
cps hostcfg-show --type network VM_NAME| grep name:slave -5
4.
执行以下命令，删除标记的网卡。
cps hostcfg-item-delete --item nic --nic-name NIC_NAME --type network
VM_NAME
cps commit
cps hostcfg-item-add --item nic --nic
name=NIC_NAME,option=PCI,dev_id=0x0,mtu=9000 --type network VM_NAME
cps commit
5.
进入“配置
>
网络
>
网口映射配置”界面，根据记录的网桥和网卡映射关系，把网
卡添加到对应的网桥中，同时选择“平面类型”为“用户态OVS网桥”，单击“提
交”。
步骤34 在FusionSphere OpenStack安装部署界面，进入“配置 > 内核参数”，选择告警主机
对应的主机组，勾选“启用自动大页内存”，单击“提交”。
步骤35 在告警主机，执行以下命令，更新服务的网卡配置。
1.
执行以下命令，获取服务所对应的az的分组名，记为CLUSTER。
cps cluster-list
2.
遍历执行以下命令，X依次表示1-5，查询组件名。
cps template-instance-list --service
组件名
|grep host_id
–
当告警服务是“ENAT”时，组件名为neutron-l3-nat-agent0X。
–
当告警服务是“VROUTER”时，组件名为neutron-vrouter0X 。
当界面显示数据时，表示当前查询的组件即为部署的服务组件。
3.
执行以下命令，更新配置。
–
如果告警服务是“ENAT”，则配置命令如下：
1

## Page 377

cps template-params-update --service nat-server neutron-l3-nat-
agent0X --cluster CLUSTER --parameter
physnet_port_enat=ETH_NAME
cps commit
其中neutron-l3-nat-agent0X是对应的组件名。
– 如果告警服务是“VROUTER”，则配置命令如下：
cps template-params-update --service vrouter neutron-vrouter0X --
cluster CLUSTER --parameter physical_port_dpdk=ETH_NAME
cps commit
其中neutron-vrouter0X是对应的组件名。
步骤36 在告警所在主机，手动执行以下命令。
●
如果告警服务是“ENAT”，则命令如下：
python /etc/neutron/neutron-l3-nat-agent/alarm.py
●
如果告警服务是“VROUTER”，则命令如下：
python /etc/neutron/neutron-vrouter/alarm.py
●
如果告警服务是 "CVS"，则命令如下：
python /opt/cloud/elb/agent/bin/l4_alarm.py
●
如果告警服务是 "NGINX"，则命令如下：
python /opt/cloud/elb/agent/bin/l7_alarm.py
步骤37 在告警页面，查看告警是否恢复。
●
是，处理完毕。
● 否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.106 ALM-1200082
交换机异步配置失败
告警解释
在Region
Type
I场景下，当在交换机上异步下发overlay网络配置失败时，系统产生此
告警。
告警属性
告警ID 告警级别 可自动清除
1200082
重要 是
1

## Page 378

告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务
●
交换机ID：下发配置失败的交换机ID
附加信息 交换机管理IP：下发配置失败的交换机管理IP地址
对系统的影响
交换机承载的网络服务通信异常。
可能原因
●
交换机上underlay配置错误，导致配置冲突。
●
交换机故障。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 查看当前告警信息。
1.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
2.
单击目标告警所在行的 ，展开告警详情。
3.
查看告警详情中的“定位信息”字段及“附加信息”字段，获取定位信息和附加
信息，记录定位信息中的交换机ID以及附加信息中的交换机管理IP。
步骤3 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤4 选择“服务列表
>
网络资源
>
交换机设备
>
交换机列表”，进入“交换机列表”界
面。
步骤5 根据告警定位信息中的“交换机ID”和附加信息的“交换机管理IP”，找到对应的交
换机。
1

## Page 379

步骤6 单击该交换机“操作”列的“对账”按钮，开启对账，并记录对账开始时间。
步骤7 等待对账结束，查看对账是否成功。
●
是，执行步骤15。
●
否，执行步骤8。
步骤8 单击对账状态中的“失败”按钮，查看对账失败原因。
●
任务超时，可能是设备故障原因，请排查设备故障，排查完后执行步骤14，再次
执行对账。
●
内容错误，可能是存在冲突的underlay配置。执行步骤9，通过日志查看冲突的配
置错误。
步骤9 登录FusionSphere OpenStack控制节点，具体请参见3.5 使用PuTTY登录
FusionSphere
OpenStack节点。
步骤10 执行命令cps
template-instance-list --service pecado
device-manager，记录状态
为active实例的omip。
66D8C5E1-1800-1897-B211-D21DB6159D34:/home/fsp # cps template-instance-list --service pecado device-
manager
+------------+----------------+---------+--------------------------------------+------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+----------------+---------+--------------------------------------+------------+
| 0 | device-manager | active | 7C8B040A-4F08-5EA6-E911-00AEF2BCF287 | 10.37.2.174 |
| 1 | device-manager | standby | 66D8C5E1-1800-1897-B211-D21DB6159D34 | 10.37.2.167 |
+------------+----------------+---------+--------------------------------------+------------+
步骤11 根据步骤10中记录的状态为active实例的omip，参考3.5 使用PuTTY登录
FusionSphere
OpenStack节点章节，登录日志所在节点。
步骤12 执行以下命令，查找错误的配置下发日志记录。
说明
只需关注开始对账后大概5分钟之内的日志记录。
grep 'some config fail to neId:
交换机ID'
-B 100 /var/log/fusionsphere/
component/device-manager/device-manager.log
比如，grep
'some config fail to neId: bb1bc8e2-9049-4e9e-9ca2-ad375ff6d6c5' -
B 100 /var/log/fusionsphere/component/device-manager/device-
manager.log，其中，bb1bc8e2-9049-4e9e-9ca2-ad375ff6d6c5为在步骤2.3中已记
录的交换机ID。
步骤13 参考正确的underlay配置，解决配置下发错误。
正确的underlay配置，请参考《华为云Stack
8.1.0
网络配置最佳实践（Region
Type
I）》（Region
Type
I）中的“L2BR服务网络配置”和“增强型云专线服务网络配置”
章节。
如下所示，错误配置为交换机中bridge
domain
VNI：298996使用冲突。
1

## Page 380

2020-03-13 22:50:42,023 INFO [dev-kafka-consumer-3] [NetconfMsgHandler:220] - Pre-commit config
transaction result is: <?xml version="1.0" encoding="UTF-8"?>
<rpc-reply message-id="216-CREATE-SUBNET-2-ddbf7de8-bde7-495a-8886-c8c685380c06-pre-commit"
xmlns="urn:ietf:params:xml:ns:netconf:base:1.0" flow-id="1167">
<rpc-error>
<error-type>application</error-type>
<error-tag>data-exists</error-tag>
<error-severity>error</error-severity>
<error-app-tag>10899</error-app-tag>
<error-message>This bridge-domain has already exist.&#13;</error-message>
<error-info>
<evc xmlns="xxxx://xxx.xxxx.xxx/xxx" format-version="1.0" content-version="1.0">
<bds>
<bd>
<bdId>298996</bdId>
<bdDesc>BY_CONTROLLER</bdDesc>
</bd>
</bds>
</evc>
</error-info>
</rpc-error>
</rpc-reply>
步骤14 再次启动对账。等待对账结束，查看对账是否成功。
●
是，执行步骤15。
●
否，请联系技术支持工程师协助解决。
步骤15 查看告警是否恢复。
●
是，处理完毕。
● 否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.107 ALM-1200083
虚拟机端口连接跟踪数过大告警
告警解释
OpenStack周期性（5分钟）检测虚拟机端口的连接跟踪数，每个虚拟机端口的连接跟
踪数都有上限值，当虚拟机端口的连接跟踪数达到了告警上报阈值（上限值的95%）
时，系统产生此告警。
当虚拟机端口的连接跟踪数低于告警恢复阈值（上限值的90%）时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
1200083
重要 是
1

## Page 381

告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID
附加信息
●
主机名：产生告警的主机名称
●
端口连接跟踪数详情：导致该告警的端口的连接跟踪数
详情，格式为['端口名/上报告警时的连接跟踪数/上报告
警时的连接跟踪数占上限值的百分比']，若同一个主机下
有多个端口同时上报告警，以空格分隔
对系统的影响
可能会导致经过该端口的连接出现丢包现象，若该端口的连接跟踪数达到了上限值，
则无法与该端口建立新的连接。
可能原因
该端口的连接跟踪数达到或超过了告警阈值（上限值的95%）。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
方案一：以端口为粒度，适用于只修改告警的网卡。
方案二：以虚拟机为粒度，适用于需要修改该虚拟机下的所有网卡。
说明
本文档里的操作为临时规避方案，最终需要客户业务侧解决连接数过多的问题。
方案一
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
1

## Page 382

步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 根据告警附加信息中的“端口连接跟踪数详情”，查询该端口的连接跟踪数上限值、
当前连接数。
dev_connlimit get
端口名
回显如下，其中，connlimit对应的值为该端口对应的连接跟踪数上限值，curr_conn对
应的值为该端口当前的连接数。
ThirdNode:~ # dev_connlimit get tap5eb4ce2e-35
interface connlimit curr_conn drop_pkt_stat group
tap5eb4ce2e-35 65535 64000 0 0
步骤7 根据业务需要，执行以下命令，增加该端口的连接跟踪数上限值，令“当前连接数
/
新连接跟踪数上限值
<
90%”。
dev_connlimit set
端口名 新连接跟踪数上限值
说明
●
本命令无回显信息，可以执行步骤6查看新上限值是否生效。若未生效，请联系技术支持工
程师协助解决。
●
端口连接跟踪数上限值不能超过当前主机的连接跟踪数上限值，端口新连接跟踪数上限值可
以逐次按当前端口连接数上限值的50%涨幅调整，避免影响当前主机下其他虚拟机的业务。
●
如果需要查询当前主机的连接跟踪数上限值，请执行以下命令。
sysctl net.netfilter.nf_conntrack_max
net.netfilter.nf_conntrack_max = 2300000
“=”后面的值即为当前主机的连接跟踪数上限值。
●
网卡重建、虚拟机迁移或主机重启后，端口连接数上限值会同步恢复为默认取值。
步骤8 等待五分钟，在告警页面，查看告警是否恢复。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
方案二
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
1

## Page 383

步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 执行以下命令，获取该端口对应的网卡的ID。
neutron port-list | grep
端口名后11位
回显如下，示例中的3bbb8210-89b4-4d0d-bd5b-e59e83f615ec即为网卡的ID。
5C300214-D21D-B211-82D2-000000821800:~ # neutron port-list | grep 3bbb8210-89
| 3bbb8210-89b4-4d0d-bd5b-e59e83f615ec | port@b9dfe413-5cd2-4c15-b494-7204dc149762 |
fa:16:3e:32:92:72 | {"subnet_id": "6c566531-c4b1-4e2e-822c-101b06849438", "ip_address": "192.168.56.204"}
步骤7 执行以下命令，查看网卡的详情，获取该网卡所属的虚拟机ID。
neutron port-show
网卡ID
回显如下，示例中的device_id对应的值fb16b0e4-6f23-47e1-9316-23fca549a159即为
该网卡所属的虚拟机的ID。
5C300214-D21D-B211-82D2-000000821800:~ # neutron port-show 3bbb8210-89b4-4d0d-bd5b-
e59e83f615ec
+-----------------------+---------------------------------------------------------------------------------------+
| Field | Value |
+-----------------------+---------------------------------------------------------------------------------------+
| admin_state_up | True |
| allowed_address_pairs | |
| binding:host_id | 5C300214-D21D-B211-82D2-000000821800 |
| binding:profile | {"primary_interface": true} |
| binding:vif_details | {"port_filter": true, "ovs_hybrid_plug": true} |
| binding:vif_type | ovs |
| binding:vnic_type | normal |
| device_id | fb16b0e4-6f23-47e1-9316-23fca549a159 |
| device_owner | compute:az2.dc2 |
| extra_dhcp_opts | {"opt_value": "0.0.0.0/0,192.168.56.1", "opt_name": "121"} |
| | {"opt_value": "192.168.56.1", "opt_name": "3"} |
| fixed_ips | {"subnet_id": "6c566531-c4b1-4e2e-822c-101b06849438", "ip_address":
"192.168.56.204"} |
| id | 3bbb8210-89b4-4d0d-bd5b-e59e83f615ec |
| mac_address | fa:16:3e:32:92:72 |
| name | port@b9dfe413-5cd2-4c15-b494-7204dc149762 |
| network_id | c91adbac-24d8-49d7-ab72-01c53d701cd7 |
| port_security_enabled | True |
| security_groups | aa513675-6ca6-4894-9d67-1974a94f0f43 |
| status | BUILD |
| tenant_id | 96be2dea8ae743e6a9c4a03f449f61ac |
+-----------------------+---------------------------------------------------------------------------------------+
步骤8 执行以下命令，修改该虚拟机的端口连接跟踪数上限值。
nova meta
虚拟机ID
set
__max_connlimit_out=新连接跟踪数上限值
此命令无回显。
步骤9 执行以下命令，确认修改生效。
nova show
虚拟机ID
| grep __max_connlimit_out
回显如下，可以看到__max_connlimit_out对应的值为100000，说明修改成功。
5C300214-D21D-B211-82D2-000000821800:~ # nova show fb16b0e4-6f23-47e1-9316-23fca549a159 | grep
__max_connlimit_out
| metadata | {"metering.image_id": "a38c16be-
1

## Page 384

baba-4003-93e5-612284fe75bd", "metering.imagetype": "gold", "metering.resourcetype": "1",
"metering.resourcespeccode": "x86.linux", "_ha_policy_type": "remote_rebuild", "server_expiry": "0",
"__cascading.hostname": "ecs-eip000011", "image_name": "EulerOS", "__instance_vwatchdog": "false",
"metering.cloudServiceType": "sys.service.type.ec2", "cascaded.instance_extrainfo":
"current_mem:1024,max_mem:4194304,max_cpu:1,cpu_num_for_one_plug:1,org_cpu:1,xml_support_live_resiz
e:False,num_of_mem_plug:0,org_mem:1024,iohang_timeout:720,current_cpu:1,pcibridge:2", "os_bit": "64",
"vpc_id": "dee52c03-cf06-4bdd-8903-2192c8ba9681", "os_type": "Linux", "charging_mode": "0",
"__max_connlimit_out": "100000", "productId": "f1e42517e71c44d1b26bbaf28782875d"} |
步骤10 根据告警附加信息中的“端口连接跟踪数详情”，查询该端口的连接跟踪数上限值是
否修改生效，端口名为“端口连接跟踪数详情”中的端口名。
dev_connlimit get
端口名
回显如下，其中，connlimit对应的值为该端口对应的连接跟踪数上限值。
ThirdNode:~ # dev_connlimit get tap5eb4ce2e-35
interface connlimit curr_conn drop_pkt_stat group
tap5eb4ce2e-35 65535 64000 0 0
●
如果修改生效，执行步骤11。
●
如果修改未生效请联系技术支持工程师协助解决。
步骤11 等待五分钟，在告警页面，查看告警是否恢复。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.108 ALM-1200084
二层桥接或增强型云专线交换机连接失败
告警解释
二层桥接、增强型云专线特性，通过ServiceOM纳管外部接入交换机，当
FusionSphere
device-manager组件与交换机之间连接失败时，系统产生此告警。定时
扫描并上报告警的周期为5s。
告警属性
告警ID 告警级别 告警类型
1200084 重要 环境告警
1

## Page 385

告警参数
参数名称 参数含义
交换机ID 发生断连的交换机ID。
交换机管理IP 发生断连的交换机管理IP。
对系统的影响
二层桥接、增强型云专线业务通信异常。
可能原因
●
FusionSphere内device-manager组件异常或该组件浮动ip配置异常。
●
二层桥接、增强型云专线交换机上路由、ibgp配置异常。
●
device-manager组件与二层桥接、增强型云专线交换机之间物理链路异常。
处理步骤
检查device-manager组件是否正常、浮动ip配置是否正常。
步骤1 查看当前告警信息。
1.
使用浏览器，登录ManageOne运维面。
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
默认帐号：admin。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
3.
单击目标告警所在行的 ，展开告警详情。
4.
查看告警详情中的“定位信息”字段及“附加信息”字段。
记录连接失败的交换机ID与交换机管理IP。
步骤2 查看device-manager组件状态。
1.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
–
默认帐号：fsp
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”
页签中，在对应节点下该帐户的默认密码。
说明
–
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
– External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP
参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，
在对应节点下该帐户的默认密码。
2.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
1

## Page 386

su - root
3.
使用命令source set_env，导入环境变量。
4.
选择鉴权方式，并按提示输入密码。
5.
使用如下命令查看device-manager组件状态 ：
cps template-instance-list --service pecado device-manager
+------------+----------------+---------+--------------------------------------+---------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+----------------+---------+--------------------------------------+---------------+
| 0 | device-manager | active | 66D8C5E1-1800-1897-B211-D21DB6159D34 | 192.168.2.101 |
| 1 | device-manager | standby | 7C8B040A-4F08-5EA6-E911-00AEF2BCF287 | 192.168.2.102 |
+------------+----------------+---------+--------------------------------------+---------------+
–
若组件状态如上回显所示，说明组件正常，请执行步骤3。
–
若组件无active状态，则表明组件异常导致的二层桥接、增强型云专线交换机
连接失败告警。请查看日志内有无明显报错提示信息，目录“/var/log/
fusionsphere/component/device-managerControl”。
–
若组件主备节点状态分别为active与fault，请登录组件状态为fault所在的节
点，查看日志内有无明显报错提示信息，目录“/var/log/fusionsphere/
component/device-managerControl”。
步骤3 检查交换机管理IP的连通性。
1. 登录device-manager组件active节点。
具体操作请参考步骤2.1~步骤2.4其中device-manager组件active节点的omip请参
见步骤2.5。
2.
使用如下命令查看device-manager组件的float ip。
cps template-ext-params-show --service pecado device-manager
+----------------------------------------------------+-----------------+
| Property | Value |
+----------------------------------------------------+-----------------+
| device-manager.DEFAULT.south_float_ip | 192.168.1.10/24 |
| device-manager.DEFAULT.south_netcard | external_om |
| device-manager.SPRING.spring.kafka.consumer.partit | auto |
| ions | |
+----------------------------------------------------+-----------------+
记录device-manager.DEFAULT.south_float_ip的“Value”的值，192.168.1.10为
该组件的float ip。
3.
执行如下命令，检查交换机管理IP的连通性。
ping -I 192.168.1.10
交换机管理ip
192.168.1.10为步骤3.2中获取的float ip。
交换机管理IP为步骤1告警详情信息中的交换机管理IP。
无回包，则表示网络不通，请执行步骤4。
检查二层桥接、增强型云专线交换机上路由、ibgp配置是否正常。
步骤4 检查二层桥接、增强型云专线交换机配置。
1.
通过交换机管理IP登录交换机。
交换机管理IP为步骤1告警详情信息中的交换机管理IP。
2.
执行如下命令，检查device-manager
float
ip路由表是否正常。
dis bgp routing-table 192.168.1.10
192.168.1.10为步骤3.2device-manager
float ip
若回显如下，则表明正常，执行步骤5。
1

## Page 387

BGP local router ID : 192.168.11.100
Local AS number : 65201
Paths: 1 available, 1 best, 1 select, 0 best-external, 0 add-path
BGP routing table entry information of 3.37.2.0/24:
From: 192.168.5.5 (192.168.6.5)
Route Duration: 3d02h09m59s
Direct Out-interface: 10GE1/0/48
Original nexthop: 192.168.5.5
Qos information : 0x0
AS-path 100, origin igp, MED 0, pref-val 0, valid, external, best, select, pre 255
Not advertised to any peer yet
若回显如下，则表明异常，请执行4.3。
Info: The network does not exist.
3.
执行如下命令，检查ibgp状态是否正常。
dis bgp peer
Status codes: * - Dynamic
BGP local router ID : 192.168.2.200
Local AS number : 65201
Total number of peers : 1
Peers in established state : 1
Total number of dynamic peers : 0
Peer V AS MsgRcvd MsgSent OutQ Up/Down State PrefRcv
192.168.2.200 4 100 5089 5071 0 0073h33m Established 23
–
若回显为State值为Established，则表示正常，执行步骤5。
–
否则表示状态异常，请进行ibgp配置。
4.
以上配置完成后，执行步骤3.3中的ping命令，检查交换机管理IP的连通性。
–
如果能ping通，等待5分钟，查看告警是否消除。
–
如果不能ping通，请执行步骤5。
检查device-manager组件与二层桥接、增强型云专线交换机之间物理链路异常。
步骤5 检查device-manager组件所在节点与二层桥接、增强型云专线交换机之间的物理链路
是否正常，有无断连现象、有无物理接口异常情况。
●
正常，执行步骤6。
●
异常，请联系技术支持工程师协助解决。
步骤6 等待五分钟，在ManageOne运维面的“集中监控
>
告警管理
>
当前告警”界面查看
是否仍存在该告警。
●
是，请联系技术支持工程师协助解决。
●
否，告警已恢复，处理完毕。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 388

1.2.1.109 ALM-1200085
裸机接入交换机连接失败
告警解释
裸机特性，通过neutron-bm-switch-agent组件纳管裸机接入交换机，当FusionSphere
neutron-bm-switch-agent组件与交换机之间连接失败时，系统产生此告警。在进行交
换机对账时触发，对账周期为3分钟。
告警属性
告警ID 告警级别 告警类型
1200085
重要 环境告警
告警参数
参数名称 参数含义
交换机管理IP 发生断连的交换机的带内管理IP。
对系统的影响
交换数据对账异常，新扩容裸金属服务器、新下发裸机实例异常。
可能原因
●
FusionSphere内neutron-bm-switch-agent组件异常。
●
裸机接入交换机netconf配置被修改。
●
Neutron-bm-switch-agent组件与裸机接入交换机之间物理链路异常。
处理步骤
步骤1 查看当前告警信息。
1.
使用浏览器，登录ManageOne运维面。
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
默认帐号：admin。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
3.
单击目标告警所在行的 ，展开告警详情。
4.
查看告警详情中的“定位信息”字段，记录连接失败的交换机管理IP。
步骤2 查看neutron-bm-swtich-agent组件状态。
1.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
–
默认帐号：fsp
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”
页签中，在对应节点下该帐户的默认密码。
1

## Page 389

说明
–
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
– External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP
参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，
在对应节点下该帐户的默认密码。
2. 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
3. 使用命令source set_env，导入环境变量。
4. 选择鉴权方式，并按提示输入密码。
5. 使用如下命令查看neutron-bm-switch-agent组件状态 ：
cps template-instance-list --service neutron neutron-bm-switch-agent
+------------+-------------------------+---------+--------------------------------------+---------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+-------------------------+---------+--------------------------------------+---------------+
| 1 | neutron-bm-switch-agent | standby | 66D8C5E1-1800-1897-B211-D21DB6159D34 |
192.37.2.195 |
| 0 | neutron-bm-switch-agent | active | 66D8C5E1-1800-79A7-B211-D21DFEE77F32 |
192.37.2.169 |
+------------+-------------------------+---------+--------------------------------------+---------------+
– 若组件状态如上回显所示，分别为active和standby，说明组件状态正常，请
执行步骤3。
– 若组件无active状态，则表明组件异常导致的裸机接入交换机连接失败告警。
请登录组件状态为fault所在的节点收集组件日志并联系技术工程师进行处
理，日志目录为“/var/log/fusionsphere/component/neutron-bm-switch-
agent”。
– 若组件主备节点状态分别为active与fault，请登录组件状态为fault所在的节
点收集组件日志并联系技术工程师进行处理，日志目录为“/var/log/
fusionsphere/component/neutron-bm-switch-agent”。
步骤3 检查交换机带内管理IP的连通性。
1. 登录neutron-bm-switch-agent组件active节点。
具体操作请参考步骤2.1~步骤2.4，其中neutron-bm-switch-agent组件active节
点的omip请参见步骤2.5。
2. 执行如下命令，检查交换机管理IP的连通性。
ping 交换机带内管理IP
交换机带内管理IP为步骤1.4中记录的交换机带内管理IP。
– 若能ping通，则表示网络连接正常，请执行步骤4。
– 若不能ping通，则表示网络不通，请执行步骤5。
步骤4 检查裸机接入交换机上netconf配置是否正常。
1. 检查裸机接入交换机配置。
1

## Page 390

须知
交换机管理IP与步骤1.4告警详情信息中的交换机带内管理IP通常不是同一个，带
内管理IP通常限制了登入方式，无法通过telnet或者ssh直接登入，交换机管理IP
通过询问环境管理员获取。
2.
执行如下命令查看netconf帐户配置是否正常。
dis current-configuration | include client201
说明
其中client201通过netconf接口连接交换的帐号，密码为密文显示，该帐号密码可在
FusionSphere
OpenStack安装部署界面进行查询修改，需确保配置的帐号密码与交换机上
一致。
1.
登录FusionSphere OpenStack安装部署界面。
2.
选择“配置
>
裸金属管理”。
3.
若需修改，展开“配置网络 ”选择“配置裸金属网关”，填写“交换机用户名”与
“交换机密码”，单击“提交”。
–
若回显如下，则表明正常，执行4.3。
local-user client201 password irreversible-cipher $1c$dVAQ)g96=*$X"DhOyhX"J4")^4oD~,)0R'BI_
$;JE)sdmP;A1h5$
local-user client201 service-type ssh
local-user client201 level 3
ssh user client201
ssh user client201 authentication-type password
ssh user client201 service-type snetconf
–
若回显与上述不一致，请参考《华为云Stack
8.1.0
裸金属服务最佳实践
（Region
Type
I）》的“裸金属服务器节点接入交换机的配置（集中式网关
场景）”章节进行配置，配置完成后执行4.3。
3.
执行如下命令查看snetconf服务是否开启。
dis current-configuration | include snetconf
snetconf server enable
–
若回显中包含上述配置，则表明正常，执行4.4。
–
若回显中不包含上述配置，请参考《华为云Stack
8.1.0
裸金属服务最佳实践
（Region
Type
I）》的“裸金属服务器节点接入交换机的配置（集中式网关
场景）”章节开启snetconf服务，执行4.4。
4.
执行如下命令查看stelnet服务是否开启。
dis current-configuration | include stelnet
stelnet server enable
– 若回显中包含上述配置，则表明正常，执行4.5。
–
若回显中不包含上述配置，请参考《华为云Stack
8.1.0
裸金属服务最佳实践
（Region
Type
I）》的“裸金属服务器节点接入交换机的配置（集中式网关
场景）”章节开启stelnet服务，执行4.5。
5.
执行如下命令，查看带内管理IP是否配置正确。
dis current-configuration | include lldp
lldp enable
lldp management-address 192.38.30.249
–
若回显中包含上述配置，则表明正常，回显中的ip即为告警中的交换机带内
管理IP，执行步骤5。
1

## Page 391

–
若回显中不包含上述配置，请参考《华为云Stack
8.1.0
裸金属服务最佳实践
（Region
Type
I）》的“裸金属服务器节点接入交换机的配置（集中式网关
场景）”章节进行配置，配置完成后执行步骤5。
检查neutron-bm-switch-agent组件与裸机接入交换机之间物理链路异常。
步骤5 检查neutron-bm-switch-agent组件所在节点与路由交换机之间的物理链路是否正常，
有无断连现象、有无物理接口异常情况。
●
正常，执行步骤6。
●
异常，请联系技术支持工程师协助解决。
步骤6 等待五分钟，在ManageOne运维面的“集中监控
>
告警管理
>
当前告警”界面查看
是否仍存在该告警。
●
是，请联系技术支持工程师协助解决。
●
否，告警已恢复，处理完毕。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.110 ALM-1200090 NAT
网关双主告警
告警解释
NAT网关网元主备部署，当NAT网关集群存在双主的场景时，系统上报该告警。
告警属性
告警ID 告警级别 可自动清除
1200090
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
●
集群ID：产生告警的NAT网关集群ID
附加信息 主机信息：产生告警的相关主机信息
1

## Page 392

对系统的影响
SNAT和DNAT业务异常。
可能原因
网络节点连接的交换机相关接口VLAN未放通或VLAN未创建。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 在告警附加信息中获取“主机信息”，记录其中上报的NAT网关集群的两个主机ID。
步骤2 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤3 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤4 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤5 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤6 执行以下命令，防止系统超时退出。
TMOUT=0
步骤7 参考3.1 导入环境变量，选择使用cps鉴权，完成cps环境变量导入。
步骤8 创建脚本并命名为get_network_hostid.sh，将以下内容拷贝到
get_network_hostid.sh。
if [ -z $1 ]; then
echo "Usage: sh `basename $0` <host_id>"
exit 1
fi
nat_vm_uuids=`nova list | grep -E '(natgw_vm|netcluster_nat_gateway_vm)' | awk '{print $2}'`
if [[ "X${nat_vm_uuids}" == "X" ]]; then
echo "nat vm info is null."
exit 0
fi
echo "===network host info==="
nat_host_id=$1
nic_mac=`cps host-show $nat_host_id | grep -C2 nic0 | grep mac | awk '{print $3}'`
if [ -z $nic_mac ]; then
echo "nat_host_id maybe wrong."
exit 0
1

## Page 393

fi
for nat_vm_uuid in ${nat_vm_uuids};
do
echo -n "."
result=`nova interface-list $nat_vm_uuid | grep -i ${nic_mac:4}| awk '{print $2}'`
if [[ "X${result}" != "X" ]] ; then
net_host_id=`nova show $nat_vm_uuid | grep hyp | awk -F '|' '{print $3}'`
echo -e '\n'
echo "network host $net_host_id"
break
fi
done
步骤9 分别执行以下命令，查询并记录NAT网关虚拟机所在的网络节点的主机ID。
sh get_network_hostid.sh
主机ID
主机ID
:
步骤1中记录的主机ID。
32EFBDD0-2B8F-9C40-9CAE-0C89E4D15701:/home/fsp # sh get_network_hostid.sh
32EFBDD0-2B8F-9C40-9CAE-0C89E4D15701
===network host info===
..
network host 45D46A24-E83C-5A85-E811-F51B2EF1B570
步骤10 执行以下命令，获取NAT网关虚拟机所在网络节点的业务口放通的VLAN信息。
cat /etc/ugw/stargate-nat.cfg | grep vif | awk -F '.' '{print $2}' | tr -d '"'
32EFBDD0-2B8F-9C40-9CAE-0C89E4D15701:/home/fsp # cat /etc/ugw/stargate-nat.cfg | grep vif | awk -F
'.' '{print $2}' | tr -d '"'
3624
步骤11 根据现网的实际情况，排查步骤9中记录的主机ID对应的网络节点所连接的交换机，对
应的业务接口是否按要求放通了步骤10中获取到的VLAN。
●
是，请联系技术支持工程师协助解决。
●
否，请参考《华为云Stack
8.1.0
网络配置最佳实践（Region
Type
I）》
（Region
Type
I）的“调测步骤
>
基础网络配置
>
业务区交换机
>
管理业务接入
交换机配置”章节进行配置，配置完成后，执行步骤12。
步骤12 等待两分钟，在告警页面，查看告警是否恢复。
● 是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.111 ALM-1200100 redis
集群异常
告警解释
redis集群部署下，当集群内部出现异常时，系统产生此告警。定时扫描并上报告警的
周期为45s。
1

## Page 394

告警属性
告警ID 告警级别 告警类型
1200100
重要 环境告警
告警参数
参数名称 参数含义
定位信息 服务：产生告警的服务
附加信息
●
集群状态：redis集群状态是否正常
●
异常实例：异常的redis实例信息，key为实例ID，value为
实例IP
对系统的影响
redis集群异常，可能导致新下发业务不可用。
可能原因
●
redis集群状态异常。
●
redis集群内某些实例异常。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 查看当前告警信息。
1.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
2.
单击目标告警所在行的 ，展开告警详情。
3.
查看告警详情中的“定位信息”字段及“附加信息”字段。
记录告警附加信息中异常实例的ID，执行步骤3。
步骤3 重启redis-cluster组件。
1

## Page 395

1.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
说明
– 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2 使用PuTTY通过公私钥对认证方式登录节点。
– External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP
参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
2.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
3.
导入环境变量选择鉴权方式2。
导入环境变量，具体操作请参见3.1 导入环境变量。
4.
使用如下命令查看redis-cluster组件部署信息 ：
cps template-instance-list --service redis redis-cluster
+------------+---------------+--------+--------------------------------------+-------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+--------+--------------------------------------+-------------+
| 6 | redis-cluster | active | 1023404A-4650-61A3-EB11-7175E0942D52 | 192.168.0.2 |
| 2 | redis-cluster | active | 8C004B6B-1DF4-108F-E911-303A6CA406C5 | 192.168.0.3 |
| 3 | redis-cluster | active | F022404A-4650-83A0-EB11-7175220D6079 | 192.168.0.4 |
| 7 | redis-cluster | active | D022404A-4650-9984-EB11-717594E52B59 | 192.168.0.5 |
| 1 | redis-cluster | active | A32985EF-98F8-C78E-E811-4C271C5A3BF0 | 192.168.0.6 |
| 4 | redis-cluster | active | E822404A-4650-8281-EB11-7175EE444B6C | 192.168.0.7 |
| 5 | redis-cluster | active | 4824404A-4650-C98E-EB11-7175E08D617A | 192.168.0.8 |
| 0 | redis-cluster | active | D823404A-4650-97A5-EB11-71753C787B38 | 192.168.0.9 |
+------------+---------------+--------+--------------------------------------+-------------+
instanceid对应告警附加信息中的实例ID。记录告警附加信息中的实例ID对应的
redis-cluster组件的host_id，即为回显结果中的runsonhost。
5.
执行以下命令，重启redis-cluster组件，恢复告警。
cps host-template-instance-operate --service redis redis-cluster --action
stop --host runsonhost
cps host-template-instance-operate --service redis redis-cluster --action
start --host runsonhost
其中runsonhost为步骤3.4记录的host_id。
须知
组件重启过程中可能导致redis短暂时间内不可用，请勿在组件重启过程中下发任
何业务。
步骤4 等待五分钟，在ManageOne运维面的“集中监控
>
告警管理
>
当前告警”界面查看
是否仍存在该告警。
●
是，请联系技术支持工程师协助解决
1

## Page 396

●
否，告警已恢复，处理完毕。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.112 ALM-1200101 redis
集群内实例持久化异常
告警解释
redis集群部署下，当redis实例同步状态异常、数据持久化异常时，系统产生此告警。
定时扫描并上报告警的周期为30s。
告警属性
告警ID 告警级别 告警类型
1200101
紧急 环境告警
告警参数
参数名称 参数含义
定位信息 服务：产生告警的服务
附加信息 异常实例：异常的redis实例信息，key为实例ID，value为实例
IP
对系统的影响
redis实例持久化异常，可能导致redis集群内部主备倒换后老业务数据丢失，也可能导
致数据没有写入物理盘，进程重启后数据丢失。
可能原因
●
主从同步状态异常。
●
数据持久化异常。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
1

## Page 397

●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 查看当前告警信息。
1.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
2.
单击目标告警所在行的 ，展开告警详情。
3.
查看告警详情中的“定位信息”字段及“附加信息”字段。
记录告警附加信息中实例的ID，执行步骤3。
步骤3 查看redis-managerControl日志。
1.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
说明
–
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
– External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP
参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
2.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
3.
导入环境变量选择鉴权方式2。
导入环境变量，具体操作请参见3.1 导入环境变量。
4.
查询redis-manager组件主节点。
cps template-instance-list --service redis redis-manager
+------------+---------------+---------+--------------------------------------+-------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+-------------+
| 1 | redis-cluster | active | A32985EF-98F8-C78E-E811-4C271C5A3BF0 | 192.168.0.6 |
| 0 | redis-cluster | standby | D823404A-4650-97A5-EB11-71753C787B38 | 192.168.0.9 |
+------------+---------------+---------+--------------------------------------+-------------+
记录status为active的redis-manager组件的omip。
5. 使用PuTTY，通过步骤3.4中查询到的omip地址登录redis-manager主节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
6.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
1

## Page 398

su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
7.
查看redis-managerControl的日志。
grep "redis info check failed" /var/log/fusionsphere/component/redis-
managerControl/redis-managerControl.log
–
如果回显结果中包含“master_link_status”，请联系技术支持工程师协助解
决。
–
如果回显结果中不包含“master_link_status”，执行步骤4。
步骤4 检查异常实例所在节点是否异常。
1.
执行以下命令，查询异常实例所在的节点。
cps template-instance-list --service redis redis-cluster
+------------+---------------+--------+--------------------------------------+-------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+--------+--------------------------------------+-------------+
| 6 | redis-cluster | active | 1023404A-4650-61A3-EB11-7175E0942D52 | 192.168.0.2 |
| 2 | redis-cluster | active | 8C004B6B-1DF4-108F-E911-303A6CA406C5 | 192.168.0.3 |
| 3 | redis-cluster | active | F022404A-4650-83A0-EB11-7175220D6079 | 192.168.0.4 |
| 7 | redis-cluster | active | D022404A-4650-9984-EB11-717594E52B59 | 192.168.0.5 |
| 1 | redis-cluster | active | A32985EF-98F8-C78E-E811-4C271C5A3BF0 | 192.168.0.6 |
| 4 | redis-cluster | active | E822404A-4650-8281-EB11-7175EE444B6C | 192.168.0.7 |
| 5 | redis-cluster | active | 4824404A-4650-C98E-EB11-7175E08D617A | 192.168.0.8 |
| 0 | redis-cluster | active | D823404A-4650-97A5-EB11-71753C787B38 | 192.168.0.9 |
+------------+---------------+--------+--------------------------------------+-------------+
instanceid对应告警附加信息中的实例ID。记录告警附加信息中的实例ID对应的
redis-cluster组件的runsonhost和omip。
2.
使用PuTTY，通过步骤4.1中查询到的omip地址登录异常实例所在节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
3.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
4.
执行以下命令，查看异常实例节点上进程状态是否正常。
ps -ef | grep redis-cluster | grep -v grep
cps 2997877 1 0 Jul18 ? 00:02:40 /usr/local/bin/redis-cluster-server 172.28.8.134:8038
[cluster]
cps 2999800 1 0 Jul18 ? 00:03:49 python /usr/local/lib/cps_redis/monitor/redis-cluster-
monitor.py 2 1 ACTIVE
–
若回显结果中没有包含/usr/local/bin/redis-cluster-server的进程或者没有包
含/usr/local/lib/cps_redis/monitor/redis-cluster-monitor.py的进程，执行步
骤4.6。
–
若回显结果正常，执行步骤4.5。
5.
执行df -h，查看主机磁盘空间统计信息，观察回显结果中“Mounted on”列
为/opt/HUAWEI/redis-cluster的“Use%”列的值，是否接近100%。
–
若不接近100%，执行步骤4.6。
–
若接近100%，请联系技术支持工程师协助解决。
1

## Page 399

6.
在步骤3.1登录的节点上，执行以下命令，重启redis-cluster组件，恢复告警。
cps host-template-instance-operate --service redis redis-cluster --action
stop --host runsonhost
cps host-template-instance-operate --service redis redis-cluster --action
start --host runsonhost
其中runsonhost为步骤4.1记录的host_id。
须知
组件重启过程中可能导致redis短暂时间内不可用，请勿在组件重启过程中下发任
何业务。
步骤5 等待五分钟，在ManageOne运维面的“集中监控
>
告警管理
>
当前告警”界面查看
是否仍存在该告警。
●
是，请联系技术支持工程师协助解决。
●
否，告警已恢复，处理完毕。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.113 ALM-1200102 redis
主备实例持久化异常
告警解释
redis主备部署下，当redis实例同步状态异常、数据持久化异常时，系统产生此告警。
定时扫描并上报告警的周期为30s。
告警属性
告警ID 告警级别 告警类型
1200102
紧急 环境告警
告警参数
参数名称 参数含义
定位信息
●
服务：产生告警的服务
●
主机ID：异常的redis实例所在主机的ID
1

## Page 400

参数名称 参数含义
附加信息 错误信息：产生该告警的错误信息
对系统的影响
redis实例持久化异常，可能导致redis主备倒换后老业务数据丢失，也可能导致数据没
有写入物理盘，进程重启后数据丢失。
可能原因
●
主从同步状态异常。
●
数据持久化异常。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 查看当前告警信息。
1.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
2.
单击目标告警所在行的 ，展开告警详情。
3.
查看告警详情中的“定位信息”字段及“附加信息”字段。
若“附加信息”中的“错误信息”中包含“master_link_status”，请联系技术支
持工程师协助解决。
否则记录告警定位信息中的主机ID，执行步骤3。
步骤3 查找异常的redis实例所在主机。
1.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
1

## Page 401

说明
–
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
– External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP
参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
2. 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
3. 导入环境变量选择鉴权方式2。
导入环境变量，具体操作请参见3.1 导入环境变量。
4. 查询异常的redis组件信息。
cps template-instance-list --service redis redis
+------------+---------------+---------+--------------------------------------+-------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+-------------+
| 1 | redis | active | A32985EF-98F8-C78E-E811-4C271C5A3BF0 | 192.168.0.6 |
| 0 | redis | standby | D823404A-4650-97A5-EB11-71753C787B38 | 192.168.0.9 |
+------------+---------------+---------+--------------------------------------+-------------+
记录runsonhost为步骤2.3中的主机ID的redis组件的omip。
步骤4 登录异常主机查看磁盘空间统计信息。
1. 使用PuTTY，通过步骤3.4中查询到的omip地址登录redis节点。
默认帐号：fsp
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
2. 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
3. 导入环境变量选择鉴权方式2。
导入环境变量，具体操作请参见3.1 导入环境变量。
4. 执行df -h，查看主机磁盘空间统计信息，观察回显结果中“Mounted on”列
为/opt/HUAWEI/redis的“Use%”列的值，是否接近100%。
– 若不接近100%，执行步骤4.5。
– 若接近100%，请联系技术支持工程师协助解决。
5. 执行以下命令，重启redis组件，恢复告警。
cps host-template-instance-operate --service redis redis --action stop --
host runsonhost
cps host-template-instance-operate --service redis redis --action start --
host runsonhost
其中runsonhost为步骤2.3记录的主机ID。
1

## Page 402

须知
组件重启过程中可能导致redis短暂时间内不可用，请勿在组件重启过程中下发任
何业务。
步骤5 等待五分钟，在ManageOne运维面的“集中监控
>
告警管理
>
当前告警”界面查看
是否仍存在该告警。
●
是，请联系技术支持工程师协助解决。
●
否，告警已恢复，处理完毕。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.114 ALM-1200200 BGP
对等体状态异常告警
告警解释
BGP-Broker组件主备部署，系统周期（3分钟）检测BGP-Broker与对端交换机的连接
状态，即BGP对等体状态。当检查到连接状态异常时，系统上报告警。
告警属性
告警ID 告警级别 可自动清除
1200200
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
服务：BGP-Broker。
附加信息
●
浮动IP：BGP-Broker组件的浮动IP。
● 对等体IP：专线交换机上配的LoopBack 1口地址IP
对系统的影响
BGP-Broker组件不能正常处理增强型云专线l3gw和二层桥接l2br业务。
1

## Page 403

可能原因
●
专线交换机与BGP-Broker组件所在节点之间的管理网络没打通。
●
BGP-Broker组件内部故障，组件无法工作。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 在告警附加信息中，获取浮动IP和对等体IP。
步骤2 查看BGP-Broker组件是否故障。
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“组件”页签，选择pecado服务和bgp-broker组件，单击“搜索”。
检查bgp-broker组件状态存在fault。
–
是，执行2.4。
–
否，执行步骤4。
4.
全选bgp-broker组件，单击“启动”按钮。
等待1分钟，查看fault的组件是否变更为standby或者active。
–
是，执行步骤3。
–
否，查看是否上报1.2.1.6
ALM-6017
主机状态异常告警。
▪
是，优先处理主机状态异常。处理完成后，等待10-15分钟，重复执行步
骤2。若仍存在fault状态的bgp-broker组件，执行步骤6。
▪
否，执行步骤6。
步骤3 等待三分钟，在告警页面，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤6。
步骤4 查看BGP-Broker组件所在节点和专线交换机之间的管理网络是否打通。
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
在“概要”界面，根据2.3里查到的active状态的组件信息中的“主机ID”或“主
机名称”，在“管理IP地址”一栏获得主机的管理IP地址。
3.
使用PuTTY，通过组件所在主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请
参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
1

## Page 404

4.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
5.
执行以下命令，防止系统超时退出。
TMOUT=0
6.
执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
7.
输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号
的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
8.
根据步骤1中获取的IP，使用ping命令，检查网络是否互通。
ping -i
BGP-Broker浮动IP 对等体IP
如：ping
-i 10.27.52.49 172.16.102.3
–
是，则表明管理面网络正常，请执行步骤6。
–
否，请参考《华为云Stack
8.1.0
网络配置最佳实践（Region
Type
I）》
（Region
Type
I）的“调测步骤
>
增强型云专线服务网络配置
>
增强型云专
线服务网络配置”章节进行配置，打通管理面网络后，执行步骤5。
步骤5 等待三分钟，在告警页面，查看告警是否恢复。
●
是，处理完毕。
●
否，执行步骤6。
步骤6 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.115 ALM-1200400 CloudConnect
服务
tomcat
进程异常
告警解释
CloudConnect云服务使用tomcat进行云连接业务处理，当云服务节点上的tomcat异常
时，业务数据处理异常，导致云连接服务异常，业务不能正常下发。
该告警是服务监控的告警，CloudConnect云连接服务部署的虚拟机上的icagent脚本，
监控tomcat进程状态，监控周期1分钟，若连续3次监控数据达到设定阈值，则触发上
报告警；若连续3次未达到阈值，则告警消除。
1

## Page 405

告警属性
告警ID 告警级别 可自动清除
1200400
紧急 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的服务。
●
主机IP：产生告警的节点IP地址。
附加信息
●
云服务：产生告警的云服务。
●
监控类型：产生告警的对象。
●
详细信息：产生告警的详细信息。
● 阈值条件：产生告警设定的阈值。
对系统的影响
CloudConnect云连接服务异常，业务不能正常下发。
可能原因
●
文件系统为只读状态。
●
文件属组或权限异常。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”界面。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
1

## Page 406

步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用putty，登录告警节点的IP地址。
用户名：ccaas
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
Service）”页签中，该帐户对应的默认密码。
步骤6 执行如下命令切换root用户
sudo su
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤7 执行TMOUT=0防止会话超时退出。
步骤8 执行如下命令， 查看 tomcat进程是否存在。
ps -ef | grep tomcat
/opt/cloud/3rdComponent/jdk/jre_8u262/bin/java -Dnop -
Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -server -Xms2048m -Xmx2048m -
XX:MaxMetaspaceSize=256m -XX:MetaspaceSize=200m -XX:+UseG1GC -
XX:InitiatingHeapOccupancyPercent=70 -Dorg.terracotta.quartz.skipUpdateCheck=true -
Dlog4j.configurationFactory=org.wcc.framework.log.Log4j1PropertiesConfigurationFactory -
Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -
Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -classpath /opt/cloud/
3rdComponent/tomcat/bin/bootstrap.jar:/opt/cloud/3rdComponent/tomcat/bin/tomcat-juli.jar -
Dcatalina.base=/opt/cloud/CC-SERVICE -Dcatalina.home=/opt/cloud/3rdComponent/tomcat -
Djava.io.tmpdir=/opt/cloud/CC-SERVICE/temp org.apache.catalina.startup.Bootstrap start
回显结果是否如上所示：
●
是：进程不存在，请联系技术工程师协助解决。
●
否：进程已存在，执行步骤9。
步骤9 执行如下命令，重启tomcat服务。
sh /opt/cloud/CC-SERVICE/action/appctl.sh restart
步骤10 执行如下命令，查看tomcat服务是否正常启动。
ps -ef | grep tomcat
/opt/cloud/3rdComponent/jdk/jre_8u262/bin/java -Dnop -
Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -server -Xms2048m -Xmx2048m -
XX:MaxMetaspaceSize=256m -XX:MetaspaceSize=200m -XX:+UseG1GC -
XX:InitiatingHeapOccupancyPercent=70 -Dorg.terracotta.quartz.skipUpdateCheck=true -
Dlog4j.configurationFactory=org.wcc.framework.log.Log4j1PropertiesConfigurationFactory -
Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -
Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -classpath /opt/cloud/
3rdComponent/tomcat/bin/bootstrap.jar:/opt/cloud/3rdComponent/tomcat/bin/tomcat-juli.jar -
Dcatalina.base=/opt/cloud/CC-SERVICE -Dcatalina.home=/opt/cloud/3rdComponent/tomcat -
Djava.io.tmpdir=/opt/cloud/CC-SERVICE/temp org.apache.catalina.startup.Bootstrap star
回显结果是否如上所示：
●
是：表示tomcat服务已正常启动，等待5~10分钟，告警状态会自动消除，处理完
毕。
●
否：联系技术支持工程师协助解决。
----结束
1

## Page 407

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.116 ALM-1223017
负载均衡器后端实例不在线
告警解释
ELB
proxy组件周期收集后端member的健康检查状态，如果存在member不在线，则
上报此告警。
告警属性
告警ID 告警级别 可自动清除
1223017
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
● 负载均衡器ID：弹性负载均衡的ID。
附加信息
●
弹性负载均衡器名称：弹性负载均衡的名称。
●
租户ID：资源集ID。
●
离线后端实例：健康检查为离线的后端服务器的信息，
包括名称、IP地址。
对系统的影响
影响业务实际负载均衡能力，业务不会分发给离线的后端，导致业务集中于在线的后
端上处理。
可能原因
后端服务器上的业务进程异常。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
1

## Page 408

●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 获取附加信息和定位信息。
步骤5 获取VDC管理员登录的帐户。
1.
使用浏览器，以运营管理员帐号登录ManageOne。
–
非B2B场景登录地址：https://ManageOne运营面的访问地址。例如，
https://console.demo.com。
–
B2B场景登录地址：https://ManageOne运营管理面的访问地址。例如，
https://admin.demo.com。
运营管理员默认帐号为bss_admin。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“A类（Portal）”页签
中，该帐户对应的默认密码。
首次登录需要修改密码，如果不是首次登录，请获取新密码。
2.
在主菜单选择“系统”，并在左树菜单选择“资源集”，单击 ，勾选“ID”，
在搜索框中输入告警附加信息中的租户ID（实际为资源集ID），找到目标资源
集，然后获取项目所属租户名称。
3.
在主菜单选择“组织”，并在左树菜单选择“租户管理”，在租户列表中单击租
户名称，进入租户概览页面。在左树菜单中选择“用户”，获取用户名称。若密
码忘记，可以重置密码。
步骤6 使用浏览器，以步骤5中获取的VDC管理员帐号登录ManageOne。
●
非B2B场景登录地址：https://ManageOne运营面的访问地址。例如，https://
console.demo.com。
● B2B场景登录地址：https://ManageOne租户面的访问地址。例如，https://
tenant.demo.com。
步骤7 在页面左上角单击 ，选择区域，选择“网络
>
弹性负载均衡”，进入弹性负载均
衡页面。
1

## Page 409

步骤8 根据步骤4中获取的“弹性负载均衡器名称”和“负载均衡器ID”，找到对应的elb实
例，单击实例名，进入详情页面。
步骤9 单击“后端云服务器组”，进入“后端云服务器组”页签。
在页签的右侧，选择按“ID”搜索，在输入框内输入从步骤4中获取的“离线后端实
例”中的“pool_id”，搜索到对应的pool。
步骤10 单击“后端云服务器数量”列上的数字，查看该pool下的所有后端实例。
根据步骤4中获取的“离线后端实例”中member的名称和ip信息，找到离线的后端云
服务器。
步骤11 单击对应的云服务器名称，进入后端云服务器详情页面。
步骤12 单击“远程登录”，登录云服务器，并联系租户查看并处理异常的业务进程。
步骤13 处理完成后，等待五分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，请联系技术支持协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 410

参考信息
无。
1.2.1.117 ALM-1240001 FusionSphere Neutron
和
Agile Controller-DCN
进行
数据一致性修复时失败
告警解释
Agile
Controller-DCN的云平台插件定时或者手动触发云平台Neutron数据和Agile
Controller-DCN数据进行数据一致性对比修复，失败时上报告警。
告警属性
告警ID 告警级别 可自动清除
1240001
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
附加信息
●
云服务：产生告警的云服务
●
主机ID：产生告警的主机ID
●
主机名：产生告警的主机名称
●
本端地址：产生告警的主机地址信息
●
对端地址：产生告警的主机对接的Agile
Controller-DCN
的地址信息
●
详细信息：产生告警的详细信息
对系统的影响
无。
可能原因
●
白名单文件大小超过10MB。
●
正在执行数据一致性对比任务，新的任务失败。
●
向Agile Controller-DCN控制器请求数据超时。
●
向Agile Controller-DCN请求数据，Agile Controller-DCN返回失败。
●
数据一致性对比修复时，向Agile Controller-DCN下发请求超时。
●
从Agile Controller-DCN下载的文件格式错误或者内容错误。
1

## Page 411

● Agile
Controller-DCN处理下发的修复请求时，长时间没有异步返回结果确认。
●
插件发生其他内部错误。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 查看告警的详细信息是否为I/O
error occurred on whitelist
file。
●
是，执行步骤2。
●
否，执行步骤9。
步骤2 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤4 执行以下命令，防止系统超时退出。
TMOUT=0
步骤5 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤6 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤7 执行
vim
/etc/neutron/whitelist.ini，删除whitelist.ini中多余的白名单配置，保证该
文件大小小于10MB。
1

## Page 412

步骤8 查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤9。
步骤9 登录Agile Controller-DCN业务面界面，网址是https://{Agile Controller-DCN北向浮
动IP}:31943。
步骤10 选择“集成
>
云平台
>
OpenStack”，进入OpenStack页面。
步骤11 查看该FusionSphere节点对应的云平台详情。
查看“北向链路状态”和“Websocket链路状态”是否在线。
●
是，则通信业务下发链路和控制器处理业务的状态上报链路正常，执行步骤12。
●
否，则链路不通，请执行步骤16。
步骤12 重复执行步骤2~步骤6。
步骤13 执行如下命令，查看是否有一致性对比修复任务正在执行。
neutron acctrl-neutron-sync-status
若回显显示如下，说明有一致性对比修复任务正在执行。
+------------+-------------------+----------+
| server | state | sync_res |
+------------+-------------------+----------+
| controller | consistency_check | complete |
+------------+-------------------+----------+
●
是，执行步骤14。
●
否，执行步骤16。
步骤14 等待5~10分钟，重新手动执行数据一致性对比操作，或者等待下次定时任务启动。
步骤15 查看告警是否清除。
●
是，处理完毕。
● 否，执行步骤16。
步骤16 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无
1

## Page 413

1.2.1.118 ALM-1240002 FusionSphere Neutron
和
Agile Controller-DCN HTTP
连接故障
告警解释
Agile
Controller-DCN的云平台插件定时检测与控制器的HTTP通道的联通状态，检测
周期为10秒/次，当连续3次检测到失败时上报告警。
告警属性
告警ID 告警级别 可自动清除
1240002
紧急 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID
附加信息
●
云服务：产生告警的云服务
●
主机名：产生告警的主机名称
●
本端地址：产生告警的主机地址信息
●
对端地址：产生告警的主机对接的Agile
Controller-DCN
的地址信息
●
详细信息：产生告警的详细信息
对系统的影响
当FusionSphere与Agile Controller-DCN控制器之间的HTTP通道连接失败时，
FusionSphere无法向控制器进行业务下发。
可能原因
●
FusionSphere与控制器的HTTP网路链路不通。
●
FusionSphere向控制器获取TOKEN鉴权失败。
● Agile
Controller-DCN控制器故障。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
1

## Page 414

处理步骤
步骤1 登录Agile Controller-DCN业务面界面，网址是https://{Agile Controller-DCN北向浮
动IP}:31943。
步骤2 选择“集成
>
云平台
>
OpenStack”，进入OpenStack页面。
步骤3 查看该FusionSphere节点对应的云平台详情。
查看“北向链路状态”是否在线。
●
是，则当前通信业务下发链路正常，等待一段时间，执行步骤18。
●
否，执行步骤4。
步骤4 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤5 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤6 执行以下命令，防止系统超时退出。
TMOUT=0
步骤7 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤8 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤9 执行以下命令，进入neutron-server的日志目录。
cd /var/log/fusionsphere/component/neutron-server
步骤10 执行以下命令，检查neutron-server的实时报错信息。
tailf neutron-server_error.log.200
1

## Page 415

●
如果报错中包含“Authorization Failed”鉴权失败的信息，执行步骤11。
●
如果报错中包含“There
is no terminal from the
ip”连接失败的信息，执行步骤
15。
●
如果有其他未知报错，执行步骤19。
步骤11 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤12 选择“配置
> OpenStack >
Neutron”。
步骤13 在“Neutron扩展配置项”右侧，单击“配置”按钮，进入“Neutron扩展配置项”界
面。
步骤14 正确配置控制器北向帐户的帐户密码，单击“提交”，执行步骤18。
步骤15 参考步骤11~步骤13，进入“Neutron扩展配置项”界面，检查host_ip是否配置为正
确的Agile Controller的北向浮动IP。
●
是，执行步骤16。
●
否，请正确配置控制器北向浮动IP，单击“提交”， 执行步骤18。
步骤16 以root登录控制器节点，执行命令netstat
-anp | grep
18010，检查端口监听。
●
如果至少1个节点有正常的监听进程，则执行步骤17。
●
如果没有监听进程，请联系控制器技术支持工程师协助排查控制器问题，执行步
骤18。
步骤17 以root用户再次登录OpenStack节点，检查FusionSphere与控制器之间的物理链路是
否正常。以控制器的北向浮动IP为192.168.37.5为例，执行ping
-I external_om
192.168.37.5。
● 若有ping不通的情况，请联系网络规划工程师协助打通该网络平面的链路，执行
步骤18。
●
若均能ping通，执行步骤19。
步骤18 检查告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤19。
步骤19 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 416

1.2.1.119 ALM-1240003 FusionSphere Neutron
和
Agile Controller-DCN
Websocket
连接故障
告警解释
Agile
Controller-DCN的云平台插件定时检测与控制器的Websocket通道的联通状态。
当Websocket连通正常时，检测周期为10秒/次，当检测到一次失败后，检测周期为5
秒/次。当连续检测到2次失败时，上报告警。
告警属性
告警ID 告警级别 可自动清除
1240003
紧急 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID
附加信息
●
云服务：产生告警的云服务
●
主机名：产生告警的主机名称
●
本端地址：产生告警的主机地址信息
●
对端地址：产生告警的主机对接的Agile
Controller-DCN
的地址信息
●
详细信息：产生告警的详细信息
对系统的影响
当FusionSphere与Agile Controller-DCN控制器之间的Websocket通道连接失败时，
FusionSphere无法接收来自控制器的状态上报。
可能原因
●
FusionSphere与控制器的Websocket网路链路不通。
●
FusionSphere向控制器获取TOKEN鉴权失败。
● Agile
Controller-DCN控制器故障。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
1

## Page 417

处理步骤
步骤1 登录Agile Controller-DCN业务面界面，网址是https://{Agile Controller-DCN北向浮
动IP}:31943。
步骤2 选择“集成
>
云平台
>
OpenStack”，进入OpenStack页面。
步骤3 查看该FusionSphere节点对应的云平台详情。
查看“Websocket链路状态”是否在线。
●
是，则当前通信业务下发链路正常，等待一段时间，执行步骤18。
●
否，执行步骤4。
步骤4 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤5 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤6 执行以下命令，防止系统超时退出。
TMOUT=0
步骤7 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤8 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤9 执行以下命令，进入neutron-server的日志目录。
cd /var/log/fusionsphere/component/neutron-server
步骤10 执行以下命令，检查neutron-server的实时报错信息。
tailf neutron-server_error.log.200
1

## Page 418

●
如果报错中包含“Authorization Failed”鉴权失败的信息，执行步骤11。
●
如果报错中包含“There
is no terminal from the
ip”连接失败的信息，执行步骤
15。
●
如果有其他未知报错，执行步骤19。
步骤11 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤12 选择“配置
> OpenStack >
Neutron”。
步骤13 在“Neutron扩展配置项”右侧，单击“配置”按钮，进入“Neutron扩展配置项”界
面。
步骤14 正确配置控制器北向帐户的帐户密码，单击“提交”，执行步骤18。
步骤15 参考步骤11~步骤13，进入“Neutron扩展配置项”界面，检查host_ip是否配置为正
确的Agile Controller的北向浮动IP。
●
是，执行步骤16。
●
否，请正确配置控制器北向浮动IP，单击“提交”， 执行步骤18。
步骤16 以root登录控制器节点，执行命令netstat
-anp | grep
18010，检查端口监听。
●
如果至少1个节点有正常的监听进程，则执行步骤17。
●
如果没有监听进程，请联系控制器技术支持工程师协助排查控制器问题，执行步
骤18。
步骤17 以root用户再次登录OpenStack节点，检查FusionSphere与控制器之间的物理链路是
否正常。以控制器的北向浮动IP为192.168.37.5为例，执行ping
-I external_om
192.168.37.5。
● 若有ping不通的情况，请联系网络规划工程师协助打通该网络平面的链路，执行
步骤18。
●
若均能ping通，执行步骤19。
步骤18 检查告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤19。
步骤19 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 419

1.2.1.120 ALM-1260001 BR-Agent
访问
UGW
配置文件异常
告警解释
边界路由（Border Router，以下简称BR）的BR-Agent读取UGW配置文件，并将这些
配置信息通过UGW命令行下发到UGW，UGW根据接收到的配置信息进行相应的网络
控制。当BR-Agent读取UGW配置文件出现异常时，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
1260001
重要 是
告警参数
参数名称 参数含义
附加信息
●
云服务：产生告警的云服务。
●
主机ID：产生告警的主机ID。
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的服务。
●
错误信息：告警相关的错误信息。
对系统的影响
●
路由下发失效。
●
有关UGW的流表下发失效。
●
限速相关配置参数下发失效。
●
配置相关参数下发失效。
●
VPN配置相关参数下发失效。
●
各个子接口的转发模式配置失效。
可能原因
●
UGW配置文件不存在。
●
UGW配置文件信息不合规。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
1

## Page 420

处理步骤
步骤1 从告警定位信息中获取“云服务”和“主机ID”的取值。
步骤2 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤3 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤4 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤5 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤6 执行以下命令，防止系统超时退出。
TMOUT=0
步骤7 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤8 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤9 执行以下命令，进入UGW配置文件目录，查看该目录下是否有UGW配置文件。
cd /etc/border-router/border-router-agent
ll
total 12
-rw-r--r-- 1 root root 586 Jul 31 20:01 application-prod.yml
-rw-r--r-- 1 root root 1956 Jul 31 20:01 logback.xml
-rw-r--r-- 1 root root 220 Jul 31 20:01 ugw_init.conf
查看回显中是否出现“ugw_init.conf”字样。
●
是，进入步骤10。
●
否，说明UGW配置文件不存在，请联系技术支持工程师协助解决。
步骤10 执行以下命令，查看当前BR节点所在集群。
1

## Page 421

cps cluster-list
| br_vm_az1_dc1_group1_2 | E42FE661-437E-9940-AD58-B865FA497D57 | | cpufamily:x86_64 |
步骤11 根据查询到的集群名，执行以下命令，查看cps中BR的配置项。
cps template-params-show --service fn-border-router border-router-agent --
cluster br_vm_az1_dc1_group1_2
将查询到的cps中BR的配置项与步骤9中ugw_init.conf的配置项进行对比，查看是否可
以匹配。
●
是，请联系技术支持工程师协助解决。
●
否，说明UGW配置文件信息不合规，请参考cps中的配置项，修改ugw_init.conf
中的配置项，然后执行步骤12。
步骤12 执行如下命令，重启BR服务。
cps host-template-instance-operate --action stop --service fn-border-router
border-router-agent --host `cat /etc/uuid`
cps host-template-instance-operate --action start --service fn-border-router
border-router-agent --host `cat /etc/uuid`
步骤13 等待5分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.121 ALM-1260005
自动隔离
BR
节点
告警解释
依赖keepalived组件，边界路由（Border Router，以下简称BR）的BR-Agent以ICMP
探测的方式监控BR节点EIP流量的南向、北向、VPN网关下一跳的健康状况。每次间隔
1秒，连续3次发现南向、北向、VPN网关下一跳中有一项处于异常状态，就会自动隔
离本BR节点。此时，系统产生此告警。
说明
隔离原理就是针对将带宽墙发送给BR的ICMP请求报文全部丢弃，让上游节点认为BR节点处于故
障状态，从而不会将EIP流量导向BR节点。这个告警的上报意味着从告警上报之后，此BR节点处
于自我隔离不工作的状态。
1

## Page 422

告警属性
告警ID 告警级别 可自动清除
1260005
重要 是
告警参数
参数名称 参数含义
附加信息
●
云服务：产生告警的云服务。
●
主机ID：产生告警的主机ID。
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的服务。
●
错误信息：告警相关的错误信息。
对系统的影响
BR节点不再响应带宽墙的ICMP请求报文，上游节点认为BR节点处于故障状态，从而
不会将EIP流量导向该BR节点。
可能原因
●
BR监控的北向下一跳IP（配置在交换机上Internet网关）ping不通，超过规定的时
间。
●
BR监控的南向下一跳IP（当前组网规划下E-NAT的IP）ping不通，超过规定的时
间。
● BR监控的VPN网关IP（配置在交换机上的VPN网关）ping不通，超过规定的时
间。
●
BR上监控下一跳的软件模块keepalived异常导致判断下一跳错误。
处理步骤
步骤1 从告警定位信息中获取“云服务”和“主机ID”的取值。
步骤2 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤3 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤4 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
1

## Page 423

步骤5 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤6 执行以下命令，防止系统超时退出。
TMOUT=0
步骤7 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤8 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤9 执行以下命令，查看keepalived进程是否存在。
ps -ef |grep keepalive | grep -v grep
●
是，执行步骤10。
●
否，无回显，说明模块keepalived异常，请联系技术支持工程师协助解决。
步骤10 执行以下命令查询keepalived探测的南北向ip。
cat /etc/border-router/border-router-agent/ugw_init.conf
north-probe-ip = 192.168.156.1
master-south-probe-ips = 10.12.12.2,10.12.12.3
slave-south-probe-ips = 10.12.12.4,10.12.12.5
vpn_gateway = 172.168.0.1
其中，north-probe-ip表示北向Internet网关探测地址，master-south-probe-ips表示
public平面下一跳主集群的主备ip，slave-south-probe-ips表示public平面下一跳从集
群的主备ip，vpn_gateway表示vpn0网关ip。
查看以上参数值是否与现网中规划的参数配置的一致。
●
是，执行步骤11。
●
否，按照现网中规划的参数重新配置，或者请联系技术支持工程师协助解决。
步骤11 执行以下命令，查看ecmp的group权值。
egf-ipvsadm --list
如下所示，返回结果中ecmp group的weight列，1表示up，0表示down。
IP Virtual Server version 0.0.0 (size=0)
Prot LocalAddress:Port Scheduler Flags
-> RemoteAddress:Port Forward Weight Priority ActiveConn InActConn
FWM 101 ecmphash
-> 10.14.25.1:0 Masq 1 0 0 0
FWM 102 ecmphash
1

## Page 424

-> [1426::1]:0 Masq 1 0 0 0
FWM 106ecmphash
-> 172.16.0.1 Masq 1 0 0 0
FWM 120 ecmphash sched_on_all_down
-> 10.14.19.1:0 Masq 1 0 0 0
FWM 121 ecmphash sched_on_all_down
-> 10.14.19.1:0 Masq 0 0 0 0
FWM 122 ecmphash sched_on_all_down
-> 10.14.19.1:0 Masq 1 0 0 0
FWM 123 ecmphash sched_on_all_down
-> 10.14.19.1:0 Masq 1 0 0 0
查看是北向、南向或者VPN网关中哪一项的下一跳处于down的状态，并联系交换机物
理组网人员排查处理，以下举例说明排查方向。
●
如果是北向下一跳101、102探测组（配置在交换机上的internet默认网关）存在
问题，需要排查BR与北向下一跳之间的网络连通。
●
如果是120以上探测组（当前组网规划下软NET）存在问题，需要排查BR与南向下
一跳之间的网络连通。
●
如果是VPN下一跳106探测组（配置在交换机上的vpn默认网关）存在问题，需要
排查BR与VPN下一跳之间的网络连通。
步骤12 重新执行步骤11，检查ecmp group的weight列是否还有全为0的情况。
●
是，继续排查物理组网问题，或者请联系技术支持工程师协助解决。
●
否，执行步骤13。
步骤13 等待5分钟，查看告警是否恢复。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.122 ALM-1260015 BR
数据面异常
告警解释
当边界路由（BorderRouter，以下简称BR）的一条限速策略（qos_policy）中经过的
流量达到配额上限时，就会发送告警。
告警属性
告警ID 告警级别 可自动清除
1260015
重要 是
1

## Page 425

告警参数
参数名称 参数含义
附加信息
●
云服务：产生告警的云服务。
●
主机ID：产生告警的主机ID。
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的服务。
●
错误信息：告警相关的错误信息。
对系统的影响
用户在此条qos_policy中已无可用的带宽配额，无法通过更多流量。
可能的原因
用户设定的qos_policy配额已用尽。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 从告警定位信息中获取“云服务”和“主机ID”的取值， 从告警附加信息中获取错误
信息中的qospolicyid。
步骤2 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤3 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤4 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤5 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤6 执行以下命令，防止系统超时退出。
TMOUT=0
1

## Page 426

步骤7 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤8 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤9 执行以下命令，观察“pass_bytes”参数是否超限额。
ovs-appctl border-router/get-qos qos-id qospolicyid
"flow__egress": "drop_bytes= 0 drop_pkts= 0 pass_bytes= 0 pass_pkts= 0
pass_bytes_delta= 0 drop_rate=0.000000 avg_pkt_size=0.000000,0.000000"
●
是，执行步骤11。
●
否，请联系技术支持工程师协助解决。
步骤10 参考“修改共享带宽配额大小”章节，扩大此条qos_policy配额。
请参考《弹性IP(EIP)
8.1.0
使用指南(for 华为云Stack 8.1.0)》中的《弹性IP(EIP)
8.1.0
用户指南(for 华为云Stack 8.1.0)》“修改共享带宽配额大小”章节。
步骤11 等待2分钟，观察告警是否清除。
●
否，请联系技术支持工程师协助解决。
●
是，处理完毕。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.123 ALM-1260016 BR-Agent
与其他组件连接异常
告警解释
●
边界路由（BorderRouter，以下简称BR）的BR-Agent会将UGW初始配置信息及
从数据库查询到的网络配置信息通过UGW命令行下发到UGW，UGW根据接收到
的配置信息进行相应的网络控制。当BR-Agent通过UGW命令行下发配置信息出现
异常时，系统产生此告警。
●
BR-Agent作为消费端，获取来自kafka集群服务器中的带宽信息，以此向数据面
下发带宽配置信息。当BR-Agent与kafka通信异常时，系统产生此告警。
1

## Page 427

●
BR-Agent依赖gaussdb服务向neutron数据库获取带宽信息，连续40次重试后依然
处于连接异常状态，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
1260016
重要 是
告警参数
参数名称 参数含义
附加信息
●
云服务：产生告警的云服务。
●
对象组件：产生告警的BR-Agent对接的组件。
●
主机ID：产生告警的主机ID。
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的服务。
●
错误信息：告警相关的错误信息。
●
对端地址：产生告警的BR-Agent对接的组件地址。
对系统的影响
●
配置信息下发到UGW滞后，UGW相应的网络控制滞后：即BR-Agent与数据面命
令行通信处于异常状态，则BR-Agent下发带宽、路由、流表等配置会滞后，直到
与数据面通信异常恢复，BR-Agent下发以上操作才会成功。
●
此告警产生时，导致BR-Agent无法获取kafka服务端中配置更新信息，使得配置
信息无法同步到UGW中。
●
此告警产生时，导致BR-Agent无法获取数据库中带宽信息，使最新数据无法同步
到BR-Agent。
可能原因
●
OVS存在故障。
●
dataplane存在故障。
●
gaussdb组件异常。
●
neutron-server异常。
●
kafka组件异常。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
1

## Page 428

处理步骤
步骤1 在告警的定位信息中，获取“主机ID”、对象组件的取值。
步骤2 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤3 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤4 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤5 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤6 执行以下命令，防止系统超时退出。
TMOUT=0
步骤7 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤8 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤9 根据步骤1中获取的对象组件值，选择处理步骤。
●
对象组件ugw_cli，参考步骤10~步骤12处理。
●
对象组件kafka，参考步骤13~步骤18处理。
●
对象组件database，参考步骤19~步骤25处理。
步骤10 执行以下命令，对OVS进行排查。
ps -ef|grep ovs-vswitchd | grep –v grep
查看是否有“ovs-vswitchd”字样。
●
是，执行步骤11。
●
否，说明是ovs异常，请联系技术支持工程师协助解决。
步骤11 执行以下命令，对dataplane进行排查。
1

## Page 429

cps template-instance-list --service fn-border-router border-router-dataplane
+----------------+-------------------------+--------+--------------------------------------+----------------+
| instanceid | componenttype | status | runsonhost | omip |
+----------------+-------------------------+--------+--------------------------------------+----------------+
| agt_0000020007 | border-router-dataplane | active | C64B486C-2CC0-E611-9AA2-487B6BEACB5D |
192.168.167.138 |
| agt_0000020005 | border-router-dataplane | fault | 68130E28-D21D-B211-B50F-0018E1C5D866 |
192.168.167.85 |
+----------------+-------------------------+--------+--------------------------------------+----------------+
查看本节点的数据面是否为fault状态。
●
是，说明dataplane异常，执行步骤12。
●
否，请联系技术支持工程师协助解决。
步骤12 执行以下命令，重启当前节点的数据面。
cps host-template-instance-operate --service fn-border-router border-router-
dataplane --action start --host `cat /etc/uuid`
执行完成后，观察告警是否消失。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
步骤13 执行以下命令，排查kafka组件故障。
cps template-instance-list --service kafka kafka
+------------+---------------+--------+--------------------------------------+----------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+--------+--------------------------------------+----------------+
| 1 | kafka | fault | 4205A2EC-C461-9DC2-70AD-1F9BE490BEFC | 192.168.117.61 |
| 0 | kafka | fault | 42058D90-49F6-7264-9804-3560E5B9B080 | 192.168.117.207 |
| 2 | kafka | fault | 42055B0C-E90F-3F0F-1FBE-15D787EBB63E | 192.168.117.126 |
+------------+---------------+--------+--------------------------------------+----------------+
查看kafka组件是否存在fault状态。
● 是，执行步骤14。
●
否，执行步骤15。
步骤14 执行以下命令，依次重启异常节点的kafka服务。
cps host-template-instance-operate --service kafka kafka --action start --host
host_uuid
host_uuid为步骤13中的runsonhost的取值。
执行完成后，观察告警是否消失。
●
是，处理完毕。
●
否，执行步骤15。
步骤15 排查BR节点到kafka的浮动IP地址是否可以ping通：
1.
执行以下命令，查看当前BR节点所在的集群。
cps cluster-list
| br_vm_az1_dc1_group1_2 | E42FE661-437E-9940-AD58-B865FA497D57 | |
cpufamily:x86_64 |
2.
根据查询到的集群名，执行以下命令。
1

## Page 430

cps template-params-show --service fn-border-router border-router-agent
--cluster br_vm_az1_dc1_group1_2
| kafka.bootstrap-servers | 192.168.50.151:9093,192.168.50.152:9093,192.168.50.153:9093 |
3.
查看kafka.bootstrap-servers参数配置的IP值，对其执行ping命令，是否ping通。
IPV4环境执行ping IP，IPV6环境执行ping -6 IP。
–
是，执行步骤16。
–
否，请联系技术支持工程师协助解决。
步骤16 执行以下命令，排查BR节点的kafka配置参数。
cps template-params-show --service fn-border-router border-router-agent --
cluster br_vm_az1_dc1_group1_2
查看以kafka开头的参数是否与现网中规划的kafka参数配置一致,参数如下：
| kafka.bootstrap-servers | 192.168.50.151:9093,192.168.50.152:9093,192.168.50.153:9093 |
| kafka.enable | true |
| kafka.password | 1001#HS3EO9U7CpeHnrxuvHQaOhJC9G+xv2qbnsWZ+TRzMEhyv |
| kafka.request_timeout | 15000 |
| kafka.ssl.truststore.password | 1001#o/3ubNDQ/mxegxWOaLP8kDEbu2Zzq2DApaovYYYizdk= |
| kafka.topic.bandwidth | vpc_eipbandwidths_notify |
| kafka.user | nvwa |
●
是，请联系技术支持工程师协助解决。
●
否，执行步骤17。
步骤17 执行以下命令，更新kafka配置，使之与现网中规划的参数相同。
cps template-params-update --service fn-border-router border-router-agent –
cluster br_vm_az1_dc1_group1_2 –parameter kafka.bootstrap-
servers=192.168.50.151:9093,192.168.50.152:9093,192.168.50.153:9093
等待2分钟，检查kafka告警是否恢复。
●
是，执行步骤18。
●
否，请联系技术支持工程师协助解决。
步骤18 告警恢复后，在与kafka通信异常的BR-Agent节点上，手动执行全量审计同步，命令如
下。
curl 127.0.0.1:8080/startsyncjob
步骤19 执行以下命令，排查gaussdb组件异常。
cps template-instance-list --service gaussdb gaussdb
+------------+---------------+---------+--------------------------------------+---------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+---------------+
| 0 | gaussdb | active | F652CF6D-1624-7294-E911-DF34EA7DEC38 | 172.24.93.168 |
| 1 | gaussdb | standby | 2AC833ED-3598-CBA7-E911-D434963B881B | 172.24.93.112 |
+------------+---------------+---------+--------------------------------------+---------------+
查看gaussdb状态是否全为fault。
●
是，执行步骤20。
●
否，执行步骤21。
步骤20 执行以下命令，重启异常节点的gaussdb服务。
1

## Page 431

cps host-template-instance-operate --service gaussdb gaussdb--action start --
host host_uuid
host_uuid为步骤19中的runsonhost的取值。
执行完成后，观察告警是否消失。
●
是，处理完毕。
●
否，执行步骤21。
步骤21 执行以下命令，排查neutron-server异常。
cps template-instance-list --service neutron neutron-server
+------------+----------------+--------+--------------------------------------+----------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+----------------+--------+--------------------------------------+----------------+
| 0 | neutron-server | fault | 4205A2EC-C461-9DC2-70AD-1F9BE490BEFC | 192.168.117.61 |
| 2 | neutron-server | active | 42058D90-49F6-7264-9804-3560E5B9B080 | 192.168.117.207 |
| 1 | neutron-server | active | 42055B0C-E90F-3F0F-1FBE-15D787EBB63E | 192.168.117.126 |
+------------+----------------+--------+--------------------------------------+----------------+
查看是否存在neutron-server状态为fault。
●
是，执行步骤22。
●
否，执行步骤23。
步骤22 执行以下命令，重启异常节点的neutron-server服务。
cps host-template-instance-operate --service neutron-server neutron-server--
action start --host host_uuid
host_uuid为步骤21中的runsonhost的取值。
执行完成后，观察告警是否消失。
●
是，处理完毕。
●
否，执行步骤23。
步骤23 依次执行以下命令，排查BR组件是否故障。
cps template-instance-list --service fn-border-router border-router-agent
cps template-instance-list --service fn-border-router border-router-dataplane
查看服务fn-border-router所有组件的状态是否全为fault。
●
是，请联系技术支持工程师协助解决。
●
否，执行步骤24。
步骤24 排查BR配置参数。
1.
执行以下命令，查看当前BR节点所在集群。
cps cluster-list
| br_vm_az1_dc1_group1_2 | E42FE661-437E-9940-AD58-B865FA497D57 | |
cpufamily:x86_64 |
2.
执行以下命令，查看数据库的连接参数是否与现网中规划的参数一致，如下：
cps template-params-show --service fn-border-router border-router-agent
--cluster br_vm_az1_dc1_group2_1 | grep datasource.password
| spring.datasource.password | N8296FGj0gDK1OA8djBQ50u/7CZvJ+RfE2qNhiGICE8= |
1

## Page 432

–
是，执行步骤25。
–
否，按照现网中规划的参数重配，或者请联系技术支持工程师协助解决。
步骤25 检查告警是否恢复。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.124 ALM-1301021 EVS/OVS-DPDK
转发能力达到瓶颈告警
告警解释
在EVS/OVS-DPDK转发能力达到最大转发能力时上报EVS/OVS-DPDK转发能力达到瓶
颈告警。
告警属性
告警ID 告警级别 可自动清除
1301021
重要 是
告警参数
参数名称 参数含义
名称 告警的名称。
对象ID 产生告警对象的ID。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的ID，比如：主机ID。如果是业务模块产生的告
警，则表示的是业务模块的ID，比如：Openstack OM。
对象类型 产生告警的对象的类型，比如：host（代表主机），heart
beat（代表心跳检测系统）。
对象名称 产生告警的对象的名称。
如果是主机、虚拟机之类的资源对象产生的告警，则表示的
是具体资源的名称，比如：主机名。如果是业务模块产生的
告警，则表示的是业务模块的名称，比如：Openstack
OM。
1

## Page 433

参数名称 参数含义
部件类型 产生告警的部件的类型，比如：Openstack、Openstack
OM。
部件名称 产生告警的部件的名称。
定位信息 产生告警的对象的具体信息，一般用key=value,key=value
方式。比如：host=*****,portName=###，表示：****主机
上的###端口产生此告警。
附加信息 产生告警的一些扩展信息，一般用key=value,key=value方
式。比如：Threshold=70,current_value=75，标识产生告
警的原因是阈值为70，而当前值为75。
产生时间 告警产生的时间。
清除时间 告警清除的时间。
清除类型 告警清除的方式，告警清除的类型包括手工清除和自动清
除。
清除用户 手工清除告警的用户名称，自动清除告警时此参数为空。
清除用户ID 手工清除告警的用户ID，自动清除告警时此参数为空。
清除来源 手动清除告警时，清除告警的来源（租户侧视图或管理侧视
图）。
流水号 此条告警信息产生的顺序编号。
对系统的影响
虚拟网络端口出现丢包，影响业务。
可能原因
●
虚拟机交换机uplink端口流量大于EVS/OVS-DPDK不丢包性能规格。
●
虚拟交换网络中广播流量过大。
●
软中断分布不均衡，长时间集中在一个CPU上，后续报文得不到及时处理。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
1

## Page 434

步骤2 在“概要”界面，根据告警附加信息中的“主机ID”或“主机名”，在“管理IP地
址”一栏获得主机的管理IP地址。
步骤3 使用PuTTY，通过主机的管理IP地址，登录告警所在主机。
默认帐号：fsp。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
步骤4 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤5 通过执行以下命令分别查看EVS/OVS-DPDK物理网口和网卡组bond模式的uplink端
口。
ovs-vsctl --timeout=120 find interface type=dpdkphy | grep ^name | awk -F ':'
'{print $2}' | tr -d '"'
ovs-vsctl --timeout=120 find interface type=dpdkbond | grep ^name | awk -F
':' '{print $2}' | tr -d '"'
步骤6 通过以下命令查看步骤5查询得到的uplink端口所在的网桥。
ovs-vsctl port-to-br port_name
其中，port_name为步骤5中查询到的端口信息。
步骤7 执行以下命令获取端口在步骤6得到的网桥上的ofproto端口号。
ovs-ofctl show br_name
其中，br_name为步骤6中的查询结果。
步骤8 执行以下命令得到10秒钟内uplink端口上收包数变化，计算出uplink端口的pps并与性
能规格做比较，确认流量是否大于等于性能规格。
ovs-ofctl dump-ports br_name;sleep 10;ovs-ofctl dump-ports br_name
1

## Page 435

其中，br_name为步骤6中的查询结果。
● 是，说明主机外部进入主机的流量过大，超过性能规格，请排查外部网络流量过
大的原因。
●
否：
–
EVS网桥，执行步骤9。
–
OVS-DPDK网桥，执行步骤10。
步骤9 执行以下命令查看是否持续存在异常的广播丢包。
watch -d -n 1 ovs-appctl dpif-dpdk/show-mac-entry br_name --missed
其中，br_name为步骤6中的查询结果。
●
是，说明存在大量广播包影响转发性能导致上报告警，由于产生异常广播流量有
很多种原因，请联系技术支持工程师，根据流的走向排查异常广播流量的根源。
●
否，执行步骤10。
步骤10 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.125 ALM-1316000 OpenStack
服务包升级完成后未提交
告警解释
upg-server定时（默认每天一次）检查服务包是否已经提交，如果有服务包升级生效
后超过7天没有提交，则上报该OpenStack服务包升级完成后未提交的告警；当该服务
包升级提交后，该告警自动恢复。
1

## Page 436

告警属性
告警ID 告警级别 可自动清除
1316000
重要 是
告警参数
参数名称 参数含义
定位信息 云服务：产生告警的云服务。
附加信息
●
云服务：产生告警的云服务。
●
错误信息：告警相关的错误信息。
对系统的影响
系统运行无影响，但是会影响下一次的升级。
说明
下次升级之前，必须要先提交上次的升级服务包。长期不提交，如果配置、角色等发生了变化，
可能导致后续提交失败。同时，会占用一部分系统磁盘空间。
可能原因
升级完成后，忘记最后在升级工程上做提交操作。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 判断当前版本的升级是否是所有部件已经全部完成。
●
否，忽略本告警， 待升级全部完成后再处理。
●
是，执行步骤2。
步骤2 当时的升级工程是否还存在。
●
是，执行步骤3。
●
否，执行步骤4。
步骤3 重新启动升级工程，参考对应版本升级指导书中的“提交工程”章节，在升级工程中
做提交操作，提交完成后执行步骤8。
步骤4 使用“PuTTY”工具登录任意主机。
以fsp帐号登录。
1

## Page 437

执行su
-
root命令，切换到root帐户。
执行“Enter”，并导入openstack环境变量。
步骤5 执行以下命令，查询服务版本号，复制回显中upgrade cmd下的服务及版本信息。
upgrade service-pkg-list
步骤6 执行以下命令，使用命令行提交服务。
upgrade commit --service-pkg-list service_package_list
如下为命令示例，其中，service_package_list是执行步骤5得到的结果。
如：upgrade
commit --service-pkg-list "gcn_network, GCN EVS
1.0.RC7.SPC100B010" "ceilometer, FUSIONSPHERE CEILOMETER 6.5.1"
"uvp_hostos, UVP KVM 3.0.RC2.SPC101B010" "upgradeservice, FUSIONSPHERE
UPGRADE 6.5.1" "nova, FUSIONSPHERE NOVA 6.5.1" "keystone, FUSIONSPHERE
KEYSTONE 6.5.1" "gcn-egf, GCN EGF 1.0.RC7.SPC10B010" "ironic, FUSIONSPHERE
IRONIC 6.5.1" "cinder, FUSIONSPHERE CINDER 6.5.1" "glance, FUSIONSPHERE
GLANCE 6.5.1" "fusionplatform, FUSIONSPHERE FUSIONPLATFORM 6.5.1" "swift,
FUSIONSPHERE SWIFT 6.5.1" "drextend, FUSIONSPHERE DREXTEND 6.5.1"
"neutron, FUSIONSPHERE NEUTRON 6.5.1"
步骤7 执行upgrade query查询提交进度。
步骤8 提交完成后，等待30分钟，查看告警是否自动清除。
●
是，处理完毕。
● 否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
以"fsp"用户到登录Openstack控制节点，切换到"root"用户并3.1 导入环境变量，执行
下面命令,可以查看升级生效的时间：
upgrade history
1.2.1.126 ALM-1316001
忽略升级的单板未处理
告警解释
upg-server定时（默认每天一次）检查是否存在忽略升级的故障节点，如果当前升级
工程已经提交且存在忽略升级的故障节点，则系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
1316001
重要 是
1

## Page 438

告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
附加信息
●
主机名：产生告警的主机名。
● 错误信息：告警相关的错误信息。
对系统的影响
系统运行无影响，但是会影响下一次的升级。下次升级之前，必须重装执行忽略操作
的故障节点，避免在下一次升级时出现残留数据、服务版本不匹配等导致升级失败的
问题。
可能原因
升级或回退期间，由于主机硬件故障导致升级或回退失败，并且硬件故障无法恢复的
情况下，对故障节点使用了忽略操作。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 在FusionSphere OpenStack安装部署界面，选择“运维
>
扩容”，将“自动PXE主
机”设置为开启状态。
说明
扩容主机时，如果服务包存在多版本，请指定服务包版本。单击“配置”，设置PXE主机的服务
包版本信息，单击“确认”。
步骤2 手动启动故障主机，在启动过程中选择从PXE启动，重装主机操作系统。
可使用服务器BMC系统的远程控制功能，或使用键盘显示器直连服务器，在服务器启
动过程中手动选择启动方式为PXE启动。
主机重新安装耗时约为10~15分钟。
步骤3 在FusionSphere OpenStack安装部署界面的“概要”界面，查看主机的安装进度，确
认主机是否安装完成。
当故障主机所在行的“进度”显示100%时，表示主机安装成功。
步骤4 选择新安装的主机，单击“重启”。
步骤5 待所有忽略的节点重新安装完成且服务正常后，在Service OM界面，选择“服务列表
>
资源
>
计算资源
>
主机”，查看忽略的节点是否处于资源隔离状态。
若处于资源隔离状态，请单击“解除隔离”进行解除资源隔离操作。若未处于资源隔
离状态，“解除隔离”会置灰，无法单击。
1

## Page 439

步骤6 在FusionSphere OpenStack安装部署界面，选择“运维
>
扩容”，将“自动PXE主
机”设置为关闭状态。
步骤7 使用“PuTTY”工具登录任意主机。
以fsp帐号登录。
执行su
-
root命令，切换到root帐户。
执行“Enter”，并导入openstack环境变量。
步骤8 执行如下命令，查看回显中host-list是否为空。
upgrade ext ignore-query
564DD0E0-7BE0-4479-FF87-CCDBAFBC25C5:/opt/fusionplatform/data/upgrade/upg-server # upgrade ext
ignore-query
+--------------------------------------+
| host-list |
+--------------------------------------+
| 564DCC89-DA70-5B6C-2A66-353A93556C70 |
| 564DFC2D-2195-A2F2-2EBF-2676F0AA459B |
+--------------------------------------+
●
是，处理完毕。
●
否，说明还存在忽略的主机，继续执行步骤9。
步骤9 执行如下命令，取消忽略的主机。
upgrade ext ignore-cancel --service-pkg-list "package1,package_version1"
"package2,package_version2" --host-list host_id1,host_id2 --verify false
说明
●
package1、package_version1等需替换为实际升级的所有服务及对应的版本号，在告警详情
的“附加信息”中，获取“错误信息=ignored packages:”后的字段。
●
host_id1、host_id2等替换为实际忽略的主机id。
564DD0E0-7BE0-4479-FF87-CCDBAFBC25C5:/opt/fusionplatform/data/upgrade/upg-server # upgrade ext
ignore-cancel --service-pkg-list "ceilometer,FUSIONSPHERE CEILOMETER 6.5.RC1.B040"
"fusionplatform,FUSIONSPHERE FUSIONPLATFORM 6.5.RC1.B040" --host-list 564DCC89-
DA70-5B6C-2A66-353A93556C70,564DFC2D-2195-A2F2-2EBF-2676F0AA459B --verify false
+--------------------------------------+-----------------+----------------------+-------+
| host-id | service-package | ignore-cancel-status | code |
+--------------------------------------+-----------------+----------------------+-------+
| 564DCC89-DA70-5B6C-2A66-353A93556C70 | fusionplatform | ignore_canceled | 11213 |
| 564DCC89-DA70-5B6C-2A66-353A93556C70 | ceilometer | ignore_canceled | 11213 |
| 564DFC2D-2195-A2F2-2EBF-2676F0AA459B | fusionplatform | ignore_canceled | 11213 |
| 564DFC2D-2195-A2F2-2EBF-2676F0AA459B | ceilometer | ignore_canceled | 11213 |
+--------------------------------------+-----------------+----------------------+-------+
步骤10 执行如下命令，查看回显中host-list是否为空。
upgrade ext ignore-query
564DD0E0-7BE0-4479-FF87-CCDBAFBC25C5:/opt/fusionplatform/data/upgrade/upg-server # upgrade ext
ignore-query
+--------------------------------------+
| host-list |
+--------------------------------------+
| 564DCC89-DA70-5B6C-2A66-353A93556C70 |
| 564DFC2D-2195-A2F2-2EBF-2676F0AA459B |
+--------------------------------------+
●
是，处理完毕。
1

## Page 440

●
否，说明还存在忽略的主机，继续执行步骤9。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.127 ALM-1316002
热补丁运行异常告警
告警解释
在热补丁安装过程中， CPU压力过大，或者安装热补丁后服务器重启异常等，导致热
补丁未生效，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
1316002
重要 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生该告警的主机ID。
附加信息
●
服务名：产生该告警的服务名。
● 微服务名：产生该告警的微服务名。
●
主机名：产生该告警的主机名。
●
错误信息：该告警相关的错误信息。
对系统的影响
热补丁未生效不影响正在运行的业务，但由于热补丁通常用于解决安全漏洞，未生效
说明对应的安全漏洞没有被修复。
可能原因
安装热补丁过程中，主机节点CPU压力大。
前提条件
●
已获取fsp、root用户的密码：
1

## Page 441

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
查询告警的错误信息，如果是“配置文件不一致”，即“the
patch configuration is
inconsistent”，执行步骤12。
如果是热补丁异常，即“hotpatch
status is
abnormal”，具体处理步骤如下：
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤5 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤6 确认1.2.1.7
ALM-6018
主机CPU占用率超过阈值和1.2.1.21
ALM-6033
I层服务CPU
占用率超过阈值告警是否存在，如果存在说明当前节点CPU压力过大，请先按照相应
的告警处理流程清除告警后再执行步骤7。
步骤7 进入"/opt/hotpatch/UVP"补丁管理目录。
步骤8 执行如下命令，进入对应异常补丁的目录。
cd
异常补丁目录
1

## Page 442

说明
每个热补丁有自己的单独目录，例如，告警提示“hostos_2018101107098”热补丁异常，则进
入“/opt/hotpatch/UVP/hostos_2018101107098”目录。
步骤9 执行如下命令，安装热补丁。
sh hotpatch.sh install
步骤10 执行如下命令，查询热补丁状态。
sh hotpatch.sh query
执行命令，查看查询命令执行的返回值。
echo $?
●
返回值0，执行步骤11。
●
返回值非0，执行步骤12。
步骤11 热补丁状态正常，请确认下一个检查周期后（12小时），告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤12。
步骤12 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 443

1.2.1.128 ALM-1316003 QEMU
版本异常告警
告警解释
QEMU热替换补丁安装后，如果主机上有虚拟机未成功替换成新版本QEMU，仍然使
用替换前的老版本QEMU，系统产生此告警。当前主机上所有虚拟机都使用热替换后
的新版本QEMU时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
1316003
重要 是
告警参数
参数名称 参数含义
定位信息
● 主机ID：产生该告警的主机ID。
●
虚拟机ID：产生该告警的虚拟机ID。
附加信息
●
服务名：产生该告警的服务名。
●
微服务名：产生该告警的微服务名。
●
主机名：产生该告警的主机名。
●
虚拟机名：产生该告警的虚拟机名。
●
错误信息：该告警相关的错误信息。
对系统的影响
出现该告警时，说明有虚拟机对应的QEMU组件未成功替换成新版本。由于QEMU热
替换补丁通常用于解决安全漏洞，此异常说明对应虚拟机的安全漏洞没有被修复。
可能原因
●
系统异常，导致QEMU热替换失败。
●
虚拟机配置了不支持QEMU热替换的设备，如配置vGPU设备。
前提条件
●
已获取fsp、root用户的密码：
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 获取告警信息中的虚拟机uuid，找到对应的主机。
1

## Page 444

步骤2 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
步骤4 执行以下命令，防止系统超时退出。
TMOUT=0
步骤5 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤6 输入“1”，选择使用keystone v3鉴权，按照提示输入OS_USERNAME对应帐号的密
码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤7 执行命令，尝试对虚拟机进行热替换。此命令会获取主机上的虚拟机列表，对QEMU
版本异常的虚拟机逐一进行QEMU热替换。
python /usr/libexec/uvp_hotreplace_upgrade --action=upgradevm | grep -w
"Domain"
●
如果虚拟机热替换成功，会打印以下关键日志：
[ INFO ] ... Domain %s do hot replace success
●
否则会打印以下关键日志：
[ ERROR ] ... Domain %s hot replace fail, reason %s
说明
%s
包含虚拟机名和失败原因。
1

## Page 445

步骤8 执行如下命令，查询热替换结果。
python /usr/libexec/uvp_hotreplace_upgrade --
action=check_vm_running_at_current_bin 2&>1 > /dev/null
执行如下命令，查看命令执行的返回值。
echo $?
●
返回值0，修复成功，执行步骤9。
●
返回值非0，对QEMU版本异常虚拟机进行重启来完成修复，完成后执行9。
注意
执行重启虚拟机会先关闭虚拟机再重新启动（重新启动的虚拟机会使用新版本的
QEMU），此操作会中断虚拟机内的业务。
步骤9 修复动作执行成功后，请确认下一个检查周期后（12小时），告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤10。
步骤10 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.129 ALM-1507002 RabbitMQ
资源使用率超过阈值
告警解释
rabbitmq资源使用率超过阈值后，系统会产生此告警。
说明
系统默认告警阈值的偏移量为5%，且系统默认的告警阈值如下：
●
紧急：80%
<=
使用率阈值
● 重要：70% <= 使用率阈值< 80%
告警属性
告警ID 告警级别 可自动清除
1507002
紧急/重要 是
1

## Page 446

告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务。
●
服务：产生告警的组件名称。
●
实例名：产生告警的服务所在的实例名。
附加信息
●
告警信息：告警的类型及具体的参数。
● 主机ID：产生告警的主机ID。
●
主机名：产生告警的主机名。
●
云服务：产生告警的云服务。
●
微服务：产生告警的微服务名称。
●
阈值：资源使用率阈值。
对系统的影响
此告警产生，组件对应资源可使用量较少，长期持续会造成业务无法正常进行。
可能原因
主机业务繁忙负载过重。
前提条件
已获取fsp、root用户的密码
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 告警是否自动清除。
●
是，任务结束。
●
否，执行步骤2。
步骤2 根据附加信息找出超过阈值告警项。
●
如果是fd_use_rate，proc_use_rate，sockets_use_rate使用率超过阈值，请联系
技术支持工程师协助解决。
●
如果是mem_use_rate，内存水位线(memory_high_watermark)超过阈值，执行
步骤3。
说明
– fd_use_rate：文件描述符(file descriptor)使用率。
– proc_use_rate：erlang进程数使用率。
–
sockets_use_rate：socket数使用率。
1

## Page 447

步骤3 在告警附加信息中获取发生告警主机ID。
步骤4 以"fsp"用户到登录Openstack控制节点，切换到"root"用户并3.1 导入环境变量，执行
下面命令,根据告警主机ID查看对应管理IP地址。
su - root
cps host-list | grep
主机ID
步骤5 使用管理IP地址登录发生告警主机。
步骤6 执行命令cps
template-params-show --service rabbitmq
$rabbitmq_template，其
中$rabbitmq_template的取值根据告警主机对应的RabbitMQ是否为分库以及是哪个
分库确定，对应关系请参见表1-45，后续步骤针对$rabbitmq_template 变量的取值相
同处理。
结果如下图所示,查看配置项内存水位线(memory_high_watermark)的值，默认为空。
●
确认当前系统主机及虚拟机规模，如果内存水位线值小于表1-46对应规模下的水
位线值memory_size或者为空，请执行如下命令(其中$memory_size为
memory_size的值，设置时需带上单位，如：16G)，完毕后执行步骤10。
cps template-params-update --service rabbitmq $rabbitmq_template --
parameter memory_high_watermark=$memory_size
cps commit
须知
请确保修改的内存水位线值不能大于主机物理内存的40%，如果物理内存不足，
请先扩容物理内存才能执行下面的变更操作。
●
如果内存水位线值大于或者等于表1-46对应规模下的水位线值，请联系技术支持
工程师协助解决。
步骤7 在发生告警的rabbitmq主机所在节点执行df -h命令，结果如下图所示。
1

## Page 448

查看上图中$rabbitmq_template分区(示例为：/opt/fusionplatform/data/rabbitmq)
可用空间大小，记为size，其中$rabbitmq_template的取值根据告警主机对应的
RabbitMQ是否为分库以及是哪个分库确定，对应关系见表1-45，后续步骤针对
$rabbitmq_template变量的取值相同处理。
步骤8 执行命令cps template-params-show --service rabbitmq $rabbitmq_template，查
看配置项内存水位线(memory_high_watermark)值，记为memory_size。
步骤9 执行命令cps hostcfg-list --type storage，查看rabbitmq所在主机磁盘分组信息如下
图所示。
+---------+-----------------------+---------------------------------------------+--------------------+
| type | name | hosts | metadata |
+---------+-----------------------+---------------------------------------------+--------------------+
| storage | control_group2_6A7554 | hostid:6A7554E9-410C-61A7-E811-6D0CD8E2B1D4 | grouptype:control, |
| | | | cpufamily:x86_64 |
| | | | |
| storage | control_group1_8B4BA4 | hostid:8B4BA4EF-98F8-3EB5-E811-5B2B7A47E62D | grouptype:control, |
| | | | cpufamily:x86_64 |
| | | | |
| storage | default | default:all | |
| | | | |
| storage | control_group0_304BA4 | hostid:304BA4EF-98F8-8F94-E811-852B82CB59EF | grouptype:control, |
| | | | cpufamily:x86_64 |
| | | | |
| storage | compute_group0 | hostid:8EA1E3EF-98F8-08BC-E811-5B2BA28835CA | grouptype:compute, |
| | | | cpufamily:x86_64 |
| | | | |
| storage | compute_group1 | hostid:F95330EF-98F8-D9A5-E811-DB289E423FB0 | grouptype:compute, |
| | | | cpufamily:x86_64 |
| | | | |
+---------+-----------------------+---------------------------------------------+--------------------+
记发生告警的rabbitmq主机hostid对应的name为group_name，如果rabbitmq主机
hostid不在上图中，则分组名默认为default。
●
如果size小于memory_size大小的50%，执行如下命令扩容rabbitmq数据分区磁
盘。
cps hostcfg-item-update --item logical-volume --lvname
$rabbitmq_template --size $size --type storage $hostcfg_name
cps commit
其中$size为当前规模下对应的建议磁盘大小（见表1-46中磁盘分区大小列，设置
时需带上单位，如：16g），$hostcfg_name为刚查询确认的hostcfg组的name字
1

## Page 449

段（即group_name），若RabbitMQ所在节点hostid分属多个hostcfg组，则需针
对每个$hostcfg_name执行此步骤。
说明
磁盘分区大小建议为内存水位线的50%。
●
如果size大于memory_size大小的50%，请联系技术支持工程师协助解决。
步骤10 修改之后等待3-4分钟查看告警是否清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
表1-45
RabbitMQ
template名称与分库情况对应关系
RabbitMQ分库情况
RabbitMQ
template名称
未分库
rabbitmq
nova分库
rabbitmq_nova
neutron分库
rabbitmq_neutron
表1-46 RabbitMQ参数配置规格
规模 内存水位线（GB）
100PM/1000VM 32
256PM/2000VM 32
512PM/5000VM 50
1024PM/10000VM 50
1.2.1.130 ALM-1607000
弹性裸机容器引擎故障告警
告警解释
弹性裸机（Elastic
Machine
Service，简称EMS）是以容器技术为基础的轻量级主机虚
拟化技术。弹性裸机与虚拟机功能类似，拥有完整的Guest OS，且有更轻量、更易分
发、性能更高、损耗更小的特点，主要适用于大数据、数据库等业务。弹性裸机也称
为系统容器。
1

## Page 450

弹性裸机在虚拟化层使用iSula做为容器引擎，用来创建容器，当iSula的lcrd和lxcfs进
程异常时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
1607000
紧急 是
告警参数
参数名称 参数含义
定位信息 主机ID：产生告警的主机ID。
附加信息 详细信息：产生告警的主机IP。
IP地址/URL/域名 产生告警的主机IP地址或者URL地址或者域名
对系统的影响
此告警产生时，系统中不能正常创建弹性裸机，影响系统对弹性裸机的管理。
可能原因
●
主机状态异常。
●
主机磁盘空间占满导致主机上的进程异常。
处理步骤
当此告警产生时，系统会自动执行lcrd和lxcfs的重启操作。进程正常后，告警自动清
除，无需处理。
说明
若告警无法自动消除，请联系技术支持工程师协助解决。
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.1.131 ALM-1607011
弹性裸机审计告警
告警解释
弹性裸机（Elastic
Machine
Service，简称EMS）是以容器技术为基础的轻量级主机虚
拟化技术。弹性裸机与虚拟机功能类似，拥有完整的Guest OS，且有更轻量、更易分
1

## Page 451

发、性能更高、损耗更小的特点，主要适用于大数据、数据库等业务。弹性裸机也称
为系统容器。
当执行系统审计时，发现存在非正常状态的系统容器，如假系统容器、野系统容器、
中间态容器等，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
1607011
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：产生告警的云服务名称
●
服务：产生告警的服务名称
附加信息 详细信息：告警的详细信息
IP地址/URL/域名 产生告警的主机IP地址或者URL地址或者域名
对系统的影响
此告警产生时，系统中存在不正常状态的系统容器，影响系统对系统容器的管理。
可能原因
系统中存在不正常状态的系统容器。
说明
请在告警的详细信息中获取引发告警的具体审计问题，并参考处理步骤完成相应问题的处理。
处理步骤
步骤1 参考表1-47，获取对应的审计报告名称。
表1-47 详细信息与审计报告、异常类型的对应关系
详细信息 审计报告
audit_orphan_ems orphan_ems.csv
audit_invalid_ems invalid_ems.csv
audit_stucking_vms stucking_ems.csv
audit_host_changed_ems host_changed_ems.csv
1

## Page 452

详细信息 审计报告
audit_host_invalid_migrations host_invalid_ems_migration.csv
步骤2 参考《华为云Stack
8.1.0
产品文档》的“收集审计报告”章节，获取审计报告。
步骤3 参照《华为云Stack
8.1.0
产品文档》中“审计结果定位”章节，查找对应审计报告名
称的处理方式，并按之处理审计项。
步骤4 参考《华为云Stack
8.1.0
产品文档》的“手动审计”章节，重新触发系统审计。
步骤5 查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤6。
步骤6 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.2 Service OM
告警参考
1.2.2.1 ALM-9206 Service OM
数据备份失败
告警解释
备份恢复模块每隔4小时进行一次本地自动备份，每隔30分钟，把备份文件上传到第三
方服务器。
当本地自动备份失败、备份操作失败、上传备份文件到第三方服务器失败时，系统产
生此告警。在告警的附加信息中会说明产生告警的错误码和错误信息。
告警属性
告警ID 告警级别 可自动清除
9206
重要 是
1

## Page 453

告警参数
参数名称 参数含义
定位信息 云服务：固定为ServiceOM
附加信息
●
FTP地址：FTP的地址，IP或者域名。
●
错误码：FTP备份或者上传文件失败的错误码
● 错误信息：错误码对应的错误描述信息
对系统的影响
●
当出现一次本地自动备份失败，系统会缺少一天的备份数据。
● 当出现一次备份操作失败，系统会缺少本次的备份数据。
●
当出现一次上传备份文件到第三方服务器失败，第三方服务器会缺少一份备份数
据。
可能原因
本地自动备份失败、备份操作失败或上传备份文件到第三方服务器失败。
处理步骤
步骤1 检查本地主机备份空间是否不足。
1.
登录Service OM主节点，具体请参见3.6 使用PuTTY登录Service OM节点。
2.
执行以下命令，检查备份目录所在分区的空间。
df -m
Filesystem Size Used Avail Use% Mounted on
/dev/vda1 6.0G 1.3G 4.7G 22% /
devtmpfs 4.8G 0 4.8G 0% /dev
tmpfs 4.8G 0 4.8G 0% /dev/shm
tmpfs 4.8G 505M 4.4G 11% /run
tmpfs 4.8G 0 4.8G 0% /sys/fs/cgroup
/dev/mapper/vg_om-lv_home 5.0G 33M 5.0G 1% /home
/dev/mapper/vg_om-lv_sysback 1014M 33M 982M 4% /sysback
/dev/mapper/vg_om-lv_var 4.0G 98M 3.9G 3% /var
/dev/mapper/vg_om-lv_tmp 3.0G 33M 3.0G 2% /tmp
/dev/mapper/vg_om-lv_log 6.0G 87M 6.0G 2% /var/log
/dev/mapper/vg_om-lv_goku 8.0G 81M 8.0G 1% /var/log/goku
/dev/mapper/vg_om-lv_opt 10G 2.0G 8.0G 20% /opt
/dev/mapper/vg_om-lv_gmbackup 6.0G 55M 6.0G 1% /opt/gmbackup
/dev/mapper/vg_om-lv_data 21G 43M 21G 1% /opt/goku/data
/dev/mapper/vg_om-lv_db 6.0G 418M 5.6G 7% /opt/goku/data/db
tmpfs 983M 0 983M 0% /run/user/0
tmpfs 983M 0 983M 0% /run/user/2000
显示每个分区的空间使用情况，查看第6列（Mounted on），目录/opt对应的第4
列（Avail），可用磁盘空间是否小于900。这里的900为参考值，实际备份任务对
磁盘空间的要求还和备份的数据量大小相关，如果备份数据量较大时，建议为备
份任务保留更大的磁盘空间。
–
小于900，执行步骤1.3。
–
大于等于900，执行步骤1.13。
1

## Page 454

3.
执行以下命令，进入目录“/opt/gmbackup/db”。
cd /opt/gmbackup/db
4.
执行以下命令，查看目录“/opt/gmbackup/db”下的文件和目录。
ls
5.
检查目录“/opt/gmbackup/db”下是否有不合法的文件和目录。
–
是，执行步骤1.6。
–
否，执行步骤1.8。
说明
目录和文件的合法性请参见本文末尾的参考信息。
6.
逐个删除目录“/opt/gmbackup/db”下不合法的文件和目录。
7.
执行步骤1.2。
8.
执行以下命令，进入目录“/opt/gmbackup/db”。
cd /opt/gmbackup/db
9.
执行以下命令，查看配置的自动备份文件个数。
cat /opt/gmbackup/backup.conf | grep MAX_AUTO_BACKUP_NUM
说明
如果用户不进行配置，自动备份文件个数默认为7。
10.
执行以下命令，查看目录“/opt/gmbackup/db”下的备份文件。
ls
说明
备份文件名的格式请参见本文末尾的参考信息。
11.
检查目录“/opt/gmbackup/db”下的备份文件个数是否大于所配置的自动备份文
件个数。
–
大于，执行步骤1.12。
–
不大于，执行步骤1.13。
12.
删除序号最小的备份文件。
说明
备份文件的序号查看方法请参见本文末尾的参考信息。
13.
登录告警页面，检查告警是否清除。
– 是，结束。
–
否，执行步骤2。
步骤2 检查本地主机备份文件序列号是否超过上限
1.
使用“winscp”，以“fsp”用户登录Service OM节点主机。
2.
进入目录“/opt/gmbackup/db”，查看是否存在序号大于4294967295的备份文
件。
–
存在，删除序号大于4294967295的备份文件后，执行步骤2.3。
–
不存在，执行步骤2.3。
说明
备份文件的序号查看方法请参见本文末尾的参考信息。
1

## Page 455

3.
登录告警页面，检查告警是否清除。
–
是，结束。
–
否，执行步骤3。
步骤3 检查本地主机的备份文件数是否超过上限
1.
登录Service OM主节点，具体请参见3.6 使用PuTTY登录Service OM节点。
2.
执行以下命令，进入目录“/opt/gmbackup/db”。
cd /opt/gmbackup/db
3.
执行以下命令，查看配置的自动备份文件个数。
cat /opt/gmbackup/backup.conf | grep MAX_AUTO_BACKUP_NUM
说明
如果用户不进行配置，自动备份文件个数默认为7。
4.
执行以下命令，查看目录“/opt/gmbackup/db”下的备份文件。
ls
说明
备份文件名的格式请参见本文末尾的参考信息。
5.
检查目录“/opt/gmbackup/db”下的备份文件个数是否大于所配置的自动备份文
件个数。
–
是，执行步骤3.6。
–
否，执行步骤3.7。
6.
删除序号较小的备份文件，直至备份文件个数等于所配置的自动备份文件个数。
说明
备份文件的序号查看方法请参见本文末尾的参考信息。
7.
登录告警页面，检查告警是否清除。
–
是，结束。
–
否，执行步骤4。
步骤4 检查是否正常连接第三方备份服务器
1.
准备第三方服务器的IP和第三方服务器ftps服务设置指导书。
2.
登录Service OM主节点，具体请参见3.6 使用PuTTY登录Service OM节点。
3.
执行以下命令，查看Service OM节点主机和第三方服务器之间的网络连接是否正
常。
ping第三方服务器IP，如ping
192.168.41.10
返回信息如下所示，则通信正常。
ping (192.168.41.10) 56(84) bytes of data.
64 bytes from 192.168.41.10: icmp_seq=1 ttl=64 time=0.035 ms
64 bytes from 192.168.41.10: icmp_seq=2 ttl=64 time=0.028 ms
64 bytes from 192.168.41.10: icmp_seq=3 ttl=64 time=0.025 ms
4.
通信是否正常。
–
是，执行步骤4.5。
–
否，执行步骤5.7。
5.
检查第三方服务器ftps服务是否正常。
1

## Page 456

–
正常，执行步骤4.6。
–
不正常，请参考第三方服务器ftps服务设置指导书，进行恢复。
说明
请参考第三方服务器ftps服务设置指导书，检查第三方服务器ftps服务是否正常。
6.
登录告警页面，检查告警是否清除。
–
是，结束。
–
否，执行步骤5。
步骤5 检查数据库状态是否异常
1.
登录Service OM主节点，具体请参见3.6 使用PuTTY登录Service OM节点。
2.
执行以下命令，检查数据库的状态。
galaxmanager status|grep gaussDB
3.
数据库状态是否正常。
–
显示status:abnormal，数据库状态异常，执行步骤5.4。
–
显示status:normal，数据库状态正常，执行步骤5.6。
4.
执行以下命令，停止数据库。
gaussDB stop
5.
执行命令成功后，两分钟后执行步骤5.2，检查数据库状态。
6.
登录告警页面，手工清除告警。
–
告警清除成功，任务结束。
–
告警清除失败，执行步骤5.7。
7.
请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
参考信息
1.
备份文件名的格式为：gmdb-年-月-日-序号.dump，其中年为4位数，月和日都为
两位数，序号为不大于4294967295的正整数。例如备份文件为
gmdb-2012-07-12-1.dump，该备份文件的生成日期为2012-07-12，序号为1。
2.
本地自动备份目录/opt/gmbackup/db下合法的目录为：autobakm
3.
本地备份目录/opt/gmbackup/db下合法的文件为：
–
gmdb-年-月-日-序号.dump
– lftp.out
1.2.2.2 ALM-9207 License
即将过期
告警解释
告警模块按24小时周期检测License状态，当检测到当前系统时间距离License截止期限
小于等于30天时，系统产生此告警。
1

## Page 457

告警属性
告警ID 告警级别 可自动清除
9207
重要 是
告警参数
参数名称 参数含义
定位信息 云服务：固定为ServiceOM
附加信息 过期时间：License文件的过期时间
对系统的影响
无影响。
可能原因
当前系统时间距离现有License的截止期限小于等于30天。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 在Service OM界面，选择“系统
>
系统管理
>
License”。
步骤3 记录页面上显示的ESN号码。
步骤4 准备合同号。
步骤5 联系技术支持工程师申请License文件。
步骤6 在“License”页面，单击“上传License”，在弹出的窗口中选择新申请的License文
件。
步骤7 单击“打开”。
步骤8 加载License是否成功。
●
是，执行步骤9。
●
否，请联系华为技术支持工程师。
步骤9 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
1

## Page 458

–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤10 选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面，查看告警是否清
除。
●
是，处理完毕。
●
否，请联系华为技术支持工程师。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.2.3 ALM-9208 License
已经过期
告警解释
告警模块按24小时周期检测License状态，当检测到当前系统时间较之License截止期限
已经过期时，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
9208
紧急 是
告警参数
参数名称 参数含义
定位信息 云服务：固定为ServiceOM
附加信息 过期时间：License的过期时间
对系统的影响
License过期后，系统还可用60天。License过期60天后，限制如下功能的使用：
●
用户登录系统后，主机(隔离、解隔离、上电、下电)、主机组（创建、增/删主
机、删除、修改、标签管理）、裸金属服务器（初始化）、虚拟机（创建、启
动、关闭、重启、强制重启、重置状态、冷迁移、热迁移、修改规格、修改启动
1

## Page 459

方式）、镜像（注册、修改、同步、下载、清除、删除、上传）、规格（创建、
删除、复制、标签管理、查看使用情况）、SNMP管理站（添加）的功能将无法
继续使用或授权数量受限。
● 将无法添加新的KVM服务器到系统中。(默认License不涉及。)
●
已经分配给其他部件的License资源也将失效。(默认License不涉及。)
●
将无法分配License资源给其他部件。(默认License不涉及。)
可能原因
现有License已经过期。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 在Service OM界面，选择“系统 >系统管理
>
License”。
步骤3 记录页面上显示的ESN号码。
步骤4 准备合同号。
步骤5 联系技术支持工程师申请License文件。
步骤6 在“License”页面，单击“上传License”，在弹出的窗口中选择新申请的License文
件。
步骤7 单击“打开”。
步骤8 加载License是否成功。
●
是，执行步骤9。
●
否，请联系华为技术支持工程师。
步骤9 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤10 选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面，查看告警是否清
除。
●
是，处理完毕。
●
否，请联系华为技术支持工程师。
----结束
1

## Page 460

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.2.4 ALM-9209
当前资源数量大于
License
许可上限
告警解释
告警模块按24小时周期检测License状态，当检测到当前资源使用值大于License授权许
可值时，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
9209
重要 是
告警参数
参数名称 参数含义
定位信息 云服务：固定为ServiceOM
附加信息 资源类型：License界面显示的资源使用值大于License授权
许可值的License的英文授权名称列表
对系统的影响
● 用户登录系统后，主机(上电、下电)、主机组（创建）、裸金属服务器（初始
化）、虚拟机（修改规格）的功能将无法继续使用。
●
将无法添加新的KVM服务器到系统中。(默认License不涉及。)
●
将无法分配License资源给其他部件。(默认License不涉及。)
可能原因
当前系统中资源使用量已经超过License授权的资源数。
处理步骤
加载已经申请到的正确的License。
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
1

## Page 461

步骤2 在Service OM界面，选择“系统 >系统管理
>
License”。
步骤3 单击“上传License”，在弹出的窗口中选择新申请的License文件。
步骤4 单击“打开”。
步骤5 加载License是否成功。
●
是，执行步骤6。
●
否，请联系华为技术支持工程师。
步骤6 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤7 选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面，查看告警是否清
除。
●
是，处理完毕。
●
否，请联系华为技术支持工程师。
如果正确的License文件已经丢失，重新申请License文件，并重新进行加载。
步骤8 单击“系统”，进入“系统”页面。
步骤9 单击“系统管理”下的“License”，进入“License”页面。
步骤10 记录页面上显示的ESN号码。
步骤11 准备合同号。
步骤12 联系技术支持工程师申请License文件。
步骤13 在“License”页面，单击“上传License”，在弹出的窗口中选择新申请的License文
件。
步骤14 单击“打开”。
步骤15 加载License是否成功。
●
是，执行步骤16。
●
否，请联系华为技术支持工程师。
步骤16 在ManageOne运维面，选择“集中监控
>
告警管理
>
当前告警”，进入“当前告
警”页面，查看告警是否清除。
● 是，处理完毕。
●
否，请联系华为技术支持工程师。
----结束
1

## Page 462

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.2.5 ALM-9210
当前
License
已失效
告警解释
告警模块按24小时周期检测license状态，当检测到当前License已失效时，系统产生此
告警。
告警属性
告警ID 告警级别 可自动清除
9210
重要 是
告警参数
参数名称 参数含义
定位信息 云服务：固定为ServiceOM
附加信息 错误原因：License失效的错误原因
对系统的影响
License失效后，系统还可用60天。License失效60天后，限制如下功能的使用：
●
用户登录系统后，主机(隔离、解隔离、上电、下电)、主机组（创建、增/删主
机、删除、修改、标签管理）、裸金属服务器（初始化）、虚拟机（创建、启
动、关闭、重启、强制重启、重置状态、冷迁移、热迁移、修改规格、修改启动
方式）、镜像（注册、修改、同步、下载、清除、删除、上传）、规格（创建、
删除、复制、标签管理、查看使用情况）、SNMP管理站（添加）的功能将无法
继续使用。
●
将无法添加新的KVM服务器到系统中。(默认License不涉及。)
●
已经分配给其他部件的License资源最多60天后将失效。(默认License不涉及。)
●
将无法分配License资源给其他部件。(默认License不涉及。)
可能原因
● Service
OM虚拟机重新安装，导致ESN变化。
●
R版本升级后，未加载升级后版本的License。
1

## Page 463

处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 在Service OM界面，选择“系统 >系统管理 > License”。
步骤3 在“License”页面，单击“上传License”，在弹出的窗口中选择之前申请的License
文件。
步骤4 单击“打开”。
步骤5 加载License是否成功。
●
是，执行步骤13。
●
否，自动回到“License”页面。
步骤6 记录页面上显示的ESN号码。
步骤7 准备合同号。
步骤8 联系技术支持工程师获取新License文件。
步骤9 在“License”页面，单击“上传License”，在弹出的窗口中选择新获取的License文
件。
步骤10 单击“打开”。
步骤11 加载License是否成功。
●
是，执行步骤12。
●
否，请联系华为技术支持工程师。
步骤12 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤13 选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面，查看告警是否清
除。
●
是，处理完毕。
●
否，请联系华为技术支持工程师。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 464

参考信息
无。
1.2.2.6 ALM-9215
系统磁盘使用率过大
告警解释
告警模块按15分钟周期检测磁盘分区空间使用率，当检测到有系统分区空间使用率超
过70%时，产生重要告警，当检测到有系统分区空间使用率超过90%时，产生紧急告
警。当检测到系统磁盘分区的使用率低于70%时，告警恢复。
告警属性
告警ID 告警级别 可自动清除
9215
紧急/重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：固定为ServiceOM
●
IP地址：ServiceOM的浮动IP地址
附加信息
●
阈值：重要告警阈值为70%，紧急告警阈值为90%
●
使用量：超过阈值的磁盘分区和磁盘分区对应的使用率
信息列表
对系统的影响
可能影响业务的正常运行。
/opt/goku/data/db分区的使用率大于等于98%时，系统会自动停机。
可能原因
●
系统和用户进程生成的临时文件过多等原因。
●
人为操作目标系统，并创建大文件。
处理步骤
步骤1 登录Service OM主节点，具体请参见3.6 使用PuTTY登录Service OM节点。
步骤2 执行以下命令，查看分区使用率。
df -h
Filesystem Size Used Avail Use% Mounted on
/dev/vda1 6.0G 1.3G 4.7G 22% /
1

## Page 465

devtmpfs 4.8G 0 4.8G 0% /dev
tmpfs 4.8G 0 4.8G 0% /dev/shm
tmpfs 4.8G 505M 4.4G 11% /run
tmpfs 4.8G 0 4.8G 0% /sys/fs/cgroup
/dev/mapper/vg_om-lv_home 5.0G 33M 5.0G 1% /home
/dev/mapper/vg_om-lv_sysback 1014M 33M 982M 4% /sysback
/dev/mapper/vg_om-lv_var 4.0G 98M 3.9G 3% /var
/dev/mapper/vg_om-lv_tmp 3.0G 33M 3.0G 2% /tmp
/dev/mapper/vg_om-lv_log 6.0G 87M 6.0G 2% /var/log
/dev/mapper/vg_om-lv_goku 8.0G 81M 8.0G 1% /var/log/goku
/dev/mapper/vg_om-lv_opt 10G 2.0G 8.0G 20% /opt
/dev/mapper/vg_om-lv_gmbackup 6.0G 55M 6.0G 1% /opt/gmbackup
/dev/mapper/vg_om-lv_data 21G 43M 21G 1% /opt/goku/data
/dev/mapper/vg_om-lv_db 6.0G 418M 5.6G 7% /opt/goku/data/db
tmpfs 983M 0 983M 0% /run/user/0
tmpfs 983M 0 983M 0% /run/user/2000
回显显示每个分区的空间使用情况，其中第6列（Mounted on）是分区名称，第5列
（Use%）是分区的使用率。
表1-48 分区占满的影响
分区名称 分区占满的影响
/opt/goku/data/db
数据库无法正常运行，Service OM不能正常提供服务
/opt/goku/data Service OM业务不能正常运行
其他 OS和Service OM不能正常运行
步骤3 参考3.8 查找并处理主机或者虚拟机系统中的大文件章节，搜索并处理使用率超过
70％的分区下的大文件。
步骤4 执行以下命令，查看分区使用率。是否还有分区的使用率超过70%。
df -h
●
是，执行步骤3。
●
否，执行步骤5。
步骤5 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤6 选择“集中监控
>
告警管理
>
当前告警”页面，在本条告警所在行单击“清除”手动
清除告警。
步骤7 清除告警是否成功。
●
是，处理完毕。
1

## Page 466

●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，需要在Manage One运维面上手工清除此告警。
参考信息
无。
1.2.2.7 ALM-9216
软件订阅与保障年费即将到期
告警解释
告警模块按24小时周期检测license状态，当检测到当前系统时间距离License软件订阅
与保障年费截止期限小于等于60天时，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
9216
提示 是
告警参数
参数名称 参数含义
定位信息 云服务：固定为ServiceOM
附加信息 过期时间：License软件订阅与保障年费的过期时间
对系统的影响
无影响。
可能原因
现有软件订阅与保障年费距离截止期限小于等于60天。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 在Service OM界面，选择“系统 >系统管理
>
License”。
步骤3 记录页面上显示的ESN号码。
1

## Page 467

步骤4 准备合同号。
步骤5 联系技术支持工程师申请License文件。
步骤6 在“License”页面，单击“上传License”，在弹出的窗口中选择新申请的License文
件。
步骤7 单击“打开”。
步骤8 加载License是否成功。
●
是，执行步骤9。
●
否，请联系华为技术支持工程师。
步骤9 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤10 选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面，查看告警是否清
除。
●
是，处理完毕。
●
否，请联系华为技术支持工程师。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.2.8 ALM-9217
软件订阅与保障年费已经过期
告警解释
告警模块按24小时周期检测License状态，当检测到当前系统时间较之License软件订阅
与保障年费截止期限已经过期时，系统产生此告警。
当主机加载新License，且新License软件订阅与保障年费截止期限大于系统时间时，告
警恢复。
1

## Page 468

告警属性
告警ID 告警级别 可自动清除
9217
重要 是
告警参数
参数名称 参数含义
定位信息 云服务：固定为ServiceOM
附加信息 过期时间：License软件订阅与保障年费的过期时间
对系统的影响
将无法享受软件订阅与保障年费。
可能原因
现有软件订阅与保障年费已经过期。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 在Service OM界面，选择“系统 >系统管理
>
License”。
步骤3 记录页面上显示的ESN号码。
步骤4 准备合同号。
步骤5 联系技术支持工程师申请License文件。
步骤6 在“License”页面，单击“上传License”，在弹出的窗口中选择新申请的License文
件。
步骤7 单击“打开”。
步骤8 加载License是否成功。
●
是，执行步骤9。
●
否，请联系华为技术支持工程师。
步骤9 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
1

## Page 469

–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤10 选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面，查看告警是否清
除。
●
是，处理完毕。
●
否，请联系华为技术支持工程师。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.2.9 ALM-9801 Service OM
资源异常
告警解释
每20秒钟检测Service OM资源状态，当连续三次检测到资源状态异常，系统产生此告
警。
告警属性
告警ID 告警级别 可自动清除
9801
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：固定为ServiceOM
●
IP地址：ServiceOM虚拟机主节点的IP地址
附加信息
●
组件：异常组件信息列表
●
节点名称：ServiceOM虚拟机主节点名称
对系统的影响
资源异常对系统影响随不同的资源而不同，附加信息中包含了异常的资源名，各资源
影响如表1-49所示。
1

## Page 470

表1-49 资源异常影响
资源名 资源异常影响
irm
资源管理将不可用。
uportal Service
OM界面无法登录，所有的操作界面都会异常。
北向接口不可用。
primarydb Service
OM的操作界面所有操作可能无法直接生效。
csm
使用RPC服务的模块会受到影响，如：irm、connector等。
软件调测功能、License管理功能、时间管理功能不可用，后台自
动定时备份将无法执行。
uhm
硬件相关的资源管理不可用。
exfloatip Service
OM所有操作将无法进行。
omfloatip
SNMP告警将无法提供。
standbydb Service
OM的操作界面所有操作可能无法同步到备机，当主
Service
OM节点掉电可能导致数据丢失。
arcontrol Service
OM资源管理不可用。
ardata
报表和监控将不可用。
nginx
整个系统将不可用。
connector Service
OM资源池管理不可用。
orchestrator Service
OM部分资源不可用。
fault
告警功能不可用。
HA Service
OM主备节点数据库及文件系统无法保证同步。
当Service OM主节点故障时，系统可能无法倒换到备节点。
可能原因
监控资源检测到某个资源异常后，尝试重启该资源，如果连续三次重启仍然失败将触
发该告警。
处理步骤
检查系统资源状态
步骤1 在告警列表中，单击此告警所在行，在“告警详细信息”区域“附加信息”中，查看
如下信息：
●
告警对应的资源名称，如：connector
●
告警对应的节点名称，如：allinonefm0
步骤2 登录Service OM主节点，具体请参见3.6 使用PuTTY登录Service OM节点。
1

## Page 471

步骤3 执行以下命令，获取主备节点的节点名称和管理IP地址。
QueryHaState
输出结果类似如下显示，表明当前节点名称为allinonefm0，当前节点为主节点，其管
理IP地址是192.168.61.138；对端节点名称为allinonefm1，对端节点为备节点，其管
理IP地址是192.168.61.165。
LOCAL_HOST=allinonefm0
LOCAL_STATE=active
LOCAL_IP=192.168.61.138
REMOTE_HOST=allinonefm1
REMOTE_STATE=standby
REMOTE_IP=192.168.61.165
步骤4 查看步骤3执行结果，检查当前登录节点LOCAL_STATE是否为“standby”。
●
是，执行步骤5。
●
否，执行步骤9。
步骤5 检查告警对应的节点名称是否为备节点的节点名称。
● 是，执行步骤6。
●
否，执行步骤13。
步骤6 参考3.6 使用PuTTY登录Service OM节点章节，通过步骤3中获取的备节点管理IP地
址，登录Service OM备节点。
步骤7 执行以下命令，启动HA。
haStartAll -r
步骤8 经过约15分钟，查看告警是否清除。
●
是，处理完毕。
● 否，执行步骤13。
步骤9 检查告警对应的节点名称是否为主节点的节点名称。
●
是，执行步骤10。
●
否，执行步骤13。
步骤10 参考3.6 使用PuTTY登录Service OM节点章节，通过步骤3中获取的主节点管理IP地
址，登录Service OM主节点。
步骤11 执行以下命令，启动HA。
haStartAll -r
步骤12 经过约15分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤13。
步骤13 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 472

参考信息
无。
1.2.2.10 ALM-9902 Service OM
双机心跳中断
告警解释
系统一分钟检测一次主备心跳IP是否能连通，不能连通则产生告警。
告警属性
告警ID 告警级别 可自动清除
9902
重要 是
告警参数
参数名称 参数含义
定位信息 云服务：固定为ServiceOM
附加信息
●
本端地址：ServiceOM主节点IP地址
●
对端地址：ServiceOM备节点IP地址
对系统的影响
Service
OM主备节点数据库及文件系统无法保证主备同步；当主节点故障时，系统可
能无法倒换到备节点。
可能原因
●
备节点下电。
●
网络故障。
●
备节点操作系统异常。
●
备节点HA进程未启动。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 在Service OM界面，选择“服务列表
>
资源
>
计算资源
>
虚拟机”。
步骤3 在右侧搜索框输入“allinone”后单击搜索，搜索Service OM虚拟机，查看虚拟机是
否都处于运行状态。
●
是，如下图，执行步骤8。
1

## Page 473

● 否，执行步骤4。
步骤4 查看界面“操作”列，启动按钮是否被灰化。
●
是，执行步骤6。
●
否，执行步骤5。
步骤5 单击“更多
>
启动”，启动Service OM虚拟机，是否能启动成功。
●
是，执行步骤8。
●
否，执行步骤6。
步骤6 登录FusionSphere OpenStack控制节点，具体请参见3.5 使用PuTTY登录
FusionSphere
OpenStack节点。
步骤7 执行以下命令，重启Service OM备节点虚拟机。
nova reboot FM_ID
FM_ID为Service OM备节点虚拟机的ID，在“服务列表
>
资源
>
计算资源
>
虚拟机”
页签，可以查看虚拟机的ID。
步骤8 等待约15分钟，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤9。
步骤9 获取备节点虚拟机所在的主机信息，在OM界面的主机列表检查主机状态是否正常。
●
是，登录FusionSphere OpenStack安装部署界面，选择“云化服务
>
FusionSphere Openstack
OM”，如果虚拟机的“启动源”是“后端存储”，执
行步骤12。
●
否，执行步骤10。
步骤10 检查主机是否下电。
●
是，对主机上电，等待约20分钟，如果告警自动清除，处理完毕；如果告警没有
自动清除，执行步骤11。
●
否，执行步骤11。
步骤11 检查是否执行过“更换主机”操作。
●
是，执行步骤13。
●
否，执行步骤12。
步骤12 检查虚拟机所在的后端存储对接是否正常。
●
是，执行步骤13。
●
否，恢复存储链接后，等待约15分钟，查看告警是否清除，如果告警自动清除，
处理完毕；如果告警没有自动清除，执行步骤13。
步骤13 参考2.4.2.1.2 主备部署时单个Service OM虚拟机故障恢复该虚拟机。
1

## Page 474

步骤14 等待约15分钟，查看告警是否清除。
●
是，处理完毕。
● 否，执行步骤15。
步骤15 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.2.11 ALM-9903 Service OM
双机文件同步失败
告警解释
系统5分钟进行主备节点文件全同步，全同步失败则产生告警。
告警属性
告警ID 告警级别 可自动清除
9903 提示 是
告警参数
参数名称 参数含义
定位信息 云服务：固定为ServiceOM
附加信息
●
本端地址：ServiceOM主节点IP地址
● 对端地址：ServiceOM备节点IP地址
对系统的影响
Service
OM主备节点文件系统无法保持一致性，当主备倒换时，备节点升主后可能导
致部分文件在原主节点的修改丢失，造成部分业务配置失效。
可能原因
●
主节点文件HA同步服务异常。
●
网络闪断。
●
节点重启。
1

## Page 475

处理步骤
步骤1 登录Service OM主节点，具体请参见3.6 使用PuTTY登录Service OM节点。
步骤2 执行以下命令，检查HA主备状态是否正常。
QueryHaState om
输出结果类似如下显示，表明当前HA状态正常。
LOCAL_HOST=allinonefm0
LOCAL_STATE=active
LOCAL_IP=192.168.61.138
REMOTE_HOST=allinonefm1
REMOTE_STATE=standby
REMOTE_IP=192.168.61.165
如果LOCAL_STATE或REMOTE_STATE存在unknow，则表明当前HA状态存在异常。
●
HA状态正常，执行步骤8。
●
LOCAL_STATE状态异常，执行步骤3。
●
REMOTE_STATE状态异常，执行步骤5。
步骤3 执行以下命令，重启HA。
haStopAll -r;haStartAll -r
步骤4 执行步骤8。
步骤5 参考3.6 使用PuTTY登录Service OM节点章节，通过步骤2中获取的备节点管理IP地
址，登录Service OM备节点。
说明
备节点IP可以由步骤2中的REMOTE_IP获取。
步骤6 执行以下命令，重启HA。
haStopAll -r;haStartAll -r
步骤7 执行步骤8。
步骤8 15分钟以后，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 476

1.2.2.12 ALM-9913
系统默认证书使用提醒
告警解释
Service
OM周期（默认为1小时）检查环境上的证书是否是华为默认证书，如果存在证
书是华为默认证书，产生此告警。
告警属性
告警ID 告警级别 可自动清除
9913
提示 是
告警参数
参数名称 参数含义
定位信息
●
云服务：固定为ServiceOM
●
证书类型：默认证书的类型
附加信息 无
对系统的影响
华为缺省证书仅建议用于开局调试阶段，正式商用后需切换到局方证书，继续使用缺
省证书不会影响业务功能，华为不承担因使用华为证书带来的安全风险。
可能原因
系统中使用的证书是华为默认出厂证书。
处理步骤
步骤1 在告警定位信息中，获取需要更换的证书类型。
说明
● A类证书：FusionSphere-CpsWeb、FusionSphere-DMK、FusionSphere-CloudNetDebug、
FusionSphere-Service和FusionSphere-ServiceOM证书。
●
B类证书：FusionSphere-API和ManageOne-PKI证书。
步骤2 参考相应章节，更换证书。
●
A类证书：请参考《华为云Stack
8.1.0
运维指南》中“更换FusionSphere A类证
书（FusionSphere-ServiceOM、FusionSphere-CpsWeb、FusionSphere
OM）”、“更换DMK界面的Nginx证书”、“更换ManageOne运营面证书
（FusionSphere-Service）”。
●
B类证书：请参考《华为云Stack
8.1.0
运维指南》中“通过ManageOne界面方式
单个或批量更换证书”。
1

## Page 477

步骤3 在替换完所有证书之后，等待一小时左右，检查告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤4。
步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.2.13 ALM-9915
证书过期预警
告警解释
Service
OM周期（默认为1小时）检查环境上的证书是否过期，如果存在证书未到生效
时间、即将过期或者已经过期，产生此告警。
告警属性
告警ID 告警级别 可自动清除
9915
紧急/重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：固定为ServiceOM
● 证书类型：默认证书的类型
附加信息
●
开始时间：证书开始时间
●
结束时间：证书结束时间
●
详细信息：证书即将过期或者还未生效或者已经过期的
时间说明
对系统的影响
如果环境上的证书过期， 且在证书认证开关打开的情况下，则服务和命令行将不可
用。
1

## Page 478

可能原因
●
组件的证书还未到生效时间。告警级别：紧急。
●
组件的证书即将（30天内）过期。告警级别：重要。
●
组件的证书马上（7天内）过期。告警级别：紧急。
●
组件的证书已经过期。告警级别：紧急。
处理步骤
步骤1 在告警定位信息中，获取需要更换的证书类型。
说明
● A类证书：FusionSphere-CpsWeb、FusionSphere-DMK、FusionSphere-CloudNetDebug、
FusionSphere-Service和FusionSphere-ServiceOM证书。
●
B类证书：FusionSphere-API和ManageOne-PKI证书。
步骤2 查看告警附加信息，根据证书开始和结束的时间，判断证书状态。
●
证书未到生效时间或证书已经过期，执行步骤3。
●
证书即将过期，执行步骤4。
步骤3 参考《华为云Stack
8.1.0
运维指南》“证书管理
>
附录”中的以下章节，分别更新下
列证书：
●
“手动替换Service OM界面证书”
●
“手动恢复FusionSphere
OpenStack
SSL证书”
●
“手动恢复FusionSphere-Keystone PKI证书”
●
“更换Service OM的HA服务认证证书”
●
“更换Service OM的Web服务器nginx证书”
●
“更换Service OM的数据库证书”
●
“更换Service OM的backup-client证书”
更新完成后，执行步骤5。
步骤4 参考相应章节，更换证书。
●
A类证书：请参考《华为云Stack
8.1.0
运维指南》中“更换FusionSphere A类证
书（FusionSphere-ServiceOM、FusionSphere-CpsWeb、FusionSphere
OM）”、“更换DMK界面的Nginx证书”、“更换ManageOne运营面证书
（FusionSphere-Service）”。
●
B类证书：请参考《华为云Stack
8.1.0
运维指南》中“通过ManageOne界面方式
单个或批量更换证书”。
步骤5 在替换完所有证书之后，等待一小时左右，检查告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤6。
步骤6 请联系技术支持工程师协助解决。
----结束
1

## Page 479

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.2.14 ALM-9917 Service OM
虚拟机
CPU
占用率超过阈值
告警解释
Service
OM组件周期（默认为5分钟）检查环境上自身虚拟机CPU使用率情况。如果
CPU使用率超过95%，则产生此告警。如果使用率低于该阈值，告警恢复。
告警属性
告警ID 告警级别 可自动清除
9917
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：固定为ServiceOM
●
IP地址：ServiceOM虚拟机的固定IP地址
附加信息
● 云服务：固定为ServiceOM
●
阈值：告警上报阈值
●
使用率：CPU使用率
对系统的影响
Service
OM所在虚拟机CPU利用率超过阈值，可能导致Service OM所在虚拟机响应缓
慢，命令超时，或出现无法正常运行等现象。
可能原因
某些进程未被及时处理占用太多的CPU资源。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 选择“ 系统
>
任务与日志
>
任务中心”，观察是否有正在执行的任务。
1

## Page 480

●
是，请等待任务执行结束之后，执行步骤3。
●
否，执行步骤4。
步骤3 等待10分钟左右，检查告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤4。
步骤4 选择“系统
>
任务与日志
>
操作日志”，请查看是否有当前5分钟内的操作日志。
●
是，执行步骤5。
●
否，执行步骤6。
步骤5 等待10分钟左右，检查告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤6。
步骤6 等待超过30分钟，检查告警是否自动清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.2.2.15 ALM-9918 Service OM
虚拟机内存占用率超过阈值
告警解释
Service
OM组件周期（默认为5分钟）检查环境上自身虚拟机内存使用率情况。如果内
存使用率超过95%，则产生此告警。如果使用率低于该阈值，告警恢复。
告警属性
告警ID 告警级别 可自动清除
9918
重要 是
告警参数
参数名称 参数含义
定位信息
●
云服务：固定为ServiceOM
●
IP地址：ServiceOM虚拟机的固定IP地址
1

## Page 481

参数名称 参数含义
附加信息
●
云服务：固定为ServiceOM
●
阈值：告警上报阈值
●
使用率：内存使用率
对系统的影响
如果Service OM虚拟机内存占用率过高，则业务响应较慢，出现异常可能性增大，影
响用户体验。
可能原因
某些进程未被及时处理，造成大量内存耗费。
处理步骤
步骤1 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤2 选择“ 系统
>
任务与日志
>
任务中心”，观察是否有正在执行的任务。
●
是，请等待任务执行结束之后，执行步骤3。
●
否，执行步骤4。
步骤3 等待10分钟左右，检查告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤4。
步骤4 选择“系统
>
任务与日志
>
操作日志”，请查看是否有当前5分钟内的操作日志。
●
是，执行步骤5。
●
否，执行步骤6。
步骤5 等待10分钟左右，检查告警是否自动清除。
●
是，处理完毕。
●
否，执行步骤6。
步骤6 等待超过30分钟，检查告警是否自动清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 482

参考信息
无。
1.2.3
常见问题
1.2.3.1 FusionSphere OpenStack
类
1.2.3.1.1
如何处理强制时间同步失败
现象描述
在FusionSphere OpenStack安装部署界面，执行强制时间同步失败。
可能原因
执行强制时间同步的过程中外部时钟源异常。
定位思路
恢复系统后检查外部时钟源是否正常。
必备事项
已登录FusionSphere OpenStack安装部署界面。
操作步骤
步骤1 使用“PuTTY”，登录第一台主机。
以“fsp”用户通过管理IP地址登录。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证，具体
操作请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 导入环境变量，具体操作请参见3.1 导入环境变量。
此处请固定输入“2”，导入CPS环境变量。
步骤5 执行以下命令，查看强制时间同步结果。
ntp result-show
1

## Page 483

命令执行是否返回成功。
● 是，执行步骤6。
●
否，执行步骤9。
步骤6 执行以下命令，恢复环境。
ntp start-hosts --host all
命令执行成功5分钟后，查看环境是否恢复正常。
●
是，执行步骤7。
●
否，执行步骤9。
步骤7 执行以下命令，查看时钟源是否故障。
ntp time-delta --host all
●
是，ntp-server与外部时钟源时差显示为Fail，执行步骤8。
●
否，执行步骤9。
步骤8 恢复ntp-server与外部时钟源，恢复后，采用手工操作执行强制时间同步。具体操作请
参见1.2.1.2
ALM-6010
NTP服务器与外部时钟源时间差超过阈值。
步骤9 如果出现“Max
retries exceeded with url:
/cps/v1/ntp/sync”的错误信息，则先将三
个控制节点重启，再重新执行原先的处理流程。其他错误信息，请联系技术支持工程
师协助解决。
----结束
1.2.3.1.2 nova-compute
组件故障处理
可能原因
● 网络异常。
●
组件运行异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
在“概要”界面，根据告警定位信息中的“主机ID”，在“管理IP地址”一栏获
得主机的管理IP地址。
3.
选择“运维
>
组件维护”，进入“组件维护”页面。
4.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
1

## Page 484

–
是，执行5。
–
否，执行13。
5.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
6. 在“组件”页签，选择nova服务和nova-compute组件，单击“搜索”。
检查nova-compute组件状态是否为active。
–
是，执行13。
–
否，执行7。
7.
在“组件”页签，选择neutron服务和neutron-openvswitch-agent组件，单击
“搜索”。
检查neutron-openvswitch-agent组件状态是否为active。
–
是，执行8。
–
否，执行1.2.3.1.20 neutron-openvswitch-agent组件故障处理。
8.
清空搜索栏的“主机ID”，选择nova服务和nova-conductor组件，单击“搜
索”。
检查nova-conductor组件状态是否为active。
–
是，执行9。
–
否，执行1.2.3.1.5 nova-conductor组件故障处理。
9.
登录故障组件所在节点。
a.
使用“PuTTY”，通过2中的管理IP登录故障主机。
以“fsp”帐户登录。
b.
执行以下命令，并输入“root”帐户的密码切换到“root”帐户。
su - root
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
10.
后台检查使用存储多路径开关是否开启。
执行命令cps
template-params-show --service nova nova-compute | grep
libvirt_iscsi_use_ultrapath
查看配置项libvirt_iscsi_use_ultrapath值。
–
值为true，表示开启，检查多路径服务是否启动。
执行命令ps
-ef | grep
upservice，查看服务是否启动正常。
▪
否，表示未安装，则安装多路径服务。
▪
是，表示已安装，执行11。
–
值为false，表示关闭，请打开多路径开关或者安装多路径包。
说明
●
手动开启和关闭多路径的命令如下：
●
打开多路径开关：cps
template-params-update --service nova nova-
compute --parameter libvirt_iscsi_use_ultrapath=true; cps commit
● 关闭多路径开关：cps template-params-update --service nova nova-
compute --parameter libvirt_iscsi_use_ultrapath=false; cps commit
11.
在FusionSphere OpenStack安装部署界面，参考3~6，勾选筛选出的“fault”状
态nova-compute组件，单击“启动”按钮。
1

## Page 485

12.
等待1分钟，单击“刷新”按钮，查看nova-compute组件状态是否为active。
–
是，处理完毕。
–
否，执行13。
13.
请联系技术支持工程师协助解决。
1.2.3.1.3 nova-api
组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，执行8。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择nova服务和nova-api组件，单击“搜索”。
6.
勾选筛选出的“fault”状态nova-api组件，单击“启动”按钮。
7.
等待1分钟，单击“刷新”按钮，查看nova-api组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
请联系技术支持工程师协助解决。
1.2.3.1.4 nova-scheduler
组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
1

## Page 486

2.
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，执行步骤8。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择nova服务和nova-scheduler组件，单击“搜索”。
检查nova-scheduler组件状态是否为active。
●
是，执行步骤8。
●
否，执行步骤6。
步骤6 勾选筛选出的“fault”状态nova-scheduler组件，单击“启动”按钮。
步骤7 等待1分钟，单击“刷新”按钮，查看nova-scheduler组件状态是否为active。
●
是，处理完毕。
●
否，执行步骤8。
步骤8 请联系技术支持工程师协助解决。
----结束
1.2.3.1.5 nova-conductor
组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
1

## Page 487

步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，执行步骤8。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择nova服务和nova-conductor组件，单击“搜索”。
检查nova-conductor组件状态是否为active。
●
是，执行步骤8。
●
否，执行步骤6 。
步骤6 勾选筛选出的“fault”状态nova-conductor组件，单击“启动”按钮。
步骤7 等待1分钟，单击“刷新”按钮，查看nova-conductor组件状态是否为active。
●
是，处理完毕。
●
否，执行步骤8。
步骤8 请联系技术支持工程师协助解决。
----结束
1.2.3.1.6 vmware-nova-compute
组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3. 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，执行8。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择nova服务和vmware-nova-compute00X组件，单击“搜
索”。
1

## Page 488

检查vmware-nova-compute00X组件状态是否为active。
说明
vmware-nova-compute00X中X表示1、2或者3等数字，是在对接VMware时候，按照顺序
生成的，例如第一个对接的VMware会生成组件vmware-nova-compute001，第二次则会
生成vmware-nova-compute002组件，以此类推。
–
是，执行8。
–
否，执行6。
6.
勾选筛选出的“fault”状态vmware-nova-compute00X组件，单击“启动”按
钮。
7.
等待1分钟，单击“刷新”按钮，查看vmware-nova-compute00X组件状态是否
为active。
–
是，处理完毕。
– 否，执行8。
8.
请联系技术支持工程师协助解决。
1.2.3.1.7
memcache组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2. 查询节点状态是否正常。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3. 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，执行8。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择nova服务和memcache组件，单击“搜索”。
检查memcache组件状态是否为active。
–
是，执行8。
–
否，执行6。
6. 勾选筛选出的“fault”状态memcache组件，单击“启动”按钮。
7.
等待1分钟，单击“刷新”按钮，查看memcache组件状态是否为active。
1

## Page 489

–
是，处理完毕。
–
否，执行8。
8. 请联系技术支持工程师协助解决。
1.2.3.1.8 cinder-volume
组件故障处理
可能原因
● 网络异常。
●
组件运行异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“配置
>
资源池管理
>
KVM”，进入“集群管理”页面。
步骤3 在“存储集群”页签中，根据告警定位信息中的资源池ID，定位到对应的资源池，单
击下方的“ ”按钮，进入“配置存储集群”页面。
步骤4 在“配置存储集群”页面，检查REST URL、存储资源池名称、存储IP地址、用户名、
密码是否配置正确。
●
是，执行步骤5。
●
否，重新配置错误项。
步骤5 在“配置存储集群”页面下方的“选择主机部署服务”列表，查看并记录下组件所部
署的主机ID。
步骤6 检查多路径开关是否打开。
选择“配置
>
多网元管理”界面，单击“主机组”中不同的主机组，在其右侧的“主
机列表”中，查看根据步骤5中获取到的主机ID是否都在其中。
●
是，查看页面上“Cinder”使用存储多路径的配置项，如果对接了华为磁阵，应
该选择ultrapath，否则选择multipath。
●
否，则选择“配置
> OpenStack > Cinder >
配置存储多路径”界面，如果对接了
华为磁阵，应该选择ultrapath，否则选择multipath。
步骤7 检查多路径服务是否正常。
选择“运维
>
系统检查”页面，在“初始安装全量检查”页签中的基本用例中，勾选
“组件配置数据一致性检查”，单击“执行用例”，查看执行完成后，状态是否正
常。
●
是，说明多路径服务正常。
1

## Page 490

●
否，单击 查看具体异常信息，如果其中不包含ultrapath、multipath等字样，
说明多路径服务正常，否则说明多路径服务异常，记录错误信息提示的主机ID，
执行步骤8。
步骤8 修复异常多路径服务。
选择“概要”，在主机列表中，查找步骤7中记录的错误信息中提示的主机ID，获取对
应的“管理IP地址”。
使用PuTTY工具登录管理IP地址，执行命令rpm
-qa | grep
UltraPath，如果返回空，
表示未安装华为多路径包，请安装和配置多路径包。
说明
多路径软件包的获取和安装方式如下：
1.
通过https://support.huawei.com/enterprise/，获取并解压“FusionSphere
SIA
X.X.X_Drivers.zip”驱动包。
2.
在“06
Driver for FusionSphere X.X > for FusionSphere OpenStack > 01
UltraPath”文件
夹获取并解压缩“ULTRAPATH_XXX_XXX_FSOV1R6C30.tar.gz”软件包。
3.
在解压缩后的“ULTRAPATH_XXX_XXX_FSOV1R6C30.tar.gz”文件夹中，打开os子文件夹，
获取UltraPath-xxx-xxx.rpm文件，并执行如下命令，安装多路径软件包。
rpm -ivh UltraPath-xxx-xxx.rpm
4. 执行如下命令，启动多路径服务。
service nxup start
步骤9 检查节点与存储设备的存储网络、管理网络是否连通。
在FusionSphere OpenStack安装部署界面，选择“运维
>
系统检查”界面，执行“存
储驱动检查”高级用例，检查错误信息是否包含不通的ip列表。
步骤10 如以上步骤都不能排查出故障原因，请联系技术支持工程师协助解决。
----结束
1.2.3.1.9 nova-compute-ironic
组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
1

## Page 491

3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，执行8。
4.
单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择ironic服务、nova-compute-ironic组件，单击“搜索”。
6.
勾选筛选出的“fault”状态组件，单击“启动”按钮。
7.
等待1分钟左右，单击“刷新”按钮查看故障组件是否为“active”。
– 是，操作结束。
–
否，执行8。
8.
请联系技术支持工程师协助解决。
1.2.3.1.10 glance
组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，执行步骤9。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择glance服务和glance组件，单击“搜索”。
检查glance服务状态是否为active。
●
是，执行步骤6。
●
否，执行步骤7。
步骤6 勾选筛选出的“active”状态组件，单击“停止”按钮，然后单击“确认”按钮，停止
组件。
1

## Page 492

步骤7 勾选筛选出的“fault”状态组件，单击“启动”按钮，启动组件。
步骤8 检查glance服务状态是否为active。
●
是，处理完毕。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
1.2.3.1.11 gaussdb
组件故障处理
可能原因
● 组件运行异常。
●
系统环境被破坏。
●
网络异常。
●
主机磁盘空间占满。
●
主数据库故障，备数据库由于同步数据不正常无法升主。
定位思路
1.
查询节点状态是否正常。
2.
检查节点网络是否可达。
3. 检查数据同步网络是否有丢包。
4.
检查磁盘空间和数据库是否故障。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
– 是，执行4。
–
否，参考1.2.1.6
ALM-6017
主机状态异常章节，优先处理主机状态异常。处
理完成后，等待10-15分钟，执行4。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签的组件列表中，查找并记录以“gaussdb”开头的服务及组件名
称。
6.
清空搜索栏的“主机ID”，选择5中获取的服务和组件名称，单击“搜索”，查询
两个节点的组件状态是否分别为active和standby。
– 是，处理完成。
–
否，执行7。
7.
勾选筛选出的“fault”状态的组件， 单击“启动”，等待3~5分钟，查看组件状
态是否变为active或者standby。
1

## Page 493

–
是，gaussdb组件故障修复成功，处理完成。
–
否，记录两个主机的主机ID及组件状态对应关系，并执行8。
8.
在“概要”界面，根据记录的主机ID，获取两个主机的“主机IP地址”。
9.
导入环境变量。
a.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b. 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c. 导入环境变量，具体操作请参见3.1 导入环境变量。
10. 查看网络状态是否正常。
ping manageip，查看manageip是否ping通。
– 是，执行11。
– 否，则说明故障节点网络不可达，需要先排查网络问题。
说明
manageip：8中获取的故障节点的主机IP地址。
11.
查看7中记录的两个节点的gaussdb组件状态是否分别为active和fault。
–
是，执行12。
–
否，执行15。
12.
参考9，登录gaussdb主节点的主机IP地址。
13.
执行如下命令获取gaussdb数据同步ip。
ip addr show brcps|grep -E "gaussdb0|gaussdb1"
14.
参考9，登录gaussdb的fault节点，ping13中获取到的ip，持续3分钟，查看是否
有丢包。
–
是，先排查网络丢包问题。
–
否，执行15。
15.
恢复gaussdb组件状态，具体操作请参见2.4.1.4.2 数据库状态异常处理。
16.
请联系技术支持工程师协助解决。
1

## Page 494

1.2.3.1.12
keystone组件故障处理
可能原因
●
组件运行异常。
●
系统环境被破坏。
●
网络异常。
定位思路
1.
查询节点状态是否正常。
2.
检查节点网络是否可达。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“组件”页签，选择gaussdb服务、gaussdb组件，单击“搜索”，查看“组件
状态”列是否有“fault”。
–
是，执行1.2.3.1.11 gaussdb组件故障处理。
–
否，执行4。
4.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行5。
–
否，则说明节点故障，参考1.2.1.6
ALM-6017
主机状态异常章节，优先处理
主机状态异常。处理完成后，等待10-15分钟，执行5。
5. 在“组件”页签，选择“keystone”服务，“keystone”组件，单击“搜索”，
查询两个节点的组件状态是否分别为active和standby。
–
是，处理完成。
–
否，执行6。
6.
勾选筛选出的“fault”状态的组件， 单击“启动”，等待3~5分钟，查看组件状
态是否变为active或者standby。
–
是，keystone组件故障修复成功，处理完成。
–
否，记录两个主机的主机ID及组件状态对应关系，并执行7。
7.
在“概要”界面，根据记录的主机ID，获取两个主机的“主机IP地址”。
8.
导入环境变量。
a.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
1

## Page 495

说明
External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
9.
查看网络状态是否正常。
执行命令ping manageip，查看manageip是否ping通。
– 是，执行10。
–
否，则说明故障节点网络不可达，需要先排查网络问题。
说明
manageip：7中获取的故障节点的主机IP地址。
10.
请联系技术支持工程师协助解决。
1.2.3.1.13
rabbitmq组件故障处理
可能原因
●
组件运行异常。
●
系统环境被破坏。
●
网络异常。
定位思路
1.
查询节点状态是否正常。
2.
检查节点网络是否可达。
3.
检查rabbitmq_extend_ip是否被其他节点配置，导致IP冲突。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，参考1.2.1.6
ALM-6017
主机状态异常章节，优先处理主机状态异常。处
理完成后，等待10-15分钟，执行4。
4. 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签的组件列表中，查找并记录以“rabbitmq”开头的服务及组件名
称。
1

## Page 496

6.
清空搜索栏的“主机ID”，选择5中获取的服务和组件名称，单击“搜索”，查询
两个节点的组件状态是否分别为active和standby。
–
是，处理完成。
–
否，执行7。
7.
勾选筛选出的“fault”状态的组件， 单击“启动”，等待3~5分钟，查看组件状
态是否变为active或者standby。
–
是，rabbitmq组件故障修复成功，处理完成。
–
否，记录两个主机的主机ID及组件状态对应关系，并执行8。
8.
在“概要”界面，根据记录的主机ID，获取两个主机的“主机IP地址”。
9.
导入环境变量。
a.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
10.
查看网络状态是否正常。
执行命令ping manageip，查看manageip是否ping通。
–
是，执行11。
–
否，则说明故障节点网络不可达，需要先排查网络问题。
说明
manageip：8中获取的故障节点的主机IP地址。
11.
参考9，通过rabbitmq为active的主机IP地址登录rabbitmq节点。
12.
执行命令cps
template-params-show --service rabbitmq
rabbitmq，查看是
否可以获取rabbitmq_extend_ip中的ip和systeminterface。
CD7D28B5-8958-A048-9B61-0E4F2B08A15A:/home/fsp # cps template-params-show --service
rabbitmq rabbitmq
+------------------------+----------------------------------------------------+
| Property | Value |
+------------------------+----------------------------------------------------+
| heartbeat_timeout | 6 |
| memory_high_watermark | |
| om_monitor_ip | {} |
| rabbit_password | XXXXXX |
| rabbit_use_ssl | true |
| rabbitmq_extend_ip | [{"ip": "10.10.10.10", "systeminterface": "externa |
| | l_om", "mask": "24", "gateway": "10.10.10.1"}] |
| socket_connection_mode | CHAP |
1

## Page 497

| ssl_version | TLSv1_2 |
+------------------------+----------------------------------------------------+
– 是，执行13。
–
否，执行15。
13. 执行如下命令，查看是否能获取rabbitmq_extend_ip对应的MAC地址。
arping -D -I systeminterface rabbitmq_extend_ip
6F4AB81F-B799-8348-A691-E29D5B25EC64:~ # arping -D -I external_om 10.10.10.10
ARPING 10.10.10.10 from 0.0.0.0 external_om
Unicast reply from 10.10.10.10 [FA:16:3E:1A:9C:A1] 1.085ms
Sent 1 probes (1 broadcast(s))
Received 1 response(s)
–
是，执行14。
–
否，执行15。
14.
执行如下命令，查询MAC地址是否在本节点。
ifconfig|grep -i
MAC地址
–
如果有查到，则代表rabbitmq的rabbitmq_extend_ip在本节点，无IP冲突，
执行15。
–
如果没查到，则表示存在IP冲突，请排查IP规划是否正确。
15.
请联系技术支持工程师协助解决。
1.2.3.1.14
neutron-server组件故障处理
可能原因
● 网络异常。
●
组件运行异常。
●
组件配置错误。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
组件常用配置项检查。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择neutron服务和neutron-server组件，单击“搜索”。
1

## Page 498

6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
7. 等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
– 否，执行8。
8.
导入环境变量。
a.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
9.
检查组件neutron-server配置项是否正常：
–
是否同时配置了qos_extension和ac_qos_plugin。执行
cat /etc/neutron/
neutron.conf | grep service_plugins
查看service_plugins中qos_extension和
ac_qos_plugin是否同时存在。如果是，请使用cps命令更新配置项删除其中
一个。
–
neutron-server的cfg文件是否有空值。执行cat
/etc/huawei/fusionsphere/
neutron.neutron-server/cfg/neutron.neutron-server.cfg | grep
null查看
是否有空值，如果有，请联系技术支持工程师协助解决。
– Agile
Controller-DCN插件配置是否正确。在对接Agile Controller-DCN场景
下，配置/etc/neutron/huawei_driver_config.ini时漏填或者将值置为空会导
致neutron-server异常。常见问题为rpc_server_ip或者host没有配，建议参照
组网规划逐个排查所有控制节点/etc/neutron/huawei_driver_config.ini 中的
配置。此外需要提醒的是，无需填值的配置项保持原样注视掉该配置项即
可，如果去掉注释符号，则不再有默认配置，用户需要保证自己填写的内容
的正确性。举例：“#
ac_auth_password
=”表示会使用默认的密码，但是
如果去掉注释符号即“ac_auth_password =”，则表示密码为空，neutron-
server组件会报异常。
–
service_plugins和service_provider是否匹配。plugin和provider不匹配（拼写
错误或者忘记配其中一个）会导致neutron-server服务异常。如果环境使用负
载均衡（例如对接F5）或端口镜像(neutron-taas-agent)，建议参照调测文
档重新检查配置。
如有配置错误请先修复，然后执行如下命令启动组件。
cps host-template-instance-operate --service neutron neutron-server --
action start
–
是，处理完毕。
1

## Page 499

–
否，执行10。
10.
请联系技术支持工程师协助解决。
1.2.3.1.15
neutron-l3-service-agent组件故障处理
可能原因
●
网络异常。
●
组件配置异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
检查组件配置是否正常。
处理步骤
1.
登录控制节点，切换到root用户，导入环境变量。
a.
使用“PuTTY”，通过反向代理的IP地址登录AZ内第一台主机。
以“fsp”帐户登录。
b.
执行以下命令，并输入“root”帐户的密码切换到“root”帐户。
su - root
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
2.
检查主机状态是否正常。
执行命令cps
host-list | grep fault
主机状态是否为fault。
如果有状态为fault的主机，则环境存在问题，请优先排查节点fault原因。
3.
执行如下命令查询 neutron-l3-service-agent组件配置。
cps template-params-show --service neutron neutron-l3-service-agent01
从回显的信息中确认fip_mappings,hm_ip_mappings和vrouter_mappings已配
置，且格式准确。
fip_mappings,vrouter_mappings为列表，元素为节点ID：seq值，seq值为int型且
在1到16之间。
hm_ip_mappings为列表，元素为节点ID：IP/mask。
如配置格式不准确，请参考如下命令重新配置，XXX=YYY替换为具体的配置项和
值。
cps template-params-update --service neutron neutron-l3-service-agent01
--parameter XXX=YYY
cps commit
4.
等待1分钟查看组件是否恢复，如未恢复，请联系技术支持工程师协助解决。
1

## Page 500

1.2.3.1.16
neutron-vrouter组件故障处理
可能原因
●
网络异常。
● 组件配置异常。
●
系统环境被破坏。
●
Mellanox网卡未安装驱动。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
查询组件配置是否正常。
4.
检查网络节点使用的网卡是否为Mellanox。
处理步骤
1.
检查网卡的类型。
–
Mellanox，请参考中“在FusionSphere安装部署界面导入Mellanox原生驱
动”《华为云Stack
8.1.0
运维指南》中“在FusionSphere安装部署界面导入
Mellanox原生驱动”章节操作，处理完成后，执行8。
–
其他，执行2。
2.
登录控制节点，切换到root用户，导入环境变量。
a.
使用“PuTTY”，通过反向代理的IP地址登录AZ内第一台主机。
以“fsp”帐户登录。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
b.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
3.
检查主机状态是否正常。
执行命令cps
host-list | grep fault
主机状态是否为fault。
如果有状态fault的主机，则环境存在问题，请优先排查节点fault原因。
4.
执行如下命令确认neutron-l3-service-agent组件已部署，并且状态正常，否则请
先参考1.2.3.1.15 neutron-l3-service-agent组件故障处理排查。
cps template-instance-list --service neutron neutron-l3-service-agent01
5.
执行如下命令查询neutron-vrouter组件部署的节点ID。
cps template-instance-list --service vrouter neutron-vrouter01
1

## Page 501

6.
执行如下命令查询neutron-l3-service-agent的配置。
cps template-params-show --service neutron neutron-l3-service-agent01
7.
检查6中查询的vrouter_mappings配置中的ID和从5查询的部署了neutron-vrouter
组件的节点ID是否一致，seq值是否在1到16之间并且互不相等，如果不正确请执
行如下命令修改neutron-l3-service-agent的配置。
cps template-params-update --service neutron neutron-l3-service-agent01
--parameter
vrouter_mappings="节点1 ID:seq1,节点
2 ID:seq2"
例如：cps
template-params-update --service neutron neutron-l3-service-
agent01 --parameter vrouter_mappings="7A7C7D29-D21D-B211-
AB16-0018E1C5D866:1,9236322A-D21D-B211-A515-0018E1C5D866:2"
再执行cps
commit
提交配置更改。
8.
请等待1分钟，查询neutron-vrouter组件是否恢复正常，如没有恢复正常，请联
系技术支持工程师协助解决。
1.2.3.1.17
neutron-ipv6-vrouter组件故障处理
可能原因
●
网络异常。
●
组件配置异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
查询组件配置是否正常。
1

## Page 502

处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维 > 组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，环境存在问题，请优先排查节点fault原因，执行步骤9。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择neutron服务和neutron-l3-service-agentXXX组件（XXX表示组
件编号，可以从01~99），单击“搜索”。
检查neutron-l3-service-agentXXX组件状态是否为active。
● 是，执行步骤6。
●
否，参考1.2.3.1.15 neutron-l3-service-agent组件故障处理进行处理。
步骤6 重新选择neutron服务和neutron-ipv6-vrouterXXX组件（XXX表示组件编号，可以从
01~99，具体组件名从告警附加信息中获取），单击“搜索”。
步骤7 勾选筛选出的“fault”状态组件，单击“启动”按钮。
步骤8 等待1分钟，检查组件状态是否为active。
●
是，处理完毕。
●
否，执行步骤9。
步骤9 请联系技术支持工程师协助解决。
----结束
1.2.3.1.18
neutron-l3-nat-agent组件故障处理
可能原因
●
网络异常。
●
组件配置错误。
●
系统环境被破坏。
●
依赖的组件异常。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
组件常用配置项检查。
4.
确保依赖的组件正常。
1

## Page 503

处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，环境存在问题，请优先排查节点fault原因。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择nat-server服务和neutron-l3-nat-agentXXX组件（表示组件编
号，可以从01~99，具体组件名从告警附加信息中获取），单击“搜索”。
步骤6 勾选筛选出的“fault”状态组件，单击“启动”按钮。
步骤7 等待1分钟，查看组件状态是否为active。
●
是，处理完毕。
●
否，执行步骤8。
步骤8 导入环境变量。
1.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请
参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack Deploy
导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签
搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
2.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
3.
导入环境变量，具体操作请参见3.1 导入环境变量。
步骤9 执行如下命令，查看故障组件配置。
cps template-params-show --service nat-server neutron-l3-nat-agent01
1

## Page 504

确保host_ip_mapping配置项中主机ID和部署该组件的主机ID一致，并且格式正确，格
式为natserver_hostid1:IP11/mask11,natserver_hostid2:IP21/mask21。
如有配置错误，请先修复，然后执行如下命令启动组件。
cps host-template-instance-operate --service nat-server neutron-l3-nat-
agent01 --action start
等待1分钟，检查组件是否恢复正常(active)。
●
是，处理完毕。
●
否，执行步骤10。
步骤10 确保neutron-l3-service-agentXXX（XXX表示组件编号，可以从01~99，具体组件名从
告警附加信息中获取）、neutron-vrouter组件状态正常(active)，如有异常请先修复
(参考对应指导)，然后执行如下命令启动组件。
cps host-template-instance-operate --service neutron neutron-l3-service-
agent01 --action start
等待1分钟，检查组件是否恢复正常(active)。
●
是，处理完毕。
●
否，执行步骤11。
步骤11 执行如下命令查询neutron-l3-service-agent的fip_mappings配置，neutron-l3-
service-agentX是具体的组件名，后缀X可能是01、02、03等，请根据实际环境确定。
cps template-params-show --service neutron neutron-l3-service-agent01
1

## Page 505

检查fip_mappings配置项中的ID和部署neutron-l3-nat-agent组件的节点ID是否一致，
seq是否在1到16之间并且互不相同，如果不正确请执行如下命令修改配置。
cps template-params-update --service neutron neutron-l3-service-agent01 --
parameter fip_mappings="节点1 ID:seq1,节点 2 ID:seq2"
例如：cps
template-params-update --service neutron neutron-l3-service-
agent01 --parameter fip_mappings="7A7C7D29-D21D-B211-
AB16-0018E1C5D866:1,9236322A-D21D-B211-A515-0018E1C5D866:2"
cps commit
等待1分钟后查看组件故障是否消除。
●
是，处理完毕。
●
否，执行步骤12。
步骤12 请联系技术支持工程师协助解决。
----结束
1.2.3.1.19 neutron-cascading-proxy
组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
组件配置错误。
● 系统环境被破坏。
定位思路
1. 检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
组件常用配置项检查。
1

## Page 506

处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行5。
–
否，则环境存在问题，请优先排查节点fault原因，执行10。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择neutron服务和neutron-cascading-proxyXXX组件（XXX表
示组件编号，可以从001~999，具体组件名从告警附加信息中获取），单击“搜
索”。
6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
7.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
导入环境变量。
a. 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
9.
执行如下命令，查看故障组件配置，neutron-cascading-proxy001是具体的组件
名，请根据实际故障组件确定。
cps template-params-show --service neutron neutron-cascading-proxy001
1

## Page 507

确保host、nova_hosts等配置项配置正确，已完成和对应AZ的对接。
如有配置错误，请先修复，然后执行如下命令启动组件。
cps host-template-instance-operate --service neutron neutron-cascading-
proxy001 --action start
等待1分钟，检查组件是否恢复正常(active)。
–
是，处理完毕。
–
否，执行10。
10.
请联系技术支持工程师协助解决。
1.2.3.1.20
neutron-openvswitch-agent组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
组件配置错误。
●
系统环境被破坏。
●
依赖的组件异常。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
组件常用配置项检查。
4.
确保依赖的组件正常。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择neutron服务和neutron-server组件，单击“搜索”。
确认neutron-server组件状态是否正常。
–
是，执行6。
–
否，请先排查1.2.3.1.14 neutron-server组件故障处理。
6.
重新选择neutron服务和neutron-openvswitch-agent组件，单击“搜索”。
7.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
8.
等待1分钟，检查组件状态是否为active。
1

## Page 508

–
是，处理完毕。
–
否，执行9。
9.
导入环境变量。
a.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
10.
检查底层ovs是否正常，在故障组件所在节点执行如下命令：
ps -ef | grep ovs-vswitchd | grep -v grep
如果有进程执行下一步。如果没有进程，则需要排查底层操作系统ovs进程。可以
尝试执行如下命令重启该组件。
cps host-template-instance-operate --service neutron neutron-
openvswitch-agent --action stop
cps host-template-instance-operate --service neutron neutron-
openvswitch-agent --action start
等待1分钟，检查组件是否恢复正常(active)。
–
是，处理完毕。
–
否，执行11。
11.
请联系技术支持工程师协助解决。
1.2.3.1.21 neutron-garbage-collector
组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
组件配置错误。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
1

## Page 509

2.
查询节点状态是否正常。
3.
组件常用配置项检查。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择neutron服务和neutron-garbage-collector组件，单击“搜
索”。
6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
7.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
导入环境变量。
a.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
9.
在故障组件所在AZ控制节点执行如下命令：
cps template-instance-list --service gaussdb gaussdb
确保同AZ内的gaussdb组件状态正常，如有异常请先修复(参考对应指导)，然后执
行如下命令启动组件：
1

## Page 510

cps host-template-instance-operate --service neutron neutron-garbage-
collector --action start
等待1分钟，检查组件是否恢复正常(active)
–
是，处理完毕。
–
否，执行10。
10.
请联系技术支持工程师协助解决。
1.2.3.1.22
neutron-dvr-compute-agent组件故障处理
可能原因
● 网络异常。
●
组件运行异常。
●
组件配置错误。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
组件常用配置项检查。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择neutron服务和neutron-dvr-compute-agent组件，单击
“搜索”。
6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
7.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
导入环境变量。
a.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
1

## Page 511

说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b. 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c. 导入环境变量，具体操作请参见3.1 导入环境变量。
9. 在故障组件所在AZ控制节点执行如下命令：
cps template-params-show --service network-agent neutron-dvr-
compute-agent
确保除该组件配置项配置正确，如enable_mq_cluster、interface_driver、
mq_instance等。
如果配置错误，请参考如下命令修复，将XXX、YYY分别替换为配置项和正确的
值。
cps template-params-update --service network-agent neutron-dvr-
compute-agent --parameter XXX=YYY
cps commit
然后执行如下命令启动组件：
cps host-template-instance-operate --service network-agent neutron-dvr-
compute-agent --action start
等待1分钟，检查组件是否恢复正常(active)
–
是，处理完毕。
–
否，执行10。
10.
请联系技术支持工程师协助解决。
1.2.3.1.23
neutron-dhcp-agent组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
组件配置错误。
●
系统环境被破坏。
1

## Page 512

定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
组件常用配置项检查。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，环境存在问题，请优先排查节点fault原因。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择neutron服务和neutron-openvswitch-agent组件，单击“搜
索”。
确认neutron-openvswitch-agent组件状态是否正常。
●
是，执行步骤6。
●
否，请先排查1.2.3.1.20 neutron-openvswitch-agent组件故障处理。
步骤6 重新选择neutron服务和neutron-dhcp-agent组件，单击“搜索”。
步骤7 勾选筛选出的“fault”状态的组件，单击“启动”按钮。
步骤8 等待1分钟，检查组件状态是否为active。
●
是，处理完毕。
●
否，执行步骤9。
步骤9 导入环境变量。
1.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请
参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack Deploy
导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签
搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
2.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
1

## Page 513

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
3.
导入环境变量，具体操作请参见3.1 导入环境变量。
步骤10 在故障组件所在AZ控制节点执行如下命令。
cps template-params-show --service neutron neutron-dhcp-agent
确保该组件配置项配置正确，如enable_mq_cluster、interface_driver、mq_instance
等。
如果配置错误，请参考如下命令修复，将XXX、YYY分别替换为具体的配置项和正确的
值。
cps template-params-update --service neutron neutron-dhcp-agent --
parameter XXX=YYY
cps commit
然后执行如下命令启动组件。
cps host-template-instance-operate --service neutron neutron-dhcp-agent --
action start
等待1分钟，检查组件是否恢复正常(active)。
●
是，处理完毕。
●
否，执行步骤11。
步骤11 请联系技术支持工程师协助解决。
----结束
1.2.3.1.24
neutron-metadata-agent组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
● 组件配置错误。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
1

## Page 514

2.
查询节点状态是否正常。
3. 组件常用配置项检查。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择neutron服务和neutron-metadata-agent组件，单击“搜
索”。
6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
7.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
导入环境变量。
a.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
9.
在故障组件所在AZ控制节点执行如下命令。
cps template-params-show --service neutron neutron-metadata-agent
1

## Page 515

确保该组件配置项配置正确，如auth_url、enable_mq_cluster、mq_instance、
os_region_name等。
如果配置错误，请参考如下命令修复，将XXX、YYY分别替换为具体的配置项和正
确的值。
cps template-params-update --service neutron neutron-metadata-agent--
parameter XXX=YYY
cps commit
然后执行如下命令启动组件。
cps host-template-instance-operate --service neutron neutron-metadata-
agent--action start
等待1分钟，检查组件是否恢复正常(active)。
–
是，处理完毕。
–
否，执行10。
10.
请联系技术支持工程师协助解决。
1.2.3.1.25
neutron-vc-vswitch-agent组件故障处理
可能原因
● 网络异常。
●
组件运行异常。
●
系统环境被破坏。
●
openstack与vSphere不通。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
检查节点是否能够ping通vSphere。
处理步骤
1.
导入环境变量。
a.
使用“PuTTY”，通过反向代理的IP地址登录AZ内第一台主机。
以“fsp”帐户登录。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
b.
执行以下命令，并输入“root”帐户的密码切换到“root”帐户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
2.
检查主机状态是否正常。
执行命令cps
host-list | grep fault
主机状态是否为fault。
1

## Page 516

–
是，环境存在问题，请优先排查节点fault原因。
–
否，执行3。
3.
检查openstack和vSphere通信是否正常。
如果openstack和vSphere不通，neutron-vc-vswitch-agent会发生异常。常见的
情形是，生产站点和容灾站点发生倒换，生产站点和vSphere通，但是容灾站点和
vSphere不通，导致neutron-vc-vswitch-agent组件异常，如果是这种场景，需要
寻找环境管理人员打通容灾站点和vSphere之间的通信。
如果依然有问题，执行4。
4.
请联系技术支持工程师协助解决。
1.2.3.1.26
neutron-elb-proxy组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
组件常用配置项检查。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择neutron服务和neutron-elb-proxyXXX组件（XXX表示组件
编号，可以从01~99，具体组件名从告警附加信息中获取），单击“搜索”。
6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
7.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
请联系技术支持工程师协助解决。
1

## Page 517

1.2.3.1.27
neutron-l3-agent组件故障处理
可能原因
与Agile Controller-DCN三层插件功能冲突。
定位思路
1.
如果对接Agile Controller-DCN，则移除该组件。
处理步骤
1.
导入环境变量。
a.
使用“PuTTY”，通过反向代理的IP地址登录AZ内第一台主机。
以“fsp”帐户登录。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
b.
执行以下命令，并输入“root”帐户的密码切换到“root”帐户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
2.
移除neutron-l3–agent。
不对接Agile Controller-DCN的场景只能使用二层功能，不会部署该组件，因此无
需考虑。
对接Agile Controller-DCN的场景由Agile Controller-DCN提供三层功能，不需要
neutron-l3–agent，还会因为功能冲突导致组件异常或者升级前检查失败，此时
需要把该组件从router角色中移除。
– cps role-update --parameter template=neutron.neutron-metering-agent
--name router
– cps commit
如果依然有问题，执行3。
3.
请联系技术支持工程师协助解决。
1.2.3.1.28 neutron-nat-gw-dataplane
组件故障处理
可能原因
●
网络异常
●
组件运行异常
●
系统环境被破坏
定位思路
1.
检查节点网络是否可达
2.
查询节点状态是否正常
3.
检查组件配置项是否正常
1

## Page 518

处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4. 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择nat-gateway服务和neutron-nat-gw-dataplane组件，单
击“搜索”。
6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
7.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
导入环境变量。
a.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b.
执行以下命令，并输入“root”帐户的密码切换到“root”帐户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
9.
在故障组件所在AZ控制节点执行如下命令。
cps cluster-list
1

## Page 519

查询nat gateway所在的cluster名称，natgw_01_1或natgw_01_2，执行以下命
令。
cps template-params-show --service nat-gateway neutron-nat-gw-data-
agent --cluster natgw_01_2
确保除该组件配置项配置正确，如vpc_vlan_vip,
vpc_vlan_gateway, eip_in_vlan
等。
如果配置错误，请参考如下命令修复，将XXX=YYY替换为具体的参数和值。
cps template-params-update --service nat-gateway neutron-nat-gw-
dataplane --cluster natgw_01_2 --parameter XXX=YYY
cps commit
其中，XXX为组件配置项key值，YYY为具体的参数值，然后执行如下命令启动组
件：
cps host-template-instance-operate --service nat-gateway neutron-nat-
gw-dataplane --action start
等待1分钟，检查组件是否恢复正常(active)。
–
是，处理完毕。
–
否，执行10。
10.
请联系技术支持工程师协助解决。
1.2.3.1.29
neutron-nat-gw-data-agent组件故障处理
可能原因
●
网络异常
●
组件运行异常
●
系统环境被破坏
定位思路
1.
检查节点网络是否可达
2.
查询节点状态是否正常
3.
检查组件配置项是否正常
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
1

## Page 520

2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择nat-gateway服务和neutron-nat-gw-data-agent组件，单
击“搜索”。
6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
7.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
导入环境变量。
a.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
9.
在故障组件所在AZ控制节点执行如下命令。
cps cluster-list
查询nat gateway所在的cluster名称，natgw_01_1或natgw_01_2，执行以下命
令。
cps template-params-show --service nat-gateway neutron-nat-gw-data-
agent --cluster natgw_01_2
1

## Page 521

确保除该组件配置项配置正确，如local_ip等。
如果配置错误，请参考如下命令修复，将XXX=YYY替换为具体的参数和值。
cps template-params-update --service nat-gateway neutron-nat-gw-data-
agent --cluster natgw_01_2 --parameter XXX=YYY
cps commit
其中，XXX为组件配置项key值，YYY为具体的参数值，然后执行如下命令启动组
件。
cps host-template-instance-operate --service nat-gateway neutron-nat-
gw-data-agent --action start
等待1分钟，检查组件是否恢复正常(active)
–
是，处理完毕。
–
否，执行10。
10.
请联系技术支持工程师协助解决。
1.2.3.1.30
neutron-ipv6-service-agent组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
组件配置错误。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
组件常用配置项检查。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
1

## Page 522

2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择neutron服务和neutron-ipv6-service-agentXXX组件（XXX
表示组件编号，可以从01~99，具体组件名从告警附加信息中获取），单击“搜
索”。
6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
7.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
请联系技术支持工程师协助解决。
1.2.3.1.31
neutron-ngfw-agent组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
● 组件配置错误。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
组件常用配置项检查。
4.
检查到防火墙节点网络正常。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择neutron服务和neutron-ngfw-agentXXX组件（XXX表示组
件编号，可以从01~99，具体组件名从告警附加信息中获取），单击“搜索”。
6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
1

## Page 523

7.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
导入环境变量。
a.
使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认
证请参见3.2 使用PuTTY通过公私钥对认证方式登录节点。
说明
External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的
IP参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
b. 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
9.
在故障组件所在AZ控制节点执行如下命令：
cps template-params-show --service neutron neutron-ngfw-agent01
确保除该组件配置项配置正确，特别检查如director、director_port、
ngfw_username、ngfw_password等。
如果配置错误，请参考如下命令修复，将XXX=YYY替换为具体的参数和值。
cps template-params-update --service neutron neutron-ngfw-agent01 --
parameter XXX=YYY
cps commit
然后执行如下命令启动组件。
1

## Page 524

cps host-template-instance-operate --service neutron neutron-ngfw-
agent01 --action start
等待1分钟，检查组件是否恢复正常(active)。
–
是，处理完毕。
–
否，执行10。
10.
检查主机与防火墙节点网络是否正常。
在组件所在节点ping 防火墙IP，如果ping不通防火墙IP地址，则需要检查物理链
路配置。如果能ping通，执行11。
11.
请联系技术支持工程师协助解决。
1.2.3.1.32 neutron-fw-proxy
组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
组件配置错误。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
组件常用配置项检查。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择neutron服务和neutron-fw-proxyXXX组件（XXX表示组件
编号，可以从01~99，具体组件名从告警附加信息中获取），单击“搜索”。
6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
7.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
请联系技术支持工程师协助解决。
1

## Page 525

1.2.3.1.33
neutron-ngfw-vpn-agent组件故障处理
可能原因
●
网络异常。
● 组件运行异常。
●
组件配置错误。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
2.
选择“运维
>
组件维护”，进入“组件维护”页面。
3.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行4。
–
否，环境存在问题，请优先排查节点fault原因。
4.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
5.
在“组件”页签，选择neutron服务和neutron-ngfw-vpn-agentXXX组件（XXX表
示组件编号，可以从01~99，具体组件名从告警附加信息中获取），单击“搜
索”。
6.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
7.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行8。
8.
请联系技术支持工程师协助解决。
1.2.3.1.34
neutron-sriov-nic-agent组件故障处理
可能原因
●
网络异常。
●
组件配置异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
1

## Page 526

处理步骤
1.
登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）章节。
1.
选择“运维
>
组件维护”，进入“组件维护”页面。
2.
在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主
机状态是否正常。
–
是，执行3。
–
否，环境存在问题，请优先排查节点fault原因。
3.
在所选主机行，单击“查看组件”按钮，进入“组件”页签。
4.
在“组件”页签，选择neutron服务和neutron-sriov-nic-agent，单击“搜索”。
5.
勾选筛选出的“fault”状态的组件，单击“启动”按钮。
6.
等待1分钟，检查组件状态是否为active。
–
是，处理完毕。
–
否，执行7。
7.
请联系技术支持工程师协助解决。
1.2.3.1.35
neutron-evs-agent组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
系统环境被破坏。
●
未配置大页内存。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
3.
检查大页内存是否配置。
处理步骤
1.
导入环境变量。
a.
使用“PuTTY”，通过反向代理的IP地址登录AZ内第一台主机。
以“fsp”帐户登录。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
b.
执行以下命令，并输入“root”帐户的密码切换到“root”帐户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
导入环境变量，具体操作请参见3.1 导入环境变量。
1

## Page 527

2.
检查主机状态是否正常。
执行命令cps
host-list | grep fault
主机状态是否为fault。
–
是，环境存在问题，请优先排查节点fault原因。
–
否，执行3。
3.
检查大页内存是否配置。
执行命令
cat /proc/meminfo |grep Huge
查看回显信息中HugePages_Total和
HugePages_Free是否为0。
–
是，在安装部署界面“配置
>
内核参数”中给部署了用户态EVS网桥的主机
组配置大页内存，重启主机生效。
–
否，执行4。
4.
请联系技术支持工程师协助解决。
1.2.3.1.36 ceilometer-agent-compute
组件故障处理
可能原因
●
组件运行异常。
●
系统环境被破坏。
定位思路
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，执行步骤8。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，服务选择“ceilometer”，组件选择“ceilometer-agent-
compute”，状态选择“fault”，单击“搜索”。
步骤6 勾选筛选出的“fault”状态组件，单击“启动”按钮，启动组件。
步骤7 等待1分钟，单击“刷新”，查看故障组件筛选结果是否为空。
●
是，处理完毕。
●
否，执行步骤8。
步骤8 请联系技术支持工程师协助解决。
----结束
1

## Page 528

1.2.3.1.37 ceilometer-agent-hardware
组件故障处理
可能原因
●
组件运行异常。
●
系统环境被破坏。
定位思路
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，执行步骤8。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，服务选择“ceilometer”，组件选择“ceilometer-agent-
hardware”，状态选择“fault”，单击“搜索”。
步骤6 勾选筛选出的“fault”状态组件，单击“启动”按钮，启动组件。
步骤7 等待1分钟，单击“刷新”，查看故障组件筛选结果是否为空。
●
是，处理完毕。
●
否，执行步骤8。
步骤8 请联系技术支持工程师协助解决。
----结束
1.2.3.1.38 ceilometer-collector
组件故障处理
可能原因
●
组件运行异常，组件状态fault，active不断切换。
● 系统环境被破坏。
定位思路
查询节点状态是否正常。
1

## Page 529

处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，执行步骤11。
步骤4 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出
的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜索“参
数名称”为Reverse-Proxy的数据，获取对应的IP地址。
步骤5 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 执行以下命令，防止系统超时退出。
TMOUT=0
步骤7 导入环境变量，具体操作请参见3.1 导入环境变量
步骤8 执行命令如下命令查询ceilometer-collector组件的扩展配置。
cps template-ext-params-show --service ceilometer ceilometer-collector
检查返回结果，确认是否存在如图所示以
event_http_dispatcher.event_http_target_url_开头的配置。
●
是，执行步骤9。
●
否，执行步骤11。
步骤9 登录其中一个fault节点， 检查步骤8中查到的配置的ip是否ping通。
1

## Page 530

●
是，执行步骤10。
●
否，参考《华为云Stack
8.1.0
运维指南》“修改系统配置”中“修改主机网络配
置”部分，配置对应的默认网关，配置完成后，等待一分钟查看组件状态是否正
常，不正常执行步骤10。
步骤10 执行openstack
endpoint list | grep
keystone查看keystone域名。
如上所示，如identity.az1.dc1.domainname.com， 执行ping
identity.az1.dc1.domainname.com查看是否可以ping通。
●
是，执行步骤11。
●
否，参考《华为云Stack
8.1.0
运维指南》“修改系统配置”中“修改主机网络配
置”部分，配置完成后，等待一分钟查看组件状态是否正常，不正常执行步骤
11。
步骤11 请联系技术支持工程师协助解决。
----结束
1.2.3.1.39
ce1800v组件故障处理
可能原因
●
组件运行异常，组件状态fault。
●
系统环境被破坏。
定位思路
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，环境存在问题，请优先排查节点fault原因。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择ce1800v服务和ce1800v组件，单击“搜索”。
步骤6 勾选筛选出的“fault”状态的组件，单击“启动”按钮。
等待1分钟，检查组件状态是否为active。
1

## Page 531

●
是，处理完毕。
●
否，执行步骤7。
步骤7 使用PuTTY，登录故障节点的管理IP。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
说明
故障节点管理IP地址的获取方式：登录FusionSphere安装部署界面，在“概要”界面可获取故障
节点的管理IP地址。
步骤8 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤9 执行以下命令，防止系统超时退出。
TMOUT=0
步骤10 导入环境变量，具体操作请参见3.1 导入环境变量
步骤11 执行cd /var/log/fusionsphere/component/ce1800v，查看CE1800V的操作日志中
是否显示“[ce1800v]Run
command: ce1800vControl -S RUN......
”。
●
是，执行步骤12。
●
否，说明CE1800V未启动，执行步骤15。
步骤12 确认日志中是否一直显示“[ce1800v]Service
is
activating......”，并未出现
“[ce1800v]Succeeded
in starting
service.”。
●
是，说明vSwitch启动异常，执行步骤13。
●
否，处理完毕。
步骤13 执行命令su
-
ce1800v，切换到ce1800v用户。
步骤14 执行命令sudo
systemctl status
ce1800v.service或sudo
journalctl
-xe，查看
vSwitch启动失败的原因。
1

## Page 532

●
如果显示“ExecStartPre=/usr/bin/sudo
/usr/local/bin/checksign /usr/ce1800v/
share/crldata.crl /usr/ce1800v/share/signature.txt.cms /usr/ce1800v/share/
signature.txt (code=exited,
status=138)”，表示/usr/ce1800v/share/
signature.txt文件被修改，请联系技术支持工程师重新安装并启动vSwitch。
●
如果显示“The
file name hash value check
failed.”，表示文件name被修改，
name为signature.txt中的文件名。请联系技术支持工程师重新安装并启动
vSwitch。
●
如果显示“the
TCP port port-number which is used for CE1800V CAP module,
has been taken by another program, please try close the program and restart
the
CE1800V.”，表示port-number端口被占用。
a.
执行命令netstat
-anp | grep
port-number，查看是否有回显信息。port-
number端口是否被占用。
▪
是，表示port-number 端口被占用，执行步骤14.b。
如下说明9090端口被占用。
▪
否，表示port-number 端口没有被占用。请执行命令vsw-logctl
collect
log，收集告警信息、日志信息和配置信息，并联系技术支持工程师协助
解决。
b.
请用户确认是否需要关闭该进程。
▪
是，执行命令kill id，如步骤14.a中示例，需要执行kill 141070。
▪
否，执行步骤15。
步骤15 请联系技术支持工程师协助解决。
----结束
1.2.3.1.40 pecado-controller
组件故障处理
可能原因
●
组件运行异常。
●
系统环境被破坏。
定位思路
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
1

## Page 533

步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，环境存在问题，请优先排查节点fault原因。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择pecado服务和pecado-controller组件，单击“搜索”。
步骤6 勾选筛选出的“fault”状态的组件，单击“启动”按钮。
步骤7 等待1分钟，检查组件状态是否为active。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
1.2.3.1.41
redis组件故障处理
可能原因
●
组件运行异常
● 数据盘异常
定位思路
查询节点状态是否正常。
查询节点磁盘状态
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，环境存在问题，请优先排查节点fault原因。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择redis服务和redis组件，单击“搜索”。
步骤6 勾选筛选出的“fault”状态的组件，单击“启动”按钮。
步骤7 等待1分钟，检查组件状态是否为active。
●
是，处理完毕。
1

## Page 534

●
否，请联系技术支持工程师协助解决
----结束
1.2.3.1.42
device-manager组件故障处理
可能原因
●
组件运行异常。
●
系统环境被破坏。
定位思路
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，环境存在问题，请优先排查节点fault原因。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择pecado服务和device-manager组件，单击“搜索”。
步骤6 勾选筛选出的“fault”状态的组件，单击“启动”按钮。
步骤7 等待1分钟，检查组件状态是否为active。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决
----结束
1.2.3.1.43 bgp-broker
组件故障处理
可能原因
●
组件运行异常。
●
系统环境被破坏。
定位思路
查询节点状态是否正常。
1

## Page 535

处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，环境存在问题，请优先排查节点fault原因。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择pecado服务和bgp-broker组件，单击“搜索”。
步骤6 勾选筛选出的“fault”状态的组件，单击“启动”按钮。
步骤7 等待1分钟，检查组件状态是否为active。
●
是，处理完毕。
● 否，请联系技术支持工程师协助解决
----结束
1.2.3.1.44
neutron-bm-switch-agent组件故障处理
可能原因
●
组件运行异常。
●
系统环境被破坏。
定位思路
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，执行步骤4。
●
否，环境存在问题，请优先排查节点fault原因。
步骤4 在所选主机行，单击“查看组件”按钮，进入“组件”页签。
步骤5 在“组件”页签，选择neutron服务和neutron-bm-switch-agent组件，单击“搜
索”。
1

## Page 536

步骤6 勾选筛选出的“fault”状态的组件，单击“启动”按钮。
步骤7 等待1分钟，检查组件状态是否为active。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决
----结束
1.2.3.1.45 drextend-agent
组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
●
系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
存储容灾”，进入“存储容灾”页面，根据告警信息中的容灾规则ID，
定位到对应的容灾规则（例如，drextend-agent001），单击容灾规则操作栏的 按
钮。
步骤3 在“存储容灾”页签中，单击“配置后端存储”栏下的 按钮，进入“配置后端存
储”页面。
步骤4 在“配置后端存储”页面，检查存储类型、设备类型、协议类型、用户名、密码、启
动双活容灾（在双活容灾场景下需要打开）是否配置正确。
●
是，执行步骤5。
●
否，重新配置错误项。
步骤5 检查节点与存储设备的存储网络、管理网络是否连通。
在FusionSphere OpenStack安装部署界面，选择“运维
>
系统检查”界面，执行“存
储驱动检查”高级用例，检查错误信息是否包含不通的ip列表。
步骤6 如以上步骤都不能排查出故障原因，请联系技术支持工程师协助解决。
----结束
1

## Page 537

1.2.3.1.46 drextend-api
组件故障处理
可能原因
●
网络异常。
●
组件运行异常。
● 系统环境被破坏。
定位思路
1.
检查节点网络是否可达。
2.
查询节点状态是否正常。
处理步骤
步骤1 登录FusionSphere OpenStack安装部署界面。
具体请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方式）章
节。
步骤2 选择“运维
>
组件维护”，进入“组件维护”页面。
步骤3 在“主机”页签，根据告警定位信息中的主机ID，定位到对应的主机行，检查主机状
态是否正常。
●
是，请联系技术支持工程师协助解决。
●
否，解决节点故障，具体操作请参见《华为云Stack
8.1.0
故障管理》中“节点类
故障”章节。
----结束
1.3
云管平台告警
1.3.1
性能监控
1.3.1.1 ALM-0001000100010001
【自定义监控】网络设备平均
CPU
利用率超过阈
值
告警解释
当性能监控检测到网络设备的设备平均CPU利用率超过管理员设置的阈值时，产生此
告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000100010001
紧急/重要/次要/提示 业务质量告警
1

## Page 538

性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
网络设备 设备IP 网络设备的IP地址。
设备名称 网络设备的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
1

## Page 539

● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.2 ALM-0001000100010002
【自定义监控】网络设备平均内存利用率超过阈
值
告警解释
当性能监控检测到网络设备的设备平均内存利用率超过管理员设置的阈值时，产生此
告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000100010002
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
网络设备 设备IP 网络设备的IP地址。
设备名称 网络设备的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
1

## Page 540

处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.3 ALM-0001000100010003
【自定义监控】网络设备响应时间超过阈值
告警解释
当性能监控检测到网络设备的响应时间超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 541

告警属性
告警ID 告警级别 告警类型
0001000100010003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
网络设备 设备IP 网络设备的IP地址。
设备名称 网络设备的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 542

–
是：处理完毕。
– 否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.4 ALM-0001000100010004
【自定义监控】网络设备当日不可达比率超过阈
值
告警解释
当性能监控检测到网络设备的当日不可达比率超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000100010004
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
网络设备 设备IP 网络设备的IP地址。
设备名称 网络设备的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 543

可能原因
●
阈值条件设置不合理。
●
设备网络异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 请联系网络设备管理员排查设备故障。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.5 ALM-0001000100020003
【自定义监控】网络设备当前会话新建速率超过
阈值
告警解释
当性能监控检测到网络设备的当前会话新建速率超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 544

告警属性
告警ID 告警级别 告警类型
0001000100020003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
网络设备 设备IP 网络设备的IP地址。
设备名称 网络设备的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 545

–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.6 ALM-0001000100020004
【自定义监控】网络设备当前会话总数超过阈值
告警解释
当性能监控检测到网络设备的当前会话总数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000100020004
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
网络设备 设备IP 网络设备的IP地址。
设备名称 网络设备的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 546

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.7 ALM-0001000100020005
【自定义监控】网络设备网络流量值超过阈值
告警解释
当性能监控检测到网络设备的网络流量值超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 547

告警属性
告警ID 告警级别 告警类型
0001000100020005
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
网络设备 设备IP 网络设备的IP地址。
设备名称 网络设备的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 548

–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.8 ALM-0001000200010001
【自定义监控】接口接收速率超过阈值
告警解释
当性能监控检测到接口接收速率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控 > 监控配置 > 性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000200010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
1

## Page 549

对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 550

1.3.1.9 ALM-0001000200010002
【自定义监控】接口发送速率超过阈值
告警解释
当性能监控检测到接口发送速率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000200010002
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
1

## Page 551

2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.10 ALM-0001000200010003
【自定义监控】接口流入带宽利用率超过阈值
告警解释
当性能监控检测到接口流入带宽利用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000200010003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
1

## Page 552

告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
1

## Page 553

● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.11 ALM-0001000200010004
【自定义监控】接口流出带宽利用率超过阈值
告警解释
当性能监控检测到接口流出带宽利用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000200010004
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 554

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.12 ALM-0001000200020001
【自定义监控】接口接收包丢弃率超过阈值
告警解释
当性能监控检测到接口接收包丢弃率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 555

告警属性
告警ID 告警级别 告警类型
0001000200020001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
设备异常或网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
– 密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
1

## Page 556

–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 请联系设备管理员排查设备故障，联系网络管理员检查网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.13 ALM-0001000200020002
【自定义监控】接口发送包丢弃率超过阈值
告警解释
当性能监控检测到接口发送包丢弃率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000200020002
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
1

## Page 557

资源类型 参数名称 参数含义
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
设备异常或网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5. 单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系设备管理员排查设备故障，联系网络管理员检查网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 558

1.3.1.14 ALM-0001000200020003
【自定义监控】接口丢弃发送包数超过阈值
告警解释
当性能监控检测到接口丢弃发送包数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000200020003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
设备异常或网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
1

## Page 559

2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系设备管理员排查设备故障，联系网络管理员检查网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.15 ALM-0001000200020004
【自定义监控】接口丢弃接收包数超过阈值
告警解释
当性能监控检测到接口丢弃接收包数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000200020004
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
1

## Page 560

资源类型 参数名称 参数含义
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
● 阈值条件设置不合理。
●
设备异常或网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3. 在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系设备管理员排查设备故障，联系网络管理员检查网络配置。
----结束
1

## Page 561

告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.16 ALM-0001000200020005
【自定义监控】接口发送包错误率超过阈值
告警解释
当性能监控检测到接口发送包错误率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000200020005
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
设备异常或网络配置异常。
1

## Page 562

处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系设备管理员排查设备故障，联系网络管理员检查网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.17 ALM-0001000200020006
【自定义监控】接口接收包错误率超过阈值
告警解释
当性能监控检测到接口接收包错误率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000200020006
紧急/重要/次要/提示 业务质量告警
1

## Page 563

性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
设备异常或网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
– 是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
1

## Page 564

–
否：执行步骤3。
步骤3 联系设备管理员排查设备故障，联系网络管理员检查网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.18 ALM-0001000200020007
【自定义监控】接口发送包数超过阈值
告警解释
当性能监控检测到接口发送包数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000200020007
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 565

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标的操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.19 ALM-0001000200020008
【自定义监控】接口接收包数超过阈值
告警解释
当性能监控检测到接口接收包数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 566

告警属性
告警ID 告警级别 告警类型
0001000200020008
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
1

## Page 567

步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.20 ALM-0001000200020009
【自定义监控】接口接收包速率超过阈值
告警解释
当性能监控检测到接口接收包速率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000200020009
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
1

## Page 568

资源类型 参数名称 参数含义
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
1

## Page 569

参考信息
无。
1.3.1.21 ALM-000100020002000A
【自定义监控】接口发送包速率超过阈值
告警解释
当性能监控检测到接口发送包速率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000100020002000A
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
1

## Page 570

–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2. 等待15分钟，在主菜单选择“集中监控 > 告警管理 > 当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
● 华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.22 ALM-000100020002000B
【自定义监控】接口发送错误包数超过阈值
告警解释
当性能监控检测到接口发送错误包数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000100020002000B
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
1

## Page 571

告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
设备异常或网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系设备管理员排查设备故障，联系网络管理员检查网络配置。
----结束
1

## Page 572

告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.23 ALM-000100020002000C
【自定义监控】接口接收错误包数超过阈值
告警解释
当性能监控检测到接口接收错误包数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000100020002000C
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
设备异常或网络配置异常。
1

## Page 573

处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系设备管理员排查设备故障，联系网络管理员检查网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.24 ALM-000100020002000D
【自定义监控】接口发送字节数超过阈值
告警解释
当性能监控检测到接口发送字节数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000100020002000D
紧急/重要/次要/提示 业务质量告警
1

## Page 574

性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
– 密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5. 单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
1

## Page 575

步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.25 ALM-000100020002000E
【自定义监控】接口接收字节数超过阈值
告警解释
当性能监控检测到接口接收字节数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000100020002000E
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
接口 接口IP 接口的IP地址。
网络设备 网络设备名称。
接口名称 接口的名称。
父资源名称 父资源名称。
接口别名 接口的别名。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 576

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2. 等待15分钟，在主菜单选择“集中监控 > 告警管理 > 当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.26 ALM-0001000300010001
【自定义监控】并发连接数超过阈值
告警解释
当性能监控检测到弹性负载均衡的并发连接数超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 577

告警属性
告警ID 告警级别 告警类型
0001000300010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性负载均
衡
ID
ID。
负载均衡器名
称
弹性负载均衡的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
连接数过多，影响弹性负载均衡稳定运行。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
1

## Page 578

2.
等待240分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是
否清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
● 华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.27 ALM-0001000300020003
【自定义监控】网络流入流速超过阈值
告警解释
当性能监控检测到弹性负载均衡的网络流入流速超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000300020003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性负载均
衡
ID
ID。
负载均衡器名
称
弹性负载均衡的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
1

## Page 579

对系统的影响
网络流量过大，消耗带宽。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待240分钟在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 580

1.3.1.28 ALM-0001000300020004
【自定义监控】网络流出流速超过阈值
告警解释
当性能监控检测到弹性负载均衡的网络流出流速超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000300020004
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性负载均
衡
ID
ID。
负载均衡器名
称
弹性负载均衡的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
网络流量过大，消耗带宽。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
1

## Page 581

4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待240分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是
否清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.29 ALM-0001000300010004
【自定义监控】新建连接数超过阈值
告警解释
当性能监控检测到弹性负载均衡的新建连接数超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000300010004
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
1

## Page 582

告警参数
资源类型 参数名称 参数含义
弹性负载均
衡
ID
ID。
负载均衡器名
称
弹性负载均衡的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
新建连接数过多，影响弹性负载均衡稳定运行。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待240分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警信
息是否清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
1

## Page 583

告警清除
修复后，系统会自动清除此告警信息，无需手工清除。
参考信息
无。
1.3.1.30 ALM-0001000300010002
【自定义监控】活跃连接数超过阈值
告警解释
当性能监控检测到弹性负载均衡的活跃连接数超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000300010002
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性负载均
衡
ID
ID。
负载均衡器名
称
弹性负载均衡的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
活跃连接数过多，影响弹性负载均衡稳定运行。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
1

## Page 584

–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
– 是：执行3。
–
否：执行2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待240分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警信
息是否清除。
– 是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警信息，无需手工清除。
参考信息
无。
1.3.1.31 ALM-0001000300010003
【自定义监控】非活跃连接数超过阈值
告警解释
当性能监控检测到弹性负载均衡的非活跃连接数超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000300010003
紧急/重要/次要/提示 业务质量告警
1

## Page 585

性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性负载均
衡
ID
ID。
负载均衡器名
称
弹性负载均衡的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
非活跃连接数过多，会占用过多的弹性负载均衡资源，导致资源浪费。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待240分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警信
息是否清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
1

## Page 586

● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警信息，无需手工清除。
参考信息
无。
1.3.1.32 ALM-0001000300020001
【自定义监控】流入数据包数超过阈值
告警解释
当性能监控检测到弹性负载均衡的流入数据包数超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000300020001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性负载均
衡
ID
ID。
负载均衡器名
称
弹性负载均衡的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
流入数据包数过大，影响弹性负载均衡稳定运行。
可能原因
阈值条件设置不合理。
1

## Page 587

处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待240分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警信
息是否清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警信息，无需手工清除。
参考信息
无。
1.3.1.33 ALM-0001000300020002
【自定义监控】流出数据包数超过阈值
告警解释
当性能监控检测到弹性负载均衡的流出数据包数超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 588

告警属性
告警ID 告警级别 告警类型
0001000300020002
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性负载均
衡
ID
ID。
负载均衡器名
称
弹性负载均衡的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
流出包数过大，影响弹性负载均衡稳定运行。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
1

## Page 589

2.
等待240分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警信
息是否清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
● 华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警信息，无需手工清除。
参考信息
无。
1.3.1.34 ALM-0001000300020005
【自定义监控】异常主机数超过阈值
告警解释
当性能监控检测到弹性负载均衡的异常主机数超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000300020005
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性负载均
衡
ID
ID。
负载均衡器名
称
弹性负载均衡的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
1

## Page 590

对系统的影响
异常主机数过多，影响系统的负载均衡能力。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待240分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警信
息是否清除。
–
是：处理完毕。
–
否：执行3。
步骤3 联系业务运维人员检查后端服务是否正常，排查主机异常的原因，无法确认请联系技
术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警信息，无需手工清除。
参考信息
无。
1.3.1.35 ALM-0001000300020006
【自定义监控】正常主机数超过阈值
告警解释
当性能监控检测到弹性负载均衡的正常主机数超过管理员设置的阈值时，产生此告警
信息。
1

## Page 591

阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000300020006
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性负载均
衡
ID
ID。
负载均衡器名
称
弹性负载均衡的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
正常主机数过多，造成系统资源浪费。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行2。
步骤2 修改指标阈值策略。
1

## Page 592

1.
根据实际指标数据修改阈值。
2.
等待240分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警信
息是否清除。
–
是：处理完毕。
–
否：执行3。
步骤3 联系业务运维人员合理评估业务量，设置合理的主机数，其他情况请联系技术支持工
程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警信息，无需手工清除。
参考信息
无。
1.3.1.36 ALM-0001000400010001
【自定义监控】单板
CPU
利用率超过阈值
告警解释
当性能监控检测到单板的单板CPU利用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000400010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
单板 单板名称 单板的名称。
网络设备 网络设备名称。
单板描述 单板的描述信息。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
1

## Page 593

对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 594

1.3.1.37 ALM-0001000400010002
【自定义监控】单板内存利用率超过阈值
告警解释
当性能监控检测到单板内存利用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000400010002
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
单板 单板名称 单板的名称。
网络设备 网络设备名称。
单板描述 单板的描述信息。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
1

## Page 595

5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无
1.3.1.38 ALM-0001000500010001
【自定义监控】光模块接收功率超过阈值
告警解释
当性能监控检测到光口的光模块接收功率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000500010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
光口 光口IP 光口的IP地址。
1

## Page 596

资源类型 参数名称 参数含义
光口名称 光口的名称。
父资源名称 光口的父资源名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5. 单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2. 等待15分钟，在主菜单选择“集中监控 > 告警管理 > 当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
1

## Page 597

参考信息
无。
1.3.1.39 ALM-0001000500010002
【自定义监控】光模块发送功率超过阈值
告警解释
当性能监控检测到光口的光模块发送功率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0001000500010002
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
光口 光口IP 光口的IP地址。
光口名称 光口的名称。
父资源名称 光口的父资源名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
1

## Page 598

2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.40 ALM-0003000200010001
【自定义监控】电源功率超过阈值
告警解释
当性能监控检测到电源的电源功率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0003000200010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
1

## Page 599

告警参数
资源类型 参数名称 参数含义
电源 电源名称 电源的名称。
服务器 服务器名称。
父资源名称 电源的父资源名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
● 阈值条件设置不合理。
●
设备异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系设备管理员检查设备。
----结束
1

## Page 600

告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.41 ALM-0005000100010001
【自定义监控】CPU 使用率超过阈值
告警解释
当性能监控检测到宿主机的CPU使用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0005000100010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
宿主机 虚拟化类型 宿主机的虚拟化类型。
主机组 主机组名称。
管理IP地址 宿主机的管理IP地址。
宿主机名称 宿主机的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成系统运行速度慢或CPU故障。
可能原因
●
阈值条件设置不合理。
●
主机业务繁忙负载过重 。
1

## Page 601

处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.42 ALM-0005000100020008
【自定义监控】内存使用率超过阈值
告警解释
当性能监控检测到宿主机的内存使用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 602

告警属性
告警ID 告警级别 告警类型
0005000100020008 紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
宿主机 虚拟化类型 宿主机的虚拟化类型。
主机组 主机组名称。
管理IP地址 宿主机的管理IP地址。
宿主机名称 宿主机的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成系统运行速度慢或内存故障。
可能原因
●
阈值条件设置不合理。
● 主机业务繁忙，负载过重。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
1

## Page 603

步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.43 ALM-000500010003000B
【自定义监控】网络流入速率超过阈值
告警解释
当性能监控检测到宿主机的网络流入速率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000500010003000B
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
宿主机 虚拟化类型 宿主机的虚拟化类型。
主机组 主机组名称。
管理IP地址 宿主机的管理IP地址。
宿主机名称 宿主机的名称。
1

## Page 604

资源类型 参数名称 参数含义
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成系统运行速度慢或网络故障。
可能原因
●
阈值条件设置不合理。
●
主机网络繁忙，传输流量过大。
●
网络风暴，安全攻击。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
1

## Page 605

参考信息
无。
1.3.1.44 ALM-000500010003000C
【自定义监控】网络流出速率超过阈值
告警解释
当性能监控检测到宿主机的网络流出速率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000500010003000C
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
宿主机 虚拟化类型 宿主机的虚拟化类型。
主机组 主机组名称。
管理IP地址 宿主机的管理IP地址。
宿主机名称 宿主机的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成系统运行速度慢或网络故障。
可能原因
●
阈值条件设置不合理。
●
主机网络繁忙，传输流量过大。
●
网络风暴，安全攻击。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
1

## Page 606

–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2. 等待5分钟，在主菜单选择“集中监控 > 告警管理 > 当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
● 华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.45 ALM-0005000100040014
【自定义监控】磁盘使用率超过阈值
告警解释
当性能监控检测到宿主机的磁盘使用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0005000100040014
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
1

## Page 607

告警参数
资源类型 参数名称 参数含义
宿主机 虚拟化类型 宿主机的虚拟化类型。
主机组 主机组名称。
管理IP地址 宿主机的管理IP地址。
宿主机名称 宿主机的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成系统的性能下降，并且无法存储系统新产生的数据。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
1

## Page 608

● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.46 ALM-0005000100040026
【自定义监控】带内磁盘使用率超过阈值
告警解释
当性能监控检测到混合云宿主机的带内磁盘使用率超过管理员设置的阈值时，产生此
告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
说明
华为云Stack场景，不支持上报该告警。
告警属性
告警ID 告警级别 告警类型
0005000100040026
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
宿主机 虚拟化类型 宿主机的虚拟化类型。
主机组 主机组名称。
管理IP地址 宿主机的管理IP地址。
宿主机名称 宿主机的名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成磁盘空间不足。
1

## Page 609

可能原因
●
阈值条件设置不合理。
●
主机磁盘存储的文件占用空间过大。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2. 等待5分钟，在主菜单选择“集中监控 > 告警管理 > 当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.47 ALM-0002000200010001
【自定义监控】CPU 使用率超过阈值
告警解释
当性能监控检测到弹性云服务器的CPU使用率超过管理员设置的阈值时，产生此告
警。该告警为通过云平台为用户发放的弹性云服务器上报的告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 610

告警属性
告警ID 告警级别 告警类型
0002000200010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别：紧急、重要、次要和提示。四个级别的通知处理方
式一致。
告警参数
资源类型 参数名称 参数含义
弹性云服务
器
宿主机 弹性云服务器所在的宿主机名称。
名称 弹性云服务器的名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
CPU使用率过高，影响弹性云服务器稳定运行。
可能原因
●
阈值条件设置不合理。
●
虚拟机业务繁忙，负载过重。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3. 在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
1

## Page 611

2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
– 是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.48 ALM-0002000200020003
【自定义监控】内存使用率超过阈值
告警解释
当性能监控检测到弹性云服务器的内存使用率超过管理员设置的阈值时，产生此告
警。该告警为通过云平台为用户发放的弹性云服务器上报的告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000200020003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性云服务
器
宿主机 弹性云服务器所在的宿主机名称。
名称 弹性云服务器的名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
1

## Page 612

对系统的影响
内存使用率过高，影响弹性云服务器稳定运行。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 613

1.3.1.49 ALM-0002000200040004
【自定义监控】云硬盘使用率超过阈值
告警解释
当性能监控检测到弹性云服务器的云硬盘使用率超过管理员设置的阈值时，产生此告
警。该告警为通过云平台为用户发放的弹性云服务器上报的告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000200040004
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性云服务
器
宿主机 弹性云服务器所在的宿主机名称。
名称 弹性云服务器的名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
硬盘空间不足，影响弹性云服务器稳定运行。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
1

## Page 614

4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
– 是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.50 ALM-0002000200030020
【自定义监控】带内磁盘使用率超过阈值
告警解释
当性能监控检测到混合云弹性云服务器的带内磁盘使用率超过管理员设置的阈值时，
产生此告警。
阈值需要在“集中监控 > 监控配置 > 性能阈值维护”中手工设置。
说明
华为云Stack场景，不支持上报该告警。
告警属性
告警ID 告警级别 告警类型
0002000200030020
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
1

## Page 615

告警参数
资源类型 参数名称 参数含义
弹性云服务
器
宿主机 弹性云服务器所在的宿主机名称。
名称 弹性云服务器的名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成磁盘空间不足。
可能原因
● 阈值条件设置不合理。
●
虚拟机磁盘存储的文件占用空间过大。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 请联系技术支持工程师协助解决。
----结束
1

## Page 616

告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.51 ALM-0005000200010001
【自定义监控】CPU 使用率超过阈值
告警解释
当性能监控检测到虚拟机的CPU使用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0005000200010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
虚拟机 名称 虚拟机的名称。
宿主机 宿主机名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成系统运行速度慢或CPU故障。
可能原因
●
阈值设置不合理。
●
虚拟机业务繁忙，负载过重。
处理步骤
步骤1 检查监控指标的阈值设置。
1

## Page 617

1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.52 ALM-0005000200020003
【自定义监控】内存使用率超过阈值
告警解释
当性能监控检测到虚拟机的内存使用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0005000200020003
紧急/重要/次要/提示 业务质量告警
1

## Page 618

性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
虚拟机 名称 虚拟机的名称。
宿主机 宿主机名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
●
阈值条件设置不合理。
●
虚拟机业务繁忙，负载过重。
可能原因
可能会造成虚拟机运行速度慢。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
1

## Page 619

●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.53 ALM-0005000200040004
【自定义监控】云硬盘使用率超过阈值
告警解释
当性能监控检测到虚拟机的云硬盘使用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0005000200040004
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
虚拟机 名称 虚拟机的名称。
宿主机 宿主机名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成磁盘空间不足，如果是虚拟化管理节点会造成无法存储新的日志数据。
可能原因
●
阈值条件设置不合理。
1

## Page 620

●
虚拟机磁盘存储的文件占用空间过大。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.54 ALM-0005000200040026
【自定义监控】带内磁盘使用率超过阈值
告警解释
当性能监控检测到混合云虚拟机的带内磁盘使用率超过管理员设置的阈值时，产生此
告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 621

说明
华为云Stack场景，不支持上报该告警。
告警属性
告警ID 告警级别 告警类型
0005000200040026
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
虚拟机 名称 虚拟机的名称。
宿主机 宿主机名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成磁盘空间不足。
可能原因
●
阈值条件设置不合理。
● 虚拟机磁盘存储的文件占用空间过大。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
1

## Page 622

–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.55 ALM-0005000300010001
【自定义监控】CPU 使用率超过阈值
告警解释
当性能监控检测到主机组的CPU使用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0005000300010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
主机组 虚拟化类型 集群的虚拟化类型。
主机组名称 主机组的名称。
来源系统 集群的来源系统。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
1

## Page 623

对系统的影响
可能会造成系统运行速度慢或CPU故障。
可能原因
●
阈值条件设置不合理。
●
集群业务繁忙，负载过重。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标的操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 624

1.3.1.56 ALM-0005000300020007
【自定义监控】内存使用率超过阈值
告警解释
当性能监控检测到主机组的内存使用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0005000300020007
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
主机组 虚拟化类型 集群的虚拟化类型。
主机组名称 主机组的名称。
来源系统 集群的来源系统。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
能会造成系统运行速度慢或CPU故障。
可能原因
●
阈值条件设置不合理。
●
集群业务繁忙，负载过重。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
1

## Page 625

4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.57 ALM-0005000300030010
【自定义监控】网络流入速率超过阈值
告警解释
当性能监控检测到主机组的网络流入速率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0005000300030010
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
1

## Page 626

告警参数
资源类型 参数名称 参数含义
主机组 虚拟化类型 集群的虚拟化类型。
主机组名称 主机组的名称。
来源系统 集群的来源系统。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成系统运行速度慢或网络故障。
可能原因
●
阈值条件设置不合理。
●
服务器网络繁忙，传输流量过大。
●
网络风暴，安全攻击。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
1

## Page 627

● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.58 ALM-0005000300030011
【自定义监控】网络流出速率超过阈值
告警解释
当性能监控检测到主机组的网络流出速率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0005000300030011
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
主机组 虚拟化类型 集群的虚拟化类型。
主机组名称 主机组的名称。
来源系统 集群的来源系统。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能会造成系统运行速度慢或网络故障。
可能原因
●
阈值条件设置不合理。
●
服务器网络繁忙，传输流量过大。
1

## Page 628

●
网络风暴，安全攻击。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.59 ALM-0007000100010001
【自定义监控】端口速率超过阈值
告警解释
当性能监控检测到端口性能的速率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 629

告警属性
告警ID 告警级别 告警类型
0007000100010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3. 在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 630

–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.60 ALM-0007000100010002
【自定义监控】端口
CRC
错误超过阈值
告警解释
当性能监控检测到端口性能的CRC错误超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0007000100010002
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 631

可能原因
●
阈值条件设置不合理。
●
存储设备异常或存储网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系存储设备运维人员检查存储设备或存储网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.61 ALM-0007000100010003
【自定义监控】端口发送
link reset
错误超过
阈值
告警解释
当性能监控检测到端口性能的发送link reset错误超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 632

告警属性
告警ID 告警级别 告警类型
0007000100010003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
存储设备异常或存储网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
1

## Page 633

2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系存储设备运维人员检查存储设备或存储网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.62 ALM-0007000100010004
【自定义监控】端口接收
link reset
错误超过
阈值
告警解释
当性能监控检测到端口性能的接收link reset错误超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0007000100010004
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 634

可能原因
●
阈值条件设置不合理。
●
存储设备异常或存储网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系存储设备运维人员检查存储设备或存储网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.63 ALM-0007000100010005
【自定义监控】端口
link reset
错误总数超过
阈值
告警解释
当性能监控检测到端口性能的link reset错误总数超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 635

告警属性
告警ID 告警级别 告警类型
0007000100010005
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
存储设备异常或存储网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
1

## Page 636

2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系存储设备运维人员检查存储设备或存储网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.64 ALM-0007000100010006
【自定义监控】端口
class 3 discard
错误超过
阈值
告警解释
当性能监控检测到端口性能的class
3
discard错误超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0007000100010006
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 637

可能原因
●
阈值条件设置不合理。
● 存储设备异常或存储网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系存储设备运维人员检查存储设备或存储网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.65 ALM-0007000100010007
【自定义监控】端口
sync loss
错误超过阈值
告警解释
当性能监控检测到端口性能的sync loss错误超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 638

告警属性
告警ID 告警级别 告警类型
0007000100010007
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
存储设备异常或存储网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
1

## Page 639

2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
– 否：执行步骤3。
步骤3 联系存储设备运维人员检查存储设备或存储网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.66 ALM-0007000100010008
【自定义监控】端口接收利用率超过阈值
告警解释
当性能监控检测到端口性能的接收利用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0007000100010008
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 640

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.67 ALM-0007000100010009
【自定义监控】端口缓冲信用量超过阈值
告警解释
当性能监控检测到端口性能的缓冲信用量超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 641

告警属性
告警ID 告警级别 告警类型
0007000100010009
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3. 在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 642

–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.68 ALM-000700010001000A
【自定义监控】端口接收速率超过阈值
告警解释
当性能监控检测到端口性能的接收速率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000700010001000A
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 643

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.69 ALM-000700010001000B
【自定义监控】端口发送利用率超过阈值
告警解释
当性能监控检测到端口性能的发送利用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 644

告警属性
告警ID 告警级别 告警类型
000700010001000B
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3. 在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 645

–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.70 ALM-000700010001000C
【自定义监控】端口带宽利用率超过阈值
告警解释
当性能监控检测到端口性能的带宽利用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000700010001000C
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 646

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2. 等待15分钟，在主菜单选择“集中监控 > 告警管理 > 当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.71 ALM-000700010001000D
【自定义监控】端口
link failure
错误超过阈值
告警解释
当性能监控检测到端口性能的link failure错误超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 647

告警属性
告警ID 告警级别 告警类型
000700010001000D
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
存储设备异常或存储网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
1

## Page 648

2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
– 否：执行步骤3。
步骤3 联系存储设备运维人员检查存储设备或存储网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.72 ALM-000700010001000E
【自定义监控】端口
signal loss
错误超过阈值
告警解释
当性能监控检测到端口性能的signal loss错误超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000700010001000E
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 649

可能原因
●
阈值条件设置不合理。
● 存储设备异常或存储网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 联系存储设备运维人员检查存储设备或存储网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.73 ALM-000700010001000F
【自定义监控】端口总
error
数超过阈值
告警解释
当性能监控检测到端口性能的总error数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 650

告警属性
告警ID 告警级别 告警类型
000700010001000F
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
端口 FC交换机端口
名称
FC交换机的端口名称。
FC交换机 FC交换机名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
●
阈值条件设置不合理。
●
存储设备异常或存储网络配置异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
1

## Page 651

2.
等待15分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
– 否：执行步骤3。
步骤3 联系存储设备运维人员检查存储设备或存储网络配置。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.74 ALM-0008000100010001
【自定义监控】CPU 使用率超过阈值
告警解释
当性能监控检测到大数据主机组的CPU使用率超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0008000100010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
大数据主机
组
主机组名称 大数据主机组的名称。
版本 大数据主机组的版本。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 652

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2. 等待5分钟，在主菜单选择“集中监控 > 告警管理 > 当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.75 ALM-0008000100010002
【自定义监控】内存使用率超过阈值
告警解释
当性能监控检测到大数据主机组的内存使用率超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 653

告警属性
告警ID 告警级别 告警类型
0008000100010002
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
大数据主机
组
主机组名称 大数据主机组的名称。
版本 大数据主机组的版本。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 654

–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.76 ALM-0008000100010003
【自定义监控】磁盘使用率超过阈值
告警解释
当性能监控检测到大数据主机组的磁盘使用率超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0008000100010003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
大数据主机
组
主机组名称 大数据主机组的名称。
版本 大数据主机组的版本。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 655

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.77 ALM-0002000500000001
【自定义监控】上行流量超过阈值
告警解释
当性能监控检测到弹性IP的上行流量超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 656

告警属性
告警ID 告警级别 告警类型
0002000500000001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性IP 名称 弹性IP的资源名称。
IP地址 弹性IP的IP地址。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
上行流量过大，消耗带宽。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
1

## Page 657

2.
等待240分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是
否清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.78 ALM-0002000500000003
【自定义监控】下行流量超过阈值
告警解释
当性能监控检测到弹性IP的下行流量超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000500000003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
弹性IP 名称 弹性IP的资源名称。
IP地址 弹性IP的IP地址。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
1

## Page 658

对系统的影响
下行流量过大，消耗带宽。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待240分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是
否清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 659

1.3.1.79 ALM-0002000A00000001
【自定义监控】用户空间
CPU
使用率超过阈值
告警解释
当性能监控检测到裸金属服务器的用户空间CPU使用率超过管理员设置的阈值时，产
生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000A00000001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
裸金属服务
器
名称 裸金属服务器的资源名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
1

## Page 660

–
是：执行3。
– 否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.80 ALM-0002000A0000000D
【自定义监控】内存使用率超过阈值
告警解释
当性能监控检测到裸金属服务器的内存使用率超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000A0000000D
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
裸金属服务
器
名称 裸金属服务器的资源名称。
1

## Page 661

资源类型 参数名称 参数含义
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
– 是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
1

## Page 662

参考信息
无。
1.3.1.81 ALM-0002000A00000014
【自定义监控】磁盘使用率超过阈值
告警解释
当性能监控检测到裸金属服务器的磁盘使用率超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000A00000014
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
裸金属服务
器
名称 裸金属服务器的资源名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
1

## Page 663

3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.82 ALM-0002000700000001
【自定义监控】CPU 使用率超过阈值
告警解释
当性能监控检测到关系型数据库的CPU使用率超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000700000001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
1

## Page 664

告警参数
资源类型 参数名称 参数含义
关系型数据
库
名称 关系型数据库的资源名称。
IP地址 关系型数据库的IP地址。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
数据库实例可能运行缓慢或失去响应。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
– 否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
1

## Page 665

告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.83 ALM-0002000700000002
【自定义监控】内存使用率超过阈值
告警解释
当性能监控检测到关系型数据库的内存使用率超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000700000002
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
关系型数据
库
名称 关系型数据库的资源名称。
IP地址 关系型数据库的IP地址。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
数据库实例可能运行缓慢、失去响应或因内存不足崩溃。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
1

## Page 666

–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2. 等待5分钟，在主菜单选择“集中监控 > 告警管理 > 当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
● 华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.84 ALM-0002000700000003
【自定义监控】IOPS 超过阈值
告警解释
当性能监控检测到关系型数据库的IOPS超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000700000003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
1

## Page 667

告警参数
资源类型 参数名称 参数含义
关系型数据
库
名称 关系型数据库的资源名称。
IP地址 关系型数据库的IP地址。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
数据库实例磁盘容量不足，磁盘占满后会导致数据库实例不可写，降备。
可能原因
●
阈值条件设置不合理。
● RDS实例磁盘容量不足。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
– 密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
1

## Page 668

告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.85 ALM-000200070000002A
【自定义监控】数据库连接数超过阈值
告警解释
当性能监控检测到关系型数据库的数据库连接数超过管理员设置的阈值时，产生此告
警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000200070000002A
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
关系型数据
库
名称 关系型数据库的资源名称。
IP地址 关系型数据库的IP地址。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
数据库连接数过多，可能影响数据库稳定运行。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
1

## Page 669

–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1. 根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.86 ALM-0002000700000036
【自定义监控】使用中的数据库连接数超过阈
值
告警解释
当性能监控检测到关系型数据库的使用中的数据库连接数超过管理员设置的阈值时，
产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000700000036
紧急/重要/次要/提示 业务质量告警
1

## Page 670

性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
关系型数据
库
名称 关系型数据库的资源名称。
IP地址 关系型数据库的IP地址。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
数据库连接数过多，可能影响数据库稳定运行。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1. 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
1

## Page 671

● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.87 ALM-0002000800000003
【自定义监控】主机内存使用率超过阈值
告警解释
当性能监控检测到Oracle CDB关系型数据库的主机内存使用率超过管理员设置的阈值
时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000800000003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
Oracle CDB
关系型数据
库
名称
Oracle
CDB关系型数据库的资源名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
数据库实例可能运行缓慢或失去响应。
可能原因
阈值条件设置不合理。
1

## Page 672

处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.88 ALM-0002000800000004
【自定义监控】主机
CPU
使用率超过阈值
告警解释
当性能监控检测到Oracle CDB关系型数据库的主机CPU使用率超过管理员设置的阈值
时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 673

告警属性
告警ID 告警级别 告警类型
0002000800000004
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
Oracle CDB
关系型数据
库
名称
Oracle
CDB关系型数据库的资源名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
数据库实例可能运行缓慢、失去响应或因内存不足崩溃。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 674

–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.89 ALM-0002000900000003
【自定义监控】主机内存使用率超过阈值
告警解释
当性能监控检测到Oracle PDB关系型数据库的主机内存使用率超过管理员设置的阈值
时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000900000003
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
Oracle PDB
关系型数据
库
名称
Oracle
PDB关系型数据库的资源名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
数据库实例可能运行缓慢或失去响应。
1

## Page 675

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2. 等待5分钟，在主菜单选择“集中监控 > 告警管理 > 当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.90 ALM-0002000900000004
【自定义监控】主机
CPU
使用率超过阈值
告警解释
当性能监控检测到Oracle PDB关系型数据库的主机CPU使用率超过管理员设置的阈值
时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 676

告警属性
告警ID 告警级别 告警类型
0002000900000004
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
Oracle PDB
关系型数据
库
名称
Oracle
PDB关系型数据库的资源名称。
ID
ID。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
数据库实例可能运行缓慢、失去响应或因内存不足崩溃。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 677

–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.91 ALM-0002000700000048
【自定义监控】CPU 使用率超过阈值
告警解释
当性能监控检测到CPU使用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0002000700000048
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
关系型数据
库
名称 关系型数据库的资源名称。
IP地址 关系型数据库的IP地址。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 678

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.92 ALM-0002000700000049
【自定义监控】内存使用率超过阈值
告警解释
当性能监控检测到内存使用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 679

告警属性
告警ID 告警级别 告警类型
0002000700000049
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
关系型数据
库
名称 关系型数据库的资源名称。
IP地址 关系型数据库的IP地址。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 680

–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.93 ALM-0003000200010005
【自定义监控】电源功率超过阈值
告警解释
当性能监控检测到电源功率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
0003000200010005
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
电源 电源名称 电源的名称。
服务器 服务器名称。
父资源名称 电源的父资源名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
1

## Page 681

可能原因
●
阈值条件设置不合理。
● 设备异常。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行步骤3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行步骤3。
步骤3 请联系设备管理员检查设备。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.94 ALM-000A000200000010
【自定义监控】每秒并发操作数超过阈值
告警解释
当性能监控检测到每秒并发操作数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 682

告警属性
告警ID 告警级别 告警类型
000A000200000010
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
分布式缓存
服务
名称 分布式缓存服务的资源名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
并发操作数过多会影响分布式缓存稳定运行。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理，可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 683

–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.95 ALM-000A000200000021
【自定义监控】缓存命中率超过阈值
告警解释
当性能监控检测到缓存命中率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000A000200000021
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
分布式缓存
服务
名称 分布式缓存服务的资源名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
缓存命中率过低，缓存没有发挥作用。
1

## Page 684

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.96 ALM-000A00020000002D
【自定义监控】每秒并发操作数超过阈值
告警解释
当性能监控检测到每秒并发操作数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 685

告警属性
告警ID 告警级别 告警类型
000A00020000002D
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
分布式缓存
服务
名称 分布式缓存服务的资源名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
可能导致系统功能不可用。
可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理，可根据业务
实际运行情况，对阈值进行调整。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
1

## Page 686

–
是：处理完毕。
–
否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.97 ALM-000A00020000004D
【自定义监控】CPU 平均利用率超过阈值
告警解释
当性能监控检测到CPU平均利用率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
告警属性
告警ID 告警级别 告警类型
000A00020000004D
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
分布式缓存
服务
名称 分布式缓存服务的资源名称。
策略名称 性能阈值维护页面配置告警阈值的策略名称。
对系统的影响
CPU过高，影响分布式缓存稳定运行。
1

## Page 687

可能原因
阈值条件设置不合理。
处理步骤
步骤1 检查监控指标的阈值设置。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4.
在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3。
–
否：执行步骤2。
步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是：处理完毕。
– 否：执行3。
步骤3 请参考对应场景的解决方案。
●
华为云Stack场景，业务正常情况下，联系业务运维人员进行扩容、迁移业务，其
他情况请联系技术工程师协助解决。
● HCS
Online场景，请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.1.98 ALM-000B00020000004D
资源性能断采
告警解释
当性能监控检测到资源的数据断采率超过设定的阈值时，产生此告警。
1

## Page 688

告警属性
告警ID 告警级别 告警类型
000B00020000004D
重要 处理错误告警
告警参数
参数名称 参数含义（示例）
云服务 产生告警的云服务名称，例如“ManageOne”。
服务 产生告警的服务名称，例如“MOPerfMonitorService”。
产品名称 对接产品的名称，例如“eSight System”。
系统名称 对接系统的名称，例如“eSight_192.168.164.35”。
对系统的影响
查看资源的性能数据为空。
可能原因
●
对接产品“eSight System”的资源性能数据为空。
●
资源的采集任务执行失败。
●
对接产品的系统时间和ManageOne时间不一致。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“集中监控
>
告警管理
>
当前告警”。
进入“当前告警”页面。
步骤3 单击告警列表右侧 ，在告警详情页签中查看“定位信息”的“产品名称”是否为
“eSight System”。
●
是，在eSight界面查看该资源类型是否有性能数据。
1

## Page 689

说明
– eSight V300R010C00SPC600及其补丁版本，请参见《eSight V300R010C00SPC600
产品文档》中的“查看性能数据”章节。
– eSight
21.0.0/21.2.0及其补丁版本，请参见《eSight
21.x.x
产品文档》中的“查看性
能数据”章节。
–
eSight版本号的查询方法请参见《华为云Stack
8.1.0
运维指南》的“参考信息
>
版本
号查询
>
查询eSight版本号”。
–
是，执行步骤5。
–
否，执行步骤4。
●
否，执行步骤5。
步骤4 在告警详情页签中查看“附加信息”中“资源类型”是否为“存储设备”或“服务
器”。
●
是，联系技术支持工程师确认断采资源是否支持eSight性能采集。
–
是，联系技术支持工程师处理。
–
否，执行参考信息的“设置告警屏蔽规则并清除当前告警”操作，任务结
束。
说明
例如：存储设备资源类型可能包含华为存储（企业存储）和非华为存储（企业存储）
类型的资源，eSight只支持华为存储（企业存储）类型的性能数据采集，不支持非华
为存储（企业存储）类型的性能数据采集，如果eSight存储设备对应资源中因包含非
华为存储（企业存储）类型的资源过多，产生资源性能断采告警时，则需要屏蔽该告
警。
●
否，联系技术支持工程师处理。
步骤5 检查资源的采集任务状态。
1.
在主菜单中选择“系统管理
>
系统集成
>
统一调度”。
进入“统一调度”页面。
2.
在“任务列表”页签，根据“系统名称”和“采集资源类型”，查看对应任务的
“最后执行结果”。
–
成功，执行步骤6。
–
失败，单击“操作”列的“启动”，触发采集任务立即执行，如果采集任务
执行结果依然失败，请联系技术支持工程师协助解决。
步骤6 检查服务器的系统时间。
1.
使用PuTTY工具以sopuser用户登录ManageOne服务部署节点查看系统时间。节
点IP地址的获取请参考参考信息的“查找节点对应管理IP地址”。
ManageOne服务所在节点为ManageOne-Service01或者ManageOne-
AppServer0X的任意一个节点。
2.
执行以下命令，查看系统时间。
date
回显示例：
Wed May 20 17:57:34 CST 2020
3.
登录对接系统的服务器节点，查看系统时间和ManageOne是否一致。
–
是，请联系技术支持工程师协助解决。
1

## Page 690

–
否，请联系技术工程师设置对接系统服务器的系统时间和ManageOne一致。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
查找节点对应管理IP地址
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在主菜单中选择“维护
>
运维管理
>
全景监控”，进入“节点监控”页面。
步骤3 单击页面左上角 并选择对应的产品。
步骤4 在“节点名称”列查找待查询管理IP地址的节点。
步骤5 单击节点名称，在节点详情页面上方的IP地址，即为该节点的管理IP地址。
----结束
设置告警屏蔽规则并清除当前告警
步骤1 在ManageOne运维面主菜单中选择“集中监控
>
告警管理
>
当前告警”。
步骤2 在待屏蔽告警“操作”列单击 ，选择“设置屏蔽规则”。
步骤3 条件设置为“附加信息”中“包含”：“系统名称=系统名称, 资源类型=["资源类型
"]”。
说明
“条件”的文本框中会自动填写当前告警的“附加信息”，只保留系统名称和资源类型字段。
例如：系统名称=eSight_192.168.x.x, 资源类型=["服务器"]。
步骤4 单击“确定”，完成屏蔽规则设置。
步骤5 单击已设置屏蔽规则告警操作列的 ，按照界面提示清除告警。
----结束
1.3.1.99 ALM-0001000700010001
【自定义监控】SNAT 连接数超过阈值
告警解释
当性能监控检测到NAT网关连接数超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 691

告警属性
告警ID 告警级别 告警类型
0001000700010001
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
NAT网关 名称 NAT网关的名称。
ID
NAT网关的ID。
策略名称 性能阈值维护页面配置的策略名称。
对系统的影响
可能导致上报告警的NAT网关实例无法创建新连接，从而造成NAT网关实例所在VPC下
的SNAT业务流量出现丢包的现象。
可能原因
●
阈值条件设置不合理。
●
上报告警的NAT网关实例所设置的规格与实际业务所需的规格不符。
●
虚拟机通过SNAT规则访问外网时，访问的IP地址不存在。
处理步骤
检查阈值条件设置是否合理
步骤1 检查监控指标的阈值设置。
1. 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3，检查NAT网关实例设置的规格是否满足实际业务所需规格。
–
否：执行2。
1

## Page 692

步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单中选择“集中监控
>
告警管理
>
当前告警”，检查告警信
息是否清除。
–
是：处理完毕。
–
否：执行3，检查NAT网关实例设置的规格是否满足实际业务所需规格。
检查NAT网关实例设置的规格是否满足实际业务所需规格
步骤3 修改NAT网关实例规格。
1.
使用浏览器，以VDC管理员、VDC业务员或代维管理员帐号登录ManageOne。
非B2B场景登录地址：https://ManageOne运营面的访问地址。例如，https://
console.demo.com。
B2B场景登录地址：https://ManageOne租户面的访问地址。例如，https://
tenant.demo.com。
2. 单击页面左上方 ，展开“服务列表”页签。
3.
选择“区域”和“资源集”。
4.
选择“基础云服务
>
网络
>
虚拟私有云”。
进入“网络控制台”页面。
5.
在左侧导航栏选择“NAT网关”页签。
6.
找到相关的NAT网关实例，在对应操作列单击“修改”，在弹出的“修改NAT网
关”对话框中调整至能满足业务需求的NAT网关规格。
7.
等待5分钟，返回到ManageOne运维面检查告警信息是否清除。
–
是：处理完毕。
–
否：执行4。
步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警信息，无需手工清除。
参考信息
无。
1.3.1.100 ALM-0001000700010002
【自定义监控】SNAT 连接率超过阈值
告警解释
当性能监控检测到NAT网关连接率超过管理员设置的阈值时，产生此告警。
阈值需要在“集中监控
>
监控配置
>
性能阈值维护”中手工设置。
1

## Page 693

告警属性
告警ID 告警级别 告警类型
0001000700010002
紧急/重要/次要/提示 业务质量告警
性能监控阈值通知共有四个级别，分别是：紧急、重要、次要和提示。四个级别的通
知处理方式一致。
告警参数
资源类型 参数名称 参数含义
NAT网关 名称 NAT网关的名称。
ID
NAT网关的ID。
策略名称 性能阈值维护页面配置的策略名称。
对系统的影响
可能导致上报告警的NAT网关实例无法创建新连接，从而造成NAT网关实例所在VPC下
的SNAT业务流量出现丢包的现象。
可能原因
●
阈值条件设置不合理。
●
上报告警的NAT网关实例所设置的规格与实际业务所需的规格不符。
●
虚拟机通过SNAT规则访问外网时，访问的IP地址不存在。
处理步骤
检查阈值条件设置是否合理
步骤1 检查监控指标的阈值设置。
1. 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
监控配置”。
3.
在左侧导航栏选择“性能阈值维护”。
4. 在“性能阈值维护”页面，找到对应监控指标的阈值。
5.
单击对应监控指标操作列的“修改”，查看阈值条件设置是否合理。
–
是：执行3，检查NAT网关实例设置的规格是否满足实际业务所需规格。
–
否：执行2。
1

## Page 694

步骤2 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
等待5分钟，在主菜单中选择“集中监控
>
告警管理
>
当前告警”，检查告警信
息是否清除。
–
是：处理完毕。
–
否：执行3，检查NAT网关实例设置的规格是否满足实际业务所需规格。
检查NAT网关实例设置的规格是否满足实际业务所需规格
步骤3 修改NAT网关实例规格。
1.
使用浏览器，以VDC管理员、VDC业务员或代维管理员帐号登录ManageOne。
非B2B场景登录地址：https://ManageOne运营面的访问地址。例如，https://
console.demo.com。
B2B场景登录地址：https://ManageOne租户面的访问地址。例如，https://
tenant.demo.com。
2. 单击页面左上方 ，展开“服务列表”页签。
3.
选择“区域”和“资源集”。
4.
选择“网络
>
虚拟私有云”。
进入“网络控制台”页面。
5.
在左侧导航栏选择“NAT网关”页签。
6.
找到相关的NAT网关实例，在对应操作列单击“修改”，在弹出的“修改NAT网
关”对话框中调整至能满足业务需求的NAT网关规格。
7.
等待5分钟，返回到ManageOne运维面检查告警信息是否清除。
–
是：处理完毕。
–
否：执行4。
步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
修复后，系统会自动清除此告警信息，无需手工清除。
参考信息
无。
1.3.2
接入管理
1.3.2.1 ALM-100002
证书已经过期
告警解释
MORCAccessConfigService服务会每小时检测接入管理对接系统的信任证书是否过
期，如果检测到信任证书已经过期，会产生告警；如果检测到证书已经更新并正常，
告警自动清除。
1

## Page 695

告警属性
告警ID 告警级别 告警类型
100002
紧急/重要/次要/提示 业务质量告警
告警参数
参数名称 参数含义
证书分类 对接系统上传的证书类型。
颁发者 信任证书的颁发者。
使用者 信任证书的使用者。
对系统的影响
当系统中证书过期时会对业务产生严重影响，甚至导致业务中断，需要及时更换证
书。
可能原因
系统中的证书过期，过期剩余时间小于30天为提示告警，小于7天为次要告警，小于3
天为重要告警，证书已过期为紧急告警。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
步骤3 在告警列表中，过滤出当前告警，展开当前告警详情，查看告警参数“定位信息-颁发
者”的值，查看产生告警的证书和所属对接系统。
步骤4 在ManageOne运维面菜单中选择“系统管理
>
系统集成”，在左侧导航栏中选择
“信任证书”，进入信任证书列表页面。
步骤5 在列表中查找对应“颁发者”后，在“备注信息”列查找对端信息。
步骤6 登录对端系统，更新信任证书。
步骤7 在“信任证书列表中”，单击过期证书的“删除”，删除完成之后，上传对接系统更
新后的证书。
步骤8 查看证书过期时间是否正常，如果正常则结束操作；否则，请再次尝试更新或联系技
术支持协助处理。
----结束
1

## Page 696

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.3
驱动管理
1.3.3.1 ALM-100502
系统连通性检测失败告警
告警解释
当对接系统的连通性测试失败时，产生该告警。
告警属性
告警ID 告警级别 告警类型
100502 重要 处理错误告警
告警参数
参数名称 参数含义
云服务 系统连接性测试失败的云服务名称。
服务 系统连通性测试失败的服务名称。
产品类型 系统连通性测试失败的对接系统所属的产品类型。
系统名称 系统连通性测试失败的对接系统的名称。
对接地址 系统连通性测试失败的对接系统的IP地址。
产品 系统连通性测试失败的对接系统所属的产品。
对系统的影响
对接系统连接故障，会导致对接系统相关业务无法下发。
可能原因
●
连通性检测失败。
–
对接系统的IP地址或端口信息错误。
–
对接系统参数错误，如用户名或密码等错误。
–
网络故障，请检查网络连通性。
1

## Page 697

–
对接系统故障，请检查对接系统是否正常。
●
驱动服务异常。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
步骤3 单击目标告警所在行的 ，展开当前告警详情。
说明
其中“级别”的颜色是根据告警级别进行变换，具体请以实际界面为准。
步骤4 查看并记录告警详情页面中的定位信息和告警可能原因。
步骤5 根据以下表格内容，逐步排查。
表1-50 告警处理步骤
排查项 操作
对接系统IP地址或端口信
息错误
1.
请联系对接系统的系统管理员获取正确的IP地址和端口信息。
2.
在主菜单中选择“系统管理
>
系统集成
>
接入管理”。
3.
在“系统分类”中单击步骤4获取的告警详情定位信息中的系统名称。
4.
在列表右上角的下拉框中选择“系统名称”，在搜索框中输入对接系统
的系统名称，单击 后显示匹配的对象。
说明
在下拉框中也可选择“IP地址/URL/域名”、“部署区域”、“版本信息”、“厂
商”和“连通状态”，在搜索框中输入对应的值，单击 后显示匹配的对象。
5.
单击需要修改的对接系统所在列的“修改”，进入修改对接系统页面。
说明
若对接系统所在“操作”列没有“修改”按钮，请联系技术工程师协助解决。
6.
在“IP地址/URL/域名”右侧输入框中输入正确的IP地址。
7.
在“端口号”右侧输入框中输入正确的端口信息。
8.
单击“确定”。
9.
单击对接系统“操作”列的“连通性测试”进行连通性测试。
–
成功，结束。
–
失败，执行步骤6。
1

## Page 698

排查项 操作
对接系统参数错误，如用
户名或密码等错误
1.
请联系对接系统的系统管理员获取正确的用户名和密码。
2.
在主菜单中选择“系统管理
>
系统集成
>
接入管理”。
3.
在“系统分类”中单击步骤4获取的告警详情页面定位信息中的系统名
称。
4.
在列表右上角的下拉框中选择“系统名称”，在搜索框中输入对接系统
的系统名称，单击 后显示匹配的对象。
说明
在下拉框中也可选择“IP地址/URL/域名”、“部署区域”、“版本信息”和“厂
商”，在搜索框中输入对应的值，单击 后显示匹配的对象。
5.
单击需要修改的对接系统所在列的“修改”，进入修改对接系统页面。
说明
若对接系统所在“操作”列没有“修改”按钮，请联系技术工程师协助解决。
6.
在“用户名”右侧输入框中输入正确的用户名。
7.
在“密码”右侧输入框中输入正确的密码，单击“确定”。
8.
单击对接系统“操作”列的“连通性测试”进行连通性测试。
–
成功，结束。
–
失败，执行步骤6。
网络故障
1.
使用PuTTY工具，以sopuser用户通过SSH方式登录节点。请在参考信息
中查询节点对应的节点IP地址。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后
台）”页签中，产品名称为“ManageOne”，帐户名称为“sopuser”
对应的默认密码。
说明
节点为ManageOne-Service01/02或ManageOne-DataServer0X的任意一个节
点。
2.
执行如下命令，切换到ossadm用户。
su - ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类
（ManageOne）”页签中，帐户名称为“ossadm”对应的默认密码。
3.
执行如下命令，是否能ping通告警参数中的“对接地址”。
ping
IP地址
–
是，表明SNMP对接系统故障，请参考“对接系统故障”中的步骤
5.1~步骤5.9处理。
–
否，执行步骤6。
1

## Page 699

排查项 操作
对接系统故障
1.
在主菜单中选择“系统管理
>
系统集成
>
接入管理”。
2.
在“系统分类”页面中单击步骤4获取的告警详情页面的定位信息中的
系统名称。
3.
在列表右上角的下拉框中单击选择“系统名称”，在搜索框中输入对接
系统的系统名称，单击 后显示匹配的对象。
说明
在下拉框中也可选择“IP地址/URL/域名”、“部署区域”、“版本信息”和“厂
商”，在搜索框中输入对应的值，单击 后显示匹配的对象。
4.
单击对接系统“操作”列的“连通性测试”进行连通性测试。
5.
查看弹框中连通性测试返回结果。
a.
对端系统接口返回500错误，则表明对接系统出现内部错误，执行步
骤5.7。
b.
对接系统网络不通，请参考“网络故障”中的步骤5.1~步骤5.3处
理。
c.
对接系统证书错误，执行步骤5.6。
说明
若返回结果没有明确的错误原因，请联系技术工程师协助解决。
6.
进入“系统管理
>
系统集成
>
信任证书”页面，查看是否有该对接系统
的证书信息。
–
否，参考运维帮助中心的“系统管理
>
系统集成
>
接入管理”章
节，根据实际对接的情况，在对应的对接系统的章节，获取上传证书
的方法。
–
是，执行步骤5.7。
7.
查看证书的有效期，看证书是否已过期。
–
是，请参见如下文档中的“证书管理”章节，根据实际对接情况，找
到对应的证书替换章节替换对接系统证书。
▪
华为云Stack场景：请参见《华为云Stack
8.1.0
运维指南》中的
“安全管理”。
▪
HCS
Online场景：请参见《ManageOne
8.1.0
安全管理指
南》。
–
否，执行步骤6。
8.
证书上传成功后，执行步骤5.9。
9.
单击对接系统“操作”列的“连通性测试”进行连通性测试。
–
成功，结束。
–
失败，执行步骤6。
1

## Page 700

排查项 操作
驱动服务异常
1.
在主菜单中选择“系统管理
>
系统集成
>
驱动管理”。
2.
按照产品类型查看该驱动实例的部署类型，如果是“inner”，即是
ManageOne内置驱动，则执行步骤5.3，如果是“outer”，则执行步
骤6，参考运维帮助中心的“系统管理
>
系统集成
>
简介”章节中的
“驱动与对接系统的关系”表。
3.
查看服务状态。
a.
使用PuTTY工具，以sopuser用户通过SSH方式登录节点。请在参考
信息中查询节点对应的IP地址。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后
台）”页签中，产品名称为“ManageOne”，帐户名称为
“sopuser”对应的默认密码。
说明
节点为ManageOne-Service01/02或ManageOne-DataServer0X的任意一个节
点。
b.
执行以命令，切换到ossadm用户。
su - ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类
（ManageOne）”页签中，帐户名称为“ossadm”对应的默认密
码。
c.
参考表1-51查看驱动名称和驱动服务的对应关系，执行以下命令查
看服务状态是否正常，此处以MOFSPPMDriverService微服务为例。
. /opt/oss/manager/bin/engr_profile.sh
/opt/oss/manager/agent/bin/ipmc_adm -cmd statusapp -app
MOFSPPMDriverService
回显信息：
Process Name Process Type App Name Tenant Name
ProcessMode IP PID Status
mofsppmdriverservice-3-0 mofsppmdriverservice MOFSPPMDriverService
Product cluster 192.168.164.35 26037 STOPPED
RUNNING表示正常，其他表示异常。
▪
是，执行步骤6。
▪
否，执行步骤5.4。
4.
执行以下命令，重启微服务并查看服务状态是否正常，此处以
MOFSPPMDriverService微服务为例。
重启微服务：
. /opt/oss/manager/bin/engr_profile.sh
/opt/oss/manager/agent/bin/ipmc_adm -cmd restartapp -app
MOFSPPMDriverService
回显信息：
success
查看微服务状态是否正常：
/opt/oss/manager/agent/bin/ipmc_adm -cmd statusapp -app
MOFSPPMDriverService
回显信息：
Process Name Process Type App Name Tenant Name ProcessMode
IP PID Status
1

## Page 701

排查项 操作
mofsppmdriverservice-3-0 mofsppmdriverservice MOFSPPMDriverService Product
cluster 192.168.164.35 26037 RUNNING
–
是，执行步骤5.5。
–
否，执行步骤6。
5.
单击对接系统“操作”列的“连通性测试”进行连通性测试。
–
成功，结束。
–
失败，执行步骤6。
表1-51 驱动服务与驱动名称的对应关系
驱动服务 驱动名称
MOFSPPMDriverService plugin_driver_hw_fusionsphereopensta
ck_pm
MOFSPFMDriverService plugin_driver_hw_fusionsphereopensta
ck_fm
MOFSPRMDriverService plugin_driver_hw_fusionsphereopensta
ck_rm
MOFSPAccessService plugin_driver_hw_fusionsphereopensta
ck_access
MOCommonDriverService plugin_driver_hw_cs
plugin_driver_hw_external
plugin_driver_hw_common
MOVRMDriverService plugin_driver_hw_fusioncompute
MORCSAPService RestConnectorService
SnmpConnectorService
步骤6 执行如下操作。
●
华为云Stack场景：下载日志并联系技术工程师。
a.
在主菜单中选择“日常运维
>
统一日志
>
运行日志”，默认进入“模板管
理”页面。
b.
选择区域，列表展示该区域下系统中预置的所有模板。
c.
在“模板名称”搜索框输入“对接系统连通性失败问题”进行搜索。
d.
单击“操作”列的“下载”，下载日志。
e.
请联系技术支持工程师协助解决。
● HCS
Online场景：请联系技术支持工程师协助解决。
----结束
1

## Page 702

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
以下介绍查找节点对应的管理IP地址的方法。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 单击“ManageOne”。
步骤3 在左侧导航栏中选择“节点监控”。
步骤4 在“节点列表”中查找待查询管理IP地址的节点。
步骤5 单击节点名称，在节点详情页面的“管理IP地址”，即为该节点的管理IP地址。
----结束
1.3.3.2 ALM-100553 SNMP
连通性检测失败告警
告警解释
当对接系统SNMP连通性检测失败时，产生该告警。
告警属性
告警ID 告警级别 告警类型
100553
重要 处理错误告警
告警参数
参数名称 参数含义
云服务 SNMP认证失败的云服务名称。
服务 SNMP连通性检测失败的服务名称。
对接系统类型 SNMP连通性检测失败的对接系统类型。
系统名称 SNMP连通性检测失败的对接系统的名称。
对接地址 SNMP连通性检测失败的对接系统的IP地址或域名。
1

## Page 703

对系统的影响
SNMP连通性异常会导致对接系统的同步告警无法正常上报或对接系统相关业务无法下
发。
可能原因
●
SNMP对接系统的认证信息错误。如用户名、授权认证密码等错误。
●
SNMP对接的IP地址或端口信息错误。
●
调用SNMP心跳接口异常。
●
报文时效超出时间窗。
●
网络异常。
●
SNMP下行通道异常。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 查看并记录告警的附加信息。
1. 在主菜单中选择“集中监控 > 告警管理 > 当前告警”，进入“当前告警”页面。
2.
单击目标告警所在行的 ，展开当前告警详情。
3.
查看并记录告警详情页面中的定位信息。
–
华为云Stack场景：执行步骤3。
– HCS
Online场景：参考表1-53，根据告警可能原因执行对应的操作。
步骤3 查看SNMP连通性检测失败脚本输出信息并做结果分析。
1.
单击“告警帮助”页签，打开“告警帮助辅助处理工具”的链接，跳转到自动作
业的“编排管理”页面。
说明
如果当前告警是汇聚告警 ，执行编排操作前，需要修改“编排管理”的告警流水号为被
汇聚告警流水号。被汇聚告警流水号可以在当前告警详情的“被汇聚告警”页签下获取。
2.
单击“执行”，进入“确认执行”页面。
3.
单击“确定”，跳转到“作业历史”页面。
4.
单击当前时间的作业名称“SNMP连通性检测失败告警信息收集”，展开作业详
情。
5.
在“作业流程”区域框中单击“告警处理_SNMP连通性检测”卡片，弹出弹框。
6.
在“执行情况”区域框下查看“脚本输出”信息，结果分析请参见表1-52。
1

## Page 704

表1-52 脚本输出结果分析
脚本输出 异常原因 解决方案
call SNMP
Connectivity
heartbeat
check
interface
error.
调用SNMP心跳告警
检测接口失败
请参考表1-53中的“调用SNMP心跳接口
异常”处理。
call SNMP
Connectivity
heartbeat
notify
interface
error.nativeI
d: xxx
check_snmp
_downstrea
m,httpCode:
404（503）
调用SNMP心跳通知
接口失败
请参考表1-53中的“调用SNMP心跳接口
异常”处理。
call SNMP
Connectivity
heartbeat
notify
interface
error.nativeI
d: xxx
check_snmp
_downstrea
m,httpCode:
400（非
404、503）
SNMP下行通道异常 请参考步骤4解决。
SNMP
Connectivity
downstream
failed.
Please
collect
Running log.
SNMP下行通道异常 请参考步骤4解决。
1

## Page 705

脚本输出 异常原因 解决方案
SNMP
Connectivity
upstream
failed.
Please
collect
Running log.
–
SNMP对接系统
的认证信息错误
–
报文时效超出时
间窗
–
网络异常
1.
在主菜单中选择“集中监控
>
告警管
理
>
事件日志”，进入事件日志统计
页面。
2.
在过滤条件下的名称栏输入“SNMP
鉴权失败”，查看是否存在SNMP鉴
权失败事件。
▪
是，执行步骤3.6.c。
▪
否，执行步骤3.6.d。
3.
检查“SNMP鉴权失败”事件定位信
息的错误码，并记录对接系统的IP地
址。
▪
如果定位信息中的错误码是1404、
1408或1410，说明对接系统的认
证信息错误，请参考表1-53中的
“SNMP对接系统的认证信息错
误”的处理步骤解决。
▪
如果定位信息中的错误码是1411，
说明南向服务异常，请参考表1-53
中的“报文时效超出时间窗”的处
理步骤解决。
4.
查看脚本输出的“respMessage”字
段值。
▪
如果值为“No
heartbeat alarm
reported by the docking system
until
now.”，请参考表1-53中的
“SNMP对接的IP地址或端口信息
错误”的处理步骤解决。
▪
如果值为“Heartbeat
alarm
reported by the docking system
out of 5
minutes.”，请参考表
1-53中的“网络异常”的处理步骤
解决。
1

## Page 706

表1-53 告警可能原因及处理步骤
可能原因 处理步骤
SNMP对接
系统的认证
信息错误
请联系对接系统的系统管理员获取并重新填写正确的系统信息。
1.
在主菜单中选择“系统管理
>
系统集成
>
驱动管理”。
2.
单击“配置管理”页签。
3.
根据部署区域信息单击对应对接系统的卡片，在对应对接系统的
“系统信息”下方单击 ，并在页面中单击 重新添加正确的系
统信息。
4.
在主菜单中选择“系统管理
>
系统集成
>
接入管理”。
5.
在“系统分类”中单击告警详情页面定位信息中的系统名称。
6.
单击对接系统“操作”列的“连通性测试”进行连通性测试。
–
成功，结束。
–
失败，执行步骤4。
SNMP对接
的IP地址或
端口信息错
误
联系对接系统的系统管理员获取并重新填写正确的SNMP对接配置信
息。
1. 在主菜单中选择“系统管理 > 系统集成 > 驱动管理”。
2. 选择“配置管理”页签。
3. 查看“本端IP地址”，根据“部署区域”信息单击对应对接系统的
卡片查看“本端端口”，确认“本端IP地址”、“本端端口”和对
端IP地址和对端端口是否一致。
– 是，执行步骤3.4，进行连通性测试。
– 否，修改对端IP地址和对端端口号与本端保持一致，执行步骤
3.4，进行连通性测试。
4. 参考“SNMP对接系统的认证信息错误”处理步骤中的步骤3.4~步
骤3.6，进行连通性测试。
须知
–
本端的默认IP地址请参考对应版本汇总文件“2.1 工具生成的IP参数”中
ManageOne的LVS IP地址。
–
本端的默认端口号请参考对应版本通信矩阵“ManageOne 12节点”或
“ManageOne 15节点”页签下端口说明为“告警管理”所在的端口
号。
1

## Page 707

可能原因 处理步骤
调用SNMP
心跳接口异
常
1.
使用PuTTY工具以sopuser用户登录节点查看驱动服务状态。请在
参考信息中查询节点对应的IP地址。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后
台）”页签中，产品名称为“ManageOne”，帐户名称为
“sopuser”对应的默认密码。
说明
节点为ManageOne-Service01/02或者ManageOne-DataServer0X的任意一
个节点。
2.
执行如下命令，切换到ossadm用户。
su - ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类
（ManageOne）”页签中，帐户名称为“ossadm”对应的默认密
码。
3.
执行如下命令，查看服务状态是否正常。
. /opt/oss/manager/bin/engr_profile.sh
/opt/oss/manager/agent/bin/ipmc_adm -cmd statusapp -
app MOCommonDriverService
当回显信息为RUNNING时表示正常，其余表示异常。回显信息示
意如下：
Process Name Process Type App Name Tenant Name
Process Mode IP PID Status
mocommondriverservice-3-0 mocommondriverservice MOCommonDriverService
Product cluster 192.168.171.185 29802 RUNNING
–
正常，执行步骤4。
–
异常，执行步骤3.4，重启微服务。
4.
执行如下命令，重启微服务。
. /opt/oss/manager/bin/engr_profile.sh
/opt/oss/manager/agent/bin/ipmc_adm -cmd restartapp -
app MORCSAPService
回显信息如下表示重启成功。
success
5.
执行如下命令，查看服务状态是否正常。
/opt/oss/manager/agent/bin/ipmc_adm -cmd statusapp -
app MOCommonDriverService
当回显信息中为RUNNING时表示正常，其余表示异常。回显信息
示意如下：
Process Name Process Type App Name Tenant Name
ProcessMode IP PID Status
mocommondriverservice-3-0 mocommondriverservice MOCommonDriverService
Product cluster 192.168.171.185 29802 RUNNING
–
华为云Stack场景：
▪
服务正常，执行步骤3，检测连通性。
回显信息如下，表示连通成功。如果连通性失败，请参考表
1-52中的其他可能原因进行处理。
SNMP Connectivity upstream success.
SNMP Connectivity downstream success.
▪
服务异常，执行步骤4。
1

## Page 708

可能原因 处理步骤
– HCS
Online场景：
▪
正常，参考“SNMP对接系统的认证信息错误”处理步骤中
的步骤3.4~步骤3.6，进行连通性测试。
▪
异常，执行步骤4。
报文时效超
出时间窗
1.
重启MORCSAPService。
a.
使用PuTTY工具以sopuser用户登录节点。请在参考信息中查询
节点对应的IP地址。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类
（后台）”页签中，产品名称为“ManageOne”，帐户名称为
“sopuser”对应的默认密码。
说明
节点为ManageOne-Service01/02或者ManageOne-DataServer0X的任
意一个节点。
b.
执行如下命令，切换到root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类
（后台）”页签中，产品名称为“ManageOne”，帐户名称为
“root”对应的默认密码。
c.
执行以下命令，重启MORCSAPService。
su ossadm -c "source /opt/oss/manager/agent/bin/
engr_profile.sh; ipmc_adm -cmd restartapp -app
MORCSAPService"
d.
间隔10分钟，依次重启其他节点上的MORCSAPService。
2.
检查ManageOne的系统时间和对接系统的后台节点时间是否一
致。
a.
使用以下命令查询ManageOne的系统时间。
date
回显信息：
Wed Aug 28 16:29:24 CST 2019
b.
在步骤3.6.c中的定位信息中获取服务名称，确认当前服务对接
系统的管理员。联系管理员获取对接系统信息。
c.
使用PuTTY工具登录步骤3.2.b中获取的对接系统的后台节点IP
地址。
d.
使用以下命令查询后台节点时间。
date
回显信息：
Wed Aug 28 16:29:24 CST 2019
▪
ManageOne的系统时间和对接系统的后台节点时间一致，
结束。
▪
ManageOne的系统时间和对接系统的后台节点时间不一
致，执行步骤4。
1

## Page 709

可能原因 处理步骤
网络异常
1.
检测网络是否故障。
a.
使用PuTTY工具以sopuser用户登录节点。请在参考信息中查询
节点对应的IP。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类
（后台）”页签中，产品名称为“ManageOne”，帐户名称为
“sopuser”对应的默认密码。
说明
节点为ManageOne-Service01/02或者ManageOne-DataServer0X的任
意一个节点。
b.
执行如下命令，切换到ossadm用户。
su - ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类
（ManageOne）”页签中，帐户名称为“ossadm”对应的默
认密码。
c.
执行如下命令，查看是否能ping通对接系统的IP地址，即告警
参数中的“对接地址”。
ping
IP地址
▪
回显信息如下，表示网络正常。执行步骤3.2。
64 bytes from IP地址
▪
等待1分钟后无回显信息，表示网络故障。请联系技术支持
工程师协助解决网络问题。
2.
检查LVS是否故障。
a.
使用PuTTY工具以sopuser用户分别登录主节点和备节点，请在
参考信息中查询节点对应的IP。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类
（后台）”页签中，产品名称为“ManageOne”，帐户名称为
“sopuser”对应的默认密码。
说明
节点为ManageOne-Service01/02或者ManageOne-DataServer0X的任
意一个节点。
b.
执行以下命令，切换到root用户
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类
（后台）”页签中，产品名称为“ManageOne”，帐户名称为
“root”对应的默认密码。
c.
执行以下命令，查看LVS转发状态。
/opt/envs/RCLVSService/lvs_install/bin/ipvsadm -ln --
stats
主节点回显信息如下。
IP Virtual Server version 1.2.1 (size=4096)
Prot LocalAddress:Port Conns InPkts OutPkts InBytes OutBytes
-> RemoteAddress:Port
TCP 192.168.129.17:27337 52 28479 0 17457284 0
-> 192.168.129.7:27337 26 16714 0 10657454 0
-> 192.168.129.8:27337 26 11766 0 6799882 0
TCP 192.168.129.17:27400 0 0 0 0 0
-> 192.168.129.13:27400 0 0 0 0 0
1

## Page 710

可能原因 处理步骤
-> 192.168.129.14:27400 0 0 0 0 0
TCP 192.168.129.17:27402 0 0 0 0 0
-> 192.168.129.13:27402 0 0 0 0 0
-> 192.168.129.14:27402 0 0 0 0 0
UDP 192.168.129.17:27367 1 64 0 21876 0
-> 192.168.129.7:27367 0 61 0 19398 0
-> 192.168.129.8:27367 1 3 0 2478 0
UDP 192.168.129.17:27401 0 0 0 0 0
-> 192.168.129.13:27401 0 0 0 0 0
-> 192.168.129.14:27401 0 0 0 0 0
备节点回显信息如下。
IP Virtual Server version 1.2.1 (size=4096)
Prot LocalAddress:Port Conns InPkts OutPkts InBytes OutBytes
主节点、备节点回显信息不一致则表示LVS转发状态正常，主节
点、备节点回显信息一致则表示LVS转发状态异常。
▪
LVS转发状态正常，结束。
▪
LVS转发状态异常，执行步骤3.2.d。
d.
执行以下命令重启进程。
/opt/envs/RCLVSService/lvs_install/script/
mgr_keepalived.sh restart
回显信息：
Shutting down Keepalived for LVS: [ OK ]
Starting Keepalived for LVS: [ OK ]
重启进程成功后，参考“SNMP对接系统的认证信息错误”处理
步骤中的步骤3.4~步骤3.6，进行连通性测试。
步骤4 下载日志并联系技术工程师。
1.
在主菜单中选择“日常运维
>
统一日志
>
运行日志”，默认进入“场景管理”页
面。
2.
在页面上方“场景搜索”行，在“场景名称”搜索框输入“对接系统SNMP连通
性失败问题”进行搜索。
3.
在“操作”列，单击 ，下载日志。
4.
请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
以下介绍查找节点对应的管理IP地址的方法。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
1

## Page 711

默认帐号：admin。
步骤2 单击“ManageOne”。
步骤3 在左侧导航栏中选择“节点监控”。
步骤4 在“节点列表”中查找待查询管理IP地址的节点。
步骤5 单击节点名称，在节点详情页面的“管理IP地址”，即为该节点的管理IP地址。
----结束
1.3.4
驱动框架
1.3.4.1 ALM-100550 LVS
配置失败告警
告警解释
MORCSAPService服务主动调用MORCLVSService服务的注册接口，当
MORCSAPService服务向MORCLVSService服务注册生成配置文件失败时，产生该告
警。
告警属性
告警ID 告警级别 告警类型
100550
紧急 处理错误告警
告警参数
参数名称 参数含义
云服务 发生告警的云服务名称。
服务 发生告警的服务名称。
节点名称 发生告警的节点名称。
IP地址 发生告警的服务所在服务器的IP地址。
对系统的影响
告警发生之后，上报到LVS（Linux
Virtual
Server）的告警无法分发到注册失败的
MORCSAPService服务节点。
可能原因
●
MORCLVSService安装部署失败。
●
系统平台在安装MORCLVSService下RCLVSService.zip包失败。
1

## Page 712

处理步骤
步骤1 登录部署面查看LVS安装部署是否失败。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在首页，单击产品类型为“ManageOne”对应的“服务”，进入“运维管理
>
全景监控
>
服务监控” 页面。
3.
在“服务列表”，搜索服务名称。
–
华为云Stack场景：搜索服务名称为“MODriverFramework”，单击
“Product/MODriverFramework/mo_om_adminplane_global_zenith
Basic
Information”实例名称。
– HCS
Online场景：搜索服务名称为“MOMedation”，单击“ManageOne/
MOMedation/mo_hybridcloud_global”实例名称。
4.
在“服务诊断”页面，“服务拓扑”视图中可以看到MORCLVSService。在微服务
列表中，可以单击蓝色字体的MORCLVSService微服务名称。
5.
在进程列表中，可以查看到微服务的进程状态是否为“正在进行”。
–
是，执行步骤2。
–
否，请联系技术支持工程师协助解决。
步骤2 查看在安装部署MORCLVSService时是否正确安装了RCLVSService.zip包。
1.
使用PuTTY工具，以sopuser用户通过SSH方式登录节点，请在参考信息中查询节
点对应的IP。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“sopuser”对应的默认密码。
说明
登录节点为ManageOne-Service01或者ManageOne-DataServer0X的任意一个节点。
2.
执行如下命令，切换到root帐号。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“root”对应的默认密码。
3.
执行如下命令，进入/opt/envs目录。
cd /opt/envs/
4.
执行如下命令，查看是否有RCLVSService目录。
ll
如果回显信息中包含“RCLVSService”，则表明有RCLVSService目录。
–
是，请执行步骤3。
–
否，请联系技术支持工程师协助解决。
步骤3 查看RCLVSService目录中RCLVSService.zip包的内容是否完整。
1.
执行如下命令，进入RCLVSService目录。
cd RCLVSService
1

## Page 713

2.
执行如下命令，查看RCLVSService.zip包的内容是否完整。
ll
完整的回显示例如下。
–
是，收集上述告警处理过程中的信息，请联系技术支持工程师协助解决。
–
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
以下介绍查找节点对应的管理IP地址的方法。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 单击“ManageOne”。
步骤3 在左侧导航栏中选择“节点监控”。
步骤4 在“节点列表”中查找待查询管理IP地址的节点。
步骤5 单击节点名称，在节点详情页面的“管理IP地址”，即为该节点的管理IP地址。
----结束
1.3.4.2 ALM-100551 LVS
中断服务告警
告警解释
MORCLVSService服务会定期检测LVS的运行状态，如果检测到LVS没有启动并重新启
动失败时，产生该告警。
1

## Page 714

告警属性
告警ID 告警级别 告警类型
100551
紧急 处理错误告警
告警参数
参数名称 参数含义
云服务 发生告警的云服务名称。
服务 发生告警的服务名称。
节点名称 发生告警的服务名称
IP地址 发生告警的服务所在服务器的IP地址。
对系统的影响
告警发生之后，依赖LVS的SNMP告警无法上报。
可能原因
●
系统错误或系统文件损坏。
●
MORCLVSService服务部署的节点有其他的服务在使用keepalived。
说明
keepalived用于倒换LVS服务部署节点的主备状态。
处理步骤
步骤1 查看MORCLVSService服务部署节点的“/var/log/messages”日志中回显信息是否出
现关键字“error”。
1.
使用PuTTY工具，以sopuser用户通过SSH方式登录节点，请在参考信息中查询节
点对应的IP。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“sopuser”对应的默认密码。
说明
登录节点为ManageOne-Service01或者ManageOne-DataServer0X的任意一个节点。
2.
执行如下命令，切换到root帐号。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“root”对应的默认密码。
3.
执行如下命令，查看回显信息中是否出现关键字“error”。
cat /var/log/messages | grep "*error*"
1

## Page 715

–
是，请联系技术支持工程师协助解决。
–
否，请执行步骤2。
步骤2 执行如下命令检查该节点是否有其他服务运行keepalived。
ps -ef | grep keepalive | grep -v "RCLVSService/lvs_install" | grep -v "grep" |
awk '{print $2}'
如果有回显产生，则表明有其他服务运行keepalived。
●
是，请联系技术支持工程师协助解决，将MORCLVSService服务与其他服务分不同
节点部署，MORCLVSService服务部署的节点将不再有其他的服务使用
keepalived。
●
否，请联系技术支持工程师协助解决，重新部署MORCLVSService服务。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
以下介绍查找节点对应的管理IP地址的方法。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 单击“ManageOne”。
步骤3 在左侧导航栏中选择“节点监控”。
步骤4 在“节点列表”中查找待查询管理IP地址的节点。
步骤5 单击节点名称，在节点详情页面的“管理IP地址”，即为该节点的管理IP地址。
----结束
1.3.5
容量管理
1.3.5.1 ALM-CloudCapacityMgmt_Base_1001 vCPU
分配率超过阈值
告警解释
当云服务某个位置（区域、资源池、AZ、集群）的vCPU分配率等于或超过所设置的某
个阈值时，上报此类告警。
1

## Page 716

告警属性
告警ID 告警级别 告警类型
CloudCapacityMg
mt_Base_1001
提示/次要/重要/紧急 业务质量告警
各级别告警的默认阈值如下所示。
容量指标 紧急阈值(%)
vCPU分配率
90
说明
提示阈值、次要阈值和重要阈值系统默认未设置，用户可根据自身情况设置。
告警参数
参数名称 参数含义
区域 上报的告警对应的位置信息。
资源池 上报的告警对应的资源池名称。
可用分区 上报的告警对应的可用分区名称。
集群 上报的告警对应的集群名称。
阈值级别 当前上报告警所属的阈值级别。
阈值门限 用户设定上报告警的门限值。
当前值 上报的告警对应的阈值。
对系统的影响
当上报此类阈值告警时，说明对应的资源不足，可能会影响ECS云服务业务发放。
可能原因
●
vCPU分配率告警阈值设置太低。
●
当前某个位置对应的vCPU资源不足。
处理步骤
步骤1 检查“vCPU分配率”的告警阈值。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
1

## Page 717

–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
单击目标告警所在行的 ，展开告警详情，查看告警参数“阈值门限”的值。
3.
在主菜单中选择“运维分析
>
资源分析”。
4.
在左侧导航树单击“资源池分析”。
5.
在左侧导航选择本地云，单击页面右上角的“容量监控配置”。
6.
在左侧导航树中选择“云服务容量阈值维护”，进入“容量阈值维护”页面。
7.
比较步骤1.2中获取的阈值，检查vCPU分配率的告警阈值是否合理。
–
是，则剩余可用量过小。
▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
–
否，执行步骤2。
步骤2 重新设置“vCPU分配率”的告警阈值。
1.
单击“操作”列的“修改”，修改告警阈值。
2.
等待10分钟，在系统主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警
是否清除。
–
是，结束。
–
否，执行如下操作。
▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
步骤3 联系管理员参考《华为云Stack
8.1.0
扩容指南》中的“扩容计算资源池”章节对
vCPU资源进行扩容。
说明
●
OpenStack资源池请参考“扩容计算资源池”章节。
●
HiCloud资源池请参考“新增安装可选云服务”章节。
●
FusionManager资源池请参考《FusionSphere 虚拟化套件
6.5.0
产品文档》中的“添加主
机”章节。
●
FusionCompute资源池请参考《FusionCompute 产品文档》中的“添加主机”章节。
步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除告警，无需手工清除。
参考信息
无。
1

## Page 718

1.3.5.2 ALM-CloudCapacityMgmt_Base_1002 vMemory
分配率超过阈值
告警解释
当云服务某个位置（区域、资源池、AZ、集群）的vMemory分配率等于或超过所设置
的某个阈值时，上报此类告警。
告警属性
告警ID 告警级别 告警类型
CloudCapacityMgmt
_Base_1002
提示/次要/重要/紧急 业务质量告警
各级别告警的默认阈值如下所示。
容量指标 紧急阈值(%)
vMemory分配率
90
说明
提示阈值、次要阈值和重要阈值系统默认未设置，用户可根据自身情况设置。
告警参数
参数名称 参数含义
区域 上报的告警对应的位置信息。
资源池 上报的告警对应的资源池名称。
可用分区 上报的告警对应的可用分区名称。
集群 上报的告警对应的集群名称。
阈值级别 当前上报告警所属的阈值级别。
阈值门限 用户设定上报告警的门限值。
当前值 上报的告警对应的阈值。
对系统的影响
当上报此类阈值告警时，说明vMemory的资源不足，可能会影响ECS云服务业务发
放。
1

## Page 719

可能原因
●
vMemory分配率告警阈值设置太低。
●
当前某个位置对应的vMemory资源不足。
处理步骤
步骤1 检查“vMemory分配率”的告警阈值。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
单击目标告警所在行的 ，展开告警详情，查看告警参数“阈值门限”的值。
3.
在主菜单中选择“运维分析
>
资源分析”。
4.
在左侧导航树单击“资源池分析”。
5.
在左侧导航选择本地云，单击页面右上角的“容量监控配置”。
6.
在左侧导航树中选择“云服务容量阈值维护”，进入“容量阈值维护”页面。
7.
比步骤1.2较中获取的阈值，检查“vMemory分配率”的告警阈值是否合理。
–
是，则剩余可用量过小。
▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
–
否，执行步骤2。
步骤2 重新设置“vMemory分配率”的告警阈值。
1.
单击“操作”列的“修改”，修改告警阈值。
2.
等待10分钟，在系统主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警
是否清除。
– 是，结束。
–
否，执行如下操作。
▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
步骤3 联系管理员参考《华为云Stack
8.1.0
扩容指南》中的“扩容计算资源池”章节对
vMemory资源进行扩容。
说明
●
OpenStack资源池请参考“扩容计算资源池”章节。
●
HiCloud资源池请参考“新增安装可选云服务”章节。
● FusionManager资源池请参考《FusionSphere 虚拟化套件 6.5.0 产品文档》中的“添加主
机”章节。
●
FusionCompute资源池请参考《FusionCompute 产品文档》中的“添加主机”章节。
1

## Page 720

步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除告警，无需手工清除。
参考信息
无。
1.3.5.3 ALM-CloudCapacityMgmt_Base_1003
块存储使用率超过阈值
告警解释
当某个位置（区域、资源池、AZ）的块存储使用率等于或超过所设置的某个阈值时，
上报此类告警。
告警属性
告警ID 告警级别 告警类型
CloudCapacityMgm
t_Base_1003
提示/次要/重要/紧急 业务质量告警
各级别告警的默认阈值如下所示。
容量指标 紧急阈值(%)
块存储使用率
90
说明
提示阈值、次要阈值和重要阈值系统默认未设置，用户可根据自身情况设置。
告警参数
参数名称 参数含义
区域 上报的告警对应的位置信息。
资源池 上报的告警对应的资源池名称。
可用分区 上报的告警对应的可用分区名称。
存储类型 上报的告警对应的存储类型。
存储池 上报的告警对应的存储池名称。
1

## Page 721

参数名称 参数含义
阈值级别 当前上报告警所属的阈值级别。
阈值门限 用户设定上报告警的门限值。
当前值 上报的告警对应的阈值。
对系统的影响
当上报此类阈值告警时，说明存储池资源不足，可能会影响EVS云服务业务发放。
可能原因
●
存储池告警阈值设置太低。
●
当前某个位置对应的存储池资源不足。
处理步骤
步骤1 检查“块存储使用率”的告警阈值。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
单击目标告警所在行的 ，展开告警详情，查看告警参数“阈值门限”的值。
3.
在主菜单中选择“运维分析
>
资源分析”。
4.
在左侧导航树单击“资源池分析”。
5. 在左侧导航选择本地云，单击页面右上角的“容量监控配置”。
6.
在左侧导航树中选择“资源池容量阈值维护”，进入“容量阈值维护”页面。
7.
比较步骤1.2中获取的阈值，检查“块存储使用率”的告警阈值是否合理。
–
是，则剩余可用量过小。
▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
–
否，执行步骤2。
步骤2 重新设置“块存储使用率”的告警阈值。
1.
单击“操作”列的“修改”，修改告警阈值。
2.
等待10分钟，在系统主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警
是否清除。
–
是，结束。
–
否，执行如下操作。
1

## Page 722

▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
步骤3 联系管理员参考《华为云Stack
8.1.0
扩容指南》中的“扩容业务存储资源”章节对存
储池资源进行扩容。
说明
●
OpenStack资源池请参考“扩容计算资源池”章节。
● HiCloud资源池请参考“新增安装可选云服务”章节。
●
FusionManager资源池请参考《FusionSphere 虚拟化套件
6.5.0
产品文档》中的“添加主
机”章节。
●
FusionCompute资源池请参考《FusionCompute 产品文档》中的“添加主机”章节。
步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除告警，无需手工清除。
参考信息
无。
1.3.5.4 ALM-CloudCapacityMgmt_Base_1004
块存储分配率超过阈值
告警解释
当云服务某个位置（区域、资源池、AZ、集群）的块存储分配率等于或超过所设置的
某个阈值时，上报此类告警。
告警属性
告警ID 告警级别 告警类型
CloudCapacityMgm
t_Base_1004
提示/次要/重要/紧急 业务质量告警
各级别告警的默认阈值如下所示。
容量指标 紧急阈值(%)
块存储分配率
90
说明
提示阈值、次要阈值和重要阈值系统默认未设置，用户可根据自身情况设置。
1

## Page 723

告警参数
参数名称 参数含义
区域 上报的告警对应的位置信息。
资源池 上报的告警对应的资源池名称。
可用分区 上报的告警对应的可用分区名称。
存储类型 上报的告警对应的存储类型。
存储池 上报的告警对应的存储池名称。
阈值级别 当前上报告警所属的阈值级别。
阈值门限 用户设定上报告警的门限值。
当前值 上报的告警对应的阈值。
对系统的影响
当上报此类阈值告警时，说明存储池资源不足，可能会影响EVS云服务业务发放。
可能原因
●
存储池告警阈值设置太低。
●
当前某个位置对应的存储池资源不足。
处理步骤
步骤1 检查“块存储分配率”的告警阈值。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
单击目标告警所在行的 ，展开告警详情，查看告警参数“阈值门限”的值。
3.
在主菜单中选择“运维分析
>
资源分析”。
4.
在左侧导航树单击“资源池分析”。
5.
在左侧导航选择本地云，单击页面右上角的“容量监控配置”。
6.
在左侧导航树中选择“云服务容量阈值维护”，进入“容量阈值维护”页面。
7.
比较步骤1.2中获取的阈值，检查块存储分配率的告警阈值是否合理。
–
是，则剩余可用量过小。
▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
1

## Page 724

–
否，执行步骤2。
步骤2 重新设置“块存储分配率”的告警阈值。
1.
单击“操作”列的“修改”，修改告警阈值。
2.
等待10分钟，在系统主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警
是否清除。
–
是，结束。
–
否，执行如下操作。
▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
步骤3 联系管理员参考《华为云Stack
8.1.0
扩容指南》中的“扩容业务存储资源”章节对存
储池资源进行扩容。
说明
●
OpenStack资源池请参考“扩容计算资源池”章节。
● HiCloud资源池请参考“新增安装可选云服务”章节。
●
FusionManager资源池请参考《FusionSphere 虚拟化套件
6.5.0
产品文档》中的“添加主
机”章节。
●
FusionCompute资源池请参考《FusionCompute 产品文档》中的“添加主机”章节。
步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除告警，无需手工清除。
参考信息
无。
1.3.5.5 ALM-CloudCapacityMgmt_Base_1005
弹性
IP
分配率超过阈值
告警解释
当云服务某个位置（区域、资源池）的弹性IP分配率等于或超过所设置的某个阈值
时，上报弹性IP使用率超过阈值告警。
告警属性
告警ID 告警级别 告警类型
CloudCapacityMgmt_Ba
se_1005
提示/次要/重要/紧急 业务质量告警
各级别告警的默认阈值如下所示。
1

## Page 725

容量指标 紧急阈值(%)
弹性IP分配率
90
说明
提示阈值、次要阈值和重要阈值系统默认未设置，用户可根据自身情况设置。
告警参数
参数名称 参数含义
区域 上报的告警对应的位置信息。
资源池 上报的告警对应的资源池名称。
用途 上报此告警对应的弹性IP的用途。
阈值级别 当前上报告警所属的阈值级别。
阈值门限 用户设定上报告警的门限值。
当前值 上报的告警对应的阈值。
对系统的影响
当上报此类阈值告警时，说明对应的资源不足，可能会影响弹性IP业务发放。
可能原因
●
弹性IP分配率告警阈值设置太低。
●
当前某个位置对应的弹性IP资源不足。
处理步骤
步骤1 检查“弹性IP分配率”的告警阈值。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
单击目标告警所在行的 ，展开告警详情，查看告警参数“阈值门限”的值。
3.
在主菜单中选择“运维分析
>
资源分析”。
4.
在左侧导航树单击“资源池分析”。
5.
在左侧导航选择本地云，单击页面右上角的“容量监控配置”。
1

## Page 726

6.
在左侧导航树中选择“云服务容量阈值维护”，进入“容量阈值维护”页面。
7.
比较步骤1.2中获取的阈值，检查弹性IP分配率的告警阈值是否合理。
–
是，则剩余可用量过小。
▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
–
否，执行步骤2。
步骤2 重新设置弹性IP“分配率”的告警阈值。
1.
单击“操作”列的“修改”，修改告警阈值。
2.
等待10分钟，在系统主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警
是否清除。
–
是，结束。
–
否，执行如下操作。
▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
步骤3 联系管理员参考《华为云Stack
8.1.0
扩容指南》中的“扩容网络节点及网络服务”章
节对弹性IP资源进行扩容。
说明
●
OpenStack资源池请参考“扩容计算资源池”章节。
●
HiCloud资源池请参考“新增安装可选云服务”章节。
●
FusionManager资源池请参考《FusionSphere 虚拟化套件
6.5.0
产品文档》中的“添加主
机”章节。
●
FusionCompute资源池请参考《FusionCompute 产品文档》中的“添加主机”章节。
步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除告警，无需手工清除。
参考信息
无。
1.3.5.6 ALM-CloudCapacityMgmt_Base_1006
数据存储使用率超过阈值
告警解释
当某个位置（区域、资源池、AZ）的数据存储使用率等于或超过所设置的某个阈值
时，上报数据存储使用率超过阈值告警。
1

## Page 727

告警属性
告警ID 告警级别 告警类型
CloudCapacityMgmt_Ba
se_1006
提示/次要/重要/紧急 业务质量告警
各级别告警的默认阈值如下所示。
容量指标 紧急阈值(%)
数据存储使用率
90
说明
提示阈值、次要阈值和重要阈值系统默认未设置，用户可根据自身情况设置。
告警参数
参数名称 参数含义
区域 上报的告警对应的位置信息。
资源池 上报的告警对应的资源池名称。
可用分区 上报的告警对应的可用分区名称。
数据存储类型 上报的告警对应的数据存储类型。
数据存储 上报的告警对应的数据存储名称。
阈值级别 当前上报告警所属的阈值级别。
阈值门限 用户设定上报告警的门限值。
当前值 上报的告警对应的阈值。
对系统的影响
当上报此类阈值告警时，说明对应的资源不足，可能会影响数据存储业务发放。
可能原因
●
数据存储使用率告警阈值设置太低。
●
当前某个位置对应的数据存储资源不足。
处理步骤
步骤1 检查“数据存储使用率”的告警阈值。
1

## Page 728

1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
单击目标告警所在行的 ，展开告警详情，查看告警参数“阈值门限”的值。
3.
在主菜单中选择“运维分析
>
资源分析”。
4.
在左侧导航树单击“资源池分析”。
5. 在左侧导航选择本地云，单击页面右上角的“容量监控配置”。
6.
在左侧导航树中选择“资源池容量阈值维护”，进入“容量阈值维护”页面。
7.
比较步骤1.2中获取的阈值，检查“数据存储使用率”的告警阈值是否合理。
–
是，则剩余可用量过小。
▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
–
否，执行步骤2。
步骤2 重新设置“数据存储使用率”的告警阈值。
1.
单击“操作”列的“修改”，修改告警阈值。
2.
等待10分钟，在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否
清除。
–
是，结束。
–
否，执行如下操作。
▪
华为云Stack场景：执行步骤3，任务结束。
▪
HCS
Online场景：执行步骤4。
步骤3 联系管理员参考《FusionCompute 产品文档》中的“添加主机”章节对数据存储资源
进行扩容。
步骤4 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除告警，无需手工清除。
参考信息
无。
1.3.6
告警管理
1

## Page 729

1.3.6.1 ALM-157
当前告警数量达到阈值
告警解释
当前告警数量达到“业务监控
>
告警监控
>
告警设置”中“当前告警阈值提示”界面
中设定的产生阈值（缺省为85%）时，产生此告警。
当前告警数量低于设定的恢复阈值（缺省为80%）时，则告警自动清除。
告警数量不仅包含当前告警列表展示的数量，同时包含被归并告警、缺省或手动被过
滤的告警等告警数量。
告警属性
告警ID 告警级别 告警类型
157
重要 业务质量告警
告警参数
类
别
参数名称 参数含义
定
位
信
息
告警阈值 用户在配置“当前告警阈值提示”中，设置的该告警的产
生阈值。
当前占用量 当前告警的数量与总容量的占比。
对系统的影响
当产生该告警的时候，若不及时确认或清除不关注的告警，可能会导致用户关注的告
警被系统转为历史告警。
可能原因
●
该告警的产生阈值设置过低。
●
当前告警中积压太多已清除未确认的告警。
●
上报大量告警。
处理步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤2 在左侧导航树中选择“当前告警阈值提示”，查看告警产生阈值是否设置过低，建议
使用缺省阈值。
●
是：调整告警的产生阈值。执行步骤3。
●
否：执行步骤5。
步骤3 1分钟后检查“当前告警数量达到阈值”告警是否清除。
1

## Page 730

●
是：处理完毕。
●
否：执行步骤5。
步骤4 在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。
步骤5 根据已清除状态、级别等条件过滤告警，手工确认不关注的已清除告警。
说明
如果未确认已清除的告警数量过多，检查是否设置了自动确认规则，如果没有，建议设置自动确
认规则，以便对已清除的告警进行自动确认。自动确认规则查看与设置入口：在运维面主菜单中
选择“业务监控
>
告警监控
>
告警设置”。在左侧导航树中选择“自动确认规则”。
步骤6 1分钟后检查“当前告警数量达到阈值”告警是否清除。
●
是：处理完毕。
●
否：执行步骤7。
步骤7 请联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.6.2 ALM-832
同类告警数量超出门限
告警解释
当系统在短时间内上报了多条相同的告警时，用户可通过汇聚规则将此类告警汇聚为
一条“同类告警数量超出门限”告警。在“业务监控
>
告警监控
>
告警设置”的汇聚
规则配置页面中，“汇聚动作”区域的“汇聚告警设置”的“告警源”选择为
“OSS”，当上报的告警符合汇聚规则时，产生该告警。
告警属性
告警ID 告警级别 告警类型
832
重要 处理错误告警
1

## Page 731

告警参数
类
别
参数名称 参数含义
定
位
信
息
规则ID 告警匹配的汇聚规则ID。
源告警信息 产生汇聚告警的源告警信息，包含源告警的名称、源告警
的告警源名称和汇聚规则中设置的关键参数。
保留字段 源告警的告警参数，当存在多个源告警参数时以“&”符
号分隔。
该参数的值在汇聚规则的“定位信息保留字段”中设置，
如果未设置则不显示该参数。
附
加
信
息
汇聚次数 上报源告警的次数。
IP地址 源告警的IP地址。
汇聚类型 取值为告警，表示该同类告警数量超出门限告警是由源告
警汇聚触发。
对系统的影响
影响服务器处理告警的效率。
可能原因
●
汇聚规则中设置的上报阈值过低。
●
网元处于调测状态或出现异常，短时间上报大量告警。
处理步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。
步骤2 在告警列表中单击该告警名称，在弹出的窗口中选择“告警详情和处理建议”页签，
在“其它”区域中查看“告警匹配的规则名”字段。
步骤3 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤4 在左侧导航树中选择“汇聚规则”，检查与步骤2中获取的规则名称一致的规则触发条
件。
●
如果汇聚的触发条件设置不合理，修改设置后在“当前告警”页面选中该汇聚告
警，单击右上角“清除”或单击该汇聚告警操作列中 手工清除汇聚告警，查看
是否重复上报。如果没有重复上报，则处理完毕；如果重复上报，则执行步骤5。
●
如果汇聚的触发条件设置合理，请执行步骤5。
步骤5 检查网元是否处于调测状态。
● 是：当调测结束后，手工清除汇聚告警，查看是否重复上报。如果没有重复上
报，则处理完毕；如果重复上报，则执行步骤6。
●
否：执行步骤6。
1

## Page 732

步骤6 根据附加信息中的源告警信息处理网元故障。
步骤7 检查网元的运行状态是否恢复正常。
●
是：在相应汇聚规则的结束条件的周期结束后，查看告警是否已清除。如果已清
除，则处理完毕；如果未清除，则执行步骤8。
●
否：执行步骤8。
步骤8 请联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.6.3 ALM-132
雪崩告警
告警解释
在“业务监控
>
告警监控
>
告警设置”的闪断/振荡规则配置页面中，当振荡处理策略
选择了产生雪崩告警时，若指定周期内满足规则条件的同一源告警产生次数大于设定
的产生告警数目时，产生该告警；当指定周期内该源告警产生次数小于或等于设定的
产生告警数目时，该告警将会被自动清除。
告警属性
告警ID 告警级别 告警类型
132
重要 处理错误告警
告警参数
类
别
参数名称 参数含义
定
位
信
息
告警名称 产生雪崩告警的源告警名称。
告警源 产生雪崩告警的源告警的告警源。
定位信息 产生雪崩告警的源告警的定位信息。
附
加
信
息
网元地址 告警源的IP地址。
DN
发生告警的网元唯一识别标识。
1

## Page 733

对系统的影响
影响服务器的告警处理效率。
可能原因
●
闪断/振荡规则中振荡策略的触发条件设置不合理。
●
告警源处于调测状态或出现异常，短时间上报大量告警。
处理步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。
步骤2 在告警列表中单击该告警名称，在弹出的窗口中选择“告警详情和处理建议”页签，
在“其它”区域中查看“告警匹配的规则名”字段。
步骤3 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤4 在左侧导航树中选择“闪断/振荡规则”，检查与步骤2中获取的规则名称一致的规则
触发条件。
●
如果触发条件的周期与产生告警数目的比值设置过大（如600秒内产生2条告
警），修改设置后手工清除雪崩告警，查看是否重复上报。如果没有重复上报，
则处理完毕；如果重复上报，则执行步骤5。
●
如果振荡策略设置合理，请执行步骤5。
步骤5 检查网元是否处于调测状态。
●
是：当调测结束后，查看告警是否已清除。如果已清除，则处理完毕；如果未清
除，则执行步骤6。
●
否：执行步骤6。
步骤6 根据附加信息中的源告警信息处理网元故障。
步骤7 检查网元的运行状态是否恢复正常。
●
是：在相应振荡规则的结束条件中的周期结束后，查看告警是否已清除。如果已
清除，则处理完毕；如果未清除，则执行步骤8。
● 否：执行步骤8。
步骤8 请联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 734

1.3.6.4 ALM-100007
告警服务健康检查异常
告警解释
当系统检测到告警满处理、告警分表（历史告警数据表中的告警数量达到上限时，系
统会自动创建一张新的数据表继续存放告警数据）或告警转储任务出现异常时，产生
该告警。
告警属性
告警ID 告警级别 告警类型
100007
重要 业务质量告警
告警参数
类
别
参数名称 参数含义
定
位
信
息
异常类型 引起该告警上报的异常任务类型。
●
满处理或分表任务异常
●
转储任务异常
该参数显示在“定位信息”中。
当前告警最大容
量
数据库中当前告警的最大数量。
该参数显示在“定位信息”中，“异常类型”为“满处理
或分表任务异常”时该参数显示。
异常当前告警最
大容量
“当前告警最大容量”超过系统设置的范围时显示该参
数。
该参数显示在“定位信息”中，“异常类型”为“满处理
或分表任务异常”时该参数显示。
“当前告警最大容量”和“异常当前告警最大容量”参数
只显示其中一个。
当前告警总量 数据库中当前告警的总数量。
该参数显示在“定位信息”中，“异常类型”为“满处理
或分表任务异常”时该参数显示。
非历史告警数量 数据库中非历史告警的总数量。
该参数显示在“定位信息”中，“异常类型”为“满处理
或分表任务异常”时该参数显示。
历史告警数量 数据库中历史告警的总数量。
该参数显示在“定位信息”中，“异常类型”为“满处理
或分表任务异常”时该参数显示。
1

## Page 735

类
别
参数名称 参数含义
数据库总容量 告警数据库总大小。
该参数显示在“定位信息”中，“异常类型”为“转储任
务异常”时该参数显示。
数据库已使用容
量
告警数据库已使用容量大小。
该参数显示在“定位信息”中，“异常类型”为“转储任
务异常”时该参数显示。
数据库使用率 数据库已使用容量与数据库总容量的占比。
该参数显示在“定位信息”中，“异常类型”为“转储任
务异常”时该参数显示。
对系统的影响
●
“当前告警”界面告警数量达到最大值，新上报告警无法显示到“当前告警”界
面。
●
在告警页面进行相关操作时，提示系统繁忙或异常。
可能原因
●
数据库发生异常。
● 分表异常，数据表信息更新错误等。
●
节点磁盘空间不足。
●
转储目录写权限异常。
处理步骤
步骤1 使用PuTTY工具以sopuser用户登录FMService服务所在的节点。
说明
FMService服务所在的节点为ManageOne-Service03/04节点或ManageOne-AppServer0X的任
意一个节点。
步骤2 执行如下命令，切换到root用户。
sudo su root
步骤3 执行如下命令，检查磁盘占用率是否超过80%。
df -k
●
是，执行步骤7。
●
否，执行步骤4。
步骤4 执行如下命令，登录告警自动转储目录。
cd /var/share/oss/product/FMService/alarmdump
1

## Page 736

说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
步骤5 执行如下命令，查看文件夹及文件所属用户是否是ossuser，是否具有写入权限。
ll
●
是，执行步骤6。
●
否，执行步骤7。
步骤6 请在以下路径获取FMService服务的日志。
/var/log/oss/Product/FMService/fmservice-*/log/
说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
步骤7 联系技术支持工程师协助处理。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.7
安全管理
1.3.7.1 ALM-128
远端认证主服务器连接失败告警
告警解释
开启LDAP认证后，运维面或管理面会周期性的检测与LDAP主、备服务器之间的连接
状况，检测周期缺省为五分钟。检测周期可在“远端认证配置”页面设置。在进行
LDAP主、备服务器异常检测时，若主LDAP服务器与运维面或管理面连接失败时上报
该告警。当主LDAP服务器连接恢复时，该告警自动清除。
说明
检测周期可在“LDAP认证”中配置：
1.
在运维面主菜单中选择“系统管理
>
安全管理
>
认证管理”。
2.
在左侧导航树中选择“远端认证配置”。
3.
在“远端认证配置”页面中，单击“LDAP认证”。
4.
配置“服务器异常检测周期（分钟）”。
1

## Page 737

告警属性
告警ID 告警级别 告警类型
128
紧急 环境告警
告警参数
类别 参数名称 参数含义
定位信息 服务器IP 主LDAP服务器地址。
附加信息 服务类型 远端认证的认证方式。
产品类型 当告警源是部署面时，上报告警时
会同时上报该参数。
对系统的影响
启用LDAP认证时，主服务器无法提供认证。
可能原因
● 主LDAP服务器未运行。
●
运维面与主LDAP服务器网络连接中断。
●
管理面与主LDAP服务器网络连接中断。
处理步骤
步骤1 检查主LDAP服务器是否运行正常。
说明
LDAP服务器是认证鉴权的服务器，一般由客户提供，需联系客户管理员检查服务器是否运行正
常。
●
如果主LDAP服务器没有运行，启动主LDAP服务器，执行步骤4。
●
如果主LDAP服务器运行正常，请执行步骤2。
步骤2 检查运维面与主LDAP服务器的网络连接是否正常。
1.
从告警“定位信息”中查看“服务器IP”，即主LDAP服务器地址。
2.
使用PuTTY工具以sopuser用户通过SSH方式登录SM服务包下的user进程或
SMLogLic服务所在节点。获取服务所在节点IP地址的方法请参考《ManageOne
8.1.0
安全管理指南》中的“如何查找服务或微服务所在节点的IP地址”章节。
3.
检查系统与主LDAP服务器的网络连接是否正常，根据主LDAP服务器地址类型选
择如下命令执行。
ping 主LDAP服务器地址
或者
ping6
主LDAP服务器地址
1

## Page 738

系统回显如下类似信息，表示网络连接正常，请按“Ctrl+C”终止ping命令。
64 bytes from 主LDAP服务器地址
命令执行后超过1分钟无返回信息，表示网络连接异常，请按“Ctrl+C”终止ping
命令，并排除网络故障后重试。
步骤3 检查管理面与主LDAP服务器的网络连接是否正常。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录管理节点。
说明
管理节点为ManageOne-SMP01节点或ManageOne-Deploy01节点。
2. 检查系统与主LDAP服务器的网络连接是否正常，根据主LDAP服务器地址类型选
择如下命令执行。
ping 主LDAP服务器地址
或者
ping6 主LDAP服务器地址
系统回显如下类似信息，表示网络连接正常，请按“Ctrl+C”终止ping命令。
64 bytes from
主LDAP服务器地址
命令执行后超过1分钟无返回信息，表示网络连接异常，请按“Ctrl+C”终止ping
命令，并排除网络故障后重试。
步骤4 5分钟后，查看本告警是否清除。
说明
告警清除的时间间隔与“服务器异常检测周期”的值相同，缺省值为5分钟。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.7.2 ALM-160
远端认证备服务器连接失败告警
告警解释
开启LDAP认证后，运维面或管理面会周期性的检测与LDAP主、备服务器之间的连接
状况，检测周期缺省为五分钟。检测周期可在“远端认证配置”页面设置。在进行
LDAP主、备服务器异常检测时，若备LDAP服务器与运维面或管理面之间连接失败时
上报该告警。当备LDAP服务器连接恢复时，该告警自动清除。
1

## Page 739

说明
检测周期可在“LDAP认证”中配置“服务器异常检测周期”：
1.
在运维面主菜单中选择“系统管理
>
安全管理
>
认证管理”。
2.
在左侧导航树中选择“远端认证配置”。
3.
在“远端认证配置”页面中，单击“LDAP认证”。
4.
配置“服务器异常检测周期（分钟）”。
告警属性
告警ID 告警级别 告警类型
160
紧急 环境告警
告警参数
类别 参数名称 参数含义
定位信息 服务器IP 备LDAP服务器地址。
附加信息 服务类型 远端认证的认证方式。
产品类型 当告警源是部署面时，上报告警时会同
时上报该参数。
对系统的影响
若启用LDAP认证时，备服务器无法提供认证。
可能原因
●
备LDAP服务器未运行。
● 运维面与备LDAP服务器网络连接中断。
●
管理面与备LDAP服务器网络连接中断。
处理步骤
步骤1 检查备LDAP服务器是否运行正常。
●
如果备LDAP服务器运行正常，执行步骤2。
●
如果备LDAP服务器没有运行，启动备LDAP服务器，执行步骤4。
说明
LDAP服务器是认证鉴权的服务器，一般由客户提供，需联系客户管理员检查服务器是否运
行正常。
步骤2 检查运维面与备LDAP服务器的网络连接是否正常。
1.
从告警“定位信息”中查看“服务器IP”，即备LDAP服务器地址。
1

## Page 740

2.
使用PuTTY工具以sopuser用户通过SSH方式登录SM服务包下的user进程或
SMLogLic服务所在节点。获取服务所在节点IP地址的方法请参考《ManageOne
8.1.0
安全管理指南》中的“如何查找服务或微服务所在节点的IP地址”章节。
3.
检查系统与备LDAP服务器的网络连接是否正常，根据备LDAP服务器地址类型选
择如下命令执行。
ping
备LDAP服务器地址
或者
ping6
备LDAP服务器地址
系统回显如下类似信息，表示网络连接正常，请按“Ctrl+C”终止命令。
64 bytes from 备LDAP服务器地址
命令执行后超过1分钟无返回信息，表示网络连接异常，请按“Ctrl+C”终止命
令，并排除网络故障后重试。
步骤3 检查管理面与备LDAP服务器的网络连接是否正常。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录管理节点。
说明
管理节点为ManageOne-SMP01节点或ManageOne-Deploy01节点。
2. 检查系统与备LDAP服务器的网络连接是否正常，根据备LDAP服务器地址类型选
择如下命令执行。
ping 备LDAP服务器地址
或者
ping6 备LDAP服务器地址
系统回显如下类似信息，表示网络连接正常，请按“Ctrl+C”终止命令。
64 bytes from
备LDAP服务器地址
命令执行后超过1分钟无返回信息，表示网络连接异常，请按“Ctrl+C”终止命
令，并排除网络故障后重试。
步骤4 5分钟后，查看本告警是否清除。
说明
告警清除的时间间隔与“服务器异常检测周期”的值相同，缺省值为5分钟。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 741

1.3.7.3 ALM-1777670 RADIUS
服务器连接失败告警
告警解释
开启RADIUS认证后，运维面或管理面会每5分钟检测一次与RADIUS主、备服务器之间
的连接状况。在进行RADIUS主、备服务器异常检测时，若运维面或管理面与RADIUS
的主、备服务器连接有异常时上报该告警。
告警属性
告警ID 告警级别 告警类型
1777670
紧急 环境告警
告警参数
类别 参数名称 参数含义
定位信息 服务器IP RADIUS服务器地址。
端口 RADIUS服务器的端口。
附加信息 服务类型 远端认证的认证方式。
产品类型 当告警源是部署面时，上报告警时会同
时上报该参数。
对系统的影响
若启用RADIUS认证时，服务器无法提供认证。
可能原因
●
RADIUS服务器未运行。
●
运维面与RADIUS服务器网络连接中断。
●
管理面与RADIUS服务器网络连接中断。
处理步骤
步骤1 检查RADIUS服务器是否运行正常。
●
如果RADIUS服务器运行正常，执行步骤2。
●
如果RADIUS服务器没有运行，启动RADIUS服务器，执行步骤5。
说明
RADIUS服务器是认证鉴权的服务器，一般由客户提供，需联系客户管理员检查服务器是否
运行正常。
步骤2 从告警“定位信息”中查看“服务器IP”，即RADIUS服务器地址。
1

## Page 742

步骤3 检查运维面与RADIUS服务器的网络连接是否正常。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录SM服务包下的user进程或
SMLogLic服务所在节点。获取服务所在节点IP地址的方法请参考《ManageOne
8.1.0
安全管理指南》中的“如何查找服务或微服务所在节点的IP地址”章节。
2.
检查系统与RADIUS服务器的网络连接是否正常，根据RADIUS服务器地址类型选
择如下命令执行。
ping
RADIUS服务器地址
或者
ping6
RADIUS服务器地址
系统回显如下类似信息，表示网络连接正常，请按“Ctrl+C”终止命令。
64 bytes from RADIUS服务器地址
命令执行后超过1分钟无返回信息，表示网络连接异常，请按“Ctrl+C”终止命
令，并排除网络故障后重试。
步骤4 检查管理面与RADIUS服务器的网络连接是否正常。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录管理节点。
说明
管理节点为ManageOne-SMP01节点或ManageOne-Deploy01节点。
2. 检查系统与RADIUS服务器的网络连接是否正常，根据RADIUS服务器地址类型选
择如下命令执行。
ping RADIUS服务器地址
或者
ping6 RADIUS服务器地址
系统回显如下类似信息，表示网络连接正常，请按“Ctrl+C”终止命令。
64 bytes from
RADIUS服务器地址
命令执行后超过1分钟无返回信息，表示网络连接异常，请按“Ctrl+C”终止命
令，并排除网络故障后重试。
步骤5 5分钟后，查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 743

1.3.7.4 ALM-30004
用户密码即将过期
告警解释
当三方系统接入用户密码和admin用户密码有效时间小于或等于剩余最短时间（缺省
10天）时上报该告警。三方系统接入用户密码和admin用户密码修改后，该告警自动
清除。
说明
●
如果admin用户处于锁定状态，当admin用户的密码即将过期时不会产生该告警。
●
用户密码剩余最短时间可在“密码策略”中设置：
1.
在主菜单中选择“系统
>
安全管理
>
用户策略”。
2.
在左侧导航树中选择“密码策略”。
3.
设置“密码到期提前提示天数”。
告警属性
告警ID 告警级别 告警类型
30004
重要 时间域告警
告警参数
类别 参数名称 参数含义
定位信息 用户名 密码即将过期的用户名称。
附加信息 产品类型 当告警源是管理面时，上报告警时会同时上报
该参数。
对系统的影响
该告警发生时，如果不及时处理，密码过期后，用户将无法登录系统。
可能原因
●
用户密码的剩余有效天数小于等于密码策略中设置的“密码到期提前提示天
数”。
●
用户密码的剩余有效天数小于等于创建用户时设置的“密码到期提前提示天
数”。
处理步骤
步骤1 查看告警“定位信息”字段的值，确认密码即将过期的用户为三方系统接入用户还是
admin用户。
●
三方系统接入用户密码即将过期，执行步骤2。
●
admin用户密码即将过期，执行步骤3。
1

## Page 744

步骤2 联系安全管理员重置密码。
1.
如果是运维面用户，则登录运维面；如果是管理面用户，则登录管理面。
2.
在主菜单中选择“系统
>
安全管理
>
用户管理”。
3.
在左侧导航树中选择“用户”。
4.
在“用户”列表中，单击密码即将过期的三方系统接入用户“操作”列的“重置
密码”，重置用户密码。
5.
重置密码后，执行步骤4。
步骤3 可以通过以下两种方法修改admin用户密码。
●
通过系统提示修改密码。
a.
admin用户可能为部署面admin用户或运维面admin用户，请使用admin用
户依次登录部署面和运维面。
b.
在系统提示界面输入“旧密码”、“新密码”和“确认密码”，单击“应
用”。
●
通过个人设置修改密码。
a.
admin用户可能为部署面admin用户或运维面admin用户，请使用admin用
户依次登录部署面和运维面。
b.
在主菜单中选择“系统
>
系统设置
>
个人设置”。
c.
在“修改密码”页面输入“旧密码”、“新密码”和“确认密码”，单击
“应用”。
步骤4 1小时后，查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.7.5 ALM-30005
用户密码已过期
告警解释
系统中的三方系统接入用户或admin用户密码过期（缺省的密码有效期为180天）时产
生该告警。当系统中的三方系统接入用户或admin用户密码在有效期内时，该告警自
动清除。
1

## Page 745

说明
●
如果admin用户处于锁定状态，当admin用户的密码已过期时不会产生该告警。
●
用户密码有效期可在“密码策略”中设置：
1.
在主菜单中选择“系统
>
安全管理
>
用户策略”。
2. 在左侧导航树中选择“密码策略”。
3.
设置“密码有效天数”。
告警属性
告警ID 告警级别 告警类型
30005
紧急 时间域告警
告警参数
类别 参数名称 参数含义
定位信息 用户名 密码过期的用户名称。
附加信息 产品类型 当告警源是管理面时，上报告警时会同时上报
该参数。
对系统的影响
密码已经过期的用户不能登录系统。
可能原因
三方系统接入用户或者admin用户密码已过期。
处理步骤
步骤1 查看告警“定位信息”字段的值，确认密码已过期的用户为三方系统接入用户还是
admin用户。
●
三方系统接入用户密码已过期，执行步骤2。
●
admin用户密码已过期，执行步骤3。
步骤2 联系安全管理员重置密码。
1.
如果是运维面用户，则登录运维面；如果是管理面用户，则登录管理面。
2.
在主菜单中选择“系统
>
安全管理
>
用户管理”。
3.
在左侧导航树中选择“用户”。
4.
在“用户”列表中，单击密码已过期的三方系统接入用户“操作”列的“重置密
码”，重置用户密码。
5.
重置密码后，执行步骤4。
步骤3 通过系统提示修改密码。
1

## Page 746

1.
admin用户可能为部署面admin用户或运维面admin用户，请使用admin用户依
次登录部署面和运维面。
2.
如果系统提示需要修改密码，在系统提示界面输入“旧密码”、“新密码”和
“确认密码”，单击“应用”。
步骤4 1小时后，查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.7.6 ALM-505001106
登录尝试次数达到最大值
告警解释
当三方系统接入用户通过某个IP地址在指定时间内连续登录失败次数达到最大值（缺
省10分钟内连续输错密码5次）时，产生该告警。
说明
● 三方系统接入用户属于机机帐号，用于运维面与第三方系统对接的用户。
● 三方系统接入用户通过调用接口登录。
●
用户登录尝试次数可在“帐号策略”中配置：
1.
在主菜单中选择“系统
>
安全管理
>
用户策略”。
2.
在左侧导航树中选择“帐号策略”。
3. 配置“启用帐号锁定策略”。
告警属性
告警ID 告警级别 告警类型
505001106
紧急 安全告警
告警参数
类别 参数名称 参数含义
定位信息 用户名 登录失败的用户名称。
附加信息 终端 登录失败的IP地址。
1

## Page 747

类别 参数名称 参数含义
限定时间段长度 限定时间段内连续输入错误密码次数达到最
大值产生该告警。例如，参数“限定时间段
长度”为10分钟，“限定时间段内连续输入
错误密码次数”为5，表示10分钟内连续输入
错误密码5次产生该告警。
限定时间段内连续输
入错误密码次数
对系统的影响
三方系统接入用户在锁定期间无法登录运维面。
可能原因
三方系统接入用户忘记登录密码或非法用户尝试密码登录，上报该告警提醒用户。
处理步骤
步骤1 可选择如下两种方式解锁用户。
●
自动解锁，等待30分钟。
●
手动解锁，请执行步骤2。
步骤2 安全管理员手动解锁用户。
1.
使用安全管理员或系统管理员登录运维面。
2.
在主菜单中选择“系统
>
安全管理
>
用户管理”。
3.
在左侧导航树中选择“用户”。
4.
在“用户”列表中，单击被锁定用户“操作”列的“
>
解锁”，解锁用户。
----结束
告警清除
ADAC：产生该告警后，用户被锁定，解锁后系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.7.7 ALM-100013
用户证书即将过期
告警解释
当证书管理服务根据证书检测周期（缺省值为1天）检测到用户管理对应个人身份证书
的使用期限小于逾期告警阈值（缺省值为30天）时，产生该告警。当用户身份证书成
功更新后，此告警自动消除。
1

## Page 748

告警属性
告警ID 告警级别 告警类型
100013
重要 时间域告警
告警参数
类别 参数名称 参数含义
定位信息 用户名 身份证书即将过期的用户名称。
租户名 用户所属租户的名称。
颁发者 用户身份证书的颁发者。
使用者 用户身份证书的使用者。
有效期从 用户身份证书的生效时间。
有效期到 用户身份证书的到期时间。
对系统的影响
该告警发生时，如果不及时处理，身份证书过期后，用户无法正常使用该证书进行登
录。
可能原因
用户的身份证书即将过期。
处理步骤
步骤1 在告警“定位信息”中查看“用户名”，确认身份证书即将过期的用户名。
步骤2 通知用户更新身份证书。
1.
登录运维面。
2.
在主菜单中选择“系统
>
系统设置
>
个人设置”。
3.
在左侧导航树中选择“修改个人信息”。
4.
单击“证书信息”区域的“更新”，更新用户身份证书。
步骤3 用户身份证书更新成功后，查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 749

参考信息
无。
1.3.7.8 ALM-100014
用户证书过期
告警解释
当系统中证书管理服务根据证书检测周期（缺省值为1天）检测到用户管理对应个人身
份证书过期时，产生该告警。当用户身份证书成功更新后，此告警自动消除。
告警属性
告警ID 告警级别 告警类型
100014
重要 时间域告警
告警参数
类别 参数名称 参数含义
定位信息 用户名 身份证书即将过期的用户名称。
租户名 用户所属租户的名称。
颁发者 用户身份证书的颁发者。
使用者 用户身份证书的使用者。
有效期从 用户身份证书的生效时间。
有效期到 用户身份证书的到期时间。
对系统的影响
当上报此告警后，用户无法正常使用该身份证书进行登录。
可能原因
用户的身份证书已过期。
处理步骤
步骤1 在告警“定位信息”中查看“用户名”，确认身份证书过期的用户名。
步骤2 联系安全管理员更新用户身份证书。
1.
登录运维面。
2.
在主菜单中选择“系统
>
安全管理
>
用户管理”。
3.
在左侧导航树中选择“用户”。
1

## Page 750

4.
在“用户”列表中，搜索用户名。
5.
单击目标用户“操作”列的“
>
更新证书”，更新用户身份证书。
步骤3 用户身份证书更新成功后，查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.8
日志转发
1.3.8.1 ALM-126
切换到备系统日志服务器告警
告警解释
当系统连接日志转发主服务器失败，切换到日志转发备服务器时，上报该告警。当系
统连接日志转发主服务器成功，切换回日志转发主服务器时，清除该告警。
告警属性
告警ID 告警级别 告警类型
126
重要 环境告警
告警参数
参数名称 参数含义
主服务器设备IP 日志转发主服务器IP地址。
主服务器端口号 日志转发主服务器端口。
备服务器设备IP 日志转发备服务器IP地址。
备服务器端口号 日志转发备服务器端口。
对系统的影响
通过Syslog协议转发的日志不再转发到日志转发主服务器，而是转发到日志转发备服
务器。
1

## Page 751

系统自处理过程
系统连接日志转发主服务器失败后，切换到日志转发备服务器。
可能原因
●
日志转发主服务器未运行。
●
系统与日志转发主服务器网络连接中断。
处理步骤
步骤1 检查日志转发主服务器是否运行正常。
●
否，启动日志转发主服务器，执行步骤3。
●
是，请执行步骤2。
说明
日志转发服务器是第三方服务器，检查是否运行正常以及是否启动的方法请参考第三方日
志转发服务器的相关说明。
步骤2 检查系统与日志转发主服务器的网络连接是否正常。
1.
从告警“定位信息”中查看“主服务器设备IP”，即日志转发主服务器IP地址。
2.
使用PuTTY工具以sopuser用户通过SSH方式登录AuditLog服务包下audit进程或
SMLogLic服务所在节点。获取服务所在节点IP地址的方法请参考《ManageOne
8.1.0
安全管理指南》中的“如何查找服务或微服务所在节点的IP地址”章节。
3.
执行如下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户密码
4.
执行以下命令，检查系统与日志转发主服务器的网络连接是否正常。
–
如果IP地址为IPv4格式，执行以下命令：
ping
日志转发主服务器IP地址
–
如果IP地址为IPv6格式，执行以下命令：
ping6
日志转发主服务器IP地址
系统回显如下类似信息，表示网络连接正常，请按“Ctrl+C”终止ping命
令。
64 bytes from
日志转发主服务器IP地址:
icmp_seq=1 ttl=62 time=2.20 ms
命令执行后超过1分钟无返回信息，表示网络连接异常，请按“Ctrl+C”终止
ping命令，并排除网络故障后重试。
步骤3 等待30秒后，查看该告警是否已清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
参考信息
无。
1

## Page 752

1.3.8.2 ALM-127
连接主、备系统日志服务器均失败告警
告警解释
当系统连接主、备日志转发服务器均失败时，上报该告警。当系统连接日志转发主服
务器或日志转发备服务器成功时，清除该告警。
告警属性
告警ID 告警级别 告警类型
127
重要 环境告警
告警参数
参数名称 参数含义
主服务器设备IP 日志转发主服务器IP地址。
主服务器端口号 日志转发主服务器端口。
备服务器设备IP 日志转发备服务器IP地址。
备服务器端口号 日志转发备服务器端口。
对系统的影响
告警发生时，日志无法转发到主、备日志转发服务器上。当系统连接日志转发主服务
器或日志转发备服务器成功时，告警清除，告警发生期间符合转发条件的日志会被转
发到日志转发主服务器或日志转发备服务器上。
系统自处理过程
无。
可能原因
●
主、备日志转发服务器都已停止运行。
●
系统与主、备日志转发服务器网络连接中断。
处理步骤
步骤1 检查日志转发主、备服务器是否运行正常。
●
是，请执行步骤2。
●
否，重新启动主、备日志转发服务器，执行步骤3。
说明
日志转发服务器是第三方服务器，检查是否运行正常以及是否启动的方法请参考第三方日
志转发服务器的相关说明。
1

## Page 753

步骤2 检查系统与主、备日志转发服务器的网络连接是否正常。
1.
从告警“定位信息”中查看“主服务器设备IP”和“备服务器设备IP”，即日志转
发主、备服务器IP地址。
2. 使用PuTTY工具以sopuser用户通过SSH方式登录SMLogLic服务所在节点。获取服
务所在节点IP地址的方法请参考《ManageOne 8.1.0 安全管理指南》中的“如何
查找服务或微服务所在节点的IP地址”章节。
3.
执行如下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户密码
4. 执行以下命令，分别检查系统与日志转发主、备服务器的网络连接是否正常。
–
如果IP地址为IPv4格式，执行以下命令：
ping IP地址
–
如果IP地址为IPv6格式，执行以下命令：
ping6 IP地址
系统回显如下类似信息，表示网络连接正常，请按“Ctrl+C”终止ping命
令。
64 bytes from IP地址: icmp_seq=1 ttl=62 time=2.20 ms
命令执行后超过1分钟无返回信息，表示网络连接异常，请按“Ctrl+C”终止
ping命令，并排除网络故障后重试。
说明
命令和回显信息中的IP地址指的是日志转发主、备服务器IP地址。
步骤3 等待30秒后，查看该告警是否已清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
参考信息
无。
1.3.9
许可管理
1.3.9.1 ALM-99999999961 ManageOne
许可控制项超量
告警解释
当ManageOne许可控制项的使用量已经超过总量时，产生该告警。当ManageOne许
可控制项的使用量小于或等于总量时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
99999999961
紧急 业务质量告警
1

## Page 754

告警参数
参数名称 参数含义
控制项 许可控制项信息
对系统的影响
ManageOne许可控制项超量，可能会导致无法对接云服务或扩容，请及时联系技术支
持工程师获取新的许可并进行更新。
可能原因
ManageOne许可控制项的使用量已经超过总量。
处理步骤
步骤1 确认是否存在已超量的ManageOne许可控制项。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“控制项列表
>
混合云管理服务”。
3.
确认是否存在已超量的许可控制项。
–
是，执行步骤2。
–
否，请联系技术支持工程师处理。
步骤2 联系技术支持工程师申请许可。
●
如果已超量控制项来源有云服务许可，申请云服务许可，申请完成后，执行步骤
3。
●
如果已超量控制项来源只有产品许可（License），申请产品许可（License），申
请完成后，执行步骤4。
步骤3 更新云服务许可。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“云服务许可文件”。
3. 在“云服务许可文件”页面中，单击“更新文件”。
4.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
5.
单击 ，选择要更新的云服务许可文件，并单击“打开”。
6.
单击“上传”。
7.
单击“下一步”，查看云服务许可文件更新前后的结果对比。
8.
单击“下一步”。
须知
更新云服务许可文件属于高危操作，可能会导致系统业务异常，请谨慎操作。
9.
单击“更新生效”，并执行步骤5。
1

## Page 755

步骤4 更新产品许可（License）。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“许可软件列表
>
产品”。
3.
在“产品”页面中，搜索栏选择“产品名称”，在搜索框输入产品许可
（License）控制项所属系统名称，搜索。
4.
单击产品许可（License）控制项所属系统“操作”列的“查看文件”。
5.
单击“更新文件”。
6.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
7.
单击 ，选择要更新的产品许可（License）文件，并单击“打开”。
8. 单击“上传”。
9.
单击“下一步”，查看产品许可（License）更新前后的结果对比。
10.
单击“下一步”，根据需要选择“全量更新”或“增量更新”。
须知
更新产品许可（License）文件属于高危操作，可能会导致系统业务异常，请谨慎
操作。
11.
单击“更新生效”。
步骤5 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.9.2 ALM-99999999962 ManageOne
许可控制项使用量超过阈值
告警解释
如果ManageOne许可控制项已设置发送阈值告警，且使用量超过阈值时，产生该告
警。当ManageOne许可控制项使用量小于或等于阈值或取消发送阈值告警时，该告警
会自动清除。
告警属性
告警ID 告警级别 告警类型
99999999962
紧急 业务质量告警
1

## Page 756

告警参数
参数名称 参数含义
控制项 许可控制项信息
对系统的影响
如果ManageOne许可控制项使用量超过阈值，不及时处理，ManageOne许可控制项
将会超量。ManageOne许可控制项超量可能会导致无法对接云服务或扩容，请及时联
系技术支持工程师获取新的许可并进行更新。
可能原因
ManageOne许可控制项使用量超过阈值。
处理步骤
步骤1 确认是否存在已超阈值的ManageOne许可控制项。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“控制项列表
>
混合云管理服务”。
3.
确认是否存在已超阈值的许可控制项。
–
是，执行步骤2。
–
否，请联系技术支持工程师处理。
步骤2 联系技术支持工程师申请许可。
●
如果已超阈值控制项来源有云服务许可，申请云服务许可，申请完成后，执行步
骤3。
●
如果已超阈值控制项来源只有产品许可（License），申请产品许可（License），
申请完成后，执行步骤4。
步骤3 更新云服务许可。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“云服务许可文件”。
3.
在“云服务许可文件”页面中，单击“更新文件”。
4.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
5.
单击 ，选择要更新的云服务许可文件，并单击“打开”。
6.
单击“上传”。
7.
单击“下一步”，查看云服务许可文件更新前后的结果对比。
8.
单击“下一步”。
须知
更新云服务许可文件属于高危操作，可能会导致系统业务异常，请谨慎操作。
1

## Page 757

9.
单击“更新生效”，并执行步骤5。
步骤4 更新产品许可（License）。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“许可软件列表
>
产品”。
3. 在“产品”页面中，搜索栏选择“产品名称”，搜索当前产品许可（License）控
制项所属的系统名称。
4.
单击许可控制项所属系统“操作”列的“查看文件”。
5.
单击“更新文件”。
6.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
7.
单击 ，选择要更新的产品许可（License）文件，并单击“打开”。
8.
单击“上传”。
9.
单击“下一步”，查看产品许可（License）更新前后的结果对比。
10.
单击“下一步”，根据需要选择“全量更新”或“增量更新”。
须知
更新产品许可（License）文件属于高危操作，可能会导致系统业务异常，请谨慎
操作。
11.
单击“更新生效”。
步骤5 查看本告警是否清除。
●
是，告警处理结束。
● 否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.9.3 ALM-99999999963
云服务许可控制项超期
告警解释
当云服务许可控制项已经超过有效期时，产生该告警。当云服务许可控制项在有效期
内时，该告警会自动清除。
上报此告警之前都会上报一条1.3.9.4
ALM-99999999964
云服务许可控制项即将超
期。上报此告警后，1.3.9.4
ALM-99999999964
云服务许可控制项即将超期的“清除
状态”自动更新为“已清除”。
1

## Page 758

告警属性
告警ID 告警级别 告警类型
99999999963
紧急 业务质量告警
告警参数
参数名称 参数含义
系统 云服务许可所属系统名称
对系统的影响
云服务许可控制项超期，可能会导致无法对接云服务或扩容，请及时联系技术支持工
程师获取新的云服务许可并进行更新。
可能原因
云服务许可控制项已经超过有效期。
处理步骤
步骤1 确认是否存在已超期的云服务许可控制项。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“控制项列表
>
产品和云服务”和“控制项列表
>
混合云管
理服务”。
3.
确认是否存在已超期的云服务许可控制项。
–
是，执行步骤2。
–
否，请联系技术支持工程师处理。
步骤2 联系技术支持工程师申请云服务许可。
步骤3 更新云服务许可。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“云服务许可文件”。
3.
在“云服务许可文件”页面中，单击“更新文件”。
4.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
5.
单击 ，选择要更新的云服务许可文件，并单击“打开”。
6.
单击“上传”。
7.
单击“下一步”，查看云服务许可文件更新前后的结果对比。
8.
单击“下一步”。
1

## Page 759

须知
更新云服务许可文件属于高危操作，可能会导致系统业务异常，请谨慎操作。
9.
单击“更新生效”。
步骤4 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.9.4 ALM-99999999964
云服务许可控制项即将超期
告警解释
当云服务许可控制项即将到达有效期时，产生该告警。当云服务许可控制项的剩余使
用天数大于到期提醒时间或云服务许可控制项已超期时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
99999999964
紧急/重要/次要/提示 业务质量告警
当云服务许可控制项的剩余使用天数分别小于等于90天、60天、30天、15天时，上报
告警的级别分别为提示、次要、重要、紧急。
告警参数
参数名称 参数含义
系统 云服务许可所属系统名称
对系统的影响
该告警上报时，若不及时处理，云服务许可控制项将会超期。云服务许可控制项超期
后，可能会导致无法对接云服务或扩容，请及时联系技术支持工程师获取新的云服务
许可并进行更新。
1

## Page 760

可能原因
云服务许可控制项即将超期。
处理步骤
步骤1 确认是否存在即将超期的云服务许可控制项。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“控制项列表
>
产品和云服务”和“控制项列表
>
混合云管
理服务”。
3.
确认是否存在即将超期的云服务许可控制项。
–
是，执行步骤2。
–
否，请联系技术支持工程师处理。
步骤2 联系技术支持工程师申请云服务许可。
步骤3 更新云服务许可。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“云服务许可文件”。
3.
在“云服务许可文件”页面中，单击“更新文件”。
4.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
5.
单击 ，选择要更新的云服务许可文件，并单击“打开”。
6.
单击“上传”。
7.
单击“下一步”，查看云服务许可文件更新前后的结果对比。
8. 单击“下一步”。
须知
更新云服务许可文件属于高危操作，可能会导致系统业务异常，请谨慎操作。
9.
单击“更新生效”。
步骤4 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
●
此告警修复后，系统会自动清除此告警，无需手工清除。
●
如果此告警在特定时间内没有清除，又满足高级别告警的上报条件，系统就会清
除掉低级别告警，上报一条高级别的告警。例如：当许可控制项的剩余使用天数
小于等于90天时，系统上报一条提示告警，如果没有及时处理，到60天时，系统
会自动清除提示告警，上报一条次要告警。
●
如果云服务许可控制项已经过期，系统会自动清除此告警，上报一条已经过期的
告警。
1

## Page 761

参考信息
无。
1.3.9.5 ALM-99999999965
产品许可控制项超期
告警解释
当产品许可（License）控制项已经超过有效期时，产生该告警。当产品许可
（License）控制项在有效期内时，该告警会自动清除。
上报此告警之前都会上报一条1.3.9.6
ALM-99999999966
产品许可控制项即将超期。
上报此告警后，1.3.9.6
ALM-99999999966
产品许可控制项即将超期的“清除状态”
自动更新为“已清除”。
告警属性
告警ID 告警级别 告警类型
99999999965
紧急 业务质量告警
告警参数
参数名称 参数含义
系统 产品许可（License）所属系统名称
对系统的影响
产品许可（License）控制项超期，可能会导致无法对接云服务或扩容，请及时联系技
术支持工程师获取新的产品许可（License）并进行更新。
可能原因
产品许可（License）控制项已经超过有效期。
处理步骤
步骤1 确认是否存在已超期的产品许可（License）控制项。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“控制项列表
>
产品和云服务”和“控制项列表
>
混合云管
理服务”。
3.
确认是否存在已超期的产品许可（License）控制项。
–
是，执行步骤2。
–
否，请联系技术支持工程师处理。
步骤2 联系技术支持工程师申请产品许可（License）。
1

## Page 762

步骤3 更新产品许可（License）。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“许可软件列表
>
产品”。
3.
在“产品”页面中，搜索栏选择“产品名称”，搜索当前产品许可（License）控
制项所属的系统名称。
4.
单击产品许可（License）控制项所属系统“操作”列的“查看文件”。
5.
单击“更新文件”。
6.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
7.
单击 ，选择要更新的产品许可（License）文件，并单击“打开”。
8. 单击“上传”。
9.
单击“下一步”，查看产品许可（License）更新前后的结果对比。
10.
单击“下一步”，根据需要选择“全量更新”或“增量更新”。
须知
更新产品许可（License）文件属于高危操作，可能会导致系统业务异常，请谨慎
操作。
11.
单击“更新生效”。
步骤4 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.9.6 ALM-99999999966
产品许可控制项即将超期
告警解释
当产品许可（License）控制项即将到达有效期时，产生该告警。当产品许可
（License）控制项的剩余使用天数大于到期提醒时间或产品许可（License）控制项已
超期时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
99999999966
紧急/重要/次要/提示 业务质量告警
1

## Page 763

当产品许可（License）控制项的剩余使用天数分别小于等于90天、60天、30天、15天
时，上报告警的级别分别为提示、次要、重要、紧急。
告警参数
参数名称 参数含义
系统 产品许可（License）所属系统名称
对系统的影响
该告警上报时，若不及时处理，产品许可（License）控制项将会超期。产品许可
（License）控制项超期后，可能会导致无法对接云服务或扩容，请及时联系技术支持
工程师获取新的产品许可（License）并进行更新。
可能原因
产品许可（License）控制项即将过期。
处理步骤
步骤1 确认是否存在即将超期的产品许可（License）控制项。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
在左侧导航树中选择“控制项列表
>
产品和云服务”和“控制项列表
>
混合云管
理服务”。
2.
确认是否存在即将超期的产品许可（License）控制项。
–
是，执行步骤2。
–
否，请联系技术支持工程师处理。
步骤2 联系技术支持工程师申请产品许可（License）。
步骤3 更新产品许可（License）。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“许可软件列表
>
产品”。
3.
在“产品”页面中，搜索栏选择“产品名称”，搜索当前产品许可（License）控
制项所属的系统名称。
4.
单击产品许可（License）控制项所属系统“操作”列的“查看文件”。
5.
单击“更新文件”。
6.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
7.
单击 ，选择要更新的产品许可（License）文件，并单击“打开”。
8.
单击“上传”。
9.
单击“下一步”，查看产品许可（License）更新前后的结果对比。
10.
单击“下一步”，根据需要选择“全量更新”或“增量更新”。
1

## Page 764

须知
更新产品许可（License）文件属于高危操作，可能会导致系统业务异常，请谨慎
操作。
11.
单击“更新生效”。
步骤4 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
●
此告警修复后，系统会自动清除此告警，无需手工清除。
●
如果此告警在特定时间内没有清除，又满足高级别告警的上报条件，系统就会清
除掉低级别告警，上报一条高级别的告警。例如：当许可控制项的剩余使用天数
小于等于90天时，系统上报一条提示告警，如果没有及时处理，到60天时，系统
会自动清除提示告警，上报一条次要告警。
●
如果产品许可（License）控制项已经过期，系统会自动清除此告警，上报一条已
经过期的告警。
参考信息
无。
1.3.9.7 ALM-99999999967
产品维保超期
告警解释
当产品维保已经超过有效期时，产生该告警。当产品维保在有效期内，该告警会自动
清除。
告警属性
告警ID 告警级别 告警类型
99999999967
紧急 业务质量告警
上报此告警之前都会上报一条1.3.9.8
ALM-99999999968
产品维保即将超期。上报此
告警后，1.3.9.8
ALM-99999999968
产品维保即将超期的“清除状态”自动更新为
“已清除”。
告警参数
参数名称 参数含义
系统 产品许可（License）所属系统名称
1

## Page 765

对系统的影响
产品维保已经超过有效期，会影响所属产品的维保服务，请及时联系技术支持工程师
获取新的产品许可（License）并进行更新。
可能原因
产品维保已经超过有效期。
处理步骤
步骤1 确认是否存在维保已超期的产品。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“许可软件列表
>
产品”。
3.
确认是否存在维保已超期的产品。
–
是，执行步骤2。
–
否，请联系技术支持工程师处理。
步骤2 联系技术支持工程师申请产品许可（License）。
步骤3 更新产品许可（License）文件。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“许可软件列表
>
产品”。
3.
在“产品”页面中，搜索栏选择“产品名称”，搜索该产品许可（License）控制
项所属系统的名称。
4.
单击产品许可（License）控制项所属系统“操作”列的“查看文件”。
5.
单击“更新文件”。
6.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
7.
单击 ，选择要更新的产品许可（License）文件，并单击“打开”。
8.
单击“上传”。
9.
单击“下一步”，查看产品许可（License）更新前后的结果对比。
10.
单击“下一步”，根据需要选择“全量更新”或“增量更新”。
须知
更新产品许可（License）文件属于高危操作，可能会导致系统业务异常，请谨慎
操作。
11.
单击“更新生效”。
步骤4 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
1

## Page 766

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.9.8 ALM-99999999968
产品维保即将超期
告警解释
当产品维保即将到达有效期时，产生该告警。当产品维保的剩余天数大于到期提醒时
间或产品维保已超期时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
99999999968 紧急/重要/次要/提示 业务质量告警
当产品维保的剩余天数分别小于等于90天、60天、30天、15天时，上报告警的级别分
别为提示、次要、重要、紧急。
告警参数
参数名称 参数含义
系统 产品许可（License）所属系统名称
对系统的影响
该告警上报后，如果不及时处理，产品维保将超过有效期，会影响所属产品的维保服
务。请及时联系技术支持工程师获取新的产品许可（License）并进行更新。
可能原因
产品维保即将超过有效期。
处理步骤
步骤1 确认是否存在维保即将超期的产品。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“许可软件列表
>
产品”。
3.
确认是否存在维保即将超期的产品。
–
是，执行步骤2。
1

## Page 767

–
否，请联系技术支持工程师处理。
步骤2 联系技术支持工程师申请产品许可（License）。
步骤3 更新产品许可（License）文件。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2. 在左侧导航树中选择“许可软件列表 > 产品”。
3.
在“产品”页面中，搜索栏选择“产品名称”，搜索该产品许可（License）控制
项所属系统的名称。
4.
单击产品许可（License）控制项所属系统“操作”列的“查看文件”。
5.
单击“更新文件”。
6.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
7.
单击 ，选择要更新的产品许可（License）文件，并单击“打开”。
8.
单击“上传”。
9.
单击“下一步”，查看产品许可（License）更新前后的结果对比。
10.
单击“下一步”，根据需要选择“全量更新”或“增量更新”。
须知
更新产品许可（License）文件属于高危操作，可能会导致系统业务异常，请谨慎
操作。
11.
单击“更新生效”。
步骤4 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
●
此告警修复后，系统会自动清除此告警，无需手工清除。
●
如果此告警在特定时间内没有清除，又满足高级别告警的上报条件，系统就会清
除掉低级别告警，上报一条高级别的告警。例如：当产品维保的剩余天数小于等
于90天时，系统上报一条提示告警，如果没有及时处理，到60天时，系统会自动
清除提示告警，上报一条次要告警。
●
产品维保已经过期，系统会自动清除此告警，上报一条已经过期的告警。
参考信息
无。
1.3.9.9 ALM-99999999969
商用永久产品许可未包含维保过期时间
告警解释
当商用永久产品许可（License）未包含维保过期时间时，产生该告警。当商用永久产
品许可（License）包含维保有效期时，该告警会自动清除。
1

## Page 768

告警属性
告警ID 告警级别 告警类型
99999999969
紧急 业务质量告警
告警参数
参数名称 参数含义
系统 产品许可（License）所属系统名称
对系统的影响
商用永久产品许可（License）未包含维保过期时间，可能会影响所属产品的维保服
务，请及时联系技术支持工程师获取新的产品许可（License）并进行更新。
可能原因
商用永久产品许可（License）未包含维保过期时间。
处理步骤
步骤1 在主菜单选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
步骤2 单击目标告警所在行的 ，展开当前告警详情。
步骤3 查看定位信息中“系统”，记录产品许可（License）所属系统的名称。
步骤4 请先联系技术支持工程师激活维保，然后再重新下载当前产品许可（License）。
步骤5 更新产品许可（License）文件。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“许可软件列表
>
产品”。
3.
在“产品”页面中，搜索栏选择“产品名称”，搜索该产品许可（License）控制
项所属系统的名称。
4.
单击产品许可（License）控制项所属系统“操作”列的“查看文件”。
5.
单击“更新文件”。
6.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
7.
单击 ，选择要更新的产品许可（License）文件，并单击“打开”。
8.
单击“上传”。
9.
单击“下一步”，查看产品许可（License）更新前后的结果对比。
10.
单击“下一步”，根据需要选择“全量更新”或“增量更新”。
1

## Page 769

须知
更新产品许可（License）文件属于高危操作，可能会导致系统业务异常，请谨慎
操作。
11.
单击“更新生效”。
步骤6 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.9.10 ALM-99999999970 ManageOne
连接云服务许可系统失败
告警解释
当ManageOne许可管理服务连续三次连接云服务许可系统失败时，产生该告警。当许
可管理服务连接云服务许可系统成功时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
99999999970
紧急 业务质量告警
告警参数
参数名称 参数含义
系统 连接异常的云服务许可系统名称
对系统的影响
ManageOne许可管理服务连接云服务许可系统失败时，会影响许可管理服务展示云服
务许可数据的正确性，请及时联系技术支持工程师处理。
可能原因
ManageOne许可管理服务连续三次连接云服务许可系统失败。
1

## Page 770

处理步骤
步骤1 收集是否存在连接异常的云服务许可系统。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“许可软件列表
>
云服务”。
3.
收集连接状态异常的云服务许可系统。
步骤2 根据步骤1.3中收集到的连接状态异常的云服务许可系统，联系技术支持工程师协助解
决该云服务许可系统的连接失败问题。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.9.11 ALM-99999999971 ManageOne
连接产品许可系统失败
告警解释
当ManageOne许可管理服务连续三次连接产品许可（License）系统失败时，产生该
告警。当许可管理服务连接产品许可（License）系统成功时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
99999999971 紧急 业务质量告警
告警参数
参数名称 参数含义
系统 连接异常的产品许可（License）系统名称
对系统的影响
ManageOne许可管理服务连接产品许可（License）系统失败时，会影响许可管理服
务展示许可数据的正确性，请及时联系技术支持工程师处理。
可能原因
ManageOne许可管理服务连续三次连接产品许可（License）系统失败。
1

## Page 771

处理步骤
步骤1 收集是否存在连接异常的产品许可（License）系统。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2. 在左侧导航树中选择“许可软件列表 > 产品”。
3.
收集连接状态异常的产品许可（License）系统。
步骤2 根据步骤1.3中收集到的连接状态异常的产品许可（License）系统，联系技术支持工程
师协助解决该产品许可（License）系统的连接失败问题。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.9.12 ALM-99999999972
产品处于试用期
告警解释
当产品处于试用期时，产生该告警。当产品导入产品许可（License）后，该告警会自
动清除。
告警属性
告警ID 告警级别 告警类型
99999999972
重要 业务质量告警
告警参数
参数名称 参数含义
系统 产品许可（License）所属系统名称
试用期 产品的试用期时间
对系统的影响
产品处于试用期，过期后将无法使用。
可能原因
产品处于试用期。
1

## Page 772

处理步骤
步骤1 联系技术支持工程师申请产品许可（License）。
步骤2 更新产品许可（License）。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“许可软件列表
>
产品”。
3.
在“产品”页面中，搜索栏选择“产品名称”，搜索当前产品许可（License）控
制项所属的系统名称。
4.
单击产品许可（License）控制项所属系统“操作”列的“查看文件”。
5.
单击“更新文件”。
6.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
7.
单击 ，选择要更新的产品许可（License）文件，并单击“打开”。
8.
单击“上传”。
9.
单击“下一步”，查看产品许可（License）更新前后的结果对比。
10.
单击“下一步”，根据需要选择“全量更新”或“增量更新”。
说明
更新产品许可（License）文件属于高危操作，可能会导致系统业务异常，请谨慎操作。
11. 单击“更新生效”。
步骤3 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.9.13 ALM-99999999973
产品试用期超期
告警解释
当产品超过试用期时，产生该告警。当产品导入产品许可（License）后，该告警会自
动清除。
上报此告警之前都会上报一条
ALM-99999999972
产品处于试用期。上报此告警后，
ALM-99999999972
产品处于试用期的“清除状态”自动更新为“已清除”。
1

## Page 773

告警属性
告警ID 告警级别 告警类型
99999999973
紧急 业务质量告警
告警参数
参数名称 参数含义
系统 产品许可（License）所属系统名称
试用期 产品的试用期时间
对系统的影响
产品试用期超期后将无法使用。
可能原因
产品试用期超期。
处理步骤
步骤1 联系技术支持工程师申请产品许可（License）。
步骤2 更新产品许可（License）。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“许可软件列表
>
产品”。
3.
在“产品”页面中，搜索栏选择“产品名称”，搜索当前产品许可（License）控
制项所属的系统名称。
4.
单击产品许可（License）控制项所属系统“操作”列的“查看文件”。
5.
单击“更新文件”。
6.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
7.
单击 ，选择要更新的产品许可（License）文件，并单击“打开”。
8.
单击“上传”。
9.
单击“下一步”，查看产品许可（License）更新前后的结果对比。
10. 单击“下一步”，根据需要选择“全量更新”或“增量更新”。
说明
更新产品许可（License）文件属于高危操作，可能会导致系统业务异常，请谨慎操作。
11.
单击“更新生效”。
步骤3 查看本告警是否清除。
●
是，告警处理结束。
1

## Page 774

●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.9.14 ALM-99999999974
云服务处于试用期
告警解释
云服务处于试用期时，产生该告警。当导入包含对应云服务许可控制项的云服务许可
后，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
99999999974
重要 业务质量告警
告警参数
参数名称 参数含义
系统 云服务许可所属系统名称
试用期 云服务的试用期时间
对系统的影响
云服务试用期过期后，云服务将无法使用。
可能原因
云服务处于试用期。
处理步骤
步骤1 联系技术支持工程师申请云服务许可。
步骤2 更新云服务许可。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“云服务许可文件”。
1

## Page 775

3.
在“云服务许可文件”页面中，单击“更新文件”。
4.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
5.
单击 ，选择要更新的云服务许可文件，并单击“打开”。
6.
单击“上传”。
7.
单击“下一步”，查看云服务许可文件更新前后的结果对比。
8.
单击“下一步”。
说明
更新云服务许可文件属于高危操作，可能会导致系统业务异常，请谨慎操作。
9.
单击“更新生效”。
步骤3 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.9.15 ALM-99999999975
云服务试用期超期
告警解释
云服务试用期超期时，产生该告警。当导入包含对应云服务许可控制项的云服务许可
后，该告警会自动清除。
上报此告警之前都会上报一条
ALM-99999999974
云服务处于试用期。上报此告警
后，ALM-99999999974 云服务处于试用期的“清除状态”自动更新为“已清除”。
告警属性
告警ID 告警级别 告警类型
99999999975
紧急 业务质量告警
告警参数
参数名称 参数含义
系统 云服务许可所属系统名称
试用期 云服务的试用期时间
1

## Page 776

对系统的影响
云服务试用期过期后，云服务将无法使用。
可能原因
云服务试用期超期。
处理步骤
步骤1 联系技术支持工程师申请云服务许可。
步骤2 更新云服务许可。
1.
在主菜单选择“系统管理
>
系统设置
>
许可管理”。
2.
在左侧导航树中选择“云服务许可文件”。
3.
在“云服务许可文件”页面中，单击“更新文件”。
4.
在界面弹出的风险信息提示框中输入当前操作用户的密码，单击“确认”。
5.
单击 ，选择要更新的云服务许可文件，并单击“打开”。
6.
单击“上传”。
7.
单击“下一步”，查看云服务许可文件更新前后的结果对比。
8.
单击“下一步”。
说明
更新云服务许可文件属于高危操作，可能会导致系统业务异常，请谨慎操作。
9.
单击“更新生效”。
步骤3 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师处理。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.10
远程通知管理
1.3.10.1 ALM-505001111
远程通知发送失败
告警解释
当设置了系统与远程通知短消息或邮箱服务器对接参数并启用时，远程通知短消息或
邮件发送失败才会产生该告警。该告警需手工清除。
1

## Page 777

说明
ManageOne在虚拟化部署形态下，不支持短信猫功能。
告警属性
告警ID 告警级别 告警类型
505001111
重要 通信告警
告警参数
类别 参数名称 参数含义
定位
信息
通知方式 发送远程通知的方式。
附加
信息
通知内容 发送失败的远程通知内容。
通知失败接收用户 发送远程通知失败的接收用户，取部
分接收用户并做匿名化处理。
对系统的影响
指定用户接收不到远程通知短消息或邮件。
可能原因
●
节点和短信网关服务器、邮箱服务器的网络连接异常。
●
通讯参数（如短信网关协议参数、邮箱设置参数等）设置有误。
处理步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录HomePageNoticeService服务节点。
步骤2 执行如下命令，测试HomePageNoticeService服务节点和服务器的连通性。
●
如果IP地址为IPv4：
ping 服务器IP地址
●
如果IP地址为IPv6：
ping6 服务器IP地址
说明
如果通过短消息方式发送远程通知，命令中的服务器IP地址为短信网关服务器的IP地址。
如果通过邮件方式发送远程通知，命令中的服务器IP地址为邮箱服务器的IP地址。
查看系统回显信息：
●
如果回显如下类似信息，表示可以ping通，说明网络连接正常。
64 bytes from 服务器IP地址: icmp_seq=1 ttl=251 time=42.1 ms
1

## Page 778

●
如果等待1分钟无回显信息，说明网络连接异常，请联系管理员检查并恢复网络。
步骤3 按“Ctrl+C”终止ping命令。
步骤4 执行如下命令，检查配置的端口。
ssh -v -p
端口号 服务器IP地址
说明
如果通过短消息方式发送远程通知，命令中的端口号为短信网关配置的端口号，服务器IP地址为
短信网关服务器的IP地址。
如果通过邮件方式发送远程通知，命令中的端口号为邮箱服务器配置的端口号，服务器IP地址为
邮箱服务器的IP地址。
如果回显如下类似信息，表示连接正常，请执行步骤5。
debug1: Connection established.
如果回显如下类似信息，表示连接失败，请联系管理员检查短信网关或者邮箱服务器
防火墙白名单是否配置了端口号。
Connection refused
说明
如果运维面的部署模式是集群模式，即存在多个服务部署节点，则需要保证每个节点都能连通。
步骤5 在运维面主菜单中选择“业务监控
>
告警监控
>
告警设置”。
步骤6 在左侧导航树中选择“远程通知规则”，查看是否已设置并启用了远程通知规则。
●
如果没有设置或没有启用，请执行步骤7。
●
如果已设置且已启用，请执行步骤8。
步骤7 检查远程通知的通知用户、通知用户组中设置的短消息、邮箱的接收号码、接收地址
是否正确。
●
如果不正确，修改为正确的短消息接收号码或邮件接收地址，再执行步骤8。
●
如果正确，请执行步骤8。
步骤8 在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。
步骤9 在当前告警页面查找并单击“远程通知发送失败”告警名称，在弹出的基本信息页面
查看“定位信息”和“附加信息”。
●
如果“定位信息”显示为“通知方式=短消息”，请检查短消息或者短信猫设置是
否正常，“附加信息”显示消息接收人，请执行步骤10和步骤11。
●
如果“定位信息”显示为“通知方式=邮件”，“附加信息”显示邮件接收人，请
执行步骤10～步骤12。
说明
此告警的定位信息包含远程通知短消息或邮件的内容，最多255个字符。
步骤10 在运维面主菜单中选择“系统 > 系统设置 > 远程通知”。
步骤11 根据短消息发送方式进行测试。
1

## Page 779

短消息
发送方
式
测试方法 测
试
成
功
连接失败
短信网
关
在左侧导航树中选择“短消息设置
>
短信网
关设置”、“短消息设置
>
协议参数设
置”，确认短信网关设置和协议参数设置是
否配置正确，并根据步骤9获取“附加信
息”的短消息接收人，在短信网关设置页面
设置接收短消息号码，单击“测试”，测试
连接短消息服务器是否正常。
操
作
结
束
收集上述告警处理
过程中的信息，联
系华为技术支持工
程师。
短信猫 在左侧导航树中选择“短信猫设置”，并根
据步骤9获取“附加信息”的短消息接收
人，设置接收短消息号码，单击“测试”，
测试连接短信猫是否正常。
步骤12 在左侧导航树中选择“邮箱设置”，查看邮箱设置是否正常，单击“测试”，查看连
接邮箱服务器是否正常。
●
如果测试成功，需根据步骤9获取“附加信息”的邮件接收人确认邮箱地址是否正
确。
●
如果连接失败，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
告警清除
ADMC：必须手工清除告警。
参考信息
无。
1.3.10.2 ALM-103400
远程通知服务证书即将过期
告警解释
系统每24小时对远程通知服务器（短消息服务器和邮箱服务器）证书进行一次检测，
当远程通知服务器证书文件的剩余使用天数小于等于30天时，会产生该告警。
告警属性
告警ID 告警级别 告警类型
103400
重要 时间域告警
1

## Page 780

告警参数
类别 参数名称 参数含义
定位
信息
通知服务器类型 包括短消息服务器和邮箱服务器。
证书颁发者 远程通知短消息服务器证书和邮箱服
务器证书颁发者。
附加
信息
距离过期剩余天数 距离远程通知短消息服务器证书和邮
箱服务器证书过期还剩余的天数。
有效期到 远程通知短消息服务器证书和邮箱服
务器证书过期时间。
对系统的影响
该告警发生时，若不及时处理，短消息服务器证书和邮箱服务器证书将会过期，导致
远程通知无法通过短消息服务器和邮箱服务器发送短消息和邮件。
可能原因
短消息服务器和邮箱服务器已配置证书，且证书即将过期（距离过期时间小于等于30
天）。
处理步骤
步骤1 获取短消息服务器证书和邮箱服务器证书并转化证书格式，再对证书密钥库进行加
密。
1.
获取短消息服务器和邮箱服务器SSL/TLS证书，将证书保存在PC中。
说明
–
短消息服务器证书请从第三方短消息服务器获取。
– 短消息服务器证书用于系统和短消息服务器之间的双向认证，只有双方均信任此证书，
双方才能成功连通。
–
邮箱服务器证书用于系统和邮箱服务器之间的双向认证，只有双方均信任此证书，双方
才能成功连通。
–
为了保证数据的安全性，远程通知支持使用SHA256withRSA、SHA384withRSA或者
SHA512withRSA签名算法生成的证书。
2.
按“win+R”键，打开“运行”窗口，输入“CMD”，单击“确定”。
3.
执行如下命令，进入keytool工具所在目录。
cd /d
keytool工具所在目录
说明
keytool工具是JRE（Java
Runtime
Environment）命令。用户需要在官网（https://
adoptopenjdk.net/releases.html）自行下载JRE，选择OpenJDK8 (LTS)版本的JRE安装
包并解压安装，keytool工具所在目录一般为“JRE安装路径\bin”。
4.
执行如下命令转换证书格式，并对密钥库进行加密。
keytool -importcert -file
原证书存放路径\原证书名称
-keystore
格式转换后证
书存放路径\格式转换后的证书名称
1

## Page 781

Enter keystore Password:
Reenter New Password:
格式转换后的证书名称扩展名为.keystore，请牢记此处设置的密码，导入证书时
需填写该密码。
说明
密钥库密码需要用户自行设置，密码长度不能少于6个字符，且不超过32个字符。为了安
全起见，建议密钥库密码符合如下复杂度要求：
–
密码不能包含用户名或者用户名的倒序。
–
至少包括一个大写字母（A~Z），一个小写字母（a~z），一个数字字符（0~9）。
–
至少包括1个特殊字符（包括!"#$%&'()*+,-./:;<=>?@[\]^`{_|}~ 以及空格）。
步骤2 在运维面主菜单中选择“系统
>
系统设置
>
远程通知”。
步骤3 配置短消息服务器证书和邮箱服务器证书。
●
配置短消息服务器证书
a.
在左侧导航树选择“短消息设置
>
短信网关设置”。
b.
单击“配置证书”。
c.
在“配置证书”窗口中，单击“证书文件”后的 ，选择格式转换后的证
书，输入1.d中设置的密钥库的密码。
d.
单击“保存”，完成证书的导入。
●
配置邮箱服务器证书
a.
在左侧导航树选择“邮箱设置”。
b.
单击“配置证书”。
c.
在“配置证书”窗口中，单击“证书文件”后的 ，选择格式转换后的证
书，输入1.d中设置的密钥库的密码。
d.
单击“保存”，完成证书的导入。
步骤4 查看该告警是否已清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.10.3 ALM-103401
远程通知服务证书已经过期
告警解释
系统每24小时对远程通知服务器（短消息服务器和邮箱服务器）证书进行一次检测，
当远程通知服务器证书文件已经过期时，会产生该告警。
1

## Page 782

告警属性
告警ID 告警级别 告警类型
103401
重要 时间域告警
告警参数
类别 参数名称 参数含义
定位
信息
通知服务器类型 包括短消息服务器和邮箱服务器。
证书颁发者 远程通知短消息服务器证书和邮箱服
务器证书颁发者。
附加
信息
已过期天数 远程通知短消息服务器证书和邮箱服
务器证书已过期的天数。
有效期到 远程通知短消息服务器证书和邮箱服
务器证书过期时间。
对系统的影响
短消息服务器证书和邮箱服务器证书已经过期，会导致远程通知连接短消息服务器和
邮箱服务器失败，无法发送短消息和邮件。
可能原因
短消息服务器和邮箱服务器已配置证书，且短消息服务器证书和邮箱服务器证书已经
过期。
处理步骤
步骤1 获取短消息服务器证书和邮箱服务器证书并转化证书格式，再对证书密钥库进行加
密。
1.
获取短消息服务器和邮箱服务器SSL/TLS证书，将证书保存在PC中。
说明
–
短消息服务器证书请从第三方短消息服务器获取。
–
短消息服务器证书用于系统和短消息服务器之间的双向认证，只有双方均信任此证书，
双方才能成功连通。
– 邮箱服务器证书用于系统和邮箱服务器之间的双向认证，只有双方均信任此证书，双方
才能成功连通。
–
为了保证数据的安全性，远程通知支持使用SHA256withRSA、SHA384withRSA或者
SHA512withRSA签名算法生成的证书。
2.
按“win+R”键，打开“运行”窗口，输入“CMD”，单击“确定”。
3.
执行如下命令，进入keytool工具所在目录。
cd /d
keytool工具所在目录
1

## Page 783

说明
keytool工具是JRE（Java Runtime Environment）命令。用户需要在官网（https://
adoptopenjdk.net/releases.html）自行下载JRE，选择OpenJDK8 (LTS)版本的JRE安装
包并解压安装，keytool工具所在目录一般为“JRE安装路径\bin”。
4.
执行如下命令转换证书格式，并对密钥库进行加密。
keytool -importcert -file
原证书存放路径\原证书名称
-keystore
格式转换后证
书存放路径\格式转换后的证书名称
Enter keystore Password:
Reenter New Password:
格式转换后的证书名称扩展名为.keystore，请牢记此处设置的密码，导入证书时
需填写该密码。
说明
密钥库密码需要用户自行设置，密码长度不能少于6个字符，且不超过32个字符。为了安
全起见，建议密钥库密码符合如下复杂度要求：
–
密码不能包含用户名或者用户名的倒序。
–
至少包括一个大写字母（A~Z），一个小写字母（a~z），一个数字字符（0~9）。
– 至少包括1个特殊字符（包括!"#$%&'()*+,-./:;<=>?@[\]^`{_|}~ 以及空格）。
步骤2 在运维面主菜单中选择“系统
>
系统设置
>
远程通知”。
步骤3 配置短消息服务器证书和邮箱服务器证书。
●
配置短消息服务器证书
a.
在左侧导航树选择“短消息设置
>
短信网关设置”。
b.
单击“配置证书”。
c.
在“配置证书”窗口中，单击“证书文件”后的 ，选择格式转换后的证
书，输入1.d中设置的密钥库的密码。
d.
单击“保存”，完成证书的导入。
●
配置邮箱服务器证书
a.
在左侧导航树选择“邮箱设置”。
b.
单击“配置证书”。
c.
在“配置证书”窗口中，单击“证书文件”后的 ，选择格式转换后的证
书，输入1.d中设置的密钥库的密码。
d.
单击“保存”，完成证书的导入。
步骤4 查看该告警是否已清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 784

1.3.11
系统维护
1.3.11.1 ALM-MOMaintenanceService_100103
证书即将过期
告警解释
系统维护定时检测IR证书过期情况，当过期时间距离当前时间间隔小于等于30天时，
产生此告警，告警级别为重要，当过期时间距离当前时间间隔小于等于7天时，告警级
别为紧急。
告警属性
告警ID 告警级别 告警类型
MOMaintenance
Service_100103
紧急/重要 环境告警
告警参数
参数名称 参数含义
节点IP地址 被检测证书所在节点的IP地址。
证书服务名称 被检测的证书的服务名称。
证书即将过期天数 被检测的证书即将过期的天数。
对系统的影响
IR证书过期不可用，影响业务功能的正常运行。
可能原因
IR证书即将过期。
处理步骤
步骤1 检查IR证书过期时间距离当前时间是否小于等于30天或小于等于7天。
1.
使用PuTTY，登录告警发生所在节点。在该告警的“定位信息”列获取告警发生
的节点IP。
默认帐户：sopuser。
默认密码：请参考《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签
中，ManageOne产品中该帐户的默认密码。
2.
执行如下命令，切换至ossadm帐户。
su - ossadm
默认密码：请参考《华为云Stack
8.1.0
帐户一览表》中“B类（ManageOne）”
页签中该帐户的默认密码。
1

## Page 785

3.
执行openssl命令，查看IR身份证书和信任证书过期时间。例如，查看server.cer证
书的到期时间，执行如下命令。
openssl x509 -enddate -noout -in /opt/oss/manager/etc/ssl/internal/
server.cer
回显信息如下，表示该证书到期时间为2028年6月10日，凌晨0点0分0秒。
notAfter=Jun 10 00:00:00 2028 GMT
4.
计算证书到期时间距离当前时间是否小于等于30天或小于等于7天。
–
是，执行步骤2。
–
否，执行步骤4。
步骤2 请参见《ManageOne
8.1.0
安全管理指南》文档中的“更换IR证书”，更新证书。
步骤3 待凌晨一点自动执行证书过期检查之后，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤4。
步骤4 请收集上述告警处理过程中的信息，联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.11.2 ALM-MOMaintenanceService_100106
证书即将过期
告警解释
系统维护定时检测CA证书过期情况，当到期时间距离当前时间间隔小于等于30天时，
产生此告警，告警级别为重要，当到期时间距离当前时间间隔小于等于7天时，告警级
别为紧急。
告警属性
告警ID 告警级别 告警类型
MOMaintenance
Service_100106
紧急/重要 环境告警
告警参数
参数名称 参数含义
节点IP地址 被检测证书所在节点的IP地址。
1

## Page 786

参数名称 参数含义
证书服务名称 被检测的证书服务名称。
证书即将过期天数 被检测的证书即将过期的天数。
对系统的影响
CA证书过期不可用，影响业务功能的正常运行。
可能原因
CA证书即将过期。
处理步骤
步骤1 检查CA证书过期时间距离当前时间是否小于等于30天或小于等于7天。
1.
使用PuTTY，登录告警发生所在节点。在该告警的“定位信息”列获取告警发生
的节点IP。
默认帐户：sopuser。
默认密码：请参考《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签
中，ManageOne产品中该帐户的默认密码。
2.
执行如下命令，切换至ossadm帐户。
su - ossadm
默认密码：请参考《华为云Stack
8.1.0
帐户一览表》中“B类（ManageOne）”
页签中该帐户的默认密码。
3.
执行openssl命令，查看CA身份证书和信任证书过期时间。例如，查看ca.cer证书
的到期时间，执行如下命令。
openssl x509 -enddate -noout -in /opt/oss/manager/var/ca/ca.cer
回显信息如下，表示该证书到期时间为2032年6月10日，凌晨0点0分0秒 。
notAfter=Jun 10 00:00:00 2032 GMT
4.
计算证书到期时间距离当前时间是否小于等于30天或小于等于7天。
–
是，执行步骤2。
–
否，执行步骤4。
步骤2 请参见《ManageOne
8.1.0
安全管理指南》文档的“上传并更换ManageOne的CA证
书（异地容灾场景）”或“上传并更换ManageOne的CA证书（非异地容灾场
景）”，更新证书。
步骤3 待凌晨一点自动执行证书过期检查之后，查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤4。
步骤4 请收集上述告警处理过程中的信息，联系技术支持工程师协助解决。
----结束
1

## Page 787

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.12
服务监控
1.3.12.1
系统类
系统类告警对应的服务监控模板ID为“os_template”。
1.3.12.1.1 ALM-1000001002
NTP同步状态阈值告警
告警解释
时间管理模块按设置的时间同步周期，从上级NTP时间服务器同步时间，同步失败时
上报此告警。
告警属性
告警ID 告警级别 告警类型
1000001002
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（虚拟机）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
对系统的影响
节点无法从上级NTP服务器同步时间。
可能原因
●
节点的时间同步服务异常。
●
节点与上级NTP时间服务器网络连接异常。
●
节点与上级NTP时间服务器时间差异大于1分钟。
1

## Page 788

处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 使用以下命令，确认上报告警的服务类型。
ps -ef|grep ntpd|grep -v grep
●
如果没有回显信息，请使用表1-54中ManageOne的处理步骤。
[root@MOC-ManageOne-Service01 log]# ps -ef|grep ntpd|grep -v grep
[root@MOC-ManageOne-Service01 log]#
●
如果有回显信息，请使用表1-54中其他云服务的处理步骤。
[root@APIGWLB01 fsp]# ps -ef|grep ntpd|grep -v grep
ntp 827 1 0 Oct21 ? 00:00:19 /usr/sbin/ntpd -u ntp:ntp -g
步骤4 根据步骤3中查找的服务类型，参考表1-54处理告警。
表1-54 服务类型与操作步骤
服务类型 操作步骤
ManageOne 1. 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地
址:31945。例如，https://192.168.0.1:31945。
默认帐号：admin。
2. 执行以下步骤，强制同步时区时间。
a. 在部署面主菜单中选择“维护 > 时间管理 > 配置时区
时间”。
b. 在“配置时区时间”界面，单击“强制同步”。
说明
强制同步时区时间前部署面会自动停止产品服务和产品数据
库，导致该服务涉及功能不可用，强制同步时区时间完成后系
统会自动启动产品数据库和产品服务，功能即可恢复。
c. 在部署面主菜单选择“系统 > 任务列表”，等待“强制
同步时区时间”任务执行成功。
3. 等待10分钟，在“当前告警”中查看告警是否清除，如果
告警未清除，请联系技术支持工程师协助解决。
1

## Page 789

服务类型 操作步骤
其他云服务
1.
检查是否有上级NTP时间服务器组配置。
cat /etc/ntp.conf |grep server|grep -v "#"
server 192.168.20.10 key 10000 true
server 192.168.20.11 key 10000
–
是，执行步骤4.2。
–
否，请联系技术支持工程师协助解决。
2.
重启NTP服务。
/usr/bin/systemctl restart ntpd
3.
等待10分钟，在“当前告警”中查看告警是否清除，如果
告警未清除，请联系技术支持工程师协助解决。
----结束
告警清除
从上级NTP时间服务器同步时间成功后，此告警自动清除。
参考信息
无。
1.3.12.1.2 ALM-1000001003
NTP偏移阈值告警
告警解释
时间管理模块监测到节点时间被修改，同时修改的时间超出了节点允许的时间调整阈
值时，系统产生此告警。
说明
时间调整阈值指上级NTP时间服务器和当前节点存在的时间差。
告警属性
告警ID 告警级别 告警类型
1000001003
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（虚拟机）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
1

## Page 790

对系统的影响
节点无法从上级NTP服务器同步时间。
可能原因
节点的时间被手动修改。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 使用以下命令，确认上报告警的服务类型。
ps -ef|grep ntpd|grep -v grep
●
如果没有回显信息，请使用表1-55中ManageOne的处理步骤。
[root@MOC-ManageOne-Service01 log]# ps -ef|grep ntpd|grep -v grep
[root@MOC-ManageOne-Service01 log]#
●
如果有回显信息，请使用表1-55中其他云服务的处理步骤。
[root@APIGWLB01 fsp]# ps -ef|grep ntpd|grep -v grep
ntp 827 1 0 Oct21 ? 00:00:19 /usr/sbin/ntpd -u ntp:ntp -g
步骤4 根据步骤3中查找的服务类型，参考表1-55处理告警。
1

## Page 791

表1-55 服务类型与操作步骤
服务类型 操作步骤
ManageOne 1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地
址:31945。例如，https://192.168.0.1:31945。
默认帐号：admin。
2.
执行以下步骤，强制同步时区时间。
a.
在部署面主菜单中选择“维护
>
时间管理
>
配置时区
时间”。
b.
在“配置时区时间”界面，单击“强制同步”。
说明
强制同步时区时间前部署面会自动停止产品服务和产品数据
库，导致该服务涉及功能不可用，强制同步时区时间完成后系
统会自动启动产品数据库和产品服务，功能即可恢复。
c.
在部署面主菜单选择“系统
>
任务列表”，等待“强制
同步时区时间”任务执行成功。
3.
执行完强制同步时区时间操作后等待大约1～15分钟，检
查告警是否清除。
–
是，结束。
–
否，请联系技术支持工程师处理。
其他云服务
1.
检查是否有带“*”的上级NTP时间服务器配置。
ntpq -p | grep "*"
remote refid st t when poll reach delay offset jitter
==========================================================
====================
*192.168.20.11 192.168.20.22 9 u 264 1024 377 0.211
0.193 1.314
–
是，执行步骤4.3。
–
否，请联系技术支持工程师协助解决。
2.
检查是否有上级NTP时间服务器组配置。
cat /etc/ntp.conf |grep server|grep -v "#"
server 192.168.20.10 key 10000 true
server 192.168.20.11 key 10000
–
是，执行步骤4.3。
–
否，请联系技术支持工程师协助解决。
3.
重启NTP服务。
/usr/bin/systemctl restart ntpd
4.
等待10分钟，检查偏移量，“offset”列的值是否小于所
配置的阈值。
ntpq -p
remote refid st t when poll reach delay offset jitter
==========================================================
==========================
*192.168.20.10 192.168.20.63 9 u 550 1024 377 0.150
0.290 0.604
+192.168.20.11 192.168.20.64 9 u 386 1024 377 0.210
0.511 0.765
–
是，结束。
–
否，请联系技术支持工程师协助解决。
1

## Page 792

----结束
告警清除
NTP偏移量小于自定义阈值时，此告警自动清除。
参考信息
无。
1.3.12.1.3 ALM-1000001004
节点心跳中断
告警解释
MOICAgent监控云服务以及ManageOne自身服务、收集云服务日志、备份
ManageOne数据库。MOICAgent定时上报心跳消息，若心跳中断，同时MOICAgent
服务无法通过Ping命令联系到对端节点，此现象时长超出阈值时，产生此告警。
说明
HCS
Online场景下，服务监控不支持监控IaaS OpenStack资源池下的云服务系统。
告警属性
告警ID 告警级别 告警类型
1000001004
紧急 通信告警
告警参数
参数名称 参数含义
被监控节点IP MOICAgentMgmtService监控的异常节点的IP地址。
监控节点IP 部署MOICAgentMgmtService所在节点的IP地址。
对系统的影响
●
MOICAgentMgmtService无法采集异常节点服务。
●
MOICAgentMgmtService无法收集异常节点服务日志。
●
异常节点所部署的服务可能运行异常。
可能原因
网络故障或者节点故障。
1

## Page 793

处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，过滤出当前告警，单击 ，查看告警详情中的“定位信息”。
●
查看“被监控节点IP”的值，以获取异常节点的IP地址。
●
查看“监控节点IP”的值，以获取MOICAgentMgmtService服务所在节点的IP地
址。
步骤4 在主菜单，单击“首页”。
在“常用链接”中，单击“Service OM”，选择区域名称，进入Service OM系统。
步骤5 在主菜单，选择“服务列表
>
资源
>
计算资源”，进入计算资源页面。
步骤6 单击“主机”或“虚拟机”，进入资源列表页面。
步骤7 在列表中，依据“IP地址”过滤出异常节点，分别确认主机节点的“状态”是否为
“正常”，虚拟机节点的“状态”对应的值是否均为“运行中”。
●
是，执行步骤8。
●
否，执行步骤10。
步骤8 使用Putty工具以具有登录权限的系统用户登录MOICAgentMgmtService服务所在节
点，切换到ossuser用户。
1.
使用sopuser用户登录MOICAgentMgmtService服务所在节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“sopuser”对应的默认密码。
2.
执行如下命令，切换root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“root”对应的默认密码。
3.
切换到ossuser用户。
su ossuser
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（ManageOne）”
页签中，帐户名称为“ossuser”对应的默认密码。
步骤9 执行如下命令，确认是否可以ping通异常节点。
ping -c 3
被监控节点IP地址
PING 192.168.197.180 (192.168.197.180) 56(84) bytes of data.
--- 192.168.197.180 ping statistics ---
3 packets transmitted, 0 received, 100% packet loss, time 2073ms
●
是，等待15分钟，查看告警是否自动清除，无法自动清除请执行步骤10。
●
否，请执行步骤10。
1

## Page 794

步骤10 请联系技术支持工程师处理。
----结束
告警清除
当MOICAgent上报心跳正常时，该告警自动清除。
参考信息
无。
1.3.12.1.4 ALM-1000001005
服务监控所管理节点数量已超过性能基线
告警解释
当前部署规格下服务监控所监控的节点数量超过ManageOne的性能基线时，上报此告
警。
告警属性
告警ID 告警级别 告警类型
1000001005
重要 环境告警
告警参数
参数名称 参数含义
当前环境所管
理的节点数量
当前环境服务监控所监控的节点数量。
最大支持的节
点数量
ManageOne当前管理规模下服务监控支持的最大节点数量。
对系统的影响
节点数量超过基线时，会增加ES的内存压力，发生ES程序父级熔断器熔断和内存溢
出，导致弹性云服务器明细报表无数据、周期报表导出无数据、性能数据断采、备份
任务执行失败、ES索引只读无法写入和服务监控页面没有监控数据等异常。
可能原因
●
服务监控所监控的节点过多。
●
服务监控所管理云服务过多。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
1

## Page 795

●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，过滤出当前告警，单击 ，查看告警详情中的“定位信息”。
查看并记录“当前环境所管理的节点数量”和“最大支持的节点数量”的值。
步骤4 查看服务监控数据。
1.
在主菜单中选择“集中监控
>
资源监控”，进入“资源监控”页面。
2.
在页面上方选择“系统资源
>
云服务”页签，展示云服务监控列表。
3.
在搜索框中输入“ManageOne”并搜索。
4.
单击资源名称，进入资源监控详情页面。
5.
在左侧导航树中选择“基础信息
>
监控视图”。
6.
查看当前指标数据展示是否正常。
–
是，执行步骤4.7。
–
否，请联系技术支持工程师处理。
7.
切换时间选择为最近一小时、最近一天，查看数据展示及折线图是否正常。
–
是，执行步骤5。
–
否，请联系技术支持工程师处理。
步骤5 查看ES集群状态。
1.
使用Putty工具以sopuser用户登录任意ES集群节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“sopuser”对应的默认密码。
说明
请参考软件安装工具导出的参数信息汇总文件的“
2.1
工具生成的IP参数”页签，“参数
名称”列获取ES集群节点的IP地址。
–
12节点形态下，ES集群的节点为ManageOne-Service0x。
– 15节点形态下，ES集群的节点为ManageOne-ESMaster0x、ManageOne-ESData0x、
ManageOne-DataServer0x。
2.
执行以下命令，切换到root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“root”对应的默认密码。
3.
执行以下命令，检查ES集群状态。
curl -i -k -u
admin:密码
https://localhost:9200/_cat/health?v
密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（ManageOne）”页签
中，帐户说明为“Elasticsearch默认帐户”，帐户名称为“admin”对应的默认密
码。
4.
查看集群初始化的进度，即active_shards_percent字段是否100.0%。
–
是，执行步骤6。
–
否，多次执行此命令，观察该字段的趋势。若该字段长时间保持不变或者无
法达到100%，表示ES集群加载异常。请联系技术支持人员进行处理。
1

## Page 796

步骤6 查看ES索引状态。
1.
使用Putty工具以sopuser用户登录任意ES集群节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“sopuser”对应的默认密码。
2.
执行以下命令，切换到root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“root”对应的默认密码。
3.
执行以下命令，检查磁盘使用率。
df -h
查看回显中/opt磁盘的使用率是否大于85%。
–
是，表示ES的索引异常。已经限制写入，请联系技术支持人员处理。
–
否，表示ES的索引正常。
步骤7 若上述检查完成后告警依然存在，请联系技术支持人员处理。
----结束
告警清除
当前环境服务监控所管理的节点数量小于最大支持的节点数量的值时，该告警自动清
除。
参考信息
无。
1.3.12.1.5 ALM-1000001006
操作系统帐号密码剩余有效期阈值告警
告警解释
监控对象管理虚拟机或物理机的操作系统帐号密码剩余有效天数达到配置的阈值条件
时，产生此告警。
告警属性
告警ID 告警级别 告警类型
1000001006
重要/次要 业务质量
告警参数
参数名称 参数含义
帐户名称 产生告警的用户名称。
资源名称 产生告警的监控对象名称。
1

## Page 797

参数名称 参数含义
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
密码剩余有效
天数
帐号密码即将过期的剩余有效天数。
对系统的影响
帐户密码过期后无法使用该帐户登录节点。
可能原因
操作系统帐户密码即将过期或已过期。
处理步骤
步骤1 在该告警的“告警详情”页签查看“定位信息”字段，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 执行chage命令，查看帐户到期时间。例如，查看ossuser帐户的到期时间，执行如下
命令。
chage -l ossuser
回显信息如下所示，其中“Password expires”对应的时间为该帐户密码的到期时间。
Last password change : May 15, 2021
Password expires : Dec 12, 2021
Password inactive : Jan 16, 2022
Account expires : never
Minimum number of days between password change : 7
Maximum number of days between password change : 180
Number of days of warning before password expires : 15
步骤4 计算帐户到期时间距离当前时间是否超出阈值。
●
是，执行步骤5。
●
否，执行步骤6。
步骤5 修改密码或密码有效期。
1

## Page 798

说明
●
您可以通过修改密码重置帐户有效期，也可以直接修改密码有效期。
● 部分帐户用于与其他云服务组件交互，如果修改为非默认密码会影响业务，此时建议直接修
改密码有效期。修改密码或密码有效期前请先评估影响。如果无法准确评估，请联系帐户所
属服务的技术支持工程师协助确认。
●
方式一：修改密码。修改密码后会重新计算帐户有效期。
以ossuser为例，执行如下命令。
passwd ossuser
也可以参考《华为云Stack
8.1.0
帐户一览表》中的“修改方法列”修改密码。
如果想要恢复默认密码，首先清空历史记录后重新设置。
a.
执行以下命令，清空旧密码的记录。
true>/etc/security/opasswd
b.
执行以下命令，修改为原来的默认密码。
passwd username
●
方式二：直接修改密码有效期。
以meteradmin帐户为例，执行如下命令。
chage -M 180 meteradmin
其中，180为天数，设置为99999为永久不过期。
步骤6 请收集上述告警处理过程中的信息，联系技术支持工程师协助解决。
----结束
告警清除
操作系统帐号密码剩余有效天数大于阈值告警上报条件时，自动清除此告警。
参考信息
无。
1.3.12.1.6 ALM-1000001010
inode的空闲率阈值告警
告警解释
当被监控对象的inode空闲率满足用户设定的告警上报阈值条件时，上报此告警。
告警属性
告警ID 告警级别 告警类型
1000001010
重要/次要/提示 业务质量
告警参数
ManageOne支持两种不同的监控视图。在不同的监控视图下，inode空闲率阈值告警
的参数不同。
1

## Page 799

●
监控视图一
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的主机IP地址。
●
监控视图二
参数名称 参数含义
区域 产生告警的对象所在区域。
云服务 产生告警的云服务名称。
主机IP 产生告警的主机IP地址。
对系统的影响
当被监控对象的inode空闲率过低时，说明磁盘分区inode即将用满，会导致系统无法
继续在该分区下创建新目录或文件，影响系统正常使用。
可能原因
系统磁盘下存在大量的文件碎片。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 使用以下命令，查询文件系统中的磁盘分区和挂载点。
df -h
如下图，“Filesystem”列所示的为文件系统的磁盘分区名称，“Mounted on”列所
示的为文件系统的挂载点名称。
1

## Page 800

步骤4 使用以下命令，查看inode空闲率。
df -i
{磁盘分区名称或挂载点}
说明
请使用具体的磁盘分区或挂载点代替{磁盘分区名称或挂载点}。
例如：df -i /dev
如下图，inode实际空闲率=100%-IUse%列的值=90%。
步骤5 使用以下命令，查看挂载点中小文件（文件大小小于1KB）的分布情况。
find
{挂载点}
-type f -size -1k
说明
请使用具体的挂载点代替{挂载点}。
例如：find
/opt -type f -size -1k
● 如果对应文件不需要，请直接使用“rm”命令批量删除文件。
●
如果对应文件为备份存储使用，请使用“tar”命令压缩到单个文件中进行存储
后，删除原来的小文件。
步骤6 使用以下命令，查看步骤4中磁盘分区的inode空闲率是否仍小于告警阈值。
df -i
{磁盘分区名称或挂载点}
说明
请使用具体的磁盘分区或挂载点代替{磁盘分区名称或挂载点}。
例如：df
-i /dev/vda
●
是，执行步骤7。
●
否，处理完成。
步骤7 请联系技术支持工程师协助解决。
----结束
1

## Page 801

告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.12.1.7 ALM-servicemonitor_agent_heartbeat
节点连续中断
告警解释
云服务、ManageOne所在节点部署了MOICAgent服务，监控云服务以及ManageOne
自身服务、收集云服务日志、备份ManageOne数据库。MOICAgent定时上报心跳消
息，若心跳中断，同时MOICAgent服务无法通过Ping命令联系到对端虚拟机节点，此
现象时长超过阈值设置，产生此告警。
说明
HCS
Online场景下，服务监控不支持监控IaaS OpenStack资源池下的云服务系统。
告警属性
告警ID 告警级别 告警类型
servicemonitor_agent_heartbeat
次要 通信告警
告警参数
参数名称 参数含义
被监控节点IP 通讯异常的被监控节点的IP地址。
监控节点IP MOICAgentMgmtService服务的节点IP地址。
对系统的影响
●
在通讯异常节点，无法监控云服务、收集云服务日志、备份ManageOne数据库。
●
若断连节点为netcluster_elb_lvs_vm_x_x，则会造成ELB流量中断10s。
●
若断连节点为netcluster_elb_nginx_vm_x_x，则会造成ELB流量中断15s。
可能原因
●
被监控节点和ManageOne的MOICAgentMgmtService服务所在节点之间网络故
障或者进程异常。
●
被监控节点和ManageOne的MOICAgentMgmtService服务所在节点之间证书不
一致。
●
被监控节点的MOICAgent进程异常或者lvs域名配置异常。
1

## Page 802

●
MOICAgent心跳上报通道异常。
处理步骤
步骤1 查看节点连续中断告警信息。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
3.
单击目标告警所在行的 ，展开告警详情。
4. 查看定位信息。
– HCS
Online场景：执行步骤5。
–
华为云Stack场景：是否是“ManageOne-Agent证书已吊销”。
▪
是，执行步骤2。
▪
否，执行步骤3。
步骤2 更新ManageOne-Agent证书。
1.
在主菜单中选择“日常运维
>
集中配置
>
证书管理”。
2.
在“证书列表”页面区域选择Global，输入关键字ManageOne-Agent搜索证书。
3.
在搜索到的证书所在行单击“更新”。
4.
在提示对话框，单击“确定”，等待证书更新完成。
5.
等待5-10分钟，查看告警是否清除。
–
是，结束。
–
否，执行步骤5。
步骤3 收集节点连续中断告警信息的异常原因。
1.
在告警详情页面，单击“告警帮助”页签，打开“告警帮助辅助处理工具”的链
接，跳转到自动作业的“编排管理
>
执行编排”页面。
说明
如果当前告警是汇聚告警 ，执行编排操作前，需要修改“编排管理”的告警流水号为被
汇聚告警流水号。被汇聚告警流水号可以在当前告警详情的“被汇聚告警”页签下获取。
2.
设置告警流水号csn、起始时间和结束时间，单击“执行”，进入“确认执行”页
面。
3.
确认风险提示信息，勾选“我已检查上述编排内容无业务风险，确认执行”，单
击“确定”，跳转到“作业历史”页面。
步骤4 结果分析。
1.
单击作业名称“节点连续中断告警信息收集”，展开作业详情。
2.
在“作业流程”中单击“告警处理_MOICAgentMgmtService状态检测”卡片，弹
出弹框。
1

## Page 803

3.
在“执行情况”下查看“脚本输出”信息是否为“The
MOICAgentMgmtService
process is
normal.”。
–
是，执行步骤4.4。
–
否，请参见表1-56进行异常处理。
4.
在“作业流程”中单击“告警处理_MOICAgent状态检测”卡片。在“执行情
况”下查看“脚本输出”信息是否为“No
error is detected. If the alarm
persists, contact Huawei technical support to troubleshoot the
fault.”。
–
是，等待5~10分钟后查看告警是否自动清除。
▪
是，结束。
▪
否，执行步骤5。
–
否，请参见表1-56进行异常处理。
表1-56 脚本输出结果分析
脚本输出 异常原因 解决方案
MOICAgentMgmtService
is still abnormal after
being restarted.
MOICAgentMgmtService
进程异常。
执行步骤5。
Failed to obtain the LVS
IP address
获取lvs IP异常。 执行步骤5。
1

## Page 804

脚本输出 异常原因 解决方案
Failed to enable port
27337.
27337端口无法正常建立监
听。
执行步骤5。
Failed to obtain
parameters required for
enabling port 27337.
无法获取启动27337端口的
参数。
执行步骤5。
MOICAgent is not
deployed.
MOICAgent被卸载或未部
署。
执行步骤5。
MOICAgent is still
abnormal after being
restarted.Contact
Huawei technical
support to troubleshoot
the problem.
MOICAgent进程异常，重
启后服务依旧无法正常运
行。
执行步骤5。
Failed to report the
ICAgent heartbeat.
Contact Huawei
technical support to
troubleshoot the
problem.
ICAgent无法正常上报心跳
信息。
执行步骤5。
The LVS domain name
cannot be pinged.
Contact Huawei
technical support to
troubleshoot the
problem.
Lvs域名无法ping通。 执行步骤5。
Failed to parse the IP
address using the
domain name.
Lvs域名无法解析出IP地
址。
执行步骤5。
The IP address mapped
to the LVS domain name
is different from that
configured in
MORCLVSService.
Contact Huawei
technical support to
troubleshoot the
problem.
Lvs域名对应的IP和接入管
理配置的不一致。
执行步骤5
Failed to obtain the
parameters.
检测异常时无法获取必要的
参数。
执行步骤5。
Network failure.
被监控节点和ManageOne
的
MOICAgentMgmtService
服务所在节点之间网络故
障。
执行步骤5。
1

## Page 805

脚本输出 异常原因 解决方案
Ip error.
无法获取到故障节点IP。 执行步骤5。
步骤5 请联系技术支持工程师协助解决。
----结束
告警清除
●
当MOICAgent上报新的心跳消息时，自动清除此告警。
●
当MOICAgent未上报心跳且不能Ping通节点时，会上报1.3.12.1.3
ALM-1000001004
节点心跳中断告警，此告警自动清除。
参考信息
无。
1.3.12.1.8 ALM-servicemonitor_os.fs.percent
硬盘使用率阈值告警
告警解释
当被监控对象的硬盘使用率满足用户设定的告警上报阈值条件时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_os.fs.percent
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的主机IP地址。
对系统的影响
当被监控对象的磁盘使用率过高时，会导致被监控对象运行缓慢，并使得整个系统的
吞吐量下降，系统响应延迟增高。
可能原因
磁盘被占满。
1

## Page 806

处理步骤
本处理步骤中所呈现的数值、文件、进程等信息仅作为告警清除的示例，可能与实际
环境中的信息不一致，具体操作中请以实际环境信息参考如下步骤进行处理。
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 收集硬盘使用率数据。
1.
执行如下命令，查找并记录“Use%”列显示占用率满足阈值条件的文件夹。如图
1-14所示。
df -h
图1-14 文件占用磁盘空间查询
说明
如果发现其他文件夹的“Use%”列显示占用率满足阈值条件，也可以按后续步骤进行处
理。
2.
执行如下命令，查询/opt目录下大于50M的文件并记录。
find /opt -type f -size +50000k -exec ls -lh {} \; | awk '{ print $9 ": " $5 }'
1

## Page 807

步骤4 业务正常情况下，联系业务运维人员进行扩容、迁移业务，其他情况请联系技术支持
工程师协助解决。
----结束
告警清除
当硬盘使用率低于设定值时告警自动清除。
参考信息
无。
1.3.12.1.9 ALM-servicemonitor_cpu.percent
CPU使用率阈值告警
告警解释
当被监控对象的CPU使用率满足用户设定的告警上报阈值条件时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_cpu.percent
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的主机IP地址。
1

## Page 808

对系统的影响
被监控对象的CPU使用率过高会导致系统吞吐量下降，系统响应延迟增加。
可能原因
●
被监控系统的CPU使用率过高。
●
bmsgw/netnode/vpcep/elb-ngnix/elb-lvs/nat-gateway/vrouter/enat/br服务节
点采用dpdk技术，会提前预留CPU，当告警源为这些服务时，该告警可以忽略。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看CPU使用率，并联系技术支持工程师协助解决。
top -c
键盘输入shift
+
p，按CPU使用率降序排序。
----结束
告警清除
当CPU使用率低于设定值时告警自动清除。
参考信息
无。
1.3.12.1.10 ALM-servicemonitor_memory.percent
物理内存使用率阈值告警
告警解释
当被监控对象的物理内存使用率满足用户设定的告警上报阈值条件时，上报此告警。
1

## Page 809

告警属性
告警ID 告警级别 告警类型
servicemonitor_memory.percent
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的主机IP地址。
对系统的影响
物理内存使用率过高，可用物理内存变少，将导致系统运行缓慢，系统吞吐量下降，
系统响应延迟增高。
可能原因
●
系统中运行过多的进程。
●
某些进程占用过多的物理内存。
●
物理内存容量过小。
●
bmsgw/netnode/vpcep/elb-ngnix/elb-lvs/nat-gateway/vrouter/enat服务节点采
用dpdk技术，会提前预留内存，当告警源为这些服务时，该告警可以忽略。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看内存使用率，并联系技术支持工程师协助解决。
top -c
键盘输入shift
+
m，按内存使用率降序排序。
1

## Page 810

----结束
告警清除
当物理内存使用率低于设定值时告警自动清除。
参考信息
无。
1.3.12.1.11 ALM-servicemonitor_os.nic.rx_dropped_ps
网卡流入丢包率阈值告警
告警解释
当被监控对象的网卡流入丢包率满足用户设定的告警上报阈值条件时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_os.nic.rx_dropped
_ps
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
对系统的影响
系统的网卡流入丢包率过高，将导致系统中进程网络通信延迟增高或无法正常通信，
业务响应时间增大。
可能原因
●
系统运行了大量的网络通信进程。
●
系统中的某个进程频繁通信。
●
系统设备故障。
1

## Page 811

处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看网卡信息。
cd /sys/class/net/
ll
步骤4 查看某一个网卡流入丢包数，并联系技术支持工程师协助解决。例如查看“eth0”网
卡流入丢包数。
cat /sys/class/net/eth0/statistics/rx_dropped
----结束
告警清除
当网卡流入丢包率低于设定值时告警自动清除。
参考信息
无。
1.3.12.1.12 ALM-servicemonitor_os.nic.rx_errors_ps
网卡流入错包率阈值告警
告警解释
当被监控对象的网卡流入错包率满足用户设定的告警上报阈值条件时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_os.nic.rx_errors_
ps
重要/次要/提示 业务质量
1

## Page 812

告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
对系统的影响
系统的网卡流入错包率过高，将导致系统中进程网络通信延迟增高或无法正常通信，
业务响应时间增大。
可能原因
●
系统运行了大量的网络通信进程。
●
系统中的某个进程频繁通信。
●
系统设备故障。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看网卡信息。
cd /sys/class/net/
ll
步骤4 查看某一个网卡流入错包数，并联系技术支持工程师协助解决。例如查看“eth0”网
卡流入错包数。
cat /sys/class/net/eth0/statistics/rx_errors
----结束
告警清除
当网卡流入错包率低于设定值时告警自动清除。
1

## Page 813

参考信息
无。
1.3.12.1.13 ALM-servicemonitor_os.nic.tx_dropped
网卡流出丢包率阈值告警
告警解释
当被监控对象的网卡流出丢包率满足用户设定的告警上报阈值条件时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_os.nic.tx_droppe
d
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
对系统的影响
系统的网卡流出丢包率过高，将导致系统中进程网络通信延迟增高或无法正常通信，
业务响应时间增大。
可能原因
●
系统运行了大量的网络通信进程。
●
系统中的某个进程频繁通信。
●
系统设备故障。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
1

## Page 814

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看网卡信息。
cd /sys/class/net/
ll
步骤4 查看某一个网卡流出丢包数，并联系技术支持工程师协助解决。例如查看“eth0”网
卡流出丢包数。
cat /sys/class/net/eth0/statistics/tx_dropped
----结束
告警清除
当网卡流出丢包率低于设定值时告警自动清除。
参考信息
无。
1.3.12.1.14 ALM-servicemonitor_os.nic.tx_errors
网卡流出错包率阈值告警
告警解释
当被监控对象的网卡流出错包率满足用户设定的告警上报阈值条件时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_os.nic.tx_errors
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
1

## Page 815

对系统的影响
系统的网卡流出错包率过高，将导致系统中进程网络通信延迟增高或无法正常通信，
业务响应时间增大。
可能原因
●
系统运行了大量的网络通信进程。
●
系统中的某个进程频繁通信。
●
系统设备故障。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
● ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
● 非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看网卡信息。
cd /sys/class/net/
ll
步骤4 查看某一个网卡流出错包数，并联系技术支持工程师协助解决。例如查看“eth0”网
卡流出错包数。
cat /sys/class/net/eth0/statistics/tx_errors
----结束
告警清除
当网卡流出错包率低于设定值时告警自动清除。
参考信息
无。
1.3.12.1.15 ALM-servicemonitor_os.disk.io_waite
硬盘IO等待时间阈值告警
告警解释
当被监控对象的硬盘IO等待时间满足用户设定的告警上报阈值条件时，上报此告警。
1

## Page 816

告警属性
告警ID 告警级别 告警类型
servicemonitor_os.disk.io_waite
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
对系统的影响
硬盘IO等待时间过长，会导致系统所有业务处理缓慢。
可能原因
业务进程出错，导致业务停止IO操作。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看磁盘信息，并联系技术支持工程师协助解决。
cat /proc/diskstats
1-14列信息具体参数意义可参考下图，示例：参数252表示设备号，即major
number。
1

## Page 817

----结束
告警清除
当硬盘IO等待时间小于设定值时告警自动清除。
参考信息
无。
1.3.12.1.16 ALM-servicemonitor_os.disk.rd_rsp_time
硬盘读响应时间阈值告警
告警解释
当被监控对象的硬盘读响应时间满足用户设定的告警上报阈值条件时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_os.disk.rd_rsp_ti
me
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
1

## Page 818

对系统的影响
当被监控对象的磁盘读响应时间过长时，会导致被监控对象运行缓慢，并使得整个系
统的吞吐量下降，系统响应延迟增高。
可能原因
业务进程出错导致业务频繁执行IO操作。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看磁盘信息，并联系技术支持工程师协助解决。
cat /proc/diskstats
每列信息具体参数意义可参考下图：
1

## Page 819

----结束
告警清除
当硬盘读响应时间小于设定值时告警自动清除。
参考信息
无。
1.3.12.1.17 ALM-servicemonitor_os.disk.wt_rsp_time
硬盘写响应时间阈值告警
告警解释
当被监控对象的硬盘写响应时间满足用户设定的告警上报阈值条件时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_os.disk.wt_rsp_ti
me
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
1

## Page 820

对系统的影响
当被监控对象的磁盘写响应时间过长时，会导致被监控对象运行缓慢，并使得整个系
统的吞吐量下降，系统响应延迟增高。
可能原因
业务进程出错导致业务频繁执行IO操作。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看磁盘信息，并联系技术支持工程师协助解决。
cat /proc/diskstats
每列信息具体参数意义可参考下图：
1

## Page 821

----结束
告警清除
当硬盘写响应时间小于设定值时告警自动清除。
参考信息
无。
1.3.12.1.18 ALM- servicemonitor_os.disk.io_util
硬盘IO操作时间占比阈值告警
告警解释
当被监控对象的硬盘IO操作时间占比满足用户设定的告警上报阈值条件时，上报此告
警。
IO操作时间占比：在统计时间内，设备处理IO问题时间占所有统计时间的比值。例
如：统计时间为1秒，该设备有0.8秒在处理IO问题，0.2秒是闲置状态，则该设备IO操
作时间占比=0.8/1=80%，表示设备的繁忙程度。
告警属性
告警ID 告警级别 告警类型
servicemonitor_os.disk.io_util
重要/次要/提示 业务质量
1

## Page 822

告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
对系统的影响
影响正常业务功能。
可能原因
●
业务IO繁忙
●
业务异常或IO攻击
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 执行以下命令，查看磁盘IO使用情况。
/usr/bin/iostat -d -x | /usr/bin/tail -n +3
关注%util列，只要任意设备的磁盘IO数据持续增加，即为异常，请联系技术工程师协
助处理。
----结束
告警清除
硬盘IO操作时间占比满足清除告警条件时，此告警自动清除。
参考信息
无。
1

## Page 823

1.3.12.1.19 ALM- servicemonitor_fhcount_percent_alarm
文件句柄使用率告警
告警解释
当操作系统的文件句柄使用率大于监控的阈值条件时，系统产生此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_fhcount_percent
_alarm
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
对系统的影响
影响正常业务功能。
可能原因
●
句柄泄露
●
句柄最大数设置过小
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 执行以下命令，查看系统句柄数。
cat /proc/sys/fs/file-nr
1

## Page 824

说明
如回显示例：
●
27264：已分配文件句柄数
●
0：已分配未使用句柄数
● 92233xxx：文件句柄的最大数目
步骤4 执行以下命令，查看使用句柄多的进程。
1.
执行以下命令，查看句柄分布。
lsof -n|awk '{print $2}'|sort|uniq -c|sort -nr| head -10
其中第一列是打开的句柄数，第二列是进程ID。
注意
此命令属于高危操作，如果虚拟机的内存利用率过高，执行lsof命令可能会导致虚
拟机异常重启，请联系技术支持评估后再执行。
说明
ManageOne节点先切换到ossadm用户再执行（su ossadm），其他云服务节点直接执行
此命令。
2.
执行以下命令，查看进程详情。
ps -ef|grep PID
说明
PID请用步骤4.1中获取的进程ID替换。
步骤5 收集以上信息联系技术支持工程师协助解决。
----结束
告警清除
操作系统的文件句柄使用率满足清除的阈值条件时，此告警自动消除。
参考信息
无。
1.3.12.2
进程类
进程类告警对应的服务监控模板ID为“os_template”。
1

## Page 825

1.3.12.2.1 ALM-1000001001
NTP进程异常告警
告警解释
当被监控虚拟机上不存在NTP服务进程时，上报此告警。
告警属性
告警ID 告警级别 告警类型
1000001001
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（虚拟机）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
对系统的影响
节点的NTP服务异常，影响NTP时间同步。
可能原因
NTP服务进程启动失败。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 使用以下命令，确认上报告警的服务类型。
ps -ef|grep ntpd|grep -v grep
●
如果没有回显信息，请使用表1-57中ManageOne的处理步骤。
[root@MOC-ManageOne-Service01 log]# ps -ef|grep ntpd|grep -v grep
[root@MOC-ManageOne-Service01 log]#
1

## Page 826

●
如果有回显信息，请使用表1-57中其他云服务的处理步骤。
[root@APIGWLB01 fsp]# ps -ef|grep ntpd|grep -v grep
ntp 827 1 0 Oct21 ? 00:00:19 /usr/sbin/ntpd -u ntp:ntp -g
步骤4 根据步骤3中查找的服务类型，参考表1-57处理告警。
表1-57 服务类型与操作步骤
服务类型 操作步骤
ManageOne 1.
执行以下命令，判断NTP服务使用的组件。
bash /usr/local/osconfig/os/bin/
getsupportntptype.sh
–
若如下类似回显信息，则表示NTP服务使用的是ntpd组
件。
["ntpd"]
–
若如下类似回显信息，则表示NTP服务使用的是chrony
组件。
["ntpd", "chrony"]
2.
执行以下命令，切换至root用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的
“A类（后台）”页签中，产品名称为“ManageOne”，
帐户名称为“root”对应的默认密码。
3.
根据步骤4.1中查询的组件类型选择对应的操作，检查NTP
服务是否已经启动。
–
ntp组件
service ntpd status
▪
若系统回显信息中包含“active (running)”字样的
信息，说明节点的NTP服务已启动。
▪
否则，说明节点的NTP服务未启动，执行以下命令启
动NTP服务。
service ntpd start
–
chrony组件
service chronyd status
▪
若系统回显信息中包含“active (running)”字样的
信息，说明节点的NTP服务已启动。
▪
否则，说明节点的NTP服务未启动，执行以下命令启
动NTP服务。
systemctl start chronyd
4. 检查告警是否清除。
– 是，结束。
– 否，请联系技术支持工程师处理。
1

## Page 827

服务类型 操作步骤
其他云服务
1.
重启NTP服务。
/usr/bin/systemctl restart ntpd
2.
等待10分钟，在“当前告警”中查看告警是否清除，如果
告警未清除，请联系技术支持工程师协助解决。
3.
等待10分钟，查询是否有NTP服务进程。
ps -ef | grep ntpd | grep -v grep
ntp 1062193 1 0 16:54 ? 00:00:00 /usr/sbin/ntpd -u ntp:ntp -
x -g
–
是，结束。
–
否，请联系技术支持工程师协助解决。
----结束
告警清除
NTP服务进程启动成功后，此告警自动清除。
参考信息
无。
1.3.12.3 Redis
类
Redis类告警对应的服务监控模板ID为“cloud_sop_redis_template”。
1.3.12.3.1 ALM-servicemonitor_redis.dbsvrStatus Redis
数据库实例状态阈值告警
告警解释
当数据库实例状态异常时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_redis.dbsvrStatu
s
重要/次要/提示 业务质量
参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址（一般为数据库节点）。
1

## Page 828

对系统的影响
数据库无法正常访问，影响业务正常使用。
可能原因
数据库节点或进程异常。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看Redis实例信息。例如查看“mosmrdb-6-41”实例信息（实例信息名称具体以环
境为准），其他实例信息也可按后续步骤操作。
cd /opt/redis/data/mosmrdb-6-41
ll
步骤4 查看实例的端口信息和IP地址。
cat redis.conf
1

## Page 829

步骤5 登录Redis实例数据库。
登录命令：
/opt/redis/bin/redis-cli -h
主机IP地址
-p
数据库端口
-cipherdir /opt/redis/etc/
cipher/1/
在交互窗口中，输入认证信息：
auth
Redis数据库名@Redis数据库用户@Redis数据库密码
说明
mosmrdb为数据库实例，Redis数据库用户和密码请参见如下文档。
●
华为云Stack场景：请参见《华为云Stack
8.1.0
帐户一览表》。
● HCS
Online场景：请参见《ManageOne
8.1.0
安全管理指南》。
步骤6 查询Redis服务器信息。
INFO server
1

## Page 830

步骤7 确认数据库节点或进程是否存在异常。
●
是，恢复数据库节点和异常进程，查看该是否清除。如果未清除告警，请联系技
术支持工程师处理。
●
否，请联系技术支持工程师处理。
----结束
告警清除
当Redis数据库实例状态正常时告警自动清除。
参考信息
无。
1.3.12.3.2 ALM-servicemonitor_redis.dbcopyStatus Redis
数据库实例复制状态阈值告警
告警解释
当被监控对象的数据库主备复制状态发生异常时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_redis.dbcopyStat
us
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址（一般为数据库节点）。
对系统的影响
数据库主备状态不同步，会导致数据丢失。
可能原因
数据库主备状态不同步。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
1

## Page 831

步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看Redis实例信息。例如查看“mosmrdb-6-41”实例信息（实例信息名称具体以环
境为准），其他实例信息也可按后续步骤操作。
cd /opt/redis/data/mosmrdb-6-41
ll
步骤4 查看实例的端口信息和IP地址。
cat redis.conf
“port”对应的是端口号，“bind”对应的是IP地址。
步骤5 登录Redis实例数据库。
登录命令：
/opt/redis/bin/redis-cli -h
主机IP地址
-p
数据库端口
-cipherdir /opt/redis/etc/
cipher/1/
在交互窗口中，输入认证信息：
1

## Page 832

auth
Redis数据库名@Redis数据库用户@Redis数据库密码
说明
mosmrdb为数据库实例，Redis数据库用户和密码请参见如下文档。
●
华为云Stack场景：请参见《华为云Stack
8.1.0
帐户一览表》。
● HCS
Online场景：请参见《ManageOne
8.1.0
安全管理指南》。
步骤6 查询主/从复制信息。
INFO Replication
步骤7 请联系技术支持工程师根据已获得的信息进行处理。
----结束
告警清除
当Redis数据库实例复制状态正常时告警自动清除。
参考信息
无。
1.3.12.3.3 ALM-servicemonitor_redis.connectedClientsRate Redis
数据库实例的客户端
连接使用率阈值告警
告警解释
当被监控对象的数据库连接率满足用户设定的告警上报阈值条件时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_redis.connected
ClientsRate
重要/次要/提示 业务质量
1

## Page 833

告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址（一般为数据库节点）。
对系统的影响
当数据库连接率过高时，当前可用数据库连接数过少，导致后来的数据库操作请求失
败，影响业务系统的性能。
可能原因
●
客户端频繁发起数据库连接。
●
单个数据库操作耗时过长。
●
连接池数量设置不合理。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 使用Putty工具以具有登录权限的系统用户登录上报告警的异常节点，切换到root用
户。
●
ManageOne节点
默认密码：请参见《ManageOne
8.1.0
安全管理指南》中“帐户一览表”章节内
容。
●
非ManageOne节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签查
找节点对应云服务的root用户登录方法。
步骤3 查看Redis实例信息。例如查看“mosmrdb-6-41”实例信息（实例信息名称具体以环
境为准），其他实例信息也可按后续步骤操作。
cd /opt/redis/data/mosmrdb-6-41
ll
1

## Page 834

步骤4 查看实例的端口信息和IP地址。
cat redis.conf
步骤5 登录Redis实例数据库。
登录命令：
/opt/redis/bin/redis-cli -h
主机IP地址
-p
数据库端口
-cipherdir /opt/redis/etc/
cipher/1/
在交互窗口中，输入认证信息：
auth
Redis数据库名@Redis数据库用户@Redis数据库密码
说明
mosmrdb为数据库实例，Redis数据库用户和密码请参见如下文档。
● 华为云Stack场景：请参见《华为云Stack 8.1.0 帐户一览表》。
● HCS
Online场景：请参见《ManageOne
8.1.0
安全管理指南》。
步骤6 查询连接客户端信息。
INFO clients
步骤7 持续观察数据库连接率，如果长期超过阈值且不断增长时，执行如下操作。否则，请
联系技术支持工程师处理。
1.
检查应用系统中对数据库的访问是否合理，如果存在不合理访问需要修改应用系
统。
2.
调整数据库连接池容量。
3.
优化单次数据库操作，减少单次操作的时间。
步骤8 如果依然无法清除告警，请联系技术支持工程师处理。
----结束
1

## Page 835

告警清除
当Redis数据库实例的客户端连接使用率低于设定值时告警自动清除。
参考信息
无。
1.3.12.4
高斯数据库类
高斯数据库类告警对应的服务监控模板ID为“cloud_sop_zenith_template”。
1.3.12.4.1 ALM-1000001008
数据库实例的CPU 使用率阈值告警
告警解释
高斯数据库实例的CPU使用率满足用户配置的阈值条件时产生此告警。
告警属性
告警ID 告警级别 告警类型
1000001008 重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称。
资源类型 产生告警的资源类型。
主机IP 产生告警的资源的IP地址。
数据库实例名
称
产生告警的数据库实例名称。
对系统的影响
系统响应速度慢。
可能原因
数据库操作语句执行频繁或者语句执行效率低。
处理步骤
步骤1 在该告警的“告警详情”页签查看“定位信息”字段，获取数据库实例名称。
步骤2 使用浏览器登录ManageOne部署面。
1

## Page 836

登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤3 选择ManageOne的“关系数据库”，单击进入数据库实例界面。
步骤4 搜索步骤1中获取的数据库实例名称，单击名称进入详情界面。
步骤5 单击“性能分析报告”，导出分析报告。
步骤6 联系技术支持工程师协助解决。
----结束
告警清除
数据库实例的CPU使用率低于设定值时，此告警自动清除。
参考信息
无。
1.3.12.4.2 ALM-1000001009
数据库实例的内存使用率阈值告警
告警解释
高斯数据库实例的内存使用率满足用户配置的阈值条件时产生此告警。
1

## Page 837

告警属性
告警ID 告警级别 告警类型
1000001009
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称。
资源类型 产生告警的资源类型。
主机IP 产生告警的资源的IP地址。
数据库实例名
称
产生告警的数据库实例名称。
对系统的影响
系统响应速度慢。
可能原因
数据库操作语句执行频繁或者语句执行效率低。
处理步骤
步骤1 在该告警的“告警详情”页签查看“定位信息”字段，获取数据库实例名称。
步骤2 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤3 选择ManageOne的“关系数据库”，单击进入数据库实例界面。
步骤4 搜索步骤1中获取的数据库实例名称，单击名称进入详情界面。
1

## Page 838

步骤5 单击“性能分析报告”，导出分析报告。
步骤6 联系技术支持工程师协助解决。
----结束
告警清除
数据库实例的内存使用率低于设定值时，此告警自动清除。
参考信息
无。
1.3.12.4.3 ALM-servicemonitor_zenith.connectedClientsRate
Zenith数据库实例的客
户端连接使用率阈值告警
告警解释
当被监控对象的Zenith数据库连接率满足用户设定的告警上报阈值条件时，上报此告
警。连接率的计算公式为：连接率=(数据库当前连接总数/数据库支持的最大连接
数)*100%。
告警属性
告警ID 告警级别 告警类型
servicemonitor_zenith.connecte
dClientsRate
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
1

## Page 839

对系统的影响
当Zenith数据库连接率过高时，当前可用数据库连接数过少，导致数据库后续操作请
求失败的可能性增大，影响业务系统的性能和功能。
可能原因
● 客户端频繁发起数据库连接。
●
单个数据库操作耗时过长。
处理步骤
步骤1 打开告警对应的“告警详情”，查看定位信息中的“IP地址/URL/域名”和“定位信
息”，获取告警源的主机IP地址和实例名称。
步骤2 使用Putty工具，以sopuser用户登录上报告警的异常节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，产
品名称为“ManageOne”，帐户名称为“sopuser”对应的默认密码。
步骤3 执行如下命令，切换root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，产
品名称为“ManageOne”，帐户名称为“root”对应的默认密码。
步骤4 切换到dbuser用户。
su dbuser
步骤5 使用以下命令，查询数据库实例端口。
grep LSNR_PORT /opt/zenith/data/admindbsvr*/cfg/zengine.ini
说明
admindbsvr*，请根据步骤1中上报告警的定位信息中的数据库实例名称进行替换。
步骤6 使用以下命令，连接数据库。
/opt/zenith/app/bin/zsql
sys/数据库密码@127.0.0.1:数据库端口号
说明
数据库端口号：请使用步骤5中查询的数据库实例端口号进行替换。
数据库密码：请参见如下文档获取Gauss数据库sys用户的密码。
●
华为云Stack场景：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（ManageOne）”页
签中，组件名称为“ManageOne数据库节点”，帐户名称为“sys”对应的默认密码。
● HCS
Online场景：请参见《ManageOne
8.1.0
安全管理指南》文档内附件的
《ManageOne
8.1.0
帐户一览表（HCS Online场景）》文档中的“B类（ManageOne）”
页签中，组件名称为“ManageOne”，帐户名称为“sys”对应的默认密码。
步骤7 使用以下命令，查看当前数据库实例的连接总数。
select count(*) from DV_SESSIONS;
1

## Page 840

使用以下命令，查看当前数据库实例的最大连接数。
SELECT VALUE FROM DV_PARAMETERS WHERE NAME ='SESSIONS';
步骤8 使用以下命令，查看当前数据库连接数分布情况。
select username,count(*) as countnumber from DV_SESSIONS group by
username order by countnumber desc;
查看每一个用户当前的连接数分布情况。
步骤9 持续观察数据库连接率，如果长期超过阈值且不断增长时，请联系技术支持工程师处
理。
----结束
告警清除
当Zenith数据库实例的客户端连接使用率小于设定值时告警自动清除。
参考信息
无。
1.3.12.5 RabbitMQ
类
RabbitMQ类指标对应的服务监控模板ID为“cloud_sop_rabbitmq_template”。
1

## Page 841

1.3.12.5.1 ALM-servicemonitor_rabbit_mq_status RabbitMQ
集群状态异常
告警解释
当被监控对象的集群状态异常时，上报此告警。
告警属性
告警ID 告警级别 告警类型
servicemonitor_rabbit_mq_statu
s
重要/次要/提示 业务质量
告警参数
参数名称 参数含义
资源名称 产生告警的监控对象名称（应用、应用实例等）。
资源类型 产生告警的资源类型。
主机IP 产生告警的IP地址。
对系统的影响
影响业务系统的性能。
可能原因
RabbitMQ集群故障。
处理步骤
步骤1 打开告警对应的“告警详情”查看“IP地址/URL/域名”，获取告警源的主机IP地址。
步骤2 根据IP在参数信息汇总文件中查询节点名称，并记录RabbitMQ集群剩余节点对应的IP
地址。
●
如果名称包含“ManageOne-Service”，那么RabbitMQ集群在ManageOne-
Service03/04节点。
●
如果名称包含“ManageOne-SMP”，那么RabbitMQ集群在ManageOne-
SMP01/02/03节点。
说明
请参考软件安装工具导出的参数信息汇总文件的“工具生成的IP参数”页签，“参数名称”列为
节点名称。
步骤3 登录RabbitMQ集群所有的节点，执行如下操作。
1.
使用Putty工具，以sopuser用户登录RabbitMQ集群节点。
1

## Page 842

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“sopuser”对应的默认密码。
2.
执行如下命令，切换root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，产品名称为“ManageOne”，帐户名称为“root”对应的默认密码。
3.
查看有无进程状态。
ps -ef|grep -v grep|grep MORabbitMQService
如图回显，表示有进程。否则，无进程。
–
有，执行步骤3.4。
–
无，请联系技术支持工程师处理。
4.
按顺序执行以下命令，查看集群状态。
a. 执行以下命令切换目录：
cd /opt/oss/Product/apps/MORabbitMQService/
说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
b.
执行以下命令导入环境变量：
source envs/MORabbitMQService.properties
source bin/set_env
c.
执行如下命令查看集群状态：
rabbitmqctl cluster_status
回显示例如下，则表示集群状态正常，否则，不正常。
示例中RabbitMQ集群在ManageOne-Service03/04节点上。
– 正常，执行步骤4。
–
异常，执行步骤3.5。
1

## Page 843

5.
按顺序执行以下命令，清理缓存文件。
a.
执行以下命令，切换目录。
cd /opt/share/Product/MORabbitMQService/mnesia
说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
b.
执行以下命令，清理所有以“rabbit@”开头的文件。
rm -rf rabbit@*
6.
执行以下命令，重启MORabbitMQService。
su ossadm -c ". /opt/oss/manager/agent/bin/engr_profile.sh;ipmc_adm -
cmd restartapp -app MORabbitMQService"
7.
执行以下命令，查看rabbitmq集群状态。
cd /opt/oss/Product/apps/MORabbitMQService/
说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
source envs/MORabbitMQService.properties
source bin/set_env
rabbitmqctl cluster_status
回显示例如下，表示集群状态正常，否则，不正常。
8.
在任意一个节点上，执行如下命令，在rabbitmq服务中添加autoops和rts帐号。
说明
autoops和rts帐号的默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类
（ManageOne）”页签中，在对应节点下该帐户的默认密码。若密码已被修改，请使用修
改过后的密码创建帐号，否则会导致对应的业务无法访问rabbitmq。
cd /opt/oss/Product/apps/MORabbitMQService/bin
说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
su ossuser
./create_machine_account.sh 'autoops'
Input Passwd: autoops帐号密码
Confirm passwd: autoops帐号密码
1

## Page 844

./create_machine_account.sh 'rts'
Input Passwd: rts帐号密码
Confirm passwd: rts帐号密码
若系统回显信息如上图所示，表示在rabbitmq中创建帐号成功，否则，请联系技
术支持工程师协助解决。
步骤4 如果未清除告警，请联系技术支持工程师处理。
----结束
告警清除
当RabbitMQ集群所有节点的状态正常时告警自动清除。
参考信息
无。
1.3.13
证书管理
1.3.13.1 ALM-MOCertMgmt_100101
系统存在即将过期证书告警
告警解释
当ManageOne系统中存在即将过期的证书时（证书过期时间小于30天），上报此告
警。
告警属性
告警ID 告警级别 告警类型
MOCertMgmt_100101 紧急/重要 业务质量
告警参数
参数名称 参数含义
证书名称 即将过期的证书名称以及距离过期的时间。
所属部件 证书所属的部件名称。
1

## Page 845

对系统的影响
当系统中证书过期时会对业务产生严重影响，甚至导致业务中断，需要及时更换证
书。
可能原因
系统中的证书即将过期，过期时间小于30天为重要告警，小于7天为紧急告警。
处理步骤
步骤1 登录ManageOne运维面，打开告警对应的“告警详情”，查看产生告警的证书名称和
所属部件。
步骤2 根据证书过期情况进行处理。
●
如果证书名称为“ManageOne-PKI”且证书已过期，则参考《华为云Stack
8.1.0
运维指南》的“手动恢复FusionSphere-Keystone PKI证书”章节，进行手工恢复
PKI证书。
●
如果证书名称为“FusionSphere”开头的证书，查看系统中是否有“ALM-9915
证书过期预警”，如果有，则参考《华为云Stack
8.1.0
运维指南》的
“ALM-9915 证书过期预警”章节处理；如果没有，则参考步骤3-步骤7。
●
其他情况请参考步骤3-步骤7进行证书更新。
步骤3 在ManageOne运维面菜单中选择“日常运维
>
集中配置
>
证书管理”。
步骤4 在左侧导航栏中选择“证书列表”，进入证书列表页面。
步骤5 在“所属区域”和“部件名”中选择需要更新的证书所在的地域和部件。
步骤6 勾选需要更新的证书名称，单击证书名称对应的“更新”。
步骤7 查看“更新状态”列显示“成功”则结束操作。否则，请再次尝试更新或联系技术支
持协助处理。
----结束
告警清除
当即将过期的告警被成功替换后，用户可手动清除告警或等待系统自动清除告警。
参考信息
无
1.3.14
密码管理
1.3.14.1 ALM-100021
自动修改密码失败
告警解释
当自动修改高阶云服务的密码失败后上报此告警。
1

## Page 846

告警属性
告警ID 告警级别 告警类型
100021
重要 业务质量
告警参数
无。
对系统的影响
节点的密码可能会过期。
可能原因
统一密码功能故障，或自动作业中安装Agent功能故障。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单选择“日常运维
>
集中配置
>
密码管理”，筛选“最近一次变更状态”为
“自动修改失败”的帐户，查看失败原因和帐户所在节点IP地址。
●
失败原因为“agent
not exists or agentServer service run
error”，执行步骤3。
●
失败原因不为“agent
not exists or agentServer service run
error”，请联系技
术支持工程师协助解决，然后执行步骤4。
步骤3 在主菜单选择“日常运维
>
自动作业”，在左侧导航栏选择“配置
>
设备管理”，选
择“管理虚拟机”页签，搜索步骤2中帐户所在节点IP地址，查看该节点的Agent安装
状态和运行状态。
●
如果Agent安装状态为“安装失败”且Agent运行状态为“离线”，请联系技术支
持工程师协助解决，然后执行步骤4。
●
如果Agent安装状态为“未安装”，请单击操作列的“安装”并按提示安装
Agent，安装成功等待一个小时后，执行步骤4。
步骤4 在主菜单中选择“日常运维
>
集中配置
>
密码管理”，执行以下操作，手工修改自动
修改密码失败的对应帐户。
●
单个帐户密码修改：单击帐户名称对应的“修改”。
●
批量帐户密码修改：勾选需要批量修改密码的帐户名称，单击帐户列表上方的
“修改”。
步骤5 等待一个小时，查看告警是否自动清除。
●
是，告警处理结束。
1

## Page 847

●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除告警，无需手工清除。
参考信息
无。
1.3.14.2 ALM-100020
同步
BMC
密码失败
告警解释
HCS
Online场景下，当ManageOne密码管理服务同步BMC密码失败时，上报此告
警。
告警属性
告警ID 告警级别 告警类型
100020
重要 处理出错告警
告警参数
参数名称 参数含义
区域 同步失败的区域名称。
eSight IP
同步失败的eSight的IP地址。
BMC IP
同步失败的BMC的IP地址。
BMC帐号 同步失败的BMC帐号。
对系统的影响
当ManageOne同步BMC密码失败后，eSight连接对应BMC会因为密码错误而失败。
可能原因
●
ManageOne调用eSight的同步接口失败。
●
ManageOne读取kafka消息失败。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
1

## Page 848

●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
步骤3 单击目标告警所在行的 ，展开当前告警详情。
步骤4 在告警详情页面，查看并记录定位信息中的“区域”。
步骤5 在主菜单中选择“日常运维
>
故障诊断
>
ManageOne工具箱 ”，在“ManageOne
工具箱”页面中选择“更新eSight对接BMC密码”模块，进入“更新eSight对接BMC
密码”页面。
步骤6 在页面右上角搜索框中搜索步骤4记录的区域。
步骤7 查看该区域的“任务状态”，执行对应的同步密码操作。
●
未执行，单击“操作”列“执行”。
●
成功，单击“操作”列“同步”。
●
失败，单击“操作”列“重试”。
步骤8 查看同步密码的结果。
●
成功，表示同步密码成功，处理完毕。
●
失败，单击“操作”列“日志”，查看执行失败的原因，并请联系技术支持工程
师协助解决。
----结束
告警清除
同步BMC密码成功后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.15
统一日志
1.3.15.1 ALM-0001000300030001 Elasticsearch
集群心跳检测异常
告警解释
Elasticsearch集群心跳异常，当连续五次集群节点之间心跳检测异常，并且节点故障个
数超过50%则上报告警。
告警属性
告警ID 告警级别 告警类型
0001000300030001
紧急 环境告警
1

## Page 849

告警参数
参数名称 参数含义
云服务
ManageOne
服务
MOLog
组件 Elasticsearch集群
对系统的影响
●
依赖于调用链的故障定位定界不可用。
● 管理操作日志页面无数据。
●
运行日志页签下的集群状态页面无数据或集群状态为 或 。
可能原因
●
网络异常。
● Elasticsearch集群节点最近十分钟心跳检测异常。
处理步骤
步骤1 登录部署面查看服务所在的节点。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在主菜单中选择“产品
>
软件管理
>
部署产品软件”。
3.
单击“ManageOne”产品对应的卡片。
4.
在“部署历史”中最新部署的那一行对应的“操作”列单击“详细信息”，并在
搜索框中输入MOLog所属的服务名称“MOLog”，单击 ，查询该服务的部署
列表。
如果未查询到该服务对应的部署列表，则返回“部署历史”，在“部署历史”中
下一行对应的“操作”列单击“详细信息”，继续查询，以此类推。
5.
找到“特性”列为“LogCenter”对应的实例名称，并单击该实例名称，进入服务
部署详情页面。
6.
在“部署历史”中最新部署的那一行对应的“部署状态”列单击“成功”，进入
服务资源详情页面。
7.
在“资源部署”中找到软件类型名称包含MOLogStorageService微服务且“发布
类型”为“Stage”的资源名称，并在对应的“操作”列单击 。
8.
在“节点IP”中查看并获取MOLogStorageService所在的节点IP地址。
步骤2 查看ManageOne运维面该告警对应的异常节点IP地址。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
1

## Page 850

–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”。
3.
单击该告警名称对应操作列左侧的 ，进入“告警详情”页签。
4.
查看“附加信息”中的异常节点IP地址。
步骤3 登录MOLogStorageService所在的节点。
1.
对比步骤2与步骤1中的IP地址是否一致。
–
是，则登录任意节点。
–
否，则登录正常节点。
2.
使用PuTTY，根据步骤3.1中的判断结果，以sopuser用户通过对应的节点IP地址
登录节点。
步骤4 执行如下命令，防止系统超时退出。
TMOUT=0
步骤5 执行如下命令，切换至root用户。
sudo su root
步骤6 执行如下命令，切换ossadm用户。
su ossadm
步骤7 执行如下命令，检查虚拟机之间是否可以通信。
ping
MOLogStorageService异常节点IP地址
如果有类似以下回显，则证明虚拟机节点通信正常。
64 bytes from
节点IP:
icmp_seq=1 ttl=64 time=0.019 ms
64 bytes from
节点IP:
icmp_seq=2 ttl=64 time=0.036 ms
●
是，执行步骤8。
●
否，执行步骤9。
步骤8 登录异常节点，执行以下命令，重启服务。
/opt/oss/manager/agent/bin/ipmc_adm -cmd restartapp -app
MOLogStorageService
重启后如果有类似以下回显，则证明重启成功。
Stopping process mologstorageservice-10-0 ... success
Starting process mologstorageservice-10-0 ... success
所有异常节点重启完成后，约20分钟之后查看告警是否消除，如还未消除，执行步骤
9。
步骤9 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 851

参考信息
无
1.3.16
备份管理
1.3.16.1 ALM-1000001101
未配置备份服务器
告警解释
当检测到某一Region下未配置备份服务器时，会上报此告警，提示用户给该Region配
置备份服务器。
告警属性
告警ID 告警级别 告警类型
1000001101
重要 环境告警
告警参数
参数名称 参数含义
区域信息 未配置备份服务器的Region信息
对系统的影响
当Region下未配置备份服务器时，会影响后续备份管理任务下发。
可能原因
备份管理页面中未配置该Region的备份服务器。
处理步骤
步骤1 查看未配置备份服务器告警信息。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
3.
单击目标告警所在行的 ，展开告警详情。
4.
查看告警详情中的“定位信息”字段，获取未配置备份服务器的Region信息，执
行步骤2。
1

## Page 852

步骤2 备份管理页面配置该Region的备份服务器。
1.
在主菜单中选择“日常运维
>
备份管理
>
备份配置”。
2.
在“备份配置”中单击“新增备份服务器”。
3.
在“新增备份服务器”页面的“区域”选择告警中提示的Region信息，并配置备
份服务器参数，单击“确定”。
4.
等待3-5分钟，查看告警是否清除。
–
是，结束。
–
否，请联系技术支持工程师协助解决。
----结束
告警清除
当该Region下配置备份服务器后，告警会自动消除。修改区域名称或者容灾倒换后，
若出现此告警，解决后需要手动清除。
参考信息
无。
1.3.16.2 ALM-1000001102
周期备份任务执行失败
告警解释
当周期备份任务执行失败时，上报此告警。
告警属性
告警ID 告警级别 告警类型
1000001102
重要 处理出错告警
告警参数
参数名称 参数含义
云服务信息 备份任务执行失败的云服务
区域信息 云服务所属Region
对系统的影响
当备份管理中存在执行失败的周期任务时，表示相关云服务数据备份失败，则该云服
务后续无法进行数据恢复操作。
1

## Page 853

可能原因
●
备份服务器空间不足
●
备份服务器连接异常
●
备份任务执行超时
处理步骤
步骤1 查看周期备份任务执行失败信息。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
3.
单击目标告警所在行的“名称”字段，查看告警详情。
4.
查看告警详情中的“定位信息”字段，获取备份任务执行失败的Region信息，执
行步骤2。
步骤2 登录该Region的备份服务器，查看剩余空间是否充足。
1.
若空间不足，请更换备份服务器。
2.
若备份服务器空间足够，执行步骤3。
步骤3 请联系技术支持工程师协助解决。
----结束
告警清除
ADMC：备份任务执行失败，需要联系技术支持工程师协助解决后手工清除，系统不
能自动清除此告警。
参考信息
无。
1.3.17
华为虚拟化资源池
1.3.17.1 ALM-MOVCDRService_100091
话单文件发送到计量中心文件服务器失败
告警
告警解释
上传话单文件到计量中心文件服务器失败，产生此告警。
1

## Page 854

告警属性
告警ID 告警级别 告警类型
MOVCDRService_100091
重要 通信告警
告警参数
参数名称 参数含义
计量中心文件服务器 计量中心文件服务器的地址。
对系统的影响
资源的话单文件无法正常上传，导致计量系统无法采集到话单，影响资源的计量统
计。
可能原因
●
计量中心文件服务器不能正常使用。
●
计量中心文件服务器空间不足。
处理步骤
步骤1 检查计量中心文件服务器是否可以正常登录。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“系统管理
>
系统集成
>
数据通道”。
3.
在“分组名称”为“METERSFTP”的所在行，单击“修改”。
4.
设置“端口号”、“用户名”、“密码”和“地址”对应的“值”并记录。
5.
使用FileZilla工具，根据步骤1.4中记录的信息，检查是否可以正常登录计量中心
服务器。
–
是：执行步骤2。
–
否：请联系技术支持工程师协助解决。
步骤2 检查计量中心文件服务器的/opt/sftpfile/opt/meterfiles/uploads目录，是否有权限创
建文件。
●
是：删除创建的文件，执行步骤3。
● 否：请联系技术支持工程师协助解决。
步骤3 检查计量中心文件服务器的/opt/sftpfile/opt/meterfiles/uploads目录，已用空间是否
超过5GB。
●
是：请联系技术支持工程师协助解决。
1

## Page 855

●
否：执行步骤4。
图1-15 uploads目录已用空间
步骤4 等待1个小时后，检查计量中心文件服务器的/opt/sftpfile/opt/meterfiles/uploads目
录，是否有新的话单文件上传。
●
是：告警处理完毕。
●
否：请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无
1.3.18
部署面告警参考
说明
ManageOne运营指挥中心不支持HCS Online场景。
1.3.18.1 CloudSOP
管理
1.3.18.1.1 ALM-101209
节点故障倒换
告警解释
当主节点发生故障导致OMMHA倒换，或者手工倒换，倒换完成后，会产生该告警。
当倒换完成，OMMHA状态正常和OMMHA监控的资源状态均恢复正常时，该告警会
自动清除。
告警属性
告警ID 告警级别 告警类型
101209
紧急 保护倒换
告警参数
类别 参数名称 参数含义
定位信息 节点名称 倒换后的主节点名称。
站点名称 产生告警的站点名称。
1

## Page 856

类别 参数名称 参数含义
IP地址 倒换后的主节点IP地址。
产品名称 产生告警的产品名称。
对系统的影响
●
浮动IP地址从主节点切换到备节点。
●
浮动IP地址切换过程中，管理面无法登录。
●
主备节点倒换过程中业务无法使用。
可能原因
●
原主节点虚拟机所在的硬件故障。
●
原主节点异常断电。
●
原主节点critical类型的进程异常。
●
原主节点CPU、内存耗用过高。
●
原主节点所在网络故障。
●
浮动IP地址挂载不成功。
●
用户进行了手工倒换。
处理步骤
步骤1 检查原主节点虚拟机所在硬件是否故障、原主节点是否发生异常断电。
如果由于原主节点虚拟机所在硬件故障或原主节点异常断电导致OMMHA倒换，请联
系管理员修复故障。
步骤2 检查主节点进程状态是否正常。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录产生告警的节点。获取节点IP地
址的方法请参见《ManageOne
8.1.0
安全管理指南》中的“如何查找节点对应的
IP地址”章节。
2.
执行以下命令，切换到ossadm用户。
> su - ossadm
Password:
ossadm用户的密码
3.
执行如下命令，查询主备节点的状态：
> cd /opt/oss/manager/apps/OMMHAService/bin
> bash status.sh
说明
如果是产品节点，该路径中的“/opt/oss/manager”则改为“/opt/oss/SOP”。
系统回显类似如下提示信息：
NodeName HostName ... HAAllResOK HARunPhase
ha2 Service-2 ... normal Active
ha1 Service-1 ... normal Inactive
NodeName ResName ... ResHAStatus ResType
1

## Page 857

ha2 RMCritical ... Normal Active_standby
ha2 RMFloatIp ... Normal Single_active
ha2 RMIrNic ... Normal Single_active
ha1 RMCritical ... Normal Active_standby
ha1 RMFloatIp ... Normal Single_active
ha1 RMIrNic ... Normal Single_active
–
如果回显信息中的“HAAllResOK”和“ResHAStatus”均为“Normal”状
态，则表示倒换完成，且状态正常，该告警将自动清除。
–
如果“HAAllResOK”和“ResHAStatus”存在“Normal”以外的状态，则
表示存在节点故障或倒换未完成。
步骤3 等待3分钟，检查告警是否清除。
●
是，处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.18.1.2 ALM-51023 NTP
服务异常
告警解释
管理面默认间隔5分钟检测一次如下检查项，当连续3次检测到NTP服务器存在且状态
为失效或时间差超过60秒时，产生此告警。
●
NTP服务器的状态。
●
产品节点间的最大时间差值。
●
节点与NTP服务器间的时间差值。
当连续3次检测到NTP服务器存在且状态为正常或时间差小于或等于60秒时，告警将自
动清除。
告警属性
告警ID 告警级别 告警类型
51023
紧急 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 节点名称 产生告警的节点名称。
1

## Page 858

类别 参数名称 参数含义
站点名称 产生告警的站点名称。
产品别名 产生告警的产品别名。
附加信息 NTP地址 出现异常的NTP服务器IP地址。
节点IP地址 最大时间差对应的节点IP地址。
时间差值 产品节点间的最大时间差或节点与NTP
服务器的时间差。
断连的NTP地址 与节点断连的NTP服务器IP地址。
可达但时间同步状态失
效的NTP地址
与节点连接正常但时间同步状态失效的
NTP服务器IP地址。
对系统的影响
各CloudSOP服务如果无法从上级NTP服务器进行时间同步，将导致网络中各设备时间
不准确，在执行备份恢复、操作日志记录等需要记录时间戳的操作时，有可能会出现
因备份包恢复错误或日志获取错误等问题而影响业务处理效率。
可能原因
●
节点间的时间同步关系异常。
●
多个NTP服务器之间的时间不一致。
●
节点的NTP服务异常（可能由于NTP配置文件异常或者进程运行异常导致或者多
个NTP服务器之间的时间不一致）。
●
NTP服务器异常。
●
节点与NTP服务器之间通信异常。
●
产品节点间最大时间差超过60秒。
●
节点与NTP服务器时间差超过60秒。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
查看该告警中的可能原因信息，根据表1-58选择对应的处理步骤。
1

## Page 859

表1-58 操作指引
类别 可能原因 处理步骤
NTP服务异常 节点间的时间同步关系
异常。
1.
使用浏览器登录ManageOne部署
面。
登录地址：https://ManageOne部署
面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在管理面主菜单中选择“维护
>
时间
管理
>
配置NTP”，在“配置NTP”
页面单击“重新配置”，修复节点的
时间同步关系。检查告警是否清除。
●
是，处理结束。
●
否，请联系华为技术支持工程师处
理。
多个NTP服务器之间的
时间不一致。
请用户自行调整NTP服务器的系统时
间，保证所有NTP服务器的系统时间一
致。检查告警是否清除。
●
是，处理结束。
●
否，请联系华为技术支持工程师处
理。
1

## Page 860

类别 可能原因 处理步骤
节点的NTP服务异常
（可能由于NTP配置文
件异常或者进程运行异
常导致或者多个NTP服
务器之间的时间不一
致）。
1.
使用PuTTY工具以sopuser用户通过
SSH方式登录产生告警的节点。获取
节点IP地址的方法请参见
《ManageOne
8.1.0
安全管理指
南》中的“如何查找节点对应的IP地
址”章节。
2.
执行以下命令，切换到ossadm用
户。
> su - ossadm
Password:ossadm用户的密码
3.
执行以下命令，判断NTP服务使用的
组件。
> bash /usr/local/osconfig/os/bin/
getsupportntptype.sh
●
若如下类似回显信息，则表示NTP
服务使用的是ntpd组件。
["ntpd"]
●
若如下类似回显信息，则表示NTP
服务使用的是chrony组件。
["ntpd", "chrony"]
4.
执行以下命令，切换至root用户。
> su - root
Password:
root用户的密码
5.
根据3中查询的组件类型选择对应的
操作，检查NTP服务是否已经启动。
●
ntp组件
# service ntpd status
–
若系统回显信息中包含“active
(running)”字样的信息，说明
节点的NTP服务已启动。
–
否则，说明节点的NTP服务未
启动，执行以下命令启动NTP
服务。
# service ntpd start
● chrony组件
# service chronyd status
– 若系统回显信息中包含“active
(running)”字样的信息，说明
节点的NTP服务已启动。
– 否则，说明节点的NTP服务未
启动，执行以下命令启动NTP
服务。
# systemctl start chronyd
6. 根据3中查询的组件类型选择对应的
操作，检查当前节点的时间和上级
NTP服务器的时间差从而判断是否执
行强制同步时区时间操作。
1

## Page 861

类别 可能原因 处理步骤
●
ntp组件
# ntpq -np
remote ... offset jitter
==================================
===
* x.x.x.x ... -0.024 0.043
当系统回显信息中“offset”绝对
值大于5000，表示当前节点的时
间和上级NTP服务器的时间超过5
秒，执行7，否则执行11。
●
chrony组件
# chronyc tracking
...
System time: 8.829101562 seconds fast of
NTP time
...
当系统回显信息中“System
time”绝对值大于5秒，表示当前
节点的时间和上级NTP服务器的时
间超过5秒，执行7，否则执行
11。
7.
执行以下命令，退出root用户。
# exit
8.
使用浏览器登录ManageOne部署
面。
登录地址：https://ManageOne部署
面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
9.
如果NTP服务器使用的是chrony组
件，在管理面主菜单中选择“维护
>
时间管理
>
配置NTP”，在“配置
NTP”界面修改该NTP服务器的“Key
值”，结合界面上该值的配置规则根
据实际情况修改。否则请跳过本步
骤。
10.执行强制同步时区时间操作。
a.
在管理面主菜单中选择“维护
>
时间管理
>
配置时区时间”。
b.
在“配置时区时间”界面，单击
“强制同步”。
1

## Page 862

类别 可能原因 处理步骤
说明
●
强制同步时区时间前管理面会自动
停止产品服务和产品数据库，导致
该服务涉及功能不可用，强制同步
时区时间完成后系统会自动启动产
品数据库和产品服务，功能即可恢
复。
● 对于异地容灾场景，修改时区时间
前需先删除主备站点间的异地容灾
关系，具体操作请参见《华为云
Stack 8.1.0 运维指南》中的“删
除异地容灾系统”章节。
c.
在管理面主菜单选择“系统
>
任
务列表”，等待“强制同步时区时
间”任务执行成功。
d.
完成强制同步时区时间操作后等待
大约1～15分钟，执行12
11.请用户自行调整NTP服务器的系统时
间，保证所有NTP服务器的系统时间
一致。
12.检查告警是否清除。
●
是，处理结束。
●
否，请联系华为技术支持工程师处
理。
1

## Page 863

类别 可能原因 处理步骤
●
NTP服务器异常。
●
节点与NTP服务器之
间通信异常。
1.
检查管理节点与NTP服务器网络连接
是否正常。
a.
使用PuTTY工具以sopuser用户通
过SSH方式登录管理节点。
b.
检查NTP服务器是否能正常通信。
> su - root
Password:
root用户的密码
# ntpdate -q
NTP服务器的IP地址
如果回显包含如下显示，且信息中
stratum的值为1~16，
offset
不为
0，delay 不为0，表示NTP能正常
通信。否则联系华为技术支持工程
师处理。
server
NTP服务器的IP地址,
stratum 6,
offset -0.000010, delay 0.02599
c.
执行以下命令，退出root用户。
# exit
2.
检查NTP服务器是否正常，如果异
常，请自行修复NTP服务器异常。
3.
修复以后，建议等待半小时后，再检
查告警是否清除。
●
是，处理结束。
●
否，请联系华为技术支持工程师处
理。
时间差 产品节点间最大时间差
超过60秒。
1.
执行以下步骤，强制同步时区时间。
a.
在管理面主菜单中选择“维护
>
时间管理
>
配置时区时间”。
b.
在“配置时区时间”界面，单击
“强制同步”。
说明
强制同步时区时间前管理面会自动停
止产品服务和产品数据库，导致该服
务涉及功能不可用，强制同步时区时
间完成后系统会自动启动产品数据库
和产品服务，功能即可恢复。
c.
在管理面主菜单选择“系统
>
任
务列表”，等待“强制同步时区时
间”任务执行成功。
2.
执行完强制同步时区时间操作后等待
大约1～15分钟，检查告警是否清
除。
●
是，处理结束。
●
否，请联系华为技术支持工程师处
理。
节点与NTP服务器时间
差超过60秒。
1

## Page 864

告警清除
ADAC：当连续3次检测到NTP服务器存在且状态为正常且时间差小于或等于60秒时，
告警将自动清除。
参考信息
无。
1.3.18.1.3 ALM-101211
数据库实例故障倒换
告警解释
当数据库实例故障倒换成功时，产生此告警。该告警产生后会自动清除，但是当数据
库实例故障倒换期间数据库由于无法提供服务时，需手工清除此告警。
告警属性
告警ID 告警级别 告警类型
101211
重要 处理错误告警
告警参数
类别 参数名称 参数含义
定位信
息
主机 产生告警的节点名称。
数据库服务 产生告警的数据库实例名称。
数据库类型 数据库实例类型。
附加信
息
IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
数据库实例复制状态不正常，可能会有数据丢失。
可能原因
●
数据库主实例所在节点故障或者下电。
● 数据库主实例故障或者停止运行。
处理步骤
步骤1 登录管理面。
1.
打开浏览器，在地址栏中输入“https://管理面的客户端登录IP地址:31945”，按
“Enter”。
1

## Page 865

说明
如果管理面的部署模式是集群模式，即存在多个管理节点，请使用管理节点浮动IP地址进
行登录。
2. 在登录页面，输入用户名和密码，单击“登录”。
步骤2 在管理面主菜单中选择“维护 > 运维管理 > 全景监控”。
步骤3 在左侧导航树中选择“中间件监控”，选择对应的产品。查看关系数据库和Redis数据
库是否为“正在运行”状态。
●
是，在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。选择“数据库
实例故障倒换”的告警，单击“清除”，手工清除此告警。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警。
当数据库实例故障倒换期间数据库由于无法提供服务，可能出现无法清除的告警时，
需手工清除此告警。
参考信息
无。
1.3.18.1.4 ALM-101212
连接ZooKeeper 失败
告警解释
当DBAgent服务连接不上MCZKService时，此时数据库倒换功能异常，产生一条告
警。当DBAgent连接上MCZKService集群中的节点时，告警会自动清除。
告警属性
告警ID 告警级别 告警类型
101212
重要 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 主机 产生告警的节点名称。
服务名 服务名称。
对系统的影响
数据库倒换功能无法使用，数据库访问路由无法刷新。
1

## Page 866

可能原因
●
所有的MCZKService微服务故障。
●
所有的MCZKService所在节点故障，或者网络故障。
●
在DBAgent服务的环境变量中，MCZKService的IP地址和端口错误。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 查看是否存在告警“101208 节点状态异常”，并且该告警和本告警的告警参数“主
机”对应的节点名称相同。
●
是，处理异常告警，具体操作请参见1.3.18.2.3
ALM-101208
节点状态异常。
●
否，执行步骤2。
步骤2 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤3 查看MCZKService微服务进程运行状态。
1.
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”。
2.
在左侧导航树中选择“服务监控”。
3.
在“服务监控”页面左上方选择“CloudSOP-UniEP”。
4.
选择“进程”页签，在搜索框中输入“mczkapp”，并单击 。
5.
查看以“mczkapp”开头的所有服务进程的“状态”。
–
如果“状态”为“正在运行”，说明MCZKService微服务进程运行正常，执
行步骤4。
–
如果“状态”为“启动中”或“停止中”，单服务进程的启停时长一般不超
过1分钟，如果服务进程长时间处于该状态，请联系华为技术支持工程师处
理。
–
如果“状态”为“故障”、“未知”或“未运行”，说明MCZKService微服
务进程运行异常，请联系华为技术支持工程师处理。
步骤4 检查告警是否清除。
●
是，处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：当DBAgent连接上MCZKService集群中的节点时，告警会自动清除。
1

## Page 867

参考信息
无。
1.3.18.1.5 ALM-103707
关系数据库核心文件变更
告警解释
当DBAgent检测（检测周期为每天）到关系数据库zsql和zengine文件缺失或者依赖的
核心so后缀文件缺失/文件大小、权限、属组变更时，产生该告警。该告警需要手工清
除。
告警属性
告警ID 告警级别 告警类型
103707
紧急 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 节点 产生告警的节点维护IP地址。
详情 关系数据库文件缺失或者依赖的核心so后缀文件的变
更信息，如zsql和zengine文件缺失或者依赖的核心so
后缀文件缺失/文件大小、权限、属组变更等。
对系统的影响
数据库不可用。
可能原因
●
操作系统升级，导致文件丢失。
●
异常掉电，导致操作系统文件损坏。
处理步骤
获取告警中的定位信息后，请联系华为技术支持工程师处理。
告警清除
ADMC：此告警修复后，需手工清除。
参考信息
无。
1

## Page 868

1.3.18.1.6 ALM-103695
保护密码已经过期
告警解释
系统每天对管理面数据完整性校验密钥的保护密码有效期进行一次检查，当保护密码
的有效期过期时，产生该告警。
告警属性
告警ID 告警级别 告警类型
103695
紧急 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 站点名称 产生告警的站点名称。
对系统的影响
数据完整性校验密钥的保护密码失效，将无法正常使用备份恢复功能。
可能原因
数据完整性校验密钥的保护密码已超过有效期。
处理步骤
手工更新保护密码，具体操作请参见《ManageOne
8.1.0
安全管理指南》手册中“修
改数据完整性校验密钥的保护密码”章节。
告警清除
ADAC：系统在更新保护密码后的00:00:00检查密码的有效性，密码有效则系统会自动
清除此告警，无需手工清除。
参考信息
无。
1.3.18.1.7 ALM-103696
保护密码即将过期
告警解释
系统每天对管理面数据完整性校验密钥的保护密码有效期进行一次检查，当保护密码
的有效期不足10天时，产生该告警。
1

## Page 869

告警属性
告警ID 告警级别 告警类型
103696 重要 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 站点名称 产生告警的站点名称。
对系统的影响
数据完整性校验密钥的保护密码失效，将无法正常使用备份恢复功能。
可能原因
数据完整性校验密钥的保护密码有效期已不足10天。
处理步骤
手工更新保护密码，具体操作请参见《ManageOne
8.1.0
安全管理指南》手册中“修
改数据完整性校验密钥的保护密码”章节。
告警清除
ADAC：系统在更新保护密码后的00:00:00检查密码的有效性，密码有效则系统会自动
清除此告警，无需手工清除。
参考信息
无。
1.3.18.1.8 ALM-103644
操作系统用户密码已经过期
告警解释
系统每天对管理面和产品操作系统用户的密码有效期进行一次检查，当操作系统用户
密码的有效期过期时，产生该告警。
告警属性
告警ID 告警级别 告警类型
103644
紧急 处理错误告警
1

## Page 870

告警参数
类别 参数名称 参数含义
定位信息 产品别名 产生告警的产品别名。
用户名 密码已经过期的用户名称。
站点名称 产生告警的站点名称。
对系统的影响
操作系统用户的密码过期可能导致节点连接异常。
可能原因
操作系统用户密码已超过有效期。
处理步骤
手工修改操作系统用户密码，具体操作请参见《ManageOne
8.1.0
安全管理指南》手
册中“帐户一览表”章节获取帐户一览表，根据帐户一览表中“B类
（ManageOne）”页签中的“修改密码具体操作”进行修改操作系统用户密码。
告警清除
ADAC：系统在修改操作系统用户密码后系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.18.1.9 ALM-103643
操作系统用户密码即将过期
告警解释
系统每天对管理面和产品操作系统用户密码有效期进行一次检查，当操作系统用户密
码的有效期不足10天时，产生该告警。
告警属性
告警ID 告警级别 告警类型
103643
重要 处理错误告警
1

## Page 871

告警参数
类别 参数名称 参数含义
定位信息 产品别名 产生告警的产品别名。
用户名 密码即将过期的用户名称。
站点名称 产生告警的站点名称。
对系统的影响
操作系统用户的密码过期可能导致节点连接异常。
可能原因
操作系统用户密码有效期已不足10天。
处理步骤
手工修改操作系统用户密码，具体操作请参见《ManageOne
8.1.0
安全管理指南》手
册中“帐户一览表”章节获取帐户一览表，根据帐户一览表中“B类
（ManageOne）”页签中的“修改密码具体操作”进行修改操作系统用户密码。
告警清除
ADAC：系统在修改操作系统用户密码后系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.18.2
系统监控
1.3.18.2.1 ALM-151
CPU占用率过高告警
告警解释
管理面会对服务器CPU（Central
Processing
Unit）的使用率进行持续采样。在连续的
采样周期（过载次数×60秒）内，每次采样的CPU使用率均大于等于告警产生阈值时，
产生该告警。如果采样周期内有一次CPU使用率采样小于告警产生阈值时，该告警会
自动清除。
告警属性
告警ID 告警级别 告警类型
151
重要 越限
1

## Page 872

告警参数
类别 参数名称 参数含义
定位信息 主机 发生故障时，故障节点的名称。
操作系统 服务器的操作系统。
站点名称 产生告警的站点名称。
附加信息 产生门限 告警产生的门限值。
清除门限 告警清除的门限值。
占用率 服务器的CPU占用率。
IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
●
产生该告警的节点的响应变慢，与该节点相关的操作可能会出现延时。
●
实时上报性能、告警等出现延迟，不能及时获取信息。
●
业务处理缓慢，可能导致消息堆积。
可能原因
●
临时性的系统繁忙。
●
该节点CPU使用率的告警产生阈值设置不合理。
● 正在执行消耗系统资源的操作。
●
该节点硬件性能较低，不支持系统的正常运行。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 检查管理面是否存在多个任务正在执行。
在管理面主菜单中选择“系统
>
任务列表”，等待当前所有任务结束后，查看告警是
否清除。
●
是，告警处理结束。
1

## Page 873

●
否，请执行步骤3。
步骤3 检查CPU使用率的阈值设置是否合理。
1.
在管理面主菜单中选择“维护
>
运维管理
>
阈值规则设置”。
2.
在左侧导航树中选择“异常事件阈值”。
3.
在“异常事件阈值”页面左上方选择告警参数中“产品别名”对应的产品，检查
CPU占用率过高告警的阈值设置是否合理。
–
是，执行步骤4。
–
否，重新设置阈值，执行步骤7。
步骤4 检查是否存在应用程序CPU占用率超过告警产生阈值。
1.
在“节点”页签下，查找产生告警的节点名称。
2.
查看对应的CPU使用率是否超过设定的告警产生阈值。
–
是，可能由于应用程序导致CPU资源耗尽，待进程对应的业务处理完毕后，
执行步骤7。若无法等待业务处理完毕，请收集上述告警处理过程中的信息，
联系华为技术支持工程师协助解决。
–
否，执行步骤5。
步骤5 检查是否存在非应用程序CPU占用率超过告警产生阈值。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录告警参数中的故障节点。
2.
执行以下命令，查看“%CPU”列对应进程的CPU使用率，是否存在非应用程序
CPU占用率超过告警产生阈值。
top
–
是，联系华为技术支持工程师协助解决。告警处理结束。
– 否，执行步骤6。
步骤6 检查当前系统管理规模对应的硬件要求是否超过服务器硬件实际能力，同时经常连续
或频繁收到此告警。
●
是，说明服务器硬件性能过低，导致无法支撑系统正常运行，联系华为技术支持
工程师协助解决。告警处理结束。
●
否，执行步骤7。
步骤7 等待1分钟，查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
●
产生该告警的节点名称发生了变化。
●
产生该告警的站点名称发生了变化。
●
产生该告警的服务器不被监控了。
1

## Page 874

参考信息
无。
1.3.18.2.2 ALM-152
网管服务异常退出告警
告警解释
当管理面检测（检测周期为30秒）到某个业务进程异常退出后，连续10次启动进程失
败时，产生该告警。当管理面检测到进程启动时，该告警会自动清除。对于主备类型
的进程实例，当管理面检测（检测周期为10秒）到主进程异常退出后，启动1次该进程
失败时，产生该告警。当管理面检测到该进程启动后或者备进程升主后，该告警会自
动清除。
告警属性
告警ID 告警级别 告警类型
152
重要 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 服务器名 发生故障时，故障节点的名称。
服务代理 产生告警的进程名称。
服务名 产生告警的服务实例名称。
站点名称 产生告警的站点名称。
附加信息 IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
进程退出后相关业务功能不可用，并且影响依赖相关功能的服务。
可能原因
系统资源不足。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
1

## Page 875

步骤1 查看告警参数中“服务名”是否为“UniEPMgr”。
● 是，执行步骤2。
●
否，执行步骤3。
步骤2 启动管理面服务。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录告警参数中的故障节点。
2.
执行以下命令，切换到ossadm用户。
> su - ossadm
Password:ossadm用户的密码
3.
查看告警参数中“服务代理”是否包含“ommha”。
–
是，执行以下命令，启动OMMHA进程，然后执行步骤2.5。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd startapp -app OMMHAService -tenant manager
系统提示如下回显信息，进程提示“success”，则说明OMMHA进程启动成
功。否则请联系华为技术支持工程师。
Starting process ommha-0-0 ... success
–
否，执行步骤2.4。
4.
执行以下命令，启动管理面服务。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd startmgr
系统提示如下类似回显信息，所有进程都提示“success”，则说明管理面服务启
动成功。否则请联系华为技术支持工程师。
...
============================ Starting management dc is complete.
...
============================ Starting management processes is complete
5.
查看告警是否清除。
–
是，处理完毕。
–
否，请联系华为技术支持工程师处理。
步骤3 确保服务进程已启动。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在管理面主菜单中选择“维护
>
运维管理
>
全景监控”。
3.
在左侧导航树中选择“节点监控”。
4.
在“节点监控”页面左上方选择告警参数中“产品别名”对应的产品。
5. 在“节点列表”中，单击产生告警的节点名称。
6.
在左侧导航树中选择“服务监控”。
7.
单击“进程”页签，查看服务进程是否为“正在运行”状态。
–
是，执行步骤3.8。
–
否，请联系华为技术支持工程师处理。
8.
查看告警是否清除。
1

## Page 876

–
是，处理完毕。
–
否，请联系华为技术支持工程师处理。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
●
产生该告警的节点名称发生了变化。
●
产生该告警的站点名称发生了变化。
●
产生该告警的服务器不被监控了。
参考信息
无。
1.3.18.2.3 ALM-101208
节点状态异常
告警解释
当管理面连续8次检测（检测周期为180秒）到节点无数据上报时，将发送该告警。当
节点恢复正常时，该告警将自动清除。
告警属性
告警ID 告警级别 告警类型
101208
重要 通信告警
告警参数
类别 参数名称 参数含义
定位信息 主机 发生故障时，故障节点的名称。
站点名称 产生告警的站点名称。
附加信息 IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
无法登录节点，或者在节点上执行操作时可能报错。
1

## Page 877

可能原因
●
该节点操作系统无法登录或无响应。
●
该节点被下电或网络连接异常。
●
该节点的DeployAgent进程异常。
●
该节点的IR证书过期，系统内部通信异常。
●
如果该节点上存在数据库，则可能是数据库实例的数据库复制状态异常，导致节
点异常。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 依次执行表1-59中的检查项及其检查方法，按照对应的故障排除方法修复故障节点。
说明
导致产品节点故障的因素复杂，本节提供该告警基本的排查方法，如果按照以下操作仍然无法清
除该告警，请收集告警处理过程中的信息，联系华为技术支持工程师协助解决。
表1-59 产品节点故障排查
序号 检查项 检查方法 故障排除方法
1
网络连接 联系管理员检查网络是否异
常。
请联系管理员修复网络。
2
虚拟机或物理机
运行状态
联系管理员检查虚拟机或物
理机是否异常，例如虚拟机
或物理机是否被下电或者被
删除。
请联系管理员重启并修复
虚拟机或物理机。
3
操作系统运行状
态
1.
重启操作系统。
2.
尝试使用PuTTY工具以
sopuser用户通过SSH方
式登录故障节点。
如果不能正常登录或无响
应，则说明故障节点的操
作系统异常，恢复其操作
系统，具体操作请联系技
术支持工程师处理。
1

## Page 878

序号 检查项 检查方法 故障排除方法
4
DeployAgent进
程运行状态
1.
使用PuTTY工具以
sopuser用户通过SSH方
式登录故障节点。
2.
执行以下命令，切换到
ossadm用户。
su - ossadm
Password:ossadm用户的密码
3.
执行以下命令，检查
DeployAgent进程是否
运行正常。
source /opt/oss/
manager/bin/
engr_profile.sh
ipmc_adm -cmd
statusmgr
ossadm 321431 1 5
11:45 ? 00:27:26 /opt/oss/
manager/agent/DeployAgent/
rtsp/python/bin/
python /opt/oss/manager/
apps/DeployAgent-21.20.8/
tools/pyscript/deployagent/
DeployAgent.pyc -
DNFW=deployagent
...
–
系统回显信息中，若
存在
“deployagent”字
样则代表服务为启动
状态。
–
系统回显信息中，若
不存在
“deployagent”字
样则代表服务为停止
状态。
如果DeployAgent进程未
运行，执行以下命令启动
进程。
source /opt/oss/
manager/bin/
engr_profile.sh
ipmc_adm -cmd
startmgr -app
DeployAgent
系统提示如下回显信息表
示DeployAgent进程启动
成功，否则请联系华为技
术支持工程师处理。
==========================
== Starting management
processes...
Starting deployagent...
start deployagent... success
Starting mcwatchdog...
start mcwatchdog... success
Starting tracemonitor...
start tracemonitor... success
==========================
== Starting management
processes is complete.
1

## Page 879

序号 检查项 检查方法 故障排除方法
5
IR证书
1.
使用PuTTY工具以
sopuser用户通过SSH方
式登录故障节点。
2.
执行以下命令，切换到
ossadm用户。
> su - ossadm
Password:ossadm用户的密码
3.
执行以下命令，查看IR
证书有效期。
cd /opt/oss/
manager/etc/ssl/
internal
openssl x509 -in
server.cer -noout -
dates
回显以下类似信息，
“notAfter”后所显示的
时间即为IR证书的到期
时间。
notBefore=Oct 18 00:00:00
2018 GMT
notAfter=Oct 13 00:00:00
2038 GMT
–
如果IR证书已过期，
请更新CA证书。
–
如果IR证书没有过
期，则表示不是证书
过期导致该故障。
更新CA证书，具体操作请
联系技术支持工程师处
理。
6
数据库复制状态 请参见1.3.18.2.11
ALM-101210
数据库本地
主备复制异常。
请参见1.3.18.2.11
ALM-101210
数据库本地
主备复制异常。
步骤2 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤3 在管理面主菜单中选择“维护
>
运维管理
>
全景监控”。
步骤4 在左侧导航树中选择“节点监控”。
步骤5 在“节点监控”页面左上方选择告警参数中“产品别名”对应的产品。
步骤6 在“节点列表”中，根据“附加信息”的IP地址查看节点的状态。
●
如果恢复的节点的状态为“正常”，则告警已修复。
●
如果恢复的节点的状态不为正常，请联系华为技术支持工程师。
----结束
1

## Page 880

告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
●
产生该告警的节点名称发生了变化。
●
产生该告警的站点名称发生了变化。
●
产生该告警的服务器不被监控了。
参考信息
无。
1.3.18.2.4 ALM-154
内存占用率过高告警
告警解释
当管理面连续N（表示过载次数）次检测（检测周期为60秒）到物理内存占用率大于
等于告警产生阈值时，产生该告警。当物理内存占用率小于等于告警清除阈值时，该
告警会自动清除。
告警属性
告警ID 告警级别 告警类型
154
重要 越限
告警参数
类别 参数名称 参数含义
定位信息 主机 发生故障时，故障节点的名称。
操作系统 服务器的操作系统。
站点名称 产生告警的站点名称。
附加信息 产生门限 告警产生的门限值。
清除门限 告警清除的门限值。
占用率 物理内存的占用率。
IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
产生该告警的节点的响应变慢，与该节点相关的操作可能会出现延时。
1

## Page 881

可能原因
●
该节点物理内存占用率的产生门限值设置不合理。
●
正在执行消耗系统资源或耗时的操作。
●
业务处理繁忙，物理内存占用率增加。
●
程序处理异常。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 检查内存使用率的阈值设置是否合理。
1.
在管理面主菜单中选择“维护
>
运维管理
>
阈值规则设置”。
2.
在左侧导航树中选择“异常事件阈值”。
3.
在“异常事件阈值”页面左上方选择告警参数中“产品别名”对应的产品，检查
内存占用率过高告警的阈值设置是否合理。
–
是，执行步骤3。
–
否，重新设置阈值，执行步骤6。
步骤3 检查应用程序物理内存占用率。
1.
在管理面主菜单中选择“维护
>
运维管理
>
全景监控”。
2.
在左侧导航树中选择“节点监控”。
3.
在“节点监控”页面左上方选择告警参数中“产品别名”对应的产品。
4.
在“节点列表”中，查找产生告警的节点名称。
5.
查看对应的物理内存占用率是否超过设定的告警产生阈值。
–
是，可能由于应用程序导致物理内存资源耗尽，待进程对应的业务处理完毕
后，执行步骤6。若无法等待业务处理完毕，收集上述告警处理过程中的信
息，联系华为技术支持工程师协助解决。
–
否，执行步骤4。
步骤4 检查非应用程序物理内存占用率最高的进程。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录故障节点。
2.
执行以下命令，在“%MEM”列查看对应进程的物理内存占用率是否超过设定的
告警产生阈值。
top
...
PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND
164860 ossadm 20 0 832312 496564 18164 S 20.199 1.539 1480:48 java
1

## Page 882

–
是，请华为技术支持工程师协助解决。告警处理结束。
–
否，执行步骤5。
步骤5 如果物理内存足够，即使业务处理完毕后，物理内存也不会被回收，故告警不会被清
除。此时只需确认物理内存占用率是否有继续增加。判断方法如下：
1.
在管理面主菜单中选择“维护
>
运维管理
>
全景监控”。
2.
在左侧导航树中选择“节点监控”。
3.
在“节点监控”页面左上方选择告警参数中“产品别名”对应的产品。
4. 在“节点列表”中，查找产生告警的节点名称。
5.
查看对应的物理内存占用率是否有持续增加。
–
是，执行步骤6。
–
否，告警处理结束。
步骤6 等待1分钟，查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
●
产生该告警的节点名称发生了变化。
●
产生该告警的站点名称发生了变化。
●
产生该告警的服务器不被监控了。
参考信息
无。
1.3.18.2.5 ALM-36
磁盘占用率过高告警
告警解释
当管理面连续N（表示过载次数）次检测（检测周期为60秒）到磁盘或者某一分区的
占用率大于等于告警产生阈值时，产生该告警。当磁盘或者某一分区的占用率小于等
于告警清除阈值时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
36
重要 越限
1

## Page 883

告警参数
类别 参数名称 参数含义
定位信息 主机 发生故障时，故障节点的名称。
操作系统 服务器的操作系统。
磁盘 产生告警的服务器磁盘名称。
站点名称 产生告警的站点名称。
附加信息 产生门限 告警产生的门限值。
清除门限 告警清除的门限值。
容量 磁盘容量。
占用率 磁盘空间使用率。
IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
磁盘占用率过高可能导致服务进行磁盘写操作失败，并可能引发数据库异常。
可能原因
●
该节点磁盘占用率的告警产生阈值设置不合理。
●
磁盘中的无用文件过多。
–
回收站未被清空。
–
收到过多的网元告警、事件、日志，短期内大量数据从数据库中导出到磁盘
文件中。
–
保留了过多的暂存的数据文件、备份文件。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 检查磁盘使用率的阈值设置是否合理。
1

## Page 884

1.
在管理面主菜单中选择“维护
>
运维管理
>
阈值规则设置”。
2.
在左侧导航树中选择“异常事件阈值”。
3. 在“异常事件阈值”页面左上方选择告警参数中“产品别名”对应的产品，检查
磁盘占用率过高告警的阈值设置是否合理。
–
是，执行步骤3。
–
否，重新设置阈值，执行步骤4。
步骤3 清理磁盘中的无用文件。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录故障节点。
2.
执行以下命令，切换到root用户。
su - root
Password:root用户的密码
3.
执行以下命令，检查和确认哪些位置磁盘使用率过高。
df -k
说明
如果发现告警参数中的“磁盘”之外的位置也存在磁盘占用率高但还没有达到告警产生阈
值，可以一起处理。
4.
执行以下命令，进入磁盘使用率高的目录后查询该位置所有文件、目录大小，并
排序后写入文件“du_k.txt”。
cd filepath
du -k | sort -nr > /tmp/du_k.txt
5. 执行以下命令，查看“du_k.txt”文件，找到引起磁盘空间过高的子目录。
more /tmp/du_k.txt
6.
执行以下命令，进入引起磁盘空间过高的子目录后查询该位置所有文件、目录大
小，并排序后写入文件“ls_l.txt”。
cd filepath
ls -l | sort -nr > /tmp/ls_l.txt
7.
执行以下命令，查看“ls_l.txt”文件，找到引起磁盘空间过高的目录或文件。
more /tmp/ls_l.txt
8.
执行以下命令，退出root用户。
exit
9.
反复执行步骤3.4到步骤3.8，直到找到引起磁盘空间过高的文件，自行判断哪些
文件是无用文件并进行清理。
建议优先清理历史备份的安装包、补丁包、适配层安装包，安装过程中的备份文
件，core文件等。可清理的管理面及数据库无用文件。执行文件清理后，执行步
骤4。
说明
如果无法确认文件是否可以删除，请联系华为技术支持工程师。
步骤4 等待1分钟，查看本告警是否自动清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
1

## Page 885

告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
●
产生该告警的节点名称发生了变化。
●
产生该告警的站点名称发生了变化。
●
产生该告警的硬盘的挂接点发生了变化。
●
产生该告警的服务器不被监控了。
参考信息
无。
1.3.18.2.6 ALM-38
数据库进程异常
告警解释
当数据库进程异常停止时，进程异常持续4分钟后会产生该告警；如果告警上报以后，
数据库进程重新出现，该告警将会被自动清除。
告警属性
告警ID 告警级别 告警类型
38 重要 处理错误告警
告警参数
类别 参数名称 参数含义
定位信
息
主机 发生故障时，故障节点的名称。
操作系统 服务器的操作系统。
数据库服务 产生告警的数据库实例名称。
站点名称 产生告警的站点名称。
附加信
息
IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
数据库进程异常会导致业务访问数据库失败，涉及到数据读取的故障、安全菜单等操
作都无法进行。如果长时间异常会导致告警信息丢失或者业务面不可用。
1

## Page 886

可能原因
数据库进程异常停止。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 启动异常数据库服务。查看告警参数中的“产品别名”是否属于管理面。
●
是，启动管理面异常数据库服务。
a.
使用PuTTY工具以sopuser用户通过SSH方式登录管理节点。
b.
执行以下命令，切换到ossadm用户。
> su - ossadm
Password:ossadm用户的密码
c.
执行以下命令，启动异常数据库。
> source /opt/oss/manager/bin/engr_profile.sh
> ipmc_adm -cmd startdc -tenant manager -instance
数据库服务
说明
数据库服务指“定位信息”中的“数据库服务”。
系统提示以下类似回显信息，则说明该数据库服务启动成功。否则请联系华
为技术支持工程师。
...
============================ Starting data container processes is complete.
d.
待数据库服务启动成功后，等待5分钟，检查告警是否清除。
▪
是，处理完毕。
▪
否，请联系华为技术支持工程师处理。
●
否，启动产品异常数据库服务。
a.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
b. 在管理面主菜单中选择“维护 > 运维管理 > 全景监控”。
c.
在左侧导航树中选择“中间件监控”。
d.
在“中间件监控”页面左上方选择告警参数中“产品别名”对应的产品。
e.
在界面右上方，检查“关系数据库”和“Redis数据库”是否存在异常资源。
说明
红色数字为异常资源的个数。
▪
是，在左侧导航树中选择“节点监控”，在“节点监控”页面左上方选
择告警参数中“产品别名”对应的产品，在异常的数据库实例的节点所
在行，单击右侧的 。
1

## Page 887

▪
否，表示非数据库运行异常的原因，联系华为技术支持工程师协助解
决。
f.
待数据库服务启动成功后，等待5分钟，检查告警是否清除。
▪
是，处理完毕。
▪
否，请联系华为技术支持工程师处理。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
●
产生该告警的节点名称发生了变化。
●
产生该告警的站点名称发生了变化。
●
产生该告警的服务器不被监控了。
参考信息
无。
1.3.18.2.7 ALM-44
数据库占用率过高告警
告警解释
当管理面连续N（表示过载次数）次检测（检测周期为60秒）到数据库表空间或者
Redis数据库内存的使用率大于等于产生告警阈值时，产生该告警；当数据库表空间或
者Redis数据库内存的使用率小于清除告警阈值时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
44
重要 越限
告警参数
类别 参数名称 参数含义
定位信息 主机 发生故障时，故障节点的名称。
数据库服务 产生告警的数据库实例名称。
数据库 产生告警的数据库名称。
站点名称 产生告警的站点名称。
附加信息 容量 数据库表空间或Redis数据库内存的大
小。
1

## Page 888

类别 参数名称 参数含义
阈值 告警产生时表示产生告警阈值，告警清
除时表示清除告警阈值。
使用率 关系数据库表空间或Redis数据库内存的
使用率。
IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
数据库表空间或者Redis数据库内存的使用率过高可能会导致管理面数据库相关操作失
败，如告警等信息入库可能会失败。该告警发生时，若不及时处理，可能会导致管理
面、运营面和运维面运行异常。
可能原因
●
该节点数据库表空间或者Redis数据库内存的使用率的产生告警阈值设置不合理。
●
数据被导出或转储后，数据库表空间或者Redis数据库内存未及时释放。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在管理面主菜单中选择“维护
>
运维管理
>
阈值规则设置”。
步骤3 在左侧导航树中选择“异常事件阈值”。
步骤4 在“异常事件阈值”页面左上方选择告警参数中“产品别名”对应的产品。
步骤5 检查数据库占用率过高告警的阈值设置是否合理。
●
是，联系华为技术支持工程师协助解决。
●
否，重新设置阈值，执行步骤6。
步骤6 等待1分钟，查看本告警是否自动清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
1

## Page 889

告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
●
产生该告警的节点名称发生变化。
●
产生该告警的站点名称发生变化。
●
产生该告警的数据库不被监控。
参考信息
无。
1.3.18.2.8 ALM-47
服务内存占用过高告警
告警解释
系统每隔60秒检测一次服务占用内存，当系统连续40次检测到服务占用内存大于等于
用户设定的告警门限值时，产生该告警；只要有一次服务占用内存小于用户设定的告
警门限值时，该告警将会被自动清除。
告警属性
告警ID 告警级别 告警类型
47
重要 越限
告警参数
类别 参数名称 参数含义
定位信息 主机 发生故障时，故障节点的名称。
操作系统 服务器的操作系统。
服务名 产生告警的服务进程名称。
站点名称 产生告警的站点名称。
附加信息 门限值 告警产生门限和清除门限。
占用值 服务使用内存的数值。
IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
业务面服务器的响应速度变慢。
1

## Page 890

可能原因
程序处理异常。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 查看告警参数中的“主机”名称是否属于管理面。
●
是，执行步骤2。
●
否，执行步骤3。
步骤2 重启管理面服务。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录管理节点。
2.
执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
3. 执行以下命令，启动OMMHA进程。
–
如果管理节点为ManageOne-Deploy01节点，请按照先ManageOne-
Deploy01节点再ManageOne-Deploy02节点的顺序。
–
如果管理节点为ManageOne-SMP01节点，请按照先ManageOne-SMP01节
点再ManageOne-SMP02节点的顺序。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd startapp -app OMMHAService -tenant manager
系统提示如下回显信息，进程提示“success”，则说明OMMHA进程启动成功。
否则请联系华为技术支持工程师。
Starting process ommha-0-0 ... success
4.
执行以下命令，启动管理面服务。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd startmgr
说明
管理面服务的主管理节点为ManageOne-Deploy01节点或ManageOne-SMP01节点。
– 如果管理节点为ManageOne-Deploy01节点，则按顺序并行启动ManageOne-
Deploy01节点、ManageOne-Deploy02节点和ManageOne-Service04节点，即在
ManageOne-Deploy01节点执行启动命令后，立即启动ManageOne-Deploy02节点服
务，在ManageOne-Deploy02节点执行启动命令后，立即启动ManageOne-Srvice04节
点服务。
–
如果管理节点为ManageOne-SMP01节点，则按顺序并行启动ManageOne-SMP01节
点、ManageOne-SMP02节点和ManageOne-SMP03节点，即在ManageOne-SMP01
节点执行启动命令后，立即启动ManageOne-SMP02节点服务，在ManageOne-
SMP02节点执行启动命令后，立即启动ManageOne-SMP03节点服务。
所有节点启动完成后，再查看各个节点的启动结果，如果启动失败，请联系华为技术支持
工程师处理。
系统提示如下类似回显信息，所有进程都提示“success”，则说明管理面服务启
动成功。否则请联系华为技术支持工程师。
1

## Page 891

...
============================ Starting management dc is complete.
...
============================ Starting management processes is complete
5.
查看告警是否清除。
–
是，处理完毕。
–
否，请联系华为技术支持工程师处理。
步骤3 登录管理面。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在管理面主菜单中选择“维护
>
运维管理
>
全景监控”。
3.
在左侧导航树中选择“节点监控”。
4.
在“节点监控”页面左上方选择告警参数中“产品别名”对应的产品。
5.
在“节点列表”中，单击产生告警的节点名称。
6.
在左侧导航树中选择“服务监控”。
7.
在“进程”页签中查找告警产生的进程名称，选中产生告警的进程名称，先单击
“停止”，待状态转为“未运行”后再单击“启动”。
说明
从告警定位信息中查找服务名来确定进程名称。
步骤4 待进程启动成功后，等待5分钟，检查告警是否清除。
●
是，处理结束。
●
否，请联系华为技术支持工程师处理。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
●
产生该告警的节点名称发生了变化。
●
产生该告警的站点名称发生了变化。
●
产生该告警的服务器不被监控了。
参考信息
无。
1

## Page 892

1.3.18.2.9 ALM-101206
SSH管理通道故障
告警解释
当管理面连续8次检测（检测周期为180秒）到管理节点和产品节点之间的SSH连接异
常时，将产生此告警。当管理节点和产品节点之间的SSH连接恢复正常，此告警将自
动清除。
告警属性
告警ID 告警级别 告警类型
101206
紧急 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 主机 发生故障时，故障节点的名称。
站点名称 产生告警的站点名称。
附加信息 IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
无法通过管理面对相应节点进行管理，影响相应节点的系统监控、备份恢复等功能。
可能原因
●
产品节点状态异常。
●
管理节点和产品节点之间的网络连接异常。
●
产品节点的ossadm用户密码失效。
●
管理节点和产品节点之间的SSH信任关系损坏。
处理步骤
步骤1 查看是否存在告警“101208 节点状态异常”，并且该告警和本告警的告警参数“主
机”对应的节点名称相同。
●
是，处理异常告警，具体操作请参见1.3.18.2.3
ALM-101208
节点状态异常。
●
否，执行2。
步骤2 使用PuTTY工具以sopuser用户通过SSH方式登录管理节点。
1

## Page 893

说明
●
如果管理节点为ManageOne-SMP01节点，则先登录ManageOne-SMP01节点执行以下操
作，然后登录ManageOne-SMP02节点执行以下操作。
●
如果管理节点为ManageOne-Deploy01节点，则先登录ManageOne-Deploy01节点执行以
下操作，然后登录ManageOne-Deploy02节点执行以下操作。
步骤3 执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
步骤4 执行以下命令，测试管理节点与产品节点的SSH连通性。
ssh
告警参数中的节点IP地址
说明
如果告警参数中“主机”对应的节点是管理节点，则登录管理节点连接任意一个产品节点测试
SSH连通性。
●
如果不输入密码就可以成功登录节点，说明管理节点和产品节点的SSH互信关系
正常，执行步骤5。
●
如果显示以下回显信息，说明节点ossadm用户密码失效，请更新密码后再次测试
管理节点与产品节点的SSH连通性。
WARNING: Your password has expired.
说明
产品节点ossadm用户密码需要和管理节点ossadm用户密码保持一致。若产品节点与管理
节点ossadm用户密码不一致，请参见《ManageOne
8.1.0
安全管理指南》中的“修改操
作系统用户密码（非root用户）”章节进行修改。
●
如果要求输入ossadm用户密码，说明管理节点和产品节点的SSH互信关系异常，
请执行以下操作恢复SSH互信关系。
a.
按“Ctrl+C”结束当前操作。
b.
执行以下命令，打开管理节点的“id_rsa.pub”文件。
cat
<ossadm用户的家目录>/.ssh/id_rsa.pub
c.
将“id_rsa.pub”文件中的内容复制到本地用于后续操作。
d.
使用PuTTY工具以sopuser用户通过SSH方式登录待恢复SSH信任关系的节
点。
说明
如果告警参数中“主机”对应的节点是管理节点，则登录的为其他管理节点，否则为
产品节点。
e.
执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
f.
执行以下命令，打开待恢复SSH信任关系的节点的“authorized_keys”文
件。
vi
<ossadm用户的家目录>/.ssh/authorized_keys
以上命令会打开vi编辑器，打开vi编辑器后，按“i”并将步骤4.c中获取的内
容复制并添加到“authorized_keys”文件的末端。
1

## Page 894

g.
配置完成后，按“Esc”并输入“:wq!”保存“authorized_keys”文件。操
作完成后，并再次测试管理节点与产品节点的SSH连通性。
步骤5 查看告警是否清除。
●
是，处理完毕。
●
否，请联系华为技术支持工程师处理。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
●
产生该告警的节点名称发生了变化。
●
产生该告警的站点名称发生了变化。
●
产生该告警的服务器不被监控了。
参考信息
无。
1.3.18.2.10 ALM-53080
部署面服务进程资源占用异常
告警解释
当管理面连续20次检测（检测周期60秒）到管理面服务进程资源的CPU（Central
Processing
Unit）使用率大于等于告警门限值（默认值为90%）时，产生该告警。只
要有一次检测到管理面服务进程资源的CPU使用率小于告警门限值时，该告警将会被
自动清除。
告警属性
告警ID 告警级别 告警类型
53080
重要 越限
告警参数
类别 参数名称 参数含义
定位信息 主机 发生故障时，故障节点的名称。
操作系统 服务器的操作系统。
进程名称 产生告警的进程名称。
站点名称 产生告警的站点名称。
附加信息 CPU占用率 服务器的CPU占用率。
1

## Page 895

类别 参数名称 参数含义
IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
业务处理缓慢，可能导致消息堆积或系统崩溃。
可能原因
●
非重要进程未及时释放。
●
有占用系统资源大的进程正在运行。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在主菜单中选择“系统
>
任务列表”，查看当前是否有任务正在执行。
●
有正在执行的任务。待任务完成后等待半个小时，检查告警是否清除。
–
是，告警处理完毕。
–
否，请执行步骤3。
●
没有正在执行的任务，请执行步骤3。
步骤3 判断该告警出现频率是否过高。
●
如果该告警仅偶尔出现且会自动清除，可直接忽略，无需处理。
●
如果该告警出现频繁（一个小时内出现5次以上），且不会自动清除，请联系华为
技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
●
产生该告警的节点名称发生了变化。
●
产生该告警的站点名称发生了变化。
1

## Page 896

●
产生该告警的服务器不被监控了。
参考信息
无。
1.3.18.2.11 ALM-101210
数据库本地主备复制异常
告警解释
当管理面连续7次检测（检测周期为100秒）到本地主备数据库实例的复制状态异常或
者延迟时，产生该告警；当数据库实例的复制状态恢复正常时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
101210
重要 处理错误告警
告警参数
类别 参数名称 参数含义
定位信
息
主机 发生故障时，故障节点的名称。
操作系统 服务器的操作系统。
数据库服务 产生告警的数据库实例名称。
数据库类型 产生告警的数据库类型。
站点名称 产生告警的站点名称。
附加信
息
IP地址 发生故障时，故障节点的IP地址。
产品别名 产生告警的产品别名。
对系统的影响
数据库本地主备复制状态异常会导致主备数据库数据不同步，如果长时间异常会对业
务服务有影响。
如果是异地容灾场景，可能会影响异地容灾操作。
可能原因
●
主备数据库实例所在的节点之间通讯异常。
●
复制关系错误。
●
磁盘空间满。
1

## Page 897

处理步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录管理节点。
说明
需要在ManageOne-Deploy01节点或ManageOne-SMP01节点执行以下操作。
步骤2 执行以下命令，切换到ossadm用户。
> su - ossadm
Password:ossadm用户的密码
步骤3 执行以下命令，查询数据库实例复制状态。
> cd /opt/oss/manager/apps/DBAgent/bin/
> bash dbsvc_adm -cmd query-db-instance
系统提示如下类似回显信息：
DBInstanceId ... IP Port ... Role Rpl Status ...
apmdbsvr-10_90_73_163-3@10_90_73_164-3 ... 10.90.73.164 32082 ... Slave Normal ...
apmdbsvr-10_90_73_178-21@10_90_73_179-21 ... 10.90.73.179 32080 ... Slave Abnormal (101) ...
apmdbsvr-10_90_73_178-21@10_90_73_179-21 ... 10.90.73.179 32080 ... Slave Abnormal (103) ...
...
●
如果“Rpl Status”的值为“--”，表示该数据库实例为单实例，执行步骤8。
●
如果“Rpl Status”的值为“Normal”，表示该数据库实例的复制状态正常，执
行步骤8。
●
如果“Rpl Status”的值为“Building”，表示正在重建备数据库实例，并将主数
据库实例的数据强制全量同步至备数据库实例。待“Rpl Status”的值查询到成为
“Normal”后，执行步骤8。
●
如果“Rpl Status”的值为“Delay”，表示备数据库实例正在同步主数据库实例
上的数据。待“Rpl Status”的值查询到成为“Normal”后，执行步骤8。
●
如果“Rpl Status”的值为“Abnormal”，表示数据库复制状态异常，后面括号
中数字为错误码，执行步骤4。
步骤4 执行以下命令，查看数据库磁盘空间。
df -h
如以下回显所示，数据库路径“/opt/redis”或“/opt/zenith”所在的分区“/opt”
的空间为0，需要及时进行清理。
Filesystem Size Used Avail Use% Mounted on
... ...
/dev/mapper/vg_root-lv_opt 498G 498G 0 100% /opt
tmpfs 5.9G 0 5.9G 0% /run/user/3001
tmpfs 5.9G 0 5.9G 0% /run/user/0
判断数据库磁盘空间是否占满。
●
是，执行步骤5。
●
否，联系华为技术支持工程师协助解决。
步骤5 执行以下命令，切换至root用户。
su - root
Password:root用户的密码
1

## Page 898

步骤6 删除无用目录。
注意
清理磁盘空间为危险操作，请确保待删除文件/文件夹已不再使用后，谨慎进行清理。
rm -r
无用目录
步骤7 执行以下命令，退出root用户。
exit
步骤8 等待2分钟，查看该告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
● 产生该告警的节点名称发生了变化。
●
产生该告警的站点名称发生了变化。
●
产生该告警的服务器不被监控了。
参考信息
无。
1.3.18.2.12 ALM-103606
平均IO等待时间过长
告警解释
当管理面检测到某个文件系统的平均IO等待时间大于等于告警产生阈值时，产生该告
警。当文件系统的平均IO等待时间小于告警清除阈值时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
103606
重要 越限
告警参数
类别 参数名称 参数含义
定位信息 节点ID 集群中的节点ID。
1

## Page 899

类别 参数名称 参数含义
挂载点 文件系统挂载点。
文件系统 文件系统的名称。
附加信息 产生门限 告警产生的门限值。
清除门限 告警清除的门限值。
IO平均等待时间 文件系统的IO平均等待时间。
IP地址 发生故障时，故障节点的IP地址。
对系统的影响
●
系统响应变慢，操作出现延时。
●
业务处理缓慢，可能导致消息堆积。
可能原因
●
平均IO等待时间产生门限值设置不合理。
●
系统正在执行频繁读写磁盘的操作。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在主菜单中选择“系统
>
任务列表”，检查是否存在多个任务正在执行。
●
是，等待所有任务执行完成后，执行步骤7。
●
否，请执行3。
步骤3 在管理面主菜单中选择“维护
>
运维管理
>
阈值规则设置”。
步骤4 在左侧导航树中选择“异常事件阈值”。
步骤5 在“异常事件阈值”页面左上方选择对应的产品，检查IO平均等待时间的阈值设置是
否合理。
●
是，执行步骤6。
●
否，重新设置阈值，执行步骤7。
步骤6 检查当前系统管理规模对应的硬件要求是否超过服务器硬件实际能力，同时经常连续
或频繁收到此告警。
1

## Page 900

●
是，说明服务器硬件性能过低，导致无法支撑系统正常运行，联系华为技术支持
工程师协助解决。
●
否，执行步骤7。
步骤7 等待1分钟，如果告警仍未清除，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
当产生该告警的服务器不被监控时，会导致之前产生的该告警无法自动被清除，需要
手工清除。
参考信息
无。
1.3.18.2.13 ALM-103607
数据库连接数即将耗尽
告警解释
当管理面检查到某个Zenith数据库实例或Redis数据库实例的连接数大于等于告警产生
阈值时，产生该告警。当Zenith数据库实例或Redis数据库实例的连接数小于告警清除
阈值时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
103607
重要 越限
告警参数
类别 参数名称 参数含义
定位信息 产品 数据库实例所属产品。
数据库类型 Zenith或者Redis。
实例名 Zenith/Redis数据库实例的名称。
附加信息 产生门限 告警产生的门限值。
清除门限 告警清除的门限值。
连接数使用率 Zenith/Redis数据库实例的连接数。
IP地址 Zenith/Redis数据库实例所在节点的IP地
址。
1

## Page 901

对系统的影响
系统正常业务无法获取数据库连接，导致系统业务异常。
可能原因
●
数据库实例连接数使用率产生门限值设置不合理。
●
系统的应用程序和数据库的连接异常。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在管理面主菜单中选择“维护
>
运维管理
>
阈值规则设置”。
步骤3 在左侧导航树中选择“异常事件阈值”。
步骤4 在“异常事件阈值”页面左上方选择告警参数中“产品”对应的产品，检查数据库连
接数即将耗尽的阈值设置是否合理。
●
是，联系华为技术支持工程师。
●
否，重新设置阈值，执行步骤5。
步骤5 等待1分钟，如果告警仍未清除，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要手工清除。
●
产品名称被修改。
●
主服务器与备服务器发生了倒换。
●
产生该告警的服务器不被监控了。
参考信息
无。
1

## Page 902

1.3.18.2.14 ALM-30001100
网卡状态异常告警
告警解释
当物理机的网卡状态异常时，产生该告警。当物理机的网卡状态都正常时，该告警会
自动清除。
告警属性
告警ID 告警级别 告警类型
30001100
重要 越限
告警参数
类别 参数名称 参数含义
定位信息 IP地址 发生告警时，告警节点的IP地址。
主机名 发生告警时，告警节点的名称。
网卡 网卡名称。
网卡状态 网卡当前的状态。
对系统的影响
网卡状态异常导致节点的网络不稳定，影响系统的可靠性。
可能原因
●
网卡未激活。
● 网卡未插网线。
●
网卡损坏。
处理步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录产生告警的节点。
步骤2 执行以下命令，切换到ossadm用户。
> su - ossadm
Password:ossadm用户的密码
步骤3 执行以下命令，查看产生告警的网卡状态。
ifconfig
系统提示如下类似回显信息，“eth0”表示网卡，“UP，BROADCAST，RUNNING，
MULTICAST”为网卡状态。
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST> mtu 1500
1

## Page 903

●
网卡状态只显示“UP”，说明网卡未接网线，请联系华为技术支持工程师检测网
卡，确保网卡对应网线已接入，没有松脱。
●
网卡状态只显示“RUNNING”，说明是网卡未激活，请联系华为技术支持工程师
激活配置网卡。
●
网卡状态包含“UP”和“RUNNING”，说明网卡状态正常，此时，网卡上报状
态值为"up/running"。
●
如果是均不属于以上三种情况，可能是网卡损坏请联系华为技术支持工程师检查
网卡并更换。
步骤4 等待两分钟查看告警是否清除，如果没有清除，则收集上述信息联系华为技术支持工
程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要在运维面手工清除，然后在
管理面“维护
>
运维管理
>
异常事件”的“异常”页签中，单击该告警“操作”列的
“清除”手工清除。
● 网卡名称变更。
●
产生该告警的服务器不被监控了。
参考信息
无。
1.3.18.2.15 ALM-103708
数据库实例主备复制时间差超长告警
告警解释
当系统检测（检测周期为60秒）数据库主备实例数据复制时间差异超过设定阈值（默
认30分钟），产生该告警。数据库主备实例数据复制时间差异小于设定阈值（默认15
分钟，可配置），该告警会自动清除。
说明
数据库实例主备复制时间差超长告警阈值设置方法如下：
1. 在管理面主菜单中选择“维护 > 运维管理 > 阈值规则设置”。
2. 在左侧导航树中选择“异常事件阈值”。
3. 根据实际情况设置资源的阈值规则，按照界面上的指引完成相关操作。
告警属性
告警ID 告警级别 告警类型
103708
重要 越限
1

## Page 904

告警参数
类别 参数名称 参数含义
定位信息 主机 发生告警的主机名称。
IP地址 发生告警的节点IP地址。
数据库服务 产生告警的备数据库实例名称。
对系统的影响
当数据库主备实例复制差异超过30分钟，主备数据库实例之间数据差异过大。发生主
备倒换后，可能会导致大量数据丢失，从而影响正常的业务功能。
可能原因
数据库主备实例通讯网络延迟、丢包或不满足带宽要求等原因。
处理步骤
获取告警中的定位信息后，请联系华为技术支持工程师协助解决。
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
当产生该告警的数据库不被监控时，会导致之前产生的该告警无法自动被清除，需要
在运维面手工清除，然后在管理面“维护
>
运维管理
>
异常事件”的“异常”页签
中，单击该告警“操作”列的“清除”手工清除。
参考信息
无。
1.3.18.2.16 ALM-103709
数据库用户被锁定告警
告警解释
当系统检测（检测周期为24小时）到存在数据库用户被锁定时，产生该告警；当系统
下一次检测到数据库用户解除锁定时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
103709
重要 安全告警
1

## Page 905

告警参数
类别 参数名称 参数含义
定位信息 主机 发生告警的主机名称。
实例名 数据库实例的名称。
用户名 数据库用户名称。
附加信息 锁定时间 数据库用户被锁定的时间。
对系统的影响
如果数据库用户被锁定，将无法访问对应数据库，会导致数据库相关的功能都不可
用。
可能原因
●
数据库用户密码超过有效期（创建用户时可设置有效期限）被锁定。
●
数据库用户连续N次登录失败导致被锁定。
●
数据库用户被管理员用户（sys）锁定。
处理步骤
获取告警中的定位信息后，请联系华为技术支持工程师协助解决。
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
当产生该告警的数据库不被监控时，会导致之前产生的该告警无法自动清除，需要在
运维面手工清除，然后在管理面“维护
>
运维管理
>
异常事件”的“异常”页签中，
单击该告警“操作”列的“清除”手工清除。
参考信息
无。
1.3.18.2.17 ALM-103710
数据库用户密码过期告警
告警解释
当系统检测（检测周期为24小时）数据库用户密码有效期不足7天时，产生该告警；当
系统下一次检测到数据库用户密码有效期超过7天，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
103710
重要 时间域告警
1

## Page 906

告警参数
类别 参数名称 参数含义
定位信息 主机 发生告警的主机名称。
实例名 数据库实例名称。
用户名 数据库用户名称。
附加信息 过期时间 数据库用户密码过期时间。
对系统的影响
如果数据库用户密码过期，将无法访问对应数据库，会导致数据库相关的功能都不可
用。
可能原因
●
数据库用户密码已过期。
●
数据库用户密码有效期不足7天。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在管理面主菜单中选择“维护
>
密码修改
>
修改数据库用户密码”。
步骤3 按照界面上的指引完成相关操作。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
当产生该告警的数据库不被监控时，会导致之前产生的该告警无法自动清除，需要手
工清除。
参考信息
无。
1

## Page 907

1.3.18.2.18 ALM-700012
OS用户SSH免密指纹文件内容格式错误
告警解释
管理面会对系统用户（如ossuser和ossadm）的免密指纹文件内容格式进行检测（检
测周期为10分钟）。当检测到免密指纹文件内容的格式不符合规定时，则产生该告
警；当检测到免密指纹文件内容的格式符合规定时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
700012
重要 环境告警
告警参数
类别 参数名称 参数含义
定位信息 主机名 被修改的系统用户免密指纹文件的节点
名。
主机 被修改的系统用户免密指纹文件的节点
的IP地址。
用户名 被修改的系统用户免密指纹文件对应的
用户。
对系统的影响
文件格式被错误修改后，会导致节点之间ssh互信异常。
可能原因
指纹文件内容格式错误。
处理步骤
步骤1 登录管理面。
1.
打开浏览器，在地址栏中输入“https://管理面的客户端登录IP地址:31945”，按
“Enter”。
说明
如果管理面的部署模式是集群模式，即存在多个管理节点，请使用管理节点浮动IP地址进
行登录。
2.
在登录页面，输入用户名和密码，单击“登录”。
步骤2 在管理面主菜单中选择“维护
>
运维管理
>
异常事件”。
步骤3 在页面左上方单击“异常”页签，查看“OS用户SSH免密指纹文件内容格式错误”告
警，根据告警的定位信息，获取告警对应的系统用户和主机IP地址。
1

## Page 908

步骤4 使用PuTTY工具以sopuser用户通过SSH方式登录步骤3获取的主机IP地址。
步骤5 执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
步骤6 执行以下命令，查看该系统用户的免密指纹文件内容，查看文件每行内容是否符合下
列两种格式的要求：
cat /home/ossadm/.ssh/known_hosts
1.
每行以空格分成三段
2.
允许有空白行
●
是，执行步骤7。
●
否，则说明该文件被错误修改，联系华为技术支持工程师协助解决，告警处理结
束。
步骤7 等待10分钟，查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
以下情况会导致之前产生的该告警无法自动被清除，需要在运维面手工清除，然后在
管理面“维护 > 运维管理 > 异常事件”的“异常”页签中，单击该告警“操作”列的
“清除”手工清除。
●
产生该告警的主机发生了变化。
●
产生该告警的节点名称发生了变化。
参考信息
无。
1.3.18.3
备份与恢复
1.3.18.3.1 ALM-1067
备份数据包不存在
告警解释
管理面在监控周期内检查是否存在以下类型备份包，若在配置的阈值时间不存在以下
任一备份包，则产生告警。
●
产品数据备份包
●
产品应用程序备份包
●
数据库应用程序备份包
●
任一节点的操作系统备份包
1

## Page 909

●
管理面备份包
当管理面成功执行了对应类型的备份任务后，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
1067
次要 备份状态
告警参数
类别 参数名称 参数含义
定位信息 站点名称 产生告警的站点名称。
机柜号 产生告警的机柜号。
机框号 产生告警的机框号。
槽位号 产生告警的单板槽位号。
原因 告警产生的可能原因。
检查对象 产生告警后的检查对象。
对系统的影响
无法进行数据恢复。
可能原因
●
用户未及时备份数据。
● 管理面未执行完成备份任务。
处理步骤
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在主菜单选择“备份与恢复
>
数据备份”备份数据，根据告警类型创建对应的备份任
务。
步骤3 备份任务执行成功后，检查该告警是否清除。
●
是，处理结束。
●
否，请联系华为技术支持工程师处理。
----结束
1

## Page 910

告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.18.3.2 ALM-101205
产品数据定时备份失败
告警解释
当产品数据的定时备份任务部分成功或执行失败时，管理面上报产品数据定时备份失
败告警。当产品数据备份任务执行成功时，系统会自动清除此告警。
告警属性
告警ID 告警级别 告警类型
101205
紧急 备份状态
告警参数
类别 参数名称 参数含义
定位信息 产品别名 产品别名。
站点名称 产生告警的站点名称。
对系统的影响
导致产品数据定时备份任务执行失败，影响数据恢复。
可能原因
●
未配置备份参数。
●
备份数据无法存储到备份服务器。
●
产品数据备份失败或者部分失败。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
请根据定位的备份失败原因，在表1-60中选择对应的处理步骤。
1

## Page 911

表1-60 备份失败原因操作指导
原因 操作指导
未配置备份参数。 具体操作请参见•配置备份参数。
备份数据无法存储到备份服务
器。
具体操作请参见•检查备份服务器的连通性和存储
空间。
产品数据备份失败。 具体操作请参见•查看任务信息详情。
●
配置备份参数。
a.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
b.
在管理面主菜单中选择“备份与恢复
>
配置
>
配置备份参数”。
c.
在“配置备份参数”页面，按照界面指引完成相关操作。
d.
根据该告警上报的详情创建一个对应产品的产品数据备份任务。
i.
在管理面主菜单中选择“备份与恢复
>
数据备份
>
备份产品数据”。
ii.
在“备份产品数据”页面，按照界面上的指引完成相关操作。
iii.
在“系统
>
任务列表”页面查看该备份任务是否执行成功。
○
是，执行e。
○
否，请联系华为技术支持工程师处理。
e.
备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
●
检查备份服务器的连通性和存储空间。
a. 使用PuTTY工具以sopuser用户登录管理面任意一个数据库节点。
b.
执行以下命令，切换到ossadm用户。
> su - ossadm
Password:ossadm用户的密码
c.
执行以下命令检查数据库节点与备份服务器的连通性。
sftp
备份服务器用户名@备份服务器的IP地址
备份服务器用户名@备份服务器的IP地址's password:
▪
回显以下类似信息，说明网络连接正常，执行d。
Connected to 备份服务器的IP地址.
sftp>
▪
回显以下类似信息，说明该数据库节点与备份服务器之间的指纹识别认
证丢失或尚未配置，在管理面主菜单中选择“备份与恢复
>
配置
>
配置
备份参数”，在“设置备份服务器的参数”区域下，单击 重新配置
SFTP指纹，操作成功后执行d，否则联系华为技术支持工程师处理。
1

## Page 912

The authenticity of host '10.10.10.28 (10.10.10.28)' can't be established.
……
No matching host key fingerprint found in DNS.
▪
当系统回显如下信息时，请按“Ctrl+C”退出查看SFTP指纹认证信息操
作。如果退出请求超时，说明网络连接异常，请检查并恢复网络连接，
操作成功后执行d，否则联系华为技术支持工程师处理。
Are you sure you want to continue connecting (yes/no)?
d.
使用PuTTY工具以备份服务器用户通过SSH方式登录备份服务器。
说明
●
登录备份服务器的用户名需具有SSH权限，否则请联系服务器管理员设置该用户
的权限。
● 若使用管理节点作为备份服务器，请先使用sopuser用户通过SFTP方式登录备份
服务器，再切换到备份服务器用户。
▪
登录成功，说明密码未变更，备份服务器运行正常，执行e。
▪
登录失败，可能原因是密码变更或备份服务器故障，请联系运维人员处
理。
e.
查看备份服务器空间。
i.
执行以下命令查看备份服务器空间。
> df -Ph
ii.
系统回显类似如下信息，查看“Mounted on”列备份服务器SFTP共享
目录所在分区的“Avail”值：
Filesystem Size Used Avail Use% Mounted on
/dev/xxx/oss_vg-opt_vol 53G 27G 24G 54% /xxx
......
iii.
判断剩余备份空间大小是否满足备份文件要求，以备份文件的大小为
5GB为例。
○
剩余备份空间大于5GB，处理完毕。
○
剩余备份空间小于或等于5GB，请联系管理员扩充存储空间。
f.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
g.
根据该告警上报的详情创建一个对应产品的产品数据备份任务。
i.
在管理面主菜单中选择“备份与恢复
>
数据备份
>
备份产品数据”。
ii.
在“备份产品数据”页面，按照界面指引完成相关操作。
iii.
在“系统
>
任务列表”页面查看该备份任务是否执行成功。
○
是，执行h。
○
否，请联系华为技术支持工程师处理。
h. 备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
●
查看任务信息详情。
1

## Page 913

a.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
b.
在管理面主菜单中选择“系统
>
任务列表”。
c.
单击 ，查看产品数据定时备份任务执行失败的详细定位信息，根据定位信息
修复故障，如故障已修复，执行d，否则请联系华为技术支持工程师处理。
d.
根据该告警上报的详情创建一个对应产品的产品数据备份任务。
i.
在管理面主菜单中选择“备份与恢复
>
数据备份
>
备份产品数据”。
ii.
在“备份产品数据”页面，按照界面指引完成相关操作。
iii.
在“系统
>
任务列表”页面查看该备份任务是否执行成功。
○
是，执行e。
○
否，请联系华为技术支持工程师处理。
e.
备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.18.3.3 ALM-101216
定时备份失败
告警解释
当管理面的定时备份任务执行失败时，管理面上报定时备份失败告警。当管理面备份
任务执行成功时，系统会自动清除此告警。
告警属性
告警ID 告警级别 告警类型
101216
紧急 备份状态
告警参数
类别 参数名称 参数含义
定位信息 产品别名 产品别名。
站点名称 产生告警的站点名称。
1

## Page 914

类别 参数名称 参数含义
附加信息 备份对象 管理面
对系统的影响
导致管理面定时备份任务执行失败，影响数据恢复。
可能原因
●
未配置备份参数。
●
备份数据无法存储到备份服务器。
●
管理面备份失败。
处理步骤
说明
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇总文
件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理侧）”。若存
在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登录；若不存在，则使
用“ManageOne部署面”的地址进行登录。
请根据定位的备份失败原因，在表1-61中选择对应的处理步骤。
表1-61 备份失败原因操作指导
原因 操作指导
未配置备份参数。 具体操作请参见•配置备份参数。
备份数据无法存储到备份服务
器。
具体操作请参见•检查备份服务器的连通性和存储
空间。
管理面备份失败。 具体操作请参见•查看任务信息详情。
●
配置备份参数。
a.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
b.
在管理面主菜单中选择“备份与恢复
>
配置
>
配置备份参数”。
c.
在“配置备份参数”页面，按照界面指引完成相关操作。
d.
创建一个管理面的备份任务。
i.
在管理面主菜单中选择“备份与恢复
>
数据备份
>
备份管理面”。
ii.
在该页面，按照界面上的指引完成相关操作。
iii.
在“系统
>
任务列表”页面查看该备份任务是否执行成功。
1

## Page 915

○
是，执行e。
○
否，请联系华为技术支持工程师处理。
e.
备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
●
检查备份服务器的连通性和存储空间。
a.
使用PuTTY工具以sopuser用户通过SSH方式登录管理面任意一个数据库节
点。
b.
执行以下命令，切换到ossadm用户。
> su - ossadm
Password:ossadm用户的密码
c.
执行以下命令检查数据库节点与备份服务器的连通性。
sftp
备份服务器用户名@备份服务器的IP地址
备份服务器用户名@备份服务器的IP地址's
password:
▪
回显以下类似信息，说明网络连接正常，执行d。
Connected to
备份服务器的IP地址.
sftp>
▪
回显以下类似信息，说明该数据库节点与备份服务器之间的指纹识别认
证丢失或尚未配置，在管理面主菜单中选择“备份与恢复
>
配置
>
配置
备份参数”，在“备份服务器”区域下，单击 重新配置SFTP指纹，操
作成功后执行d，否则联系华为技术支持工程师处理。
The authenticity of host '10.10.10.28 (10.10.10.28)' can't be established.
……
No matching host key fingerprint found in DNS.
▪
当系统回显如下信息时，请按“Ctrl+C”退出查看SFTP指纹认证信息操
作。如果退出请求超时，说明网络连接异常，请检查并恢复网络连接，
操作成功后执行d，否则联系华为技术支持工程师处理。
Are you sure you want to continue connecting (yes/no)?
d.
使用PuTTY工具以备份服务器用户通过SSH方式登录备份服务器。
说明
●
登录备份服务器的用户名需具有SSH权限，否则请联系服务器管理员设置该用户
的权限。
●
若使用管理节点作为备份服务器，请先使用sopuser用户通过SFTP方式登录备份
服务器，再切换到备份服务器用户。
▪
登录成功，说明密码未变更，备份服务器运行正常，执行e。
▪
登录失败，可能原因是密码变更或备份服务器故障，请联系运维人员处
理。
e.
查看备份服务器空间。
i.
执行以下命令查看备份服务器空间。
> df -Ph
ii.
系统回显类似如下信息，查看“Mounted on”列备份服务器SFTP共享
目录所在分区的“Avail”值：
1

## Page 916

Filesystem Size Used Avail Use% Mounted on
/dev/xxx/oss_vg-opt_vol 53G 27G 24G 54% /xxx
......
iii.
判断剩余备份空间大小是否满足备份文件要求，以备份文件的大小为
5GB为例。
○
剩余备份空间大于5GB，处理完毕。
○
剩余备份空间小于或等于5GB，请联系管理员扩充存储空间。
f.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
g.
创建一个管理面的备份任务。
i.
在管理面主菜单中选择“备份与恢复
>
数据备份
>
备份管理面”。
ii.
在该页面，按照界面上的指引完成相关操作。
iii.
在“系统
>
任务列表”页面查看该备份任务是否执行成功。
○
是，执行h。
○
否，请联系华为技术支持工程师处理。
h. 备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
●
查看任务信息详情。
a.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
b.
在管理面主菜单中选择“系统
>
任务列表”。
c.
单击 ，查看管理面定时备份任务执行失败的详细定位信息，根据定位信息修
复故障，如故障已修复，执行d，否则请联系华为技术支持工程师处理。
d.
创建一个管理面的备份任务。
i.
在管理面主菜单中选择“备份与恢复
>
数据备份
>
备份管理面”。
ii.
在该页面，按照界面上的指引完成相关操作。
iii.
在“系统
>
任务列表”页面查看该备份任务是否执行成功。
○
是，执行e。
○
否，请联系华为技术支持工程师处理。
e.
备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 917

参考信息
无。
1.3.18.3.4 ALM-101217
产品应用程序定时备份失败
告警解释
当产品应用程序的定时备份任务执行失败时，管理面上报产品应用程序定时备份失败
告警。当产品应用程序备份任务执行成功时，系统会自动清除此告警。
告警属性
告警ID 告警级别 告警类型
101217
紧急 备份状态
告警参数
类别 参数名称 参数含义
定位信息 产品别名 产品别名。
站点名称 产生告警的站点名称。
对系统的影响
导致产品应用程序定时备份任务执行失败，影响数据恢复。
可能原因
●
未配置备份参数。
● 备份数据无法存储到备份服务器。
●
应用程序备份失败。
处理步骤
请根据定位的备份失败原因，在表1-62中选择对应的处理步骤。
表1-62 备份失败原因操作指导
原因 操作指导
未配置备份参数。 具体操作请参见•配置备份参数。
备份数据无法存储到备份服务
器。
具体操作请参见•检查备份服务器的连通性和存储
空间。
应用程序备份失败。 具体操作请参见•查看任务信息详情。
1

## Page 918

●
配置备份参数。
a.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
b.
在管理面主菜单中选择“备份与恢复
>
配置
>
配置备份参数”。
c.
在“配置备份参数”页面，按照界面指引完成相关操作。
d.
根据该告警上报的详情创建一个对应产品的产品应用程序备份任务。
i.
在管理面主菜单中选择“备份与恢复
>
数据备份
>
备份产品应用程
序”。
ii.
在“备份产品应用程序”页面，按照界面指引完成相关操作。
iii.
在“系统
>
任务列表”页面查看该备份任务是否执行成功。
○
是，执行e。
○
否，请联系华为技术支持工程师处理。
e.
备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
●
检查备份服务器的连通性和存储空间。
a.
使用PuTTY工具以sopuser用户通过SSH方式登录管理面任意一个数据库节
点。
b.
执行以下命令，切换到ossadm用户。
> su - ossadm
Password:ossadm用户的密码
c.
执行以下命令检查数据库节点与备份服务器的连通性。
sftp
备份服务器用户名@备份服务器的IP地址
备份服务器用户名@备份服务器的IP地址's password:
▪
回显以下类似信息，说明网络连接正常，执行d。
Connected to 备份服务器的IP地址.
sftp>
▪
回显以下类似信息，说明该数据库节点与备份服务器之间的指纹识别认
证丢失或尚未配置，在管理面主菜单中选择“备份与恢复
>
配置
>
配置
备份参数”，在“设置备份服务器的参数”区域下，单击 重新配置
SFTP指纹，操作成功后执行d，否则联系华为技术支持工程师处理。
The authenticity of host '10.10.10.28 (10.10.10.28)' can't be established.
……
No matching host key fingerprint found in DNS.
▪
当系统回显如下信息时，请按“Ctrl+C”退出查看SFTP指纹认证信息操
作。如果退出请求超时，说明网络连接异常，请检查并恢复网络连接，
操作成功后执行d，否则联系华为技术支持工程师处理。
Are you sure you want to continue connecting (yes/no)?
d.
使用PuTTY工具以备份服务器用户通过SSH方式登录备份服务器。
1

## Page 919

说明
●
登录备份服务器的用户名需具有SSH权限，否则请联系服务器管理员设置该用户
的权限。
●
若使用管理节点作为备份服务器，请先使用sopuser用户通过SFTP方式登录备份
服务器，再切换到备份服务器用户。
▪
登录成功，说明密码未变更，备份服务器运行正常，执行e。
▪
登录失败，可能原因是密码变更或备份服务器故障，请联系运维人员处
理。
e.
查看备份服务器空间。
i.
执行以下命令查看备份服务器空间。
> df -Ph
ii. 系统回显类似如下信息，查看“Mounted on”列备份服务器SFTP共享
目录所在分区的“Avail”值：
Filesystem Size Used Avail Use% Mounted on
/dev/xxx/oss_vg-opt_vol 53G 27G 24G 54% /xxx
......
iii.
判断剩余备份空间大小是否满足备份文件要求，以备份文件的大小为
5GB为例。
○
剩余备份空间大于5GB，处理完毕。
○
剩余备份空间小于或等于5GB，请联系管理员扩充存储空间。
f.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
g.
根据该告警上报的详情创建一个对应产品的产品应用程序备份任务。
i.
在管理面主菜单中选择“备份与恢复
>
数据备份
>
备份产品应用程
序”。
ii.
在“备份产品应用程序”页面，按照界面指引完成相关操作。
iii. 在“系统 > 任务列表”页面查看该备份任务是否执行成功。
○
是，执行h。
○
否，请联系华为技术支持工程师处理。
h.
备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
●
查看任务信息详情。
a.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
b.
在管理面主菜单中选择“系统
>
任务列表”。
1

## Page 920

c.
单击 ，查看产品应用程序的定时备份任务执行失败的详细定位信息，根据定
位信息修复故障，如故障已修复，执行d，否则请联系华为技术支持工程师处
理。
d.
根据该告警上报的详情创建一个对应产品的产品应用程序备份任务。
i.
在管理面主菜单中选择“备份与恢复
>
数据备份
>
备份产品应用程
序”。
ii.
在“备份产品应用程序”页面，按照界面指引完成相关操作。
iii.
在“系统
>
任务列表”页面查看该备份任务是否执行成功。
○
是，执行e。
○
否，请联系华为技术支持工程师处理。
e. 备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.18.3.5 ALM-101218
产品数据库应用程序定时备份失败
告警解释
当产品数据库应用程序的定时备份任务执行失败时，管理面上报产品数据库应用程序
定时备份失败告警。当产品数据库应用程序备份任务执行成功时，系统会自动清除此
告警。
告警属性
告警ID 告警级别 告警类型
101218
紧急 备份状态
告警参数
类别 参数名称 参数含义
定位信息 产品别名 产品别名。
站点名称 产生告警的站点名称。
1

## Page 921

对系统的影响
导致产品数据库应用程序定时备份任务执行失败，影响数据恢复。
可能原因
●
未配置备份参数。
●
备份数据无法存储到备份服务器。
●
数据库程序备份失败。
处理步骤
请根据定位的备份失败原因，在表1-63中选择对应的处理步骤。
表1-63 备份失败原因操作指导
原因 操作指导
未配置备份参数。 具体操作请参见•配置备份参数。
备份数据无法存储到备份服务
器。
具体操作请参见•检查备份服务器的连通性和存储
空间。
应用程序备份失败。 具体操作请参见•查看任务信息详情。
●
配置备份参数。
a.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
b.
在管理面主菜单中选择“备份与恢复
>
配置
>
配置备份参数”。
c.
在“配置备份参数”页面，按照界面指引完成相关操作。
d.
根据该告警上报的详情创建一个对应产品的数据库应用程序备份任务。
i.
在管理面主菜单中选择“备份与恢复
>
数据备份
>
备份数据库应用程
序”。
ii.
在“备份数据库应用程序”页面，按照界面指引完成相关操作。
iii.
在“系统
>
任务列表”页面查看该备份任务是否执行成功。
○
是，执行e。
○
否，请联系华为技术支持工程师处理。
e.
备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
●
检查备份服务器的连通性和存储空间。
a.
使用PuTTY工具以sopuser用户通过SSH方式登录管理面任意一个数据库节
点。
1

## Page 922

b.
执行以下命令，切换到ossadm用户。
> su - ossadm
Password:ossadm用户的密码
c.
执行以下命令检查数据库节点与备份服务器的连通性。
sftp
备份服务器用户名@备份服务器的IP地址
备份服务器用户名@备份服务器的IP地址's
password:
▪
回显以下类似信息，说明网络连接正常，执行d。
Connected to
备份服务器的IP地址.
sftp>
▪
回显以下类似信息，说明该数据库节点与备份服务器之间的指纹识别认
证丢失或尚未配置，在管理面主菜单中选择“备份与恢复
>
配置
>
配置
备份参数”，在“设置备份服务器的参数”区域下，单击 重新配置
SFTP指纹，操作成功后执行d，否则联系华为技术支持工程师处理。
The authenticity of host '10.10.10.28 (10.10.10.28)' can't be established.
……
No matching host key fingerprint found in DNS.
▪
当系统回显如下信息时，请按“Ctrl+C”退出查看SFTP指纹认证信息操
作。如果退出请求超时，说明网络连接异常，请检查并恢复网络连接，
操作成功后执行d，否则联系华为技术支持工程师处理。
Are you sure you want to continue connecting (yes/no)?
d.
使用PuTTY工具以备份服务器用户通过SSH方式登录备份服务器。
说明
●
登录备份服务器的用户名需具有SSH权限，否则请联系服务器管理员设置该用户
的权限。
● 若使用管理节点作为备份服务器，请先使用sopuser用户通过SFTP方式登录备份
服务器，再切换到备份服务器用户。
▪
登录成功，说明密码未变更，备份服务器运行正常，执行e。
▪
登录失败，可能原因是密码变更或备份服务器故障，请联系运维人员处
理。
e.
查看备份服务器空间。
i.
执行以下命令查看备份服务器空间。
> df -Ph
ii.
系统回显类似如下信息，查看“Mounted on”列备份服务器SFTP共享
目录所在分区的“Avail”值：
Filesystem Size Used Avail Use% Mounted on
/dev/xxx/oss_vg-opt_vol 53G 27G 24G 54% /xxx
......
iii.
判断剩余备份空间大小是否满足备份文件要求，以备份文件的大小为
5GB为例。
○
剩余备份空间大于5GB，处理结束。
○
剩余备份空间小于或等于5GB，请联系管理员扩充存储空间。
f.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
1

## Page 923

g.
根据该告警上报的详情创建一个对应产品的数据库应用程序备份任务。
i. 在管理面主菜单中选择“备份与恢复 > 数据备份 > 备份数据库应用程
序”。
ii.
在“备份数据库应用程序”页面，按照界面指引完成相关操作。
iii.
在“系统
>
任务列表”页面查看该备份任务是否执行成功。
○
是，执行h。
○
否，请联系华为技术支持工程师处理。
h.
备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
●
查看任务信息详情。
a.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
b.
在管理面主菜单中选择“系统
>
任务列表”。
c.
单击 ，查看数据库应用程序的定时备份任务执行失败的详细定位信息，根据
定位信息修复故障，如故障已修复，执行d，否则请联系华为技术支持工程师
处理。
d.
根据该告警上报的详情创建一个对应产品的数据库应用程序备份任务。
i.
在管理面主菜单中选择“备份与恢复
>
数据备份
>
备份数据库应用程
序”。
ii.
在“备份数据库应用程序”页面，按照界面指引完成相关操作。
iii.
在“系统
>
任务列表”页面查看该备份任务是否执行成功。
○
是，执行e。
○
否，请联系华为技术支持工程师处理。
e.
备份任务执行成功后，检查该告警是否清除。
▪
是，处理结束。
▪
否，请联系华为技术支持工程师处理。
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.18.4
证书
1

## Page 924

1.3.18.4.1 ALM-51020
证书即将过期
告警解释
系统每天对管理面和业务面的ER证书和IR证书的有效期进行一次检查，对管理面的CA
证书、Syslog证书、用户管理证书、SSO信任证书、LDAP证书和RADIUS证书的有效期
进行一次检查，对业务面的LDAP证书和RADIUS证书的有效期进行一次检查，若任意
一个证书的有效期不足90天时，产生该告警。
告警属性
告警ID 告警级别 告警类型
51020
重要 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 主机 产生告警的节点IP地址。
证书类型 ER证书、CA证书、IR证书、Syslog证
书、用户管理证书、LDAP证书、
RADIUS证书和SSO信任证书。
服务名 证书所属业务面的服务实例名称。
站点名称 产生告警的站点名称。
对系统的影响
●
如果ER证书失效，将无法登录管理面或业务面界面。
●
如果CA证书失效，将无法对IR证书及其密钥进行安全管理。
●
如果IR证书失效，将影响系统内部通信。
●
如果Syslog证书失效，将影响管理面日志转发。
●
如果用户管理证书失效，将无法登录管理面界面。
●
如果LDAP证书失效，将导致无法连接LDAP服务器。
●
如果RADIUS证书失效，将导致无法连接RADIUS服务器。
● 如果SSO信任证书失效，将导致登录SSO客户端失败。
可能原因
证书有效期已不足90天。
处理步骤
手工更新对应的证书，具体操作请参见《ManageOne
8.1.0
安全管理指南》中的“证
书管理”章节对应证书类型的更新步骤。
1

## Page 925

告警清除
ADAC：系统在更新证书后的00:00:00检查证书的有效性，证书有效则系统会自动清除
此告警，无需手工清除。
参考信息
无。
1.3.18.4.2 ALM-51021
证书已经过期
告警解释
系统每天对管理面和业务面的ER证书有效期进行一次检查，对管理面的Syslog证书、
LDAP证书、RADIUS证书、用户管理证书和SSO信任证书的有效期进行一次检查，对
业务面的LDAP证书和RADIUS证书的有效期进行一次检查，若任意一个证书的有效期
过期或者证书无效时，产生该告警。
告警属性
告警ID 告警级别 告警类型
51021
紧急 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 主机 产生告警的节点IP地址。
证书类型 ER证书、Syslog证书、用户管理证书、
LDAP证书、RADIUS证书和SSO信任证
书。
站点名称 产生告警的站点名称。
对系统的影响
●
如果ER证书失效，将无法登录管理面或业务面界面。
●
如果Syslog证书失效，将影响管理面日志转发。
● 如果用户管理证书失效，将无法登录管理面界面。
●
如果LDAP证书失效，将导致无法连接LDAP服务器。
●
如果RADIUS证书失效，将导致无法连接RADIUS服务器。
●
如果SSO信任证书失效，将导致登录SSO客户端失败。
可能原因
证书已超过有效期。
1

## Page 926

处理步骤
根据已经过期的证书类型，处理证书过期问题。
●
如果部署面或运营面的ER证书已经过期，则登录运维面更换部署面或运营面的ER
证书。具体操作请参见《ManageOne
8.1.0
安全管理指南》中的“证书管理”章
节对应证书类型的更新步骤。
●
如果运维面的ER证书已经过期，此时运维面无法登录，则需要更新运维面的ER证
书后，再执行其他证书的更新操作。具体操作请参见“ER证书过期导致运维、运
营面无法登录”章节。请参见《ManageOne
8.1.0
故障处理》中的“ER证书过
期导致运维、运营面无法登录”章节或联系技术支持工程师处理。
告警清除
ADAC：系统在更新证书后的00:00:00检查证书的有效性，证书有效则系统会自动清除
此告警，无需手工清除。
参考信息
无。
1.3.18.4.3 ALM-51022
证书更新失败
告警解释
通过命令行方式更新ER证书或者IR证书失败时上报该告警。
告警属性
告警ID 告警级别 告警类型
51022
紧急 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 证书类型 ER证书或者IR证书。
站点名称 产生告警的站点名称。
对系统的影响
系统无法登录和使用。
可能原因
新证书不符合要求。
1

## Page 927

处理步骤
步骤1 手工恢复证书。
●
对于ER证书，具体操作请参见《ManageOne
8.1.0
安全管理指南》中的“回退
更新失败的ER证书”章节。
●
对于IR证书，具体操作请参见《ManageOne
8.1.0
安全管理指南》中的“更换IR
证书”章节。
步骤2 检查该告警是否清除。
●
是，处理结束。
●
否，请联系华为技术支持工程师处理。
----结束
告警清除
ADAC：更新证书后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.18.5
异地容灾
1.3.18.5.1 ALM-101200
复制异常
说明
● 本告警仅在华为云Stack场景下存在。
●
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇
总文件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理
侧）”。若存在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登
录；若不存在，则使用“ManageOne部署面”的地址进行登录。
告警解释
当异地容灾系统连续3次检测（检测周期为30秒）到主站点和备站点产品的网络延迟或
者数据同步状态异常，或者数据同步量大导致延迟时，产生该告警。当网络或者数据
同步状态正常，或者数据同步完成后，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
101200
紧急 处理错误告警
1

## Page 928

告警参数
类别 参数名称 参数含义
定位信息 产品别名1 站点上产品的别名。
产品别名2 站点上产品的别名。
名称 数据实例名称。
类型 实例类型。
对系统的影响
●
主站点和备站点产品之间的数据无法复制。
●
无法执行主备站点产品的倒换操作。
●
若备站点产品强制接管主站点产品的业务，接管后，会使得备站点产品的部分数
据丢失。
可能原因
●
产品上存在大量数据。
●
主站点和备站点的用户数据同步失败。
●
主站点和备站点之间的心跳状态异常。
●
主站点和备站点之间用于数据复制的网络异常。
●
提供数据复制能力的服务异常。
●
本地主备数据库实例的复制状态异常。
处理步骤
步骤1 请根据下表进行故障排查。
说明
该故障排查方法比较复杂，此处只介绍初步的排查方法，如果仍不能解决，请联系华为技术支持
工程师处理。
1

## Page 929

表1-64 故障检查项
检查项 检查方法 处理措施
排查异地容灾
系统的网络是
否故障
下面以检查主站点与备站点间的心跳网
络连通性为例。
1.
使用PuTTY工具以sopuser用户通过
SSH方式登录主站点的管理节点。
说明
只需在ManageOne-Deploy01节点执行
以下操作。
获取节点IP地址的方法请参见
《ManageOne 8.1.0 安全管理指南》中
的“如何查找节点对应的IP地址”章节。
2.
执行以下命令，测试主站点和备站点
管理节点的连通性。
–
如果IP地址为IPv4：
> ping
备站点管理节点IP地址
–
如果IP地址为IPv6：
> ping6
备站点管理节点IP地址
查看系统回显信息：
–
如果回显如下类似信息，表示可以
ping通，说明网络连接正常。
64 bytes from
备站点管理节点IP地址:
icmp_seq=1 ttl=251 time=42.1 ms
–
如果等待1分钟后无回显信息，说
明网络连接异常。
3.
按“Ctrl+C”终止ping命令。
联系管理员检查并恢复
网络。
排查异地容灾
的心跳状态是
否异常
查看是否存在主备站点的心跳异常告
警。
请参见1.3.18.5.2
ALM-101201
心跳异
常。
1

## Page 930

检查项 检查方法 处理措施
排查
“/opt/oss/t
mp/
manager”目
录是否具有写
入权限
1.
使用PuTTY工具以sopuser用户通过
SSH方式登录备站点的管理节点。
说明
请先登录ManageOne-Deploy01节点执
行以下操作，然后登录ManageOne-
Deploy02节点执行以下操作。
获取节点IP地址的方法请参见
《ManageOne 8.1.0 安全管理指南》中
的“如何查找节点对应的IP地址”章节。
2.
执行以下命令，切换至ossadm用
户。
> su - ossadm
Password:ossadm用户的密码
3.
执行以下命令，查看
“/opt/oss/tmp/manager”目录权
限。
> cd /opt/oss/tmp
> ll
查看回显如下类型信息，查看
“manager”目录的权限是否为
“drwxr-x---”。
total 40
...
drwxr-x---. 29 ossadm ossgroup 4096 Mar 6
15:39 manager
...
–
是，请排查其他故障。
–
否，请重新设置目录权限。
1.
使用PuTTY工具以
sopuser用户通过
SSH方式登录备站点
的管理节点。
说明
请先登录
ManageOne-
Deploy01节点执行以
下操作，然后登录
ManageOne-
Deploy02节点执行以
下操作。
2.
执行以下命令，切
换至ossadm用户。
> su - ossadm
Password:ossadm用户的
密码
3.
执行以下命令，设
置“/opt/oss/tmp/
manager”目录权
限。
> chown -R
750 /opt/oss/tmp/
manager
排查数据库实
例异常
1.
分别登录主站点和备站点管理面。
a.
使用浏览器登录ManageOne部署
面。
登录地址：https://ManageOne部
署面浮动IP地址:31945。例如，
https://192.168.0.1:31945。
默认帐号：admin。
2.
在管理面主菜单中选择“高可用
>
异
地高可用系统
>
管理异地容灾系
统”。
3.
查看数据同步状态是否为“异常”。
–
是，表示数据同步异常，执行步骤
1.4，查看异常的数据类型。
–
否，表示数据同步正常，请排查其
他故障。
4.
单击 ，展开产品数据同步信息。
5.
查看并记录“状态”为“异常”的数
据类型。
请联系技术支持工程师
处理。
1

## Page 931

检查项 检查方法 处理措施
排查数据库本
地主备数据库
实例异常
1.
分别登录主站点和备站点管理面。
a.
使用浏览器登录ManageOne部署
面。
登录地址：https://ManageOne部
署面浮动IP地址:31945。例如，
https://192.168.0.1:31945。
默认帐号：admin。
2.
在管理面主菜单中选择“维护
>
运维
管理
>
全景监控”。
3.
在左侧导航树中选择“中间件监
控”。
4.
在“中间件监控”页面左上方选择对
应的产品。
5.
选择“关系数据库”页签，查看主备
数据库实例状态是否异常。
如果主备数据库实例的“状态”为
“正在运行”，“复制状态”为“正
常”，则数据库实例状态正常，否则
需进行修复。
请联系技术支持工程师
处理。
步骤2 强制同步主备站点间数据。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在管理面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”。
3.
在待同步数据的异地容灾系统行中单击 ，选择主备站点的数据同步方向。
若主备站点的状态为主用和备用，无需选择产品的数据同步方向，系统会自动从
主用站点向备用站点同步数据。
须知
选择数据同步方向时，异地容灾系统会根据用户选择方向进行全量数据同步，并
覆盖被同步的站点产品数据。建议以含有最新数据的产品为主用站点产品，向对
端站点产品同步。若选择由备用站点向主用站点产品同步，则首先备用站点会升
级为主用，然后再进行产品数据同步。
4.
检查操作结果。如果操作结果与预期不符，请联系华为技术支持工程师。
a.
在管理面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”。
b.
查看主备站点间的心跳状态为 。
c.
查看所有产品的“数据同步状态”为“已同步”或者“同步中”。如果“数
据同步状态”显示为“延迟”，表示主站点和备站点有较多的数据正在同
步，请等待数据同步完成后再检查状态。
1

## Page 932

d.
主用站点业务面能正常登录。
步骤3 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.18.5.2 ALM-101201
心跳异常
说明
●
本告警仅在华为云Stack场景下存在。
● 操作步骤中要登录部署面时，需要在HUAWEI CLOUD Stack Deploy工具导出的参数信息汇
总文件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理
侧）”。若存在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登
录；若不存在，则使用“ManageOne部署面”的地址进行登录。
告警解释
当异地容灾系统连续3次检测（检测周期为10秒）到在异地容灾系统预设的时间内主备
站点之间任意一方未收到对方的心跳信息时，产生该告警。当主站点与备站点之间的
心跳恢复正常时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
101201
紧急 心跳
告警参数
类别 参数名称 参数含义
定位信息 站点1 站点名称以及该站点上发生了心跳异常
的IP地址。
站点2 站点名称以及该站点上发生了心跳异常
的IP地址。
对系统的影响
用户无法执行主备站点产品的倒换、强制同步数据和删除数据同步关系操作。
1

## Page 933

可能原因
●
主站点和备站点之间心跳网络异常。
●
主站点或备站点的异地容灾服务异常。
● 主站点和备站点管理节点上的异地容灾系统证书不匹配或者已过期。
处理步骤
说明
该故障排查方法比较复杂，此处只介绍初步的排查方法，如果仍不能解决，请联系华为技术支持
工程师处理。
步骤1 检查主站点和备站点之间的心跳网络是否连通。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录主站点的管理节点。
说明
只需在ManageOne-Deploy01节点执行以下操作。
获取节点IP地址的方法请参见《ManageOne
8.1.0
安全管理指南》中的“如何查找节点对
应的IP地址”章节。
2. 执行以下命令，测试主站点和备站点管理节点的连通性。
–
如果IP地址为IPv4：
> ping
备站点管理节点的心跳IP地址
–
如果IP地址为IPv6：
> ping6
备站点管理节点的心跳IP地址
查看系统回显信息：
–
如果回显如下类似信息，表示可以ping通，说明网络连接正常。
64 bytes from 备站点管理节点的心跳IP地址: icmp_seq=1 ttl=251 time=42.1 ms
–
如果等待1分钟无回显信息，说明网络连接异常，请联系管理员检查并恢复网
络。
3.
按“Ctrl+C”终止ping命令。
步骤2 分别检查主站点和备站点管理节点的异地容灾进程是否正常。
1.
分别登录主站点和备站点管理面。
a.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在管理面主菜单中选择“维护
>
运维管理
>
全景监控”。
3. 在左侧导航树中选择“服务监控”。
4.
在“服务监控”页面左上方选择“CloudSOP-UniEP”。
5.
在“进程”页签下查看是否有“drmgrservice-x-x”进程，且该进程的“状态”是
否为“正在运行”。
说明
x为实例编号，具体以实际为准。
–
是，表示该进程存在，且运行正常。
1

## Page 934

–
否，请联系华为技术支持工程师处理。
6.
参考以上操作，检查备站点异地容灾进程是否存在，如果异常请联系华为技术支
持工程师修复异地容灾进程。
步骤3 检查主站点和备站点管理节点的异地容灾系统证书是否过期。
查看是否存在主备站点的“51025 异地容灾证书已过期”告警。
●
是，请更新异地容灾证书，操作成功后执行步骤5。
●
否，则表示不是证书过期导致该故障。
步骤4 联系华为技术支持工程师检查主站点和备站点管理节点异地容灾系统证书是否匹配。
步骤5 查看本告警是否清除。
●
是，告警处理结束。
●
否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.18.5.3 ALM-101204
主备站点部署异常
说明
● 本告警仅在华为云Stack场景下存在。
●
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇
总文件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理
侧）”。若存在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登
录；若不存在，则使用“ManageOne部署面”的地址进行登录。
告警解释
当异地容灾系统检测（检测周期为1小时）到主站点和备站点上部署的节点、时间、管
理面的语言、服务版本或者服务实例不一致时，产生该告警。当主备站点的部署方案
一致时，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
101204
重要 处理错误告警
1

## Page 935

告警参数
类别 参数名称 参数含义
定位信息 站点1 站点名称。
产品别名1 站点上产品的别名。
站点2 站点名称。
产品别名2 站点上产品的别名。
对系统的影响
在主备站点产品上执行倒换和强制同步数据操作会失败。
可能原因
●
主站点和备站点的时间差超过1分钟。
●
主站点和备站点上部署的节点不一致。
●
主站点和备站点上部署的服务版本不一致。
●
主站点和备站点上部署的服务实例不一致。
●
主备站点管理面的语言不一致。
处理步骤
查看该告警中的可能原因信息。
●
若可能原因为主站点和备站点的时间差超过一分钟，按如下方法处理：
a.
登录主站点的管理面配置NTP服务器。
i.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，
https://192.168.0.1:31945。
默认帐号：admin。
ii.
在管理面主菜单中选择“维护
>
时间管理
>
配置NTP”。
iii.
在“配置NTP”页面，按照界面指引完成相关操作。
b.
登录备站点的管理面，参照a配置NTP服务器。
c. 配置NTP服务器完成15分钟后，分别在主备站点管理节点执行以下步骤，查
看主站点和备站点时间是否小于一分钟。
i.
使用PuTTY工具以sopuser用户通过SSH方式分别登录主备站点的管理节
点。
说明
只需在ManageOne-Deploy01节点执行以下操作。
ii.
执行以下命令，分别查看主备站点管理节点的当前时间。
> date -u
系统回显如下类似信息：
1

## Page 936

Thu Sep 17 11:46:35 UTC 2020
iii.
根据c.ii查询的当前时间，对比主备站点管理节点的时间差是否超过一分
钟。
○
是，执行e。
○
否，执行d。
d.
登录主站点管理面强制同步时间。
i.
在管理面主菜单中选择“维护
>
时间管理
>
配置时区时间”。
ii.
在“配置时区时间”界面，单击“强制同步”。
说明
●
如果强制同步的时区时间是备站点的时区时间，请取消选中“警告”对话框
中“强制同步时区时间完成后自动启动产品数据库和产品服务”，避免备站
点上的产品服务被重启，造成双主运行的异常状态。
●
如果强制同步时区时间后，同步后和同步前的时间差，超出会话自动注销等
待时间，客户端会话会自动注销。
iii. 在主菜单选择“系统 > 任务列表”，等待15分钟“强制同步时区时间”
任务执行成功。
e. 等待5分钟后，查看本告警是否清除。
▪
是，告警处理结束。
▪
否，请联系华为技术支持工程师。
●
若可能原因为其他信息，请联系华为技术支持工程师处理。
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.18.5.4 ALM-101230
系统健康检查异常
说明
●
本告警仅在华为云Stack场景下存在。
●
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇
总文件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理
侧）”。若存在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登
录；若不存在，则使用“ManageOne部署面”的地址进行登录。
告警解释
当异地容灾系统检测到主备站点存在异常的健康检查结果时，产生该告警。异地容灾
系统每隔1小时会对异常项再次进行检查，当健康检查结果都正常后，系统自动清除该
告警。
1

## Page 937

告警属性
告警ID 告警级别 告警类型
101230
紧急 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 检查对象 异地容灾系统及其主备站点名称。
对系统的影响
●
存在紧急级别的检查项时，正常站点产品无法接管故障站点产品上的业务。
●
存在重要级别的检查项时，无法倒换主备站点产品。
●
存在提示级别的检查项时，可能会导致业务异常。
可能原因
异地容灾系统存在异常。
处理步骤
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在管理面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”。
步骤3 单击右上方的“查看评估结果”。
步骤4 查看评估结果为“异常”的检查项，根据修复建议处理。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 938

1.3.18.5.5 ALM-51024
站点状态异常
说明
● 本告警仅在华为云Stack场景下存在。
●
操作步骤中要登录部署面时，需要在HUAWEI
CLOUD Stack
Deploy工具导出的参数信息汇
总文件的“portal”页签中，查找是否存在“ManageOne运营指挥中心部署面（管理
侧）”。若存在，则使用“ManageOne运营指挥中心部署面（管理侧）”的地址进行登
录；若不存在，则使用“ManageOne部署面”的地址进行登录。
告警解释
当异地容灾系统连续3次检测（检测周期为30秒）到主备站点产品的异地容灾状态异常
时，即两站点上的产品处于“双主”、“双备”或者故障状态，产生该告警。当站点
状态恢复正常后，系统自动清除该告警。
告警属性
告警ID 告警级别 告警类型
51024 紧急 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 站点1 站点名称。
产品别名1 站点上产品的别名。
站点2 站点名称。
产品别名2 站点上产品的别名。
对系统的影响
●
主备站点的数据不一致，站点间的数据无法同步。
●
可能会导致主备站点数据丢失。
可能原因
●
主站点或者备站点的管理节点被下电。
●
主站点和备站点间的心跳状态异常。
●
异地容灾服务重启或异常。
●
管理面正在创建或者删除产品的异地容灾关系。
● 主站点和备站点间的心跳状态异常时，在备站点对该产品执行了接管操作，备站
点完成接管后该产品升级为主用状态，此时系统处于“双主”状态。
●
主站点和备站点间的心跳状态异常时，在主站点对该产品执行了降备操作，主站
点完成降备后该产品降级为备用状态，此时系统处于“双备”状态。
1

## Page 939

●
系统在执行升主或者降备过程时失败。
处理步骤
步骤1 请根据下表进行故障排查。
说明
该故障排查方法比较复杂，此处只介绍初步的排查方法，如果仍不能解决，请联系华为技术支持
工程师处理。
表1-65 故障检查项
检查项 检查方法 处理措施
主站点或者备站点的管
理节点是否被下电。
- 1.
联系管理员检查并上电
虚拟机。
2.
根据场景选择操作。
–
若其中一个站点的管
理节点被下电，待上
电完成后执行步骤
7。
–
若主站点和备站点上
的管理节点被下电，
待上电完成后执行步
骤2～步骤7。
主站点和备站点间的心
跳状态和异地容灾服务
是否运行正常。
●
检查主站点和备站点之
间的心跳网络。
●
检查主站点和备站点管
理节点的异地容灾服务
状态。
● 检查主站点和备站点管
理节点的异地容灾系统
证书是否匹配或者是否
已过期。
请参见1.3.18.5.2
ALM-101201
心跳异常。
创建或者删除产品的异
地容灾关系是否成功。
在管理面主菜单的“系统
>
任务列表”中查看任务执行
情况。
●
若任务执行成功，执行
步骤7。
●
若任务执行失败，请联
系华为技术支持工程
师。
查看站点状态是否都为
主站点。
在管理面主菜单的“高可用
>
异地高可用系统
>
管理异
地容灾系统”中查看站点状
态。
●
若两站点分别为主站点
和备站点，执行步骤7。
●
若两站点都为主站点，
执行步骤2～步骤7。
1

## Page 940

检查项 检查方法 处理措施
查看站点升主或者降备
是否成功。
在管理面主菜单的“系统
>
任务列表”中查看任务执行
情况。
●
若任务执行成功，执行
步骤7。
●
若任务执行失败，请联
系华为技术支持工程
师。
步骤2 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤3 在管理面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”。
步骤4 在待同步数据的产品所在行“操作”列中，单击 ，选择主备站点产品的数据同步方
向。
若主备站点的状态为主用和备用，无需选择产品的数据同步方向，系统会自动从主用
站点向备用站点同步数据。
须知
选择数据同步方向时，异地容灾系统会根据用户选择方向进行全量数据同步，并覆盖
被同步的站点产品数据。建议以含有最新数据的产品为主用站点产品，向对端站点产
品同步。若选择由备用站点向主用站点产品同步，则首先备用站点会升级为主用，然
后再进行产品数据同步。
步骤5 根据界面上的提示完成操作。
步骤6 检查操作结果。如果操作结果与预期不符，请联系华为技术支持工程师。
1. 在管理面主菜单中选择“高可用 > 异地高可用系统 > 管理异地容灾系统”。
2.
查看主备站点间的心跳状态为 。
3.
查看所有产品的“数据同步状态”为“已同步”或者“同步中”。如果“数据同
步状态”显示为“延迟”，表示主站点和备站点有较多的数据正在同步，请等待
数据同步完成后再检查状态。
4.
主用站点运维面能正常登录。
步骤7 查看本告警是否清除。
●
是，告警处理结束。
● 否，请收集上述告警处理过程中的信息，联系华为技术支持工程师协助解决。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 941

参考信息
无。
1.3.18.5.6 ALM-51025
异地容灾证书已过期
说明
本告警仅在华为云Stack场景下存在。
告警解释
系统每天对异地容灾系统证书有效期进行一次检查，当异地容灾证书的有效期过期或
者证书无效时，上报该告警。异地容灾证书更新成功后，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
51025
紧急 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 站点1 站点类型。
站点2 站点类型。
对系统的影响
异地容灾服务重启后，主站点和备站点将无法正常通信。
可能原因
异地容灾系统证书已超过有效期。
处理步骤
步骤1 更新异地容灾系统的证书，具体操作请联系华为技术支持工程师进行处理。
步骤2 检查该告警是否清除。
●
是，处理结束。
●
否，请联系华为技术支持工程师处理。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 942

参考信息
无。
1.3.18.5.7 ALM-51026
异地容灾系统的证书即将过期
说明
本告警仅在华为云Stack场景下存在。
告警解释
当异地容灾系统证书的剩余使用天数不足90天时，系统每天上报一次证书即将过期告
警。异地容灾证书更新成功后，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
51026
重要 处理错误告警
告警参数
类别 参数名称 参数含义
定位信息 站点1 站点名称。
站点2 站点名称。
对系统的影响
主站点和备站点将无法正常通信。
可能原因
异地容灾系统证书的剩余使用天数不足90天。
处理步骤
步骤1 更新异地容灾系统的证书，具体操作请联系华为技术支持工程师进行处理。
步骤2 检查该告警是否清除。
●
是，处理结束。
●
否，请联系华为技术支持工程师处理。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 943

参考信息
无。
1.3.19
数据分析平台
1.3.19.1 ALM-0001000300030003 Elasticsearch
索引个数超限
告警解释
默认间隔5分钟检测Elasticsearch索引个数，当连续3次检测到索引个数超过限制时，
产生此告警。
告警属性
告警ID 告警级别 告警类型
0001000300030003
重要 环境告警
告警参数
参数名称 参数含义
区域 产生告警的区域。
云服务 产生告警的服务。
主机IP 产生告警的IP地址。
对系统的影响
可能导致报表查询、容量查询及性能查询接口超时或者相关页面响应变慢，甚至
Elasticsearch相关功能不可用。
可能原因
环境异常导致索引老化机制失效。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“日常运维
>
自动作业”。
1

## Page 944

步骤3 在左侧导航栏选择“操作库
>
编排管理”。
进入编排管理页面。
步骤4 在“内置编排”页签右上角搜索框输入“Elasticsearch业务异常信息收集”进行搜索。
说明
如果搜索结果为空，请参考参考信息的“导入最新版本的ManageOne AutomationScripts自动
化脚本软件包”导入后重新搜索。
步骤5 在“Elasticsearch业务异常信息收集”所在行的“操作”列单击“执行”，确认执行。
步骤6 在左侧导航栏选择“作业
>
作业历史”，等待执行成功后，单击操作列的“下载结
果”，将结果保存下来。
步骤7 请联系技术工程师协助解决。
----结束
告警清除
默认连续3次检测到Elasticsearch索引个数正常时，系统会自动清除此告警信息，无需
手工清除。
参考信息
导入最新版本的ManageOne AutomationScripts自动化脚本软件包
步骤1 获取最新版本的《ManageOne
AutomationScripts X.X.X.X
使用指南》。
说明
请仔细分辨文档名称，避免获取为《华为云Stack
AutomationScripts X.X.X.X
使用指南》。
1.
在“ManageOne AutomationScripts”软件目录下，单击打开最新版本的目录。
–
企业网：单击此处
–
运营商：单击此处
2.
将页面拉至底部，查看“版本文档”下是否存在《ManageOne
AutomationScripts X.X.X.X
使用指南》？
–
是，获取该手册。
–
否，退回至“ManageOne AutomationScripts”软件目录，单击打开下一个
版本，继续查找是否存在该手册。重复此步骤，直至找到该手册的最新版
本。
步骤2 参考最新版本的《ManageOne
AutomationScripts X.X.X.X
使用指南》导入
ManageOne
8.1.0及其补丁配套的ManageOne AutomationScripts自动化脚本软件
包。
----结束
1.3.19.2 ALM-0001000300030004 Elasticsearch
集群状态异常
告警解释
默认间隔5分钟检测Elasticsearch集群状态，当连续3次检测到集群状态异常时，产生
此告警。
1

## Page 945

告警属性
告警ID 告警级别 告警类型
0001000300030004
重要 环境告警
告警参数
参数名称 参数含义
区域 产生告警的区域。
云服务 产生告警的服务。
主机IP 产生告警的IP地址。
对系统的影响
可能导致报表查询、容量查询及性能查询接口超时或者相关页面响应变慢，甚至
Elasticsearch相关功能不可用。
可能原因
●
MODataSetService微服务正在重启并且连续3个检测周期集群状态未恢复到正
常。
●
MODataSetService微服务停止并且连续3个检测周期集群状态未恢复到正常。
●
网络设备异常。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“日常运维
>
自动作业”。
步骤3 在左侧导航栏选择“操作库
>
编排管理”。
进入编排管理页面。
步骤4 在“内置编排”页签右上角搜索框输入“Elasticsearch业务异常信息收集”进行搜索。
说明
如果搜索结果为空，请参考参考信息的“导入最新版本的ManageOne AutomationScripts自动
化脚本软件包”导入后重新搜索。
步骤5 在“Elasticsearch业务异常信息收集”所在行的“操作”列单击“执行”，确认执行。
1

## Page 946

步骤6 在左侧导航栏选择“作业
>
作业历史”，等待执行成功后，单击操作列的“下载结
果”，将结果保存下来。
步骤7 请联系技术工程师协助解决。
----结束
告警清除
当Elasticsearch集群状态正常时，系统会自动清除此告警信息，无需手工清除。
参考信息
导入最新版本的ManageOne AutomationScripts自动化脚本软件包
步骤1 获取最新版本的《ManageOne
AutomationScripts X.X.X.X
使用指南》。
说明
请仔细分辨文档名称，避免获取为《华为云Stack
AutomationScripts X.X.X.X
使用指南》。
1.
在“ManageOne AutomationScripts”软件目录下，单击打开最新版本的目录。
–
企业网：单击此处
–
运营商：单击此处
2.
将页面拉至底部，查看“版本文档”下是否存在《ManageOne
AutomationScripts X.X.X.X
使用指南》？
–
是，获取该手册。
–
否，退回至“ManageOne AutomationScripts”软件目录，单击打开下一个
版本，继续查找是否存在该手册。重复此步骤，直至找到该手册的最新版
本。
步骤2 参考最新版本的《ManageOne
AutomationScripts X.X.X.X
使用指南》导入
ManageOne
8.1.0及其补丁配套的ManageOne AutomationScripts自动化脚本软件
包。
----结束
1.3.20 IAM
1.3.20.1 ALM-36064531474581504 IAM
数据库资源使用异常或服务异常
说明
本告警仅在华为云Stack场景下存在。
告警解释
IAM在定时任务中检测到Redis连接数超过阈值、获取Token失败、IAM服务握手失
败、数据库Session连接数超过阈值，基于事件聚合规则（30分钟内大于2条IAM数据
库资源使用异常或服务异常事件）产生此告警。产生的告警需在对应事件的附加信息
中查看具体原因。
1

## Page 947

告警属性
告警ID 告警级别 告警类型
36064531474581504
重要 业务质量告警
告警参数
参数名称 参数含义
节点IP地址 被检测到异常IAM服务所在服务器节点IP地址。
定位信息 包含规则ID和事件名称。
对系统的影响
ManageOne中IAMCacheProxyService服务或IAMCoreService服务运行异常，可能导
致依赖IAM服务的业务无法正常使用IAM的对外接口功能。
可能原因
●
IAMCacheProxyService服务异常无法正常生成Token。
●
IAMCacheProxyService服务操作Redis失败或者Redis连接数超过阈值。
●
IAMCacheProxyService服务操作数据库失败或者数据库Session连接数超过阈值。
●
IAMCacheProxyService与IAMCoreService握手失败。
处理步骤
步骤1 使用PuTTY，登录告警发生所在节点。节点的IP地址可在该告警的“定位信息”列中
获取。
默认帐号：sopuser。
步骤2 执行如下命令，切换root用户。
sudo su root
步骤3 执行如下命令，收集IAMCacheProxyService服务运行日志信息。
tar -zcvf
/tmp/IAMCacheProxyService-节点IP地址-log.tar.gz
/var/log/oss/
Product/IAMCacheProxyService/iamcacheproxy*/log/root.log
说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
步骤4 执行如下命令，收集IAMCoreService服务运行日志信息。
tar -zcvf
/tmp/IAMCoreService-节点IP地址-log.tar.gz
/var/log/oss/Product/
IAMCoreService/root.log
1

## Page 948

说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
步骤5 根据步骤3和步骤4收集的日志信息，联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警。
参考信息
无。
1.3.20.2 ALM-0004000700010009 IAM
鉴权失败
说明
本告警仅在华为云Stack场景下存在。
告警解释
服务监控定时5分钟巡检调用IAM鉴权Token接口，如果连续3次接口返回失败响应，则
产生该告警。鉴权Token接口失败可能导致在ManageOne运营面登录、创建、修改、
删除操作失败及云服务等业务到IAM鉴权失败。
告警属性
告警ID 告警级别 告警类型
0004000700010009
重要 业务质量告警
告警参数
参数名称 参数含义
节点IP地址 被检测IAM鉴权失败所在服务器节点IP地址。
对系统的影响
●
可能导致在ManageOne运营面登录、创建、修改、删除操作失败。
●
可能导致客户云服务（ECS、EVS、OBS等）创建、重启、扩容、迁移等操作失
败。
可能原因
●
IAMCacheProxyService服务异常无法正常生成Token。
●
IAMCacheProxyService服务连接Redis失败或操作Redis失败。
1

## Page 949

●
IAMCacheProxyService服务连接数据库失败或操作数据库失败。
处理步骤
步骤1 使用PuTTY，登录告警发生所在节点。节点的IP地址可在该告警的“定位信息”列中
获取。
默认帐号：sopuser。
步骤2 执行如下命令，切换root用户。
sudo su root
步骤3 执行如下命令，重启IAMCacheProxyService服务尝试恢复业务。
su ossadm -c "/opt/oss/manager/agent/bin/ipmc_adm -cmd restartapp -app
IAMCacheProxyService"
●
回显信息如下所示，表示重启服务成功。
Stopping process iamcacheproxy-x-x ... success
Starting process iamcacheproxy-x-x ... success
等待5-10分钟，查看告警是否清除。
–
清除，结束。
–
未清除，执行步骤4。
●
否则，表示重启服务失败，执行步骤4。
步骤4 执行如下命令，收集IAMCacheProxyService服务运行日志信息。
tar -zcvf
/tmp/IAMCacheProxyService-节点ip地址-log.tar.gz
/var/log/oss/
Product/IAMCacheProxyService/iamcacheproxy*/log/root.log
说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
步骤5 执行如下命令，收集IAMCoreService服务运行日志信息。
tar -zcvf
/tmp/IAMCoreService-节点ip地址-log.tar.gz
/var/log/oss/Product/
IAMCoreService/root.log
说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
步骤6 根据步骤4和步骤5收集的日志信息，联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警。
告警参考
无。
1

## Page 950

1.3.21 VDC
管理
1.3.21.1 ALM-36064531474581505
租户下用户组关联资源集数超过阈值
告警解释
ManageOne
VDC服务定时检查各个租户下用户组与资源集的关联数量，系统阈值设
置为50000，但如果关联关系超过45000会上报事件，按照系统预置的聚合规则，在
43200秒（12小时）内有两次事件上报则会生成此告警。
告警属性
告警ID 告警级别 告警类型
36064531474581505
重要 业务质量告警
对系统的影响
当上报此告警，可能会导致依赖VDC和IAM服务的业务无法正常对外提供服务。
可能原因
租户下用户组与资源集的关联数量超出系统阈值。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“集中监控
>
告警管理
>
事件日志”。
步骤3 根据告警名称过滤，查找到该条告警对应的事件日志。
步骤4 展开事件日志详情，查看附加信息。附加信息会显示当前环境中，超出阈值的租户名
称以及这些租户下各自的关联关系数。
步骤5 使用浏览器，以运营管理员登录ManageOne。
非B2B场景登录地址：https://ManageOne运营面的访问地址。例如，https://
console.demo.com。
B2B场景登录地址：https://ManageOne运营管理面的访问地址。例如，https://
admin.demo.com。
登录方式分为“密码认证”和“USB Key认证”。
●
密码认证：输入帐号和密码。
● USB
Key认证：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
1

## Page 951

步骤6 请对步骤4中查看到的所有超出阈值的租户执行以下操作。
1.
单击主菜单的“组织”。
进入“租户管理”页面。
2.
单击租户名称。
3.
单击左树菜单的“用户组”。
4.
逐一单击除一级VDC下的默认VDC管理员用户组外，其他用户组所在行的“权限
配置”，切换到“用户组权限管理”页签的“资源集视图”。
5.
查看用户组关联的资源集，从已选的资源集列表中移除非必要的资源集。
如果操作过程出现无法解决的问题，请执行步骤8。
步骤7 等待大约5小时后，查看告警是否消除。
●
是：结束。
●
否：执行步骤8。
步骤8 请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.22
计量
1.3.22.1 ALM-1001001004
计量话单文件磁盘配额使用率超阈值
告警解释
ManageOne
AutoOps自动作业平台定期执行脚本，计算计量话单文件磁盘配额使用
率，当使用率超过阈值时，产生此告警。80% 配额使用率 90%产生重要告警，配
额使用率 90%产生紧急告警。
告警属性
告警ID 告警级别 告警类型
1001001004
重要/紧急 环境告警
1

## Page 952

告警参数
参数名称 参数含义
附加信息 阈值：磁盘阈值，重要告警阈值是80%，紧急告警阈值
是90%。
详细信息：计量话单文件所在节点和具体IP地址，以及
每个节点上磁盘的具体配额和使用率。
对系统的影响
计量话单文件磁盘使用率超过阈值，存在计量话单文件耗尽磁盘配额，导致计量话单
文件丢失的风险。
可能原因
计量话单上报过快，超过系统的处理能力。
处理步骤
步骤1 使用PuTTY工具以sopuser用户登录磁盘配额使用率超阈值的节点。
步骤2 执行以下命令，切换到root用户。
sudo su root
步骤3 执行以下命令，防止PuTTY超时退出。
TMOUT=0
步骤4 执行以下命令，进入MOMeteringService的话单目录下。
cd /opt/sftpfile/opt/meterfiles/uploads/
步骤5 执行如下命令，查看每个云服务话单文件占用的磁盘大小。
du -h --max-depth=1 /opt/sftpfile/opt/meterfiles/uploads | sort -hr | head -10
22M /opt/sftpfile/opt/meterfiles/uploads
2.6M /opt/sftpfile/opt/meterfiles/uploads/vpnconnection
2.6M /opt/sftpfile/opt/meterfiles/uploads/volume
2.6M /opt/sftpfile/opt/meterfiles/uploads/vm
2.6M /opt/sftpfile/opt/meterfiles/uploads/snapshot
2.6M /opt/sftpfile/opt/meterfiles/uploads/lbaas
2.6M /opt/sftpfile/opt/meterfiles/uploads/ip
2.6M /opt/sftpfile/opt/meterfiles/uploads/dc
2.6M /opt/sftpfile/opt/meterfiles/uploads/bandwidth
步骤6 执行以下命令，将占用磁盘空间最大的云服务文件夹进行压缩。
zip -q -r /opt/meterfiles_CloudService.zip /opt/sftpfile/opt/meterfiles/uploads/
CloudService
说明
CloudService表示步骤5中查询出来的占用磁盘空间最大的云服务文件夹名称，例如
vpnconnection。
1

## Page 953

步骤7 执行以下命令，修改步骤6中压缩包的所属用户组。
chown sopuser:wheel /opt/meterfiles_CloudService.zip
步骤8 使用WinSCP等工具以sopuser用户连接当前登录的节点，下载话单压缩包至本地保
存。
步骤9 在PuTTY中继续执行以下命令，进入步骤5中查询出来的占用磁盘空间最大的云服务目
录。
cd /opt/sftpfile/opt/meterfiles/uploads/CloudService/bak
步骤10 执行以下命令，删除该目录下30天之前的话单文件。
find /opt/sftpfile/opt/meterfiles/uploads/CloudService/bak -mtime +30 -type f
-name \*.zip -exec rm -f {} \;
说明
●
以上命令默认删除30天之前的文件，可根据实际情况修改该时间。
●
执行以上命令时，请确认路径/opt/sftpfile/opt/meterfiles/uploads/CloudService/bak是
否正确，以防文件被误删。
步骤11 查看告警是否清除。
●
是，处理完毕。
●
否，联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.23 URL
拨测
1.3.23.1 ALM-0001000300040001 URL
拨测状态码阈值告警
告警解释
拨测请求发起之后，拨测目标返回的状态码不满足拨测任务设置的状态码阈值条件
时，产生此告警。只有HTTP或者HTTPS类型的拨测会产生此告警，PING类型的不会产
生此告警。
说明
本告警仅在华为云Stack场景下存在。
1

## Page 954

告警属性
告警ID 告警级别 告警类型
0001000300040001
紧急/重要/次要/提示 业务质量告警
告警参数
参数名称 参数含义
URL拨测 URL拨测的任务名称。
应用 应用ID。
模块 模块ID。
对系统的影响
无。
可能原因
●
阈值条件设置不合理。
●
拨测目标地址配置异常。
处理步骤
步骤1 获取拨测任务信息。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面
3.
单击目标告警所在行的 ，展开告警详情。
4.
查看并记录告警详情页面中的“定位信息”和“可能原因”。
步骤2 检查拨测目标地址配置是否正确。
1. 在主菜单中选择“集中监控 > 监控配置”。
2.
在左侧导航栏选择“监控任务”，默认进入“URL拨测（租户面）”页面。
3.
在拨测任务列表中，单击步骤1对应拨测任务所在行的“修改”，在“基本信息”
区域查看“地址”的配置是否正确。
–
是，执行步骤4。
–
否，执行步骤3。
步骤3 在拨测任务的“基本信息”中，修改拨测目标地址。
1

## Page 955

1.
修改为正确的拨测目标地址。
2.
至少等待5分钟，等待时长与拨测周期相关。
3.
在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否清除。
–
是，处理完毕。
–
否，执行步骤4。
步骤4 检查拨测任务中状态码阈值条件设置是否合理。
在拨测任务列表中，单击步骤1对应拨测任务所在行的“修改”，在“告警”区域查看
“状态码”的阈值条件设置是否合理。
●
是，执行步骤6。
●
否，执行步骤5。
步骤5 修改拨测任务的状态码阈值策略。
1.
根据实际定位故障需求，参考表1-66修改阈值策略。
表1-66 通常使用的状态码
状态码 解释说明
200、201、202、204 表示处理成功。
302
表示重定向。
400
请求参数错误。
401
表示未授权。
403
表示禁止访问。
404
表示资源找不到。
500
表示不可预知的错误。
503
表示暂停服务。
2.
至少等待5分钟，等待时长与拨测周期相关。
3.
在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否清除。
–
是，处理完毕。
–
否，执行步骤6。
步骤6 请联系技术支持工程师协助解决。
----结束
参考信息
无。
告警清除
修复后，系统会自动清除此通知信息，无需手工清除。
1

## Page 956

1.3.23.2 ALM-0001000300040002 URL
拨测响应时间阈值告警
告警解释
拨测请求发起之后，拨测目标的响应时间超过拨测任务中设置的响应时间时，产生此
告警。
说明
本告警仅在华为云Stack场景下存在。
告警属性
告警ID 告警级别 告警类型
0001000300040002
紧急/重要/次要/提示 业务质量告警
告警参数
参数名称 参数含义
URL拨测 URL拨测的任务名称。
应用 应用ID。
模块 模块ID。
对系统的影响
无。
可能原因
●
阈值条件设置不合理。
●
拨测目标地址配置异常。
处理步骤
步骤1 获取拨测任务信息。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面
3.
单击目标告警所在行的 ，展开告警详情。
1

## Page 957

4.
查看并记录告警详情页面中的“定位信息”和“可能原因”。
步骤2 检查拨测目标地址配置是否正确。
1.
在主菜单中选择“集中监控
>
监控配置”。
2. 在左侧导航栏选择“监控任务”，默认进入“URL拨测（租户面）”页面。
3.
在拨测任务列表中，单击步骤1对应拨测任务所在行的“修改”，在“基本信息”
区域查看“地址”的配置是否正确。
– 是，执行步骤4。
–
否，执行步骤3。
步骤3 在拨测任务的“基本信息”中，修改拨测目标地址。
1.
修改为正确的拨测目标地址。
2. 至少等待5分钟，等待时长与拨测周期相关。
3.
在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否清除。
– 是，处理完毕。
–
否，执行步骤4。
步骤4 检查监控指标的阈值设置是否合适。
在拨测任务列表中，单击对应拨测任务所在行的“修改”，在“告警”区域查看“响
应时间”的阈值条件设置是否合理。
●
是，执行步骤6。
●
否，执行步骤5。
步骤5 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
至少等待5分钟，等待时长与拨测周期相关。在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否清除。
–
是：处理完毕。
–
否：执行步骤6。
步骤6 请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.3.23.3 ALM-0001000300040003 URL
拨测超时告警
告警解释
拨测请求发起之后，拨测目标超过固定值30s无响应时，产生此告警。只有HTTP或者
HTTPS类型的拨测会产生此告警，PING类型的不会产生此告警。
说明
本告警仅在华为云Stack场景下存在。
1

## Page 958

告警属性
告警ID 告警级别 告警类型
0001000300040003
紧急/重要/次要/提示 业务质量告警
告警参数
参数名称 参数含义
URL拨测 URL拨测的任务名称。
应用 应用ID。
模块 模块ID。
对系统的影响
无。
可能原因
●
拨测目标地址配置异常。
●
拨测目标业务运行异常。
●
网络异常。
处理步骤
步骤1 获取拨测任务信息。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面
3.
单击目标告警所在行的 ，展开告警详情。
4.
查看并记录告警详情页面中的“定位信息”和“可能原因”。
步骤2 检查拨测目标地址配置是否正常。
1.
在主菜单中选择“集中监控
>
监控配置”。
2.
在左侧导航栏选择“监控任务”，默认进入“URL拨测（租户面）”页面。
3.
在拨测任务列表中，单击步骤1对应拨测任务所在行的“修改”，在“基本信息”
区域查看“地址”的配置是否正常。
–
是，执行步骤4。
–
否，执行步骤3。
1

## Page 959

步骤3 在拨测任务的“基本信息”中，修改拨测目标地址。
1.
修改为正确的拨测目标地址。
2.
至少等待5分钟，等待时长与拨测周期相关。
3.
在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否清除。
–
是，处理完毕。
–
否，执行步骤4。
步骤4 请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.3.23.4 ALM-0001000300040004 URL
拨测丢包率阈值告警
告警解释
拨测请求发起之后，拨测目标的丢包率超过拨测任务中设置的丢包率时，产生此告
警。只有PING类型的拨测会产生此告警，HTTP类型和HTTPS类型的不会产生此告警。
说明
本告警仅在华为云Stack场景下存在。
告警属性
告警ID 告警级别 告警类型
0001000300040004
紧急/重要/次要/提示 业务质量告警
告警参数
参数名称 参数含义
URL拨测 URL拨测的任务名称。
应用 应用ID
模块 模块ID
对系统的影响
无。
可能原因
●
阈值条件设置不合理。
1

## Page 960

●
拨测目标地址配置异常。
处理步骤
步骤1 获取拨测任务信息。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面
3.
单击目标告警所在行的 ，展开告警详情。
4.
查看并记录告警详情页面中的“定位信息”和“可能原因”。
步骤2 检查拨测目标地址配置是否正常。
1.
在主菜单中选择“集中监控
>
监控配置”。
2.
在左侧导航栏选择“监控任务”，默认进入“URL拨测（租户面）”页面。
3.
在拨测任务列表中，单击步骤1对应拨测任务所在行的“修改”，在“基本信息”
区域查看“地址”的配置是否正常。
–
是，执行步骤4。
–
否，执行步骤3。
步骤3 在拨测任务的“基本信息”中，修改拨测目标地址。
1.
修改为正确的拨测目标地址。
2.
至少等待5分钟，等待时长与拨测周期相关。
3.
在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否清除。
–
是，处理完毕。
–
否，执行步骤4。
步骤4 检查监控指标的阈值设置。在拨测任务列表中，单击对应拨测任务所在行的“修
改”，在“告警”区域查看“丢包率”的阈值条件设置是否合理。
● 是，执行步骤6。
●
否，执行步骤5。
步骤5 修改指标阈值策略。
1.
根据实际指标数据修改阈值。
2.
至少等待5分钟，等待时长与拨测周期相关。在主菜单选择“集中监控
>
告警管理
>
当前告警”，检查告警是否清除。
–
是，处理完毕。
–
否，执行步骤6。
步骤6 请联系技术支持工程师协助解决。
----结束
1

## Page 961

参考信息
无。
1.3.23.5 ALM-0001000300050001 URL
拨测异常告警
告警解释
URL拨测请求发起之后拨测目标的响应发生异常时产生此告警。
告警属性
告警ID 告警级别 告警类型
0001000300050001
紧急/重要/次要/提示 业务质量告警
告警参数
参数名称 参数含义
URL拨测 URL拨测的任务名称。
云服务 云服务名称。
拨测点 URL拨测任务发起拨测请求的管理虚拟机节点。
对系统的影响
拨测的接口响应慢或者接口不可用。
可能原因
●
业务配置异常。
●
URL拨测没有响应。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
步骤3 单击目标告警所在行的 ，展开当前告警详情。
说明
其中“级别”的颜色是根据告警级别进行变换，具体请以实际界面为准。
1

## Page 962

步骤4 查看并记录告警详情页面中的“定位信息”和“可能原因”。
步骤5 检查拨测任务是否是预置任务。
1.
在主菜单中选择“集中监控
>
监控配置”。
2.
在左侧导航栏选择“监控任务”。
3.
在右侧页面选择“URL拨测（管理面）”页签。
4.
在拨测任务列表中，选择步骤4查到的拨测任务名称所在行，查看“是否预置”列
对应参数是否为“是”。
–
是，执行步骤8。
–
否，执行步骤6。
步骤6 检查拨测目标地址配置是否正常。
在拨测任务列表中，单击拨测任务名称所在行“操作”列的“修改”，在“基本信
息”区域查看“地址”、“鉴权方式”是否正确。
●
是，执行步骤8。
●
否，执行步骤7。
步骤7 修改拨测目标地址与鉴权方式。
1.
修改为正确的拨测目标地址及鉴权方式。
2.
至少等待10分钟，检查告警是否清除。
–
是，处理完毕。
–
否，执行步骤8。
步骤8 查看拨测失败原因。
1.
在拨测任务列表中，单击步骤4查到的拨测任务所在行的任务名称。
2.
在“拨测记录”区域查看响应详情信息。
3.
查看响应详情是否正常。
–
是，执行步骤9。
– 否，执行步骤11。
步骤9 检查拨测任务高级配置是否正常。
在拨测任务列表中，单击拨测任务名称所在行“操作”列的“修改”，在“基本信
息”区域查看“高级配置”中的“匹配响应内容方式”和“匹配响应内容”是否正
确。
●
是，执行步骤11。
●
否，执行步骤10。
步骤10 修改高级配置。
1.
修改为正确的匹配响应内容方式和匹配响应内容。
2.
至少等待10分钟，检查告警是否清除。
–
是：处理完毕。
–
否：执行步骤11。
步骤11 请联系技术支持工程师协助解决。
----结束
1

## Page 963

告警清除
修复后，系统会自动清除此通知信息，无需手工清除。
参考信息
无。
1.3.24
运营指挥中心
1.3.24.1 ALM-99999996
数据源连接异常告警
说明
本告警仅在华为云Stack场景下存在。
告警解释
当定时任务扫描到运营指挥中心里配置的数据源连接异常时，会上报此告警，定时扫
描并上报告警的周期为15分钟。
告警属性
告警ID 告警级别 告警类型
99999996
重要 业务质量告警
告警参数
参数名称 参数含义
数据源名称 连接异常的数据源名称
对系统的影响
●
使用到该数据源的数据加工任务运行失败。
●
如果该数据源类型为关系型数据库，则使用到该数据源的大屏展示异常。
可能原因
●
网络无法连通。
●
数据源用户名、密码、AK、SK或上传证书错误。
处理步骤
步骤1 查看数据源连接异常告警信息。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
1

## Page 964

–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
3.
单击目标告警所在行的 ，展开告警详情，在“定位信息”中查看数据源名称。
步骤2 检查连接异常的数据源URL里的IP地址与ManageOne-OCCAPP01/02/03任意一个节点
的连通性。
1. 使用浏览器，以IT系统管理员帐号登录ManageOne运营指挥中心。
登录地址：https://ManageOne运营指挥中心访问域名:31943。例如，https://
occ.demo.com:31943。
默认帐号：occ_admin。
2.
单击主菜单“制作”，在左侧菜单栏选择“数据源管理”。
3.
在“数据源管理”页面，搜索连接异常的数据源。
4.
单击异常的数据源所在行的“修改”，进入“修改数据源”页面，查看数据源
URL，获取当前数据源URL中配置的IP地址，即目标IP地址。
5.
使用浏览器登录ManageOne运营指挥中心部署面。
默认帐号：admin。
6.
单击页面上的ManageOne产品，进入节点列表。单击ManageOne-
OCCAPP01/02/03任意一个节点，查看上方的管理IP地址。
7.
使用PuTTY工具以sopuser用户通过SSH方式登录步骤2.6获取到的任意一个节点
的管理IP地址。
8.
执行以下命令，检查登录节点与目标IP地址的连通性。
ping
目标IP地址
说明
目标IP地址为步骤2.4中获取的目标IP地址。
–
对于MRS Elasticsearch及MRS_Kafka类型的数据源，如果连通则执行步骤
4。
–
对于其他类型的数据源，如果连通则执行步骤3。
–
如果无法连通，请联系技术支持工程师协助解决。
步骤3 检查数据源连接异常是否由于用户名、密码或AK、SK错误导致。
1.
切回到ManageOne运营指挥中心操作界面，在“修改数据源”页面，重新输入正
确的用户名、密码或AK、SK。
说明
输入用户名、密码还是AK、SK是由数据源类型所决定，具体以实际操作界面为准。
2.
单击“测试连接”。
–
连接成功，单击“确定”，结束。
–
连接失败，请联系技术支持工程师协助解决。
步骤4 检查数据源连接异常是否由于用户名和上传证书错误导致。
1.
使用浏览器登录FusionInsight Manager集群管理面。
默认帐号admin。
1

## Page 965

2.
在菜单中选择“系统
>
权限
>
用户”，找到数据源中需要填写的用户。
3.
单击用户所在行的“更多
>
下载认证凭据”，单击“确定”。
下载成功后，认证凭据会下载到本地，然后解压认证凭据。
4.
切回到ManageOne运营指挥中心操作界面，在“修改数据源”页面，重新输入用
户名和上传步骤4.3已解压的认证凭据。
5.
单击测试连接。
–
连接成功，单击“确定”，结束。
–
连接失败，请联系技术支持工程师协助解决。
----结束
告警清除
数据源连接状态恢复正常，下一次定时任务启动将清除告警。
参考信息
无。
1.3.24.2 ALM-1000009010 Manageone
运营指挥中心许可控制项超量
说明
本告警仅在华为云Stack场景下存在。
告警解释
当Manageone运营指挥中心许可控制项的使用量已经超过总量时，产生该告警。当
ManageOne运营指挥中心许可控制项的使用量小于或等于总量时，该告警会自动清
除。
告警属性
告警ID 告警级别 告警类型
1000009010
紧急 业务质量告警
告警参数
参数名称 参数含义
控制项 许可控制项信息
对系统的影响
无。
1

## Page 966

可能原因
ManageOne运营指挥中心许可控制项的使用量已经超过总量。
处理步骤
步骤1 确认是否存在已超量的ManageOne运营指挥中心许可控制项。
1.
使用浏览器，以IT系统管理员帐号登录ManageOne运营指挥中心。
登录地址：https://ManageOne运营指挥中心访问域名:31943。例如，https://
occ.demo.com:31943。
默认帐号：occ_admin。
2.
单击页面右上角 ，进入“系统管理”页面。
3.
单击左树菜单的“许可管理
>
许可控制项列表”，确认是否存在已超量的许可控
制项。
–
是，执行步骤2。
–
否，请联系技术支持工程师处理。
步骤2 根据超量控制项的“来源”字段，联系技术支持工程师申请对应许可文件。
●
申请云服务许可文件，申请完成后执行步骤3。
●
申请产品许可（License）文件，申请完成后执行步骤4。
步骤3 更新云服务许可文件。
1.
在运营指挥中心的“系统管理”页面，单击左树菜单的“许可管理
>
云服务许可
文件”，进入“云服务许可文件”页面。
2.
单击“更新文件”。
说明
更新云服务许可文件属于高危操作，可能会导致系统业务异常，请谨慎操作。
3.
选择已申请的云服务许可文件，单击“上传文件”。
4.
单击“下一步”，查看许可更新前后的结果对比。
5.
单击“更新生效”，并执行步骤5。
步骤4 更新产品许可（License）文件。
1.
在运营指挥中心的“系统管理”页面，单击左树菜单的“许可管理
>
产品许可软
件列表”，进入“产品许可软件列表”页面。
2.
单击产品许可（License）控制项所属系统“操作”列的“更新文件”。
说明
更新产品许可（License）文件属于高危操作，可能会导致系统业务异常，请谨慎操作。
3.
选择已申请的产品许可（License）文件，单击“上传文件”。
4.
单击“下一步”，查看产品许可（License）更新前后的结果对比。
5.
单击“更新生效”。
步骤5 查看本告警是否清除。
●
是，告警处理结束。
1

## Page 967

●
否，请收集上述告警处理过程中的信息，联系技术支持工程师协助解决。
----结束
告警清除
告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.24.3 ALM-1000009002 ManageOne
运营指挥中心与
MapReduce Service
连
接异常
说明
本告警仅在华为云Stack场景下存在。
告警解释
ManageOne运营指挥中心与MapReduce Service服务端连接断开时产生该告警，提示
ManageOne运营指挥中心与MapReduce Service连接异常。
告警属性
告警ID 告警级别 告警类型
1000009002
紧急 通信告警
告警参数
参数名称 参数含义
环境IP ManageOne运营指挥中心登录页面IP地址
对系统的影响
ManageOne运营指挥中心无法连接到MapReduce Service服务端，数据加工任务无法
提交执行。
可能原因
● MapReduce
Service服务运行异常。
●
ManageOne运营指挥中心与MapReduce Service间网络连接异常。
处理步骤
步骤1 查看MapReduce Service服务是否运行正常。
1

## Page 968

1.
使用浏览器，登录FusionInsight Manager集群管理面（MRS）。
登录地址：https://
FusionInsight
Manager集群管理面（MRS）IP:28443/web/。
默认帐号：admin。
2.
在主菜单中选择“集群
>
Yarn”，进入Yarn服务页面。
3.
根据“基本信息”中“运行状态”，判断Yarn服务运行状态。
–
“未启动”，执行步骤1.4。
–
“良好”，执行步骤2。
4.
单击页面右上角“启动服务”，待“运行状态”显示“良好”后大约两分钟查看
告警是否清除。
–
告警清除，则告警处理结束。
–
告警未清除，执行步骤2。
步骤2 查看ManageOne运营指挥中心与MapReduce Service间网络连接是否异常。
1.
在主菜单中选择“主机”，进入主机列表页面获取主节点“管理IP”。带有 的
节点为主节点。
2.
获取ManageOne-OCCAPP01/02/03任意一个节点的IP地址。
说明
节点IP地址可通过ManageOne运营指挥中心环境LLD表查看。
3.
使用PuTTY工具以sopuser用户通过SSH方式登录步骤2.2获取到的任意一个节点
的IP地址。
4.
执行以下命令，检查登录节点与MapReduce Service主节点的连通性。
ping MapReduce
Service主节点的管理IP地址
说明
MapReduce
Service主节点的管理IP地址为步骤2.1中获取的IP地址。
–
连接失败，修复网络连接。修复网络连接后等待两分钟，查看告警是否自动
清除，未清除则联系技术工程师协助解决。
–
连接成功，请联系技术支持工程师协助解决。
----结束
告警清除
当ManageOne运营指挥中心可以连接到MapReduce Service服务端，告警会自动消
除。
参考信息
无。
1.3.25
资源管理
1

## Page 969

1.3.25.1 ALM-10000011 ManageOne
管理资源超过部署规格限制
告警解释
MOAutoOps定期执行脚本，计算出等效虚拟网元数量，以此等效虚拟网元数量和
Region数量来匹配ManageOne的部署规格，如果匹配出的规格超过ManageOne部署
规格限制时，产生此告警。
告警属性
告警ID 告警级别 告警类型
10000011
紧急 通信告警
告警参数
参数名称 参数含义
等效网元 将各云服务对象及基础设施对象以对ManageOne的资源消耗
为主要衡量单位换算成统一的等效网元，以此等效网元数量来
定义ManageOne的部署规格。
说明
处理本告警不需要了解等效网元的具体计算方式，查看告警的“定位
信息”即可获取所需值。如果希望深入了解，可以参考
《ManageOne 8.1.0 等效网元计算说明》。
当前等效网元数 当前环境管理设备的等效网元数。
最大支持网元数 最大支持的等效网元数。
当前Region总数 当前环境的Region总数。
最大支持Region总
数
最大支持的Region总数。
当前OpenStack资
源池的Region数
当前环境OpenStack资源池的Region数量，不包括通过
HiCloud、IAAS-V接入、HCS Online接入的Region。
最大支持
OpenStack资源池
的Region总数
最大支持的OpenStack资源池的Region数量，不包括通过
HiCloud、IAAS-V、HCS Online接入的Region。
对系统的影响
可能导致任务失败、接口超时、页面反应变慢，甚至内存溢出、节点重启。
可能原因
ManageOne管理设备数量或Region数量超过ManageOne部署规格限制。
1

## Page 970

处理步骤
步骤1 查看当前告警定位信息。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”。
3.
单击“ManageOne管理资源超过部署规格限制”告警左侧的 ，在“告警详
情”页签的“定位信息”中，查看当前管理资源数目和ManageOne部署规格限
制。
包括：当前等效网元数、最大支持网元数、当前Region总数、最大支持Region总
数、当前OpenStack资源池的Region数和最大支持OpenStack资源池的Region总
数。
–
如果只有当前等效网元数大于最大支持网元数，执行步骤2。
–
如果存在当前Region总数、当前OpenStack资源池的Region数大于对应最大
支持规格的情况，执行步骤6。
步骤2 通过“自动作业”界面的定期执行脚本，下载告警信息收集文件。
1.
在主菜单中选择“日常运维
>
自动作业
>
作业
>
作业历史”，进入“作业历史”
页面。
2.
搜索作业名称为“检查ManageOne管理资源”的作业历史，并在最新执行时间所
在行“操作”列单击“下载结果”。
3.
从所下载的Excel中，可查看到当前ManageOne所管理资源的资源名称、资源数
量、单位等效网元和等效网元数。
步骤3 判断是否可通过调整资源数量，使Excel中的总等效网元数小于最大支持网元数。
1.
根据现网环境评估哪些云服务和基础设施资源可释放。
2.
根据评估结果，在Excel表格“资源数量”列，调整对应的云服务或基础设施的数
量，“等效网元数”列的值会随之改变。
3.
在Excel表格最下方查看调整后的总等效网元数，确认总等效网元数是否小于最大
支持网元数，最大支持网元数在步骤1.3获取。
–
是，执行步骤4。
–
否，执行步骤6。
步骤4 释放符合要求的闲置资源。
步骤5 查看告警是否清除。
●
是，处理完毕。
●
否，执行步骤6。
步骤6 扩容解决方案，使ManageOne部署规格限制满足管理资源要求。
●
华为云Stack场景，请参考《华为云Stack
8.1.0
扩容指南》中的“扩容管理规
模”章节进行扩容。
● HCS
Online场景，联系技术工程师协助解决。
1

## Page 971

步骤7 查看告警是否清除。
●
是，处理完毕。
●
否，联系技术工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.25.2 ALM-100000200001
系统管理的自定义模型数量超过规格上限
告警解释
当CMDB纳管的自定义模型数量超过当前规模下允许管理的自定义模型上限时，会上
报此告警。当自定义模型数量小于或等于当前规模下允许管理的自定义模型上限后，
该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
100000200001
重要 业务质量告警
告警参数
参数名称 参数含义
云服务 告警所属云服务。
服务 告警所属服务。
详细信息 包括当前系统的管理规模、该规模下允许管理的自定
义模型上限和当前实际管理的自定义模型数量。
对系统的影响
若自定义模型超过当前规模下允许管理的自定义模型上限，会影响CMDB性能。
可能原因
自定义模型数量过多。
1

## Page 972

处理步骤
步骤1 查看所有的自定义模型信息。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
3.
单击目标告警所在行的 ，展开告警详情，查看“详细信息”中当前规模下允
许管理的自定义模型上限和当前实际管理的自定义模型数量。
4.
在主菜单中选择“日常运维
>
自动作业”，并在左侧导航树选择“操作库
>
操作
管理”。
5.
在“内置操作”页签搜索“获取自定义资源告警详情日志信息”，单击操作列
“执行”。
6.
在“执行操作”页面，输入“告警ID”，单击页面下方“执行”，进入“ 作业历
史”页面。
7.
在“作业历史”页面搜索当前作业，当“作业状态”为“执行成功”后，单击作
业名称链接，查看脚本输出结果中是否包含自定义模型信息。
–
是，执行步骤2。
–
否，执行步骤3。
步骤2 删除不必要的自定义模型，使模型数量达到上限以下。
说明
●
删除自定义模型前，请先确认对业务的影响。请谨慎操作。
●
以下调用接口的操作，请参考《ManageOne
8.1.0
API参考》中“资源管理”部分对应的接
口。
1.
调用“查询指定资源类型的所有实例”接口，查看待删除模型的所有实例信息，
查看返回数据是否为空。
–
是，执行步骤2.3。
–
否，执行步骤2.2。
2.
调用“批量删除资源实例”接口，批量删除资源实例信息。
3.
调用“查询指定资源类型的所有关系信息”接口，查看待删除模型的关系信息，
查看返回数据是否为空。
–
是，执行步骤2.5。
–
否，执行步骤2.4。
4.
调用“删除指定关系类型”接口，删除步骤2.3查询结果中返回的关系模型。
5.
调用“查询指定资源类型”接口，查询模型的属性信息。
6.
调用“删除指定资源类型的属性”接口，删除步骤2.5查询结果中返回的属性信
息。
7.
调用“删除指定资源类型”接口，删除该自定义模型。
8.
等待一个周期（24小时），查看告警是否清除。
–
是，结束。
1

## Page 973

–
否，执行步骤3。
步骤3 请联系技术支持工程师协助解决。
----结束
告警清除
当自定义模型数量满足要求后，告警会自动清除。
参考信息
无。
1.3.25.3 ALM-100000200002
系统管理的自定义资源数量超过规格上限
告警解释
当CMDB纳管的自定义资源总数超过当前规模下允许管理的自定义资源总数上限，或
纳管的单个自定义模型下的资源数量超过对应的资源数量上限时，会上报此告警。当
CMDB纳管的自定义资源总数小于或等于总数上限，且纳管的单个自定义模型下的资
源数量小于或等于对应资源上限，该告警会自动清除。
告警属性
告警ID 告警级别 告警类型
100000200002
重要 业务质量告警
告警参数
参数名称 参数含义
云服务 告警所属云服务。
服务 告警所属服务。
详细信息 包括当前系统的管理规模、该规模下允许管理自定义
资源总数上限、单个自定义模型允许管理的资源数量
上限、当前实际管理的自定义资源总数和超过单个自
定义资源数量上限的模型数量。
对系统的影响
若自定义资源数量超过上限，会影响CMDB性能。
可能原因
● 单个自定义模型资源数量过多。
●
所有自定义模型资源总数过多。
1

## Page 974

处理步骤
步骤1 查看自定义资源数量。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
3.
单击目标告警所在行的 ，展开告警详情，查看“详细信息”中当前规模下允
许管理自定义资源总数上限、单个自定义模型允许管理的资源数量上限、当前实
际管理的自定义资源总数和超过单个模型允许管理的资源数量的模型数量。
4.
在主菜单中选择“日常运维
>
自动作业”，并在左侧导航树选择“操作库
>
操作
管理”。
5.
在“内置操作”页签搜索“获取自定义资源告警详情日志信息”，单击操作列
“执行”。
6.
在“执行操作”页面，输入“告警ID”，单击页面下方“执行”，进入“ 作业历
史”页面。
7.
在“作业历史”页面搜索当前作业，当“作业状态”为“执行成功”后，单击作
业名称链接，查看脚本输出结果中是否包含自定义资源模型以及资源数量信息。
–
是，执行步骤2。
–
否，执行步骤3。
步骤2 删除不必要的自定义资源，使自定义资源数量达到上限以下。
说明
●
删除自定义资源前，请先确认对业务的影响。请谨慎操作。
●
建议用户根据实际业务需求，先考虑删除超过单个自定义模型允许规格上限的资源，再考虑
删除超过自定义资源总数的资源。
●
以下调用接口的操作，请参考《ManageOne
8.1.0
API参考》中“资源管理”部分对应的接
口。
1.
调用“查询指定资源类型的所有实例”接口，查看单个自定义模型对应的所有实
例信息。
2.
调用“批量删除资源实例”接口，批量删除资源实例信息。
3.
等待一个周期（24小时），查看告警是否清除。
–
是，结束。
–
否，执行步骤3。
步骤3 请联系技术支持工程师协助解决。
----结束
告警清除
当自定义模型资源数量满足要求后，告警会自动清除。
1

## Page 975

参考信息
无。
1.3.25.4 ALM-MOCMDB_Specification_1001
系统管理的资源数量超过规格上限
告警解释
当CMDB纳管的资源数量，超过当前规模下允许管理的物理设备或虚拟机的最大限
制，会上报此告警。
告警属性
告警ID 告警级别 告警类型
MOCMDB_Specification_
1001
重要 业务质量告警
告警参数
参数名称 参数含义
云服务 告警所属云服务。
服务 告警所属服务。
详细信息 包括当前系统的管理规模、该规模下允许管理的物理
设备或虚拟机资源数量，以及当前实际管理的物理设
备或虚拟机资源数量。
对系统的影响
若纳管的资源数量超过最大规格限制，会影响CMDB性能。
可能原因
纳管的物理设备过多或者虚拟机过多。
处理步骤
步骤1 查看当前告警定位信息。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
1

## Page 976

3.
单击目标告警所在行的 ，展开告警详情，查看是否物理设备超过最大限制。
说明
可在“资源拓扑
>
资源管理
>
资源列表”页面查看物理设备的数量。物理设备的数量=
（物理服务器+存储设备+FC交换机+路由器+防火墙+交换机+负载均衡+其他网络设备）数
量之和。
–
是，执行步骤2。
–
否，执行步骤3。
步骤2 根据实际情况判断业务是否存在超规格使用场景。
●
是，联系技术支持工程师扩容，否则会影响运维系统性能，严重时可造成系统不
可用。
●
否，执行步骤3。
步骤3 请联系技术支持工程师评估影响，协助删除不需要监控的物理设备或虚拟机，避免误
删。
----结束
告警清除
当系统管理的资源数量满足规格要求，默认24小时后，告警会自动清除。
参考信息
无。
1.3.26 CA
服务
1.3.26.1 ALM-800001 CA
即将过期
告警解释
当CA有效时间小于1年时，产生该告警，有效时间越短，告警级别越高，检测周期为1
天。
告警属性
告警ID 告警级别 告警类型
800001
CA的有效时间小于
90天时：紧急
CA的有效时间小于
半年时：重要
CA的有效时间小于1
年时：次要
时间域告警
1

## Page 977

告警参数
类
别
参数名称 参数含义
定
位
信
息
服务名称 CA服务。
CA名称 CA名称。
颁发者 CA的颁发者。
使用者 CA的使用者。
有效期至 CA的过期时间。
对系统的影响
CA过期后将不能签发证书，不能发布CRL。
可能原因
CA即将过期。
处理步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。
步骤2 单击“CA即将过期”，查看“定位信息”中该CA的名称。
步骤3 在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
步骤4 在左侧导航树中选择“PKI管理
>
CA管理”，找到即将过期的CA，单击右侧“去激活
CA”。
步骤5 查看告警是否清除。
●
是，处理完毕。
●
否，请联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1.3.26.2 ALM-800002 CA
已过期
告警解释
当CA已过期时产生该告警，检测周期为1天。
1

## Page 978

告警属性
告警ID 告警级别 告警类型
800002
紧急 时间域告警
告警参数
类
别
参数名称 参数含义
定
位
信
息
服务名称 CA服务。
CA名称 CA名称。
颁发者 CA的颁发者。
使用者 CA的使用者。
有效期至 CA的过期时间。
对系统的影响
CA过期后将不能签发证书，不能发布CRL。
可能原因
CA已过期。
处理步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。
步骤2 单击“CA已过期”，查看“定位信息”中该CA的名称。
步骤3 在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
步骤4 在左侧导航树中选择“PKI管理
>
CA管理”，找到已过期的CA，单击右侧“去激活
CA”。
步骤5 查看告警是否清除。
●
是，处理完毕。
●
否，请联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 979

1.3.26.3 ALM-800003 CA
服务所支持签发的证书个数即将达到上限
告警解释
当CA服务已签发的证书个数超过CA服务所支持签发的证书个数的95%时，产生该告
警。当CA服务清除了过期证书后，如果所占比例不大于95%时，该告警将自动清除，
检测周期为1天。
告警属性
告警ID 告警级别 告警类型
800003
重要 业务质量告警
告警参数
类
别
参数名称 参数含义
定
位
信
息
服务名称 CA服务。
模块 证书管理模块。
附
加
信
息
比例 已签发的证书个数占最大支持数量的百分比。
对系统的影响
如果证书个数达到上限，将会影响证书申请或证书更新。
可能原因
CA服务所支持签发的证书个数即将达到上限。
处理步骤
请联系华为技术支持工程师。
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 980

1.3.26.4 ALM-800004 CA
服务所支持签发的证书个数已达上限
告警解释
当CA服务已签发的证书个数达到CA服务所支持签发的证书个数的上限时，产生该告
警。当CA服务清除了过期证书后，如果已签发的证书个数小于所支持的上限时，该告
警将自动清除，检测周期为1天。
告警属性
告警ID 告警级别 告警类型
800004
紧急 业务质量告警
告警参数
类
别
参数名称 参数含义
定
位
信
息
服务名称 CA服务。
模块 证书管理模块。
对系统的影响
如果证书个数达到上限，将会影响证书申请或证书更新。
可能原因
CA服务所支持签发的证书个数已达上限。
处理步骤
请联系华为技术支持工程师。
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1.3.26.5 ALM-800005 CRL
发布失败
告警解释
当CA的CRL生成失败或者发布失败时，产生该告警，当CA的CRL发布成功时，该告警
将自动清除。
1

## Page 981

告警属性
告警ID 告警级别 告警类型
800005
紧急 业务质量告警
告警参数
类
别
参数名称 参数含义
定
位
信
息
服务名称 CA服务。
CA名称 CA名称。
附
加
信
息
失败原因 CRL生成失败或发布失败。
对系统的影响
如果CRL发布失败，使用该CA签发证书的设备将无法获取最新的吊销列表。
可能原因
CRL生成失败或发布失败。
处理步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。
步骤2 单击“CRL发布失败”，查看失败原因是否为CRL生成失败。
●
是，执行步骤10。
●
否，执行步骤3。
步骤3 查看“定位信息”中CA的名称。
步骤4 在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
步骤5 在左侧导航树中选择“PKI管理
>
CA管理”，找到对应CA，查看该CA对应的CRL发布
服务器。
步骤6 在左侧导航树中选择“PKI管理
>
CRL管理”。
步骤7 选择“CRL发布服务器”页签，找到对应的CRL发布服务器。检查该CRL发布服务器的
服务器地址、端口号、登录名、密码、发布目录和信任证书的配置是否正确。
●
正确，执行步骤9。
●
不正确，执行步骤8。
1

## Page 982

说明
如果存在信任证书，检查证书是否在有效期内，或者上传的信任证书是否正确。
步骤8 将CRL发布服务器的配置修改正确，选择CRL列表，选择对应的CA，执行发布操作，查
看是否发布成功。
●
发布成功，告警将自动清除。
●
发布失败，执行步骤9。
步骤9 进行连通性检查。
1.
使用PuTTY工具以ossuser用户通过SSH方式登录CA服务中的litecasignservice进
程所在节点。获取节点IP地址的方法请参见《管理员指南》中“如何查找服务所
在节点的IP地址”章节。
2.
查看CRL发布服务器的服务器地址是否可以ping通。
–
如果服务器地址为IPv4格式，执行以下命令：
ping
服务器地址
–
如果服务器地址为IPv6格式，执行以下命令：
ping6
服务器地址
3.
查看回显信息。
–
命令执行后回显如下类似信息，表示网络连接正常，请按“Ctrl+C”终止
ping命令。
64 bytes from
服务器地址
–
命令执行后超过1分钟无返回信息，表示网络连接异常，请按“Ctrl+C”终止
ping命令，并排除网络故障后重试。
4.
如果网络连接正常，选择CRL列表，选择对应的CA，执行发布操作，查看是否发
布成功。
–
如果发布成功，告警将自动清除，告警处理结束。
– 如果发布失败，执行步骤10。
步骤10 请联系华为技术支持工程师。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1.3.26.6 ALM-800006 CA
服务的证书即将过期
告警解释
当CA服务中使用的证书的有效时间小于30天时，产生该告警，当证书被更新或者删除
时，该告警将自动清除，检测周期为1天。
告警属性
告警ID 告警级别 告警类型
800006
重要 时间域告警
1

## Page 983

告警参数
类
别
参数名称 参数含义
定
位
信
息
服务名称 CA服务。
证书类型 请求验证证书、响应保护证书、TLS证书、CRL发布服务
器证书或EK信任证书。
名称 请求验证证书、响应保护证书、CRL发布服务器证书或EK
信任证书的名称。
序列号 TLS证书的序列号。
颁发者 请求验证证书、响应保护证书、TLS证书、CRL发布服务
器证书或EK信任证书的颁发者。
使用者 请求验证证书、响应保护证书、TLS证书、CRL发布服务
器证书或EK信任证书的使用者。
有效期至 请求验证证书、响应保护证书、TLS证书、CRL发布服务
器证书或EK信任证书过期时间。
对系统的影响
●
请求验证证书及响应保护证书过期将会影响通过CMP协议进行证书申请、证书更
新、证书吊销及CRL的获取。
●
TLS证书过期影响TLS连接，进而影响通过CMP协议进行证书申请及CRL的发布。
●
CRL发布服务器证书过期将会导致TLS无法成功连接，进而影响CRL的发布。
●
EK信任证书过期将会导致无法通过隐私CA协议申请证书。
可能原因
●
请求验证证书即将过期。
● 响应保护证书即将过期。
●
TLS证书（身份证书、信任证书）即将过期。
●
CRL发布服务器证书即将过期。
● EK信任证书即将过期。
处理步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。
步骤2 单击“CA服务的证书即将过期”，查看“定位信息”中该证书的参数值，修改或删除
即将过期的证书。删除证书可能会导致证书校验失败，请尽快申请新证书。
●
如果是请求验证证书即将过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
1

## Page 984

b.
在左侧导航树中选择“协议配置
>
CMP配置”。
c.
在“请求验证配置”页签中查找相应的请求验证，修改或者删除该请求验
证，告警可自动清除。
●
如果是响应保护证书即将过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
b.
在左侧导航树中选择“协议配置
>
CMP配置”。
c.
在“响应保护配置”页签中查找相应的响应保护，修改或者删除该响应保
护，告警可自动清除。
●
如果是TLS信任证书即将过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
b.
在左侧导航树中选择“全局配置
>
TLS配置”。
c.
在“TLS配置”页面中删除TLS信任证书，告警可自动清除。
●
如果是TLS身份证书即将过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
b.
在左侧导航树中选择“全局配置
>
TLS配置”。
c. 在“TLS配置”页面中更新或删除TLS身份证书，告警可自动清除。
●
如果是CRL发布服务器证书即将过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
b.
在左侧导航树中选择“PKI管理
>
CRL管理”。
c.
在“CRL发布服务器”页签中查找相应的CRL发布服务器，删除该CRL发布服
务器，或者更新该CRL发布服务器的证书，告警可自动清除。
●
如果是EK信任证书即将过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
b.
在左侧导航树中选择“协议配置
>
隐私CA协议配置”。
c.
在“EK信任证书配置”页面中删除EK信任证书，告警可自动清除。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1.3.26.7 ALM-800007 CA
服务的证书已过期
告警解释
当CA服务中使用的证书已过期时，产生该告警，当证书被更新或者删除时，该告警将
自动清除，检测周期为1天。
告警属性
告警ID 告警级别 告警类型
800007
紧急 时间域告警
1

## Page 985

告警参数
类
别
参数名称 参数含义
定
位
信
息
服务名称 CA服务。
证书类型 请求验证证书、响应保护证书、TLS证书、CRL发布服务
器证书或EK信任证书。
名称 请求验证证书、响应保护证书、CRL发布服务器证书或EK
信任证书的名称。
序列号 TLS证书的序列号。
颁发者 请求验证证书、响应保护证书、TLS证书、CRL发布服务
器证书或EK信任证书的颁发者。
使用者 请求验证证书、响应保护证书、TLS证书、CRL发布服务
器证书或EK信任证书的使用者。
有效期至 请求验证证书、响应保护证书、TLS证书、CRL发布服务
器证书或EK信任证书过期时间。
对系统的影响
●
请求验证证书及响应保护证书过期将会影响通过CMP协议进行证书申请、证书更
新、证书吊销及CRL的获取。
●
TLS证书过期影响TLS连接，进而影响通过CMP协议进行证书申请及CRL的发布。
●
CRL发布服务器证书过期将会导致TLS无法成功连接，进而影响CRL的发布。
●
EK信任证书过期将会导致无法通过隐私CA协议申请证书。
可能原因
●
请求验证证书已过期。
●
响应保护证书已过期。
●
TLS证书（身份证书、信任证书）已过期。
●
CRL发布服务器证书已过期。
●
EK信任证书已过期。
处理步骤
步骤1 在运维面主菜单中选择“业务监控
>
告警监控
>
当前告警”。
步骤2 单击“CA服务的证书已过期”，查看“定位信息”中该证书的参数值，修改或删除即
已过期的证书。删除证书可能会导致证书校验失败，请尽快申请新证书。
●
如果是请求验证证书已过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
b.
在左侧导航树中选择“协议配置
>
CMP配置”。
1

## Page 986

c.
在“请求验证配置”页签中查找相应的请求验证，修改或者删除该请求验
证，告警可自动清除。
●
如果是响应保护证书已过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
b.
在左侧导航树中选择“协议配置
>
CMP配置”。
c.
在“响应保护配置”页签中查找相应的响应保护，修改或者删除该响应保
护，告警可自动清除。
●
如果是TLS信任证书已过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
b.
在左侧导航树中选择“全局配置
>
TLS配置”。
c.
在“TLS配置”页面中删除TLS信任证书，告警可自动清除。
●
如果是TLS身份证书已过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
b.
在左侧导航树中选择“全局配置
>
TLS配置”。
c.
在“TLS配置”页面中更新或删除TLS身份证书，告警可自动清除。
●
如果是CRL发布服务器证书已过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
b.
在左侧导航树中选择“PKI管理
>
CRL管理”。
c.
在“CRL发布服务器”页签中查找相应的CRL发布服务器，删除该CRL发布服
务器，或者更新该CRL发布服务器的证书，告警可自动清除。
●
如果是EK信任证书已过期。
a.
在运维面主菜单中选择“系统
>
系统设置
>
CA服务”。
b.
在左侧导航树中选择“协议配置
>
隐私CA协议配置”。
c.
在“EK信任证书配置”页面中删除EK信任证书，告警可自动清除。
----结束
告警清除
ADAC：此告警修复后，系统会自动清除此告警，无需手工清除。
1.3.27 SNMP
告警接口
1.3.27.1 ALM-100006
认证失败次数达到最大限制
告警解释
第三方系统与CloudSOP北向接口对接后，CloudSOP会对第三方系统进行认证，缺省
在60分钟内对第三方系统认证连续失败3次，第三方系统IP地址将被锁定，同时产生该
告警。
1

## Page 987

说明
连续认证失败次数及第三方系统IP地址锁定时长可在“安全配置”中配置：
1. 在运维面主菜单中选择“系统 > 系统设置 > 北向接口”。
2.
在左侧导航树中选择“SNMP接口
>
安全配置”。
告警属性
告警ID 告警级别 告警类型
100006
紧急 安全告警
告警参数
类别 参数名称 参数含义
定位信息 IP地址 第三方系统的IP地址。
附加信息 连续登录失
败次数
设定时间段内对第三方系统认证连续失败次数达到最
大值产生该告警。
例如：参数“连续登录失败时间段长度”为60分钟，
“连续登录失败次数”为3，表示60分钟内连续认证
失败3次产生该告警。
对系统的影响
第三方系统与CloudSOP北向接口对接失败，CloudSOP采集到的告警信息无法上报给
第三方系统。
可能原因
第三方系统配置的CloudSOP认证信息错误。
处理步骤
在第三方系统中重新配置CloudSOP的认证信息。
告警清除
ADAC：产生该告警后，第三方系统IP地址被锁定，“安全配置”界面中配置的锁定时
长过后会自动解锁。解锁后系统会自动清除此告警，无需手工清除。
参考信息
无。
1.3.28 eSgiht
告警
如果是eSight V300R010C00SPC600及其补丁版本，请参考《eSight
V300R010C00SPC600
告警清单 (华为)》。
1

## Page 988

如果是eSight 21.0.0及其补丁版本，请参考《eSight
21.0.0
告警清单 (华为)》
说明
如果要查询eSight版本号，详情请参见《华为云Stack
8.1.0
运维指南》中的“查询eSight版本
号”章节。
1.4
公共组件告警
1.4.1 APIGateway
1.4.1.1
通信告警
1.4.1.1.1
ALM-48101-无法访问
shubao
告警解释
nginx无法访问shubao。
告警属性
告警ID 告警级别 告警类型
48101
紧急 通信告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
故障组件 故障组件名称
告警故障节点IP 故障节点IP地址
告警源组件 告警源组件
告警源节点IP 告警源节点
附加信息 告警原因 告警原因
对系统的影响
业务处理能力下降，业务面LB可以调用的shubao减少。
可能原因
shubao服务异常。
1

## Page 989

处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息。
–
告警源节点IP：表示告警源节点IP地址。
–
告警故障节点IP：表示故障节点IP地址。
说明
如果未能找到节点信息，返回告警列表，单击告警左侧的“>”展开详细信息，在“被汇聚
告警”页签中可找到告警的定位信息。
步骤2 使用PuTTY，登录故障节点告警故障节点IP。
默认帐号：paas，默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤3 执行以下命令，先切换到root用户，再切换到apigateway用户。
sudo su - root
默认密码：从对应版本《华为云Stack 帐户一览表》获取。
su - apigateway
步骤4 执行以下命令，防止会话超时退出。
TMOUT=0
步骤5 执行以下命令，ping告警源节点IP地址，查看网络通讯是否正常。
ping 告警源节点IP
●
正常，执行步骤6。
●
异常，请联系网络工程师修复网络通讯后，再执行步骤6。
步骤6 执行以下命令，检查shubao状态是否正常。
sh /opt/apigateway/resty/shell/health_check.sh
●
normal，执行步骤8。
● abnormal，执行步骤7。
步骤7 执行以下命令，重启shubao组件。该重启操作对系统本身无不良影响。
sh /opt/apigateway/resty/shell/restart.sh
显示“xxx
start
successfully”，表示组件启动成功。
步骤8 等待1~3分钟，查看告警是否清除。
1

## Page 990

●
是，任务结束。
●
否，执行步骤9。
步骤9 获取相关日志，并联系技术支持。
1.
执行如下命令，切到root用户。
exit
2.
执行如下命令，切换到日志目录。
cd /var/log/apigateway/shubao/runtime
3.
下载该目录中的所有日志到本地，并联系技术支持。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.1.1.2
ALM-48102-无法访问etcd
告警解释
API网关的组件无法访问etcd。
告警属性
告警ID 告警级别 告警类型
48102
次要 通信告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
故障组件 故障组件名称
告警故障节点IP 故障节点IP地址
告警源组件 告警源组件
告警源节点IP 告警源节点IP地址
附加信息 告警原因 告警原因
1

## Page 991

对系统的影响
API网关的组件不能访问etcd，将无法及时获取和更新组件的配置信息，影响该组件功
能的正常使用。
可能原因
etcd集群出现故障，无法访问。
处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，查看是否存在1.4.1.2.2 ALM-48305-证书已经过期或者1.4.1.2.3
ALM-48306-证书校验失败告警。
–
存在，参考1.4.1.2.2 ALM-48305-证书已经过期或者1.4.1.2.3
ALM-48306-
证书校验失败进行处理。
–
不存在，执行步骤1.4。
4.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
5.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息，即故
障节点IP地址告警故障节点IP。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 使用PuTTY，登录故障节点告警故障节点IP。
默认帐号：paas，默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤3 执行以下命令切换到root用户。
sudo su - root
默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤4 执行以下命令，尝试修复etcd告警。
sh /usr/bin/apigateway/common/tools/alarm/etcd_alarm_handle.sh
●
界面提示“success”，执行 步骤5。
●
界面提示“failure”，执行步骤6。
步骤5 等待1~3分钟，查看告警是否清除。
●
是，任务结束。
●
否，执行 步骤6。
1

## Page 992

步骤6 获取相关日志，并联系技术支持。
1.
执行如下命令，切换到日志目录。
cd /var/log/apigateway/etcd/runtime/
2.
下载日志 "etcd-12379.log"到本地，并联系技术支持。
----结束
须知
如果是异常断电场景，可能会导致文件系统变为只读，从而出现etcd无法访问告警。
排查：执行步骤4时屏幕会出现“Read-only
file
system”
解决：依次重启所有文件系统只读的虚拟机
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.1.1.3
ALM-48110-无法访问DB
告警解释
API网关GaussDB服务出现异常，apimgr无法访问GaussDB。
告警属性
告警ID 告警级别 告警类型
48110
重要 通信告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
故障组件 故障组件名称
告警故障节点IP 故障节点IP地址
告警源组件 告警源组件
告警源节点IP 告警源节点IP地址
附加信息 告警原因 告警原因
1

## Page 993

对系统的影响
网关管理面告警功能无法使用。
可能原因
●
keepalived服务出现异常。
●
数据库浮动IP地址丢失。
●
GaussDB服务出现故障或GaussDB主备服务都停用。
处理步骤
步骤1 在该环境的参数信息汇总文件《xxx_export_all_v2_CN.xlsm》中的“2.1 工具生成的IP
参数”页签，查找APIGWZK01节点对应的IP地址，使用PuTTY登录该节点。
说明
登录HUAWEI
CLOUD Stack Deploy
Web界面，在“工程管理”页面单击对应的工程名称。选
择“配置工程参数”，单击“参数汇总导出”可获取参数信息汇总文件
《xxx_export_all_v2_CN.xlsm》。
默认帐号：paas，默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤2 执行以下命令，切换到root用户。
sudo su - root
默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤3 执行以下命令，尝试修复DB告警。
sh /usr/bin/apigateway/common/tools/alarm/gaussdb_alarm_handle.sh
●
界面提示“success”，执行步骤4。
●
界面提示“failure”，执行步骤5。
步骤4 等待1~3分钟，查看告警是否清除。
●
是，任务结束。
●
否，GaussDB故障，执行步骤5。
步骤5 查看数据库节点状态，并联系技术支持。
1.
使用PuTTY登录PUB-DB01节点的IP地址。
用户名：fsp。默认密码：从对应版本《华为云Stack 帐户一览表》获取。
2.
执行如下命令，切换至root用户。
sudo su
默认密码：从对应版本《华为云Stack 帐户一览表》获取。
3.
执行如下命令，查看数据库状态。
service had query
回显信息类似如下：
[root@PUB-DB01 fsp]# service had query
NODE ROLE PHASE RESS VER START
PUB-DB01(PUB-DB01) active Actived normal V100R001C01 2019-07-28
17:27:03
PUB-DB02(PUB-DB02) standby Deactived normal V100R001C01 2019-07-28
1

## Page 994

17:27:13
--------------------------------------------------------------------------------------------------------
ID RES STAT RET TYPE
PUB-DB01(PUB-DB01): 1 exfloatip Normal Normal Single_active
2 gaussDB Normal Active_normal Active_standby
PUB-DB02(PUB-DB02): 1 exfloatip Normal Abnormal Single_active
2 gaussDB Normal Standby_normal Active_standby
4.
将数据库状态信息截图保存，并联系技术支持。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.1.1.4
ALM-48111-无法访问
apimgr
告警解释
API网关apimgr服务出现异常，无法访问。
告警属性
告警ID 告警级别 告警类型
48111
紧急 通信告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
故障组件 故障组件名称
告警故障节点IP 故障节点IP地址
告警源组件 告警源组件
告警源节点IP 告警源节点IP地址
附加信息 告警原因 告警原因
对系统的影响
API网关Portal中的API生命周期管理的功能无法使用。
1

## Page 995

可能原因
apimgr服务出现异常，无法正常使用，无法通过管理面LB访问apimgr。
处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息。
–
告警源节点IP：表示告警源节点IP地址。
–
告警故障节点IP：表示故障节点IP地址。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 使用PuTTY，登录故障节点 告警故障节点IP。
默认帐号：paas，默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤3 执行以下命令，先切换到root用户，再切换到apigw_apimgr用户。
sudo su - root
默认密码：从对应版本《华为云Stack 帐户一览表》获取。
su - apigw_apimgr
步骤4 执行以下命令，防止会话超时退出。
TMOUT=0
步骤5 执行以下命令，ping告警源节点IP地址，查看网络通讯是否正常。
ping
告警源节点IP
●
正常，执行步骤6。
●
异常，请联系网络工程师修复网络通讯后，再执行步骤6。
步骤6 执行以下命令，检查apimgr状态是否正常。
sh /opt/apigateway/apimgr/shell/health_check.sh
●
normal，执行步骤8。
●
abnormal，执行步骤7。
步骤7 执行以下命令，重启apimgr组件。该重启操作对系统本身无不良影响。
sh /opt/apigateway/apimgr/shell/restart.sh
1

## Page 996

显示“xxx
start
successfully”，表示组件启动成功。
步骤8 查看告警是否清除。
●
是，任务结束。
●
否，执行步骤9。
步骤9 获取相关日志，并联系技术支持。
1.
执行如下命令，并切到root用户。
exit
2.
执行如下命令，切换到日志目录。
cd /var/log/apigateway/apimgr/runtime
3.
下载该目录中的所有日志到本地，并联系技术支持。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.1.1.5
ALM-48117-无法正常接收Opsagent 心跳
告警解释
API网关主节点的alarmserver和某个节点的opsagent心跳检测出现异常。
告警属性
告警ID 告警级别 告警类型
48117
紧急 通信告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
故障组件 故障组件名称
告警故障节点IP 故障节点IP地址
告警源组件 告警源组件
告警源节点IP 告警源节点IP地址
附加信息 告警原因 告警原因
1

## Page 997

对系统的影响
opsagent和alarmserver的心跳检测功能异常，影响opsagent心跳故障节点的告警信息
与告警清除信息的上报。
可能原因
opsagent服务出现异常或者停用，alarmserver无法检测opsagent心跳。
处理步骤
步骤1 查看告警的定位信息。
1. 以admin帐号登录ManageOne运维面。
– 登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，查看是否存在1.4.1.2.2 ALM-48305-证书已经过期或者1.4.1.2.3
ALM-48306-证书校验失败告警。
–
存在，参考1.4.1.2.2 ALM-48305-证书已经过期或者1.4.1.2.3
ALM-48306-
证书校验失败进行处理。
–
不存在，步骤1.4。
4.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
5.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息。
–
告警源节点IP：表示告警源节点IP地址。
–
告警故障节点IP：表示故障节点IP地址。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 使用PuTTY，登录故障节点告警故障节点IP。
默认帐号：paas，默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤3 执行以下命令，先切换到root用户，再切换到apigateway用户。
sudo su - root
默认密码：从对应版本《华为云Stack 帐户一览表》获取。
su - apigateway
步骤4 执行以下命令，防止会话超时退出。
TMOUT=0
步骤5 执行以下命令，ping告警源节点IP地址，查看网络通讯是否正常。
ping
告警源节点IP
1

## Page 998

●
正常，执行步骤6。
●
异常，请联系网络工程师修复网络通讯后，再执行步骤8。
步骤6 执行以下命令，检查opsagent服务状态是否正常。
sh /opt/apigateway/opsagent/shell/health_check.sh
●
normal，执行步骤8。
●
abnormal，执行步骤7。
步骤7 执行以下命令，重启opsagent服务。该重启操作对系统本身无不良影响。
sh /opt/apigateway/opsagent/shell/restart.sh
显示“xxx
start
successfully”，表示服务启动成功。
步骤8 等待3～5分钟，查看告警是否清除。
●
是，任务结束。
●
否，执行步骤9。
步骤9 获取相关日志，并联系技术支持。
1. 执行如下命令，切换到root用户。
exit
2.
执行如下命令，切换到日志目录。
cd /var/log/apigateway/alarmserver/runtime/
3.
下载日志“alarmserver.log”到本地，并联系技术支持。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.1.2
处理错误告警
1.4.1.2.1
ALM-48304-证书即将过期
告警解释
API网关某些组件使用的证书即将在30天内过期。
告警属性
告警ID 告警级别 告警类型
48304
次要 处理错误告警
1

## Page 999

告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
告警源节点IP 告警源节点IP地址
附加信息 证书信息 证书的名称以及到期时间
对系统的影响
证书过期后将存在安全风险，且某些服务证书过期可能拒绝连接，影响这些服务的业
务功能。
可能原因
当前证书的剩余使用天数低于失效前提醒时间30天。
处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
– 登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息。
–
告警源节点IP：表示告警源节点IP地址。
–
证书信息：组件的证书名称和证书到期时间。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 参考对应版本《华为云Stack 运维指南》的“安全管理
>
证书管理
>
更换B类&C类证
书
>
通过ManageOne界面方式单个或批量更换证书”章节，替换APIG证书，以免影
响相关业务的使用。
步骤3 查看告警是否清除。
●
是，任务结束。
●
否，执行步骤4。
步骤4 保存告警相关信息，并联系技术支持。
1.
在告警列表中，勾选当前处理的告警记录，导出并保存告警信息压缩包。
1

## Page 1000

2.
保存上述步骤中创建的API网关证书，并联系技术支持。
----结束
告警清除
系统每24小时检查一次证书信息，此告警修复后，系统会自动清除此告警，无需手工
清除。
参考信息
无。
1.4.1.2.2
ALM-48305-证书已经过期
告警解释
API网关某些组件使用的证书已经过期。
告警属性
告警ID 告警级别 告警类型
48305
重要 处理错误告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
告警源节点IP 告警源节点IP地址
附加信息 证书信息 证书的名称以及到期时间
对系统的影响
API网关某些组件的服务证书过期。证书过期后将存在安全风险，且某些服务发现证书
过期可能拒绝连接，影响服务的业务功能。
可能原因
证书过期。
处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
1

## Page 1001

–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4. 在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息。
–
告警源节点IP：表示告警源节点IP地址。
–
证书信息：组件的证书名称和证书到期时间。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 参考对应版本《华为云Stack 运维指南》的“安全管理
>
证书管理
>
更换B类&C类证
书
>
通过ManageOne界面方式单个或批量更换证书”章节，替换APIG证书，以免影
响相关业务的使用。
步骤3 查看告警是否清除。
●
是，任务结束。
●
否，执行步骤4。
步骤4 保存告警相关信息，并联系技术支持。
1.
在告警列表中，勾选当前处理的告警记录，导出并保存告警信息压缩包。
2.
保存上述步骤中创建的API网关证书，并联系技术支持。
----结束
告警清除
系统每24小时检查一次证书信息，此告警修复后，系统会自动清除此告警，无需手工
清除。
参考信息
无。
1.4.1.2.3
ALM-48306-证书校验失败
告警解释
API网关某些组件使用的证书验证失败。
告警属性
告警ID 告警级别 告警类型
48306 紧急 处理错误告警
1

## Page 1002

告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
告警源节点IP 告警源节点IP地址
附加信息 证书信息 证书的名称以及到期时间
对系统的影响
API网关某些组件的服务验证失败。证书验证失败将存在安全风险，且某些服务发现证
书不可用可能拒绝连接，影响服务的业务功能。
可能原因
证书过期或证书无效。
处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
– 登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息。
–
告警源节点IP：表示告警源节点IP地址。
–
证书信息：组件的证书名称和证书到期时间。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 参考对应版本《华为云Stack 运维指南》的“安全管理
>
证书管理
>
更换B类&C类证
书
>
通过ManageOne界面方式单个或批量更换证书”章节，替换APIG证书，以免影
响相关业务的使用。
步骤3 查看告警是否清除。
●
是，任务结束。
●
否，执行步骤4。
步骤4 保存告警相关信息，并联系技术支持。
1.
在告警列表中，勾选当前处理的告警记录，导出并保存告警信息压缩包。
1

## Page 1003

2.
保存上述步骤中创建的API网关证书，并联系技术支持。
----结束
告警清除
系统每24小时检查一次证书信息，此告警修复后，系统会自动清除此告警，无需手工
清除。
参考信息
无。
1.4.1.2.4
ALM-48316-请求超出单实例流控阈值
告警解释
业务请求量超过单实例的处理能力，系统启动保护机制。
告警属性
告警ID 告警级别 告警类型
48316
重要 处理错误告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
告警源节点IP 告警源节点IP地址
附加信息 节点流控限额 流控阈值
对系统的影响
部分业务调用不能正常执行。
可能原因
●
业务请求量增加，达到流控阈值。
●
外部攻击导致访问量增大，达到流控阈值。
处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
1

## Page 1004

–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息，即告
警源节点IP地址告警源节点IP。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 使用PuTTY，登录故障节点告警源节点IP。
默认帐号：paas，默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤3 执行以下命令，切换到root用户。
sudo su - root
默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤4 执行以下命令，防止会话超时退出。
TMOUT=0
步骤5 执行以下命令，收集业务运行日志并联系技术支持。
cd /var/log/apigateway/shubao
zip -r shubao_log.zip run
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.1.2.5
ALM-48318-证书回退失败
告警解释
ManageOne下发证书替换任务后，网关替换失败且自动回退失败。
告警属性
告警ID 告警级别 告警类型
48318
重要 处理错误告警
1

## Page 1005

告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
告警源组件 回退失败证书所属组件名
称
文件名 回退失败证书名称
告警源节点IP 告警源节点IP地址
对系统的影响
组件证书无法使用，导致无法正常提供服务。
可能原因
ManageOne下发证书替换任务，节点在替换证书过程中出错，并且证书回退任务执行
失败。
处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息。
–
告警源节点IP：表示告警源节点IP地址。
–
告警源组件：表示组件名称。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 使用PuTTY，登录告警源节点告警源节点IP。
默认帐号： paas，默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤3 执行以下命令，切换到root用户。
sudo su - root
1

## Page 1006

默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤4 执行以下命令，防止会话超时退出。
TMOUT=0
步骤5 进入到证书目录。检查是否有该证书文件、私钥文件、及对应以“.bak”结尾的备份
文件。
参考对应版本《华为云Stack 帐户一览表》中的“FusionSphere Service”页签，查看
API网关证书文件路径。
●
是，执行步骤6。
●
否，执行步骤10。
步骤6 执行cp
xxx.bak
xxx（xxx表示证书或者私钥文件带扩展名的名称，例如server.crt，
server.key.encrypt等）命令，将“.bak”结尾的备份文件覆盖当前路径下的证书和私
钥文件。
步骤7 执行以下命令，切换到相应组件运行用户。
su -
用户名
除apimgr组件使用apigw_apimgr用户外，其他组件使用apigateway用户。
步骤8 执行以下命令，重启组件。该重启操作不会对系统造成不良影响。
sh
/opt/apigateway/告警源组件/shell/restart.sh
显示xxx
start
successfully，表示服务启动成功。
步骤9 执行以下命令，检查组件运行状态。
sh
/opt/apigateway/告警源组件/shell/health_check.sh
●
normal，手动清除该告警。
● abnormal
，执行步骤10。
步骤10 获取告警源组件组件相关日志，并联系技术支持。
1.
执行如下命令，切换到root用户。
exit
2.
执行如下命令，切换到日志目录。
cd
/var/log/apigateway/告警源组件/runtime
3.
下载日志“告警源组件.log”到本地，并联系技术支持。
如果目录下不存在“告警源组件.log”，下载“Component_shell.log”即可。
----结束
告警清除
手动清除。
参考信息
无。
1

## Page 1007

1.4.1.2.6
ALM-48319-证书无法生效
告警解释
ManageOne下发证书替换任务后，ManageOne下发的证书无法正常使用，导致证书
替换失败。
告警属性
告警ID 告警级别 告警类型
48319
重要 处理错误告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
告警源组件 未生效证书所属组件名称
文件名 未生效证书名称
告警源节点IP 告警源节点IP地址
对系统的影响
组件证书无法使用，组件无法正常提供服务。
可能原因
ManageOne下发证书替换任务，可能由于系统时间未到达证书生效时间、已超过证书
失效时间、证书格式错误等原因导致。
处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息。
–
告警源节点IP：表示告警源节点IP地址。
1

## Page 1008

–
告警源组件：表示组件名称。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 使用PuTTY，登录告警源节点告警源节点IP。
默认帐号： paas，默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤3 执行以下命令，切换到root用户。
su - root
默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤4 执行以下命令，防止会话超时退出。
TMOUT=0
步骤5 执行以下命令，切换到相应组件运行用户。
su -
用户
除apimgr组件使用apigw_apimgr用户外，其他组件使用apigateway用户。
步骤6 以相应组件用户，执行以下命令，检查组件运行状态。
sh
/opt/apigateway/告警源组件/shell/health_check.sh
●
正常，执行步骤7。
●
异常，执行步骤12。
步骤7 执行date命令，检查APIG节点系统时间是否准确。
●
正常，执行步骤10。
●
异常，执行步骤8。
步骤8 执行如下命令，检查NTP服务并修正系统时间。
1.
执行exit命令，退出当前用户。
2.
执行如下命令，查找NTP服务器的地址(NTP
Server
IP)。
cat /etc/ntp.conf | grep "^server"
3.
执行如下命令，修正系统时间。
ntpdate -u NTP Server IP
步骤9 手动清除告警。
步骤10 参考对应版本《华为云Stack 运维指南》的“安全管理
>
证书管理
>
更换B类&C类证
书
>
通过ManageOne界面方式单个或批量更换证书”章节，查看CA参数和证书规
格，并替换证书。
步骤11 查看告警是否清除。
●
是，任务结束。
●
否，执行步骤12。
步骤12 获取告警源组件组件相关日志，并联系技术支持。
1.
执行如下命令，切换到root用户。
1

## Page 1009

exit
2.
执行如下命令，切换到日志目录。
cd
/var/log/apigateway/告警源组件/runtime
3.
下载日志“告警源组件.log”到本地，并联系技术支持。
如果目录下不存在“告警源组件.log”，下载“Component_shell.log”即可。
----结束
告警清除
手动清除。
参考信息
无。
1.4.1.2.7
ALM-48320-证书即将过期
告警解释
API网关某些组件使用的证书即将在10天内过期。
告警属性
告警ID 告警级别 告警类型
48320
重要 处理错误告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
告警源节点IP 告警源节点IP地址
附加信息 证书信息 证书的名称以及到期时间
对系统的影响
证书过期后将存在安全风险，且某些服务证书过期可能拒绝连接，影响这些服务的业
务功能。
可能原因
当前证书的剩余使用天数少于10天。
1

## Page 1010

处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息。
–
告警源节点IP：表示告警源节点IP地址。
–
证书信息：组件的证书名称和证书到期时间。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 参考对应版本《华为云Stack 运维指南》的“安全管理
>
证书管理
>
更换B类&C类证
书
>
通过ManageOne界面方式单个或批量更换证书”章节，替换APIG证书，以免影
响相关业务的使用。
步骤3 查看告警是否清除。
●
是，任务结束。
●
否，步骤4。
步骤4 保存告警相关信息，并联系技术支持。
1.
在告警列表中，勾选当前处理的告警记录，导出并保存告警信息压缩包。
2.
保存上述步骤中创建的API网关证书，并联系技术支持。
----结束
告警清除
系统每24小时检查一次证书信息，此告警修复后，系统会自动清除此告警，无需手工
清除。
参考信息
无。
1.4.1.2.8
ALM-48321-证书已经被吊销
告警解释
API网关某些组件使用的证书已经被吊销。
1

## Page 1011

告警属性
告警ID 告警级别 告警类型
48321
紧急 处理错误告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
告警源节点IP 告警源节点IP地址
文件名 被吊销的证书路径
附加信息 告警原因 告警原因及被吊销的证书
名称
对系统的影响
当运维人员在ManageOne运维面吊销了某些证书，触发该告警。该告警不影响业务运
行，但需要及时替换证书以确保系统安全。
可能原因
运维人员在ManageOne运维面吊销了证书。
处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3. 在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息。
附加信息：告警原因中给出了被吊销的证书名称。
步骤2 参考对应版本《华为云Stack 运维指南》的“安全管理
>
证书管理
>
更换B类&C类证
书
>
通过ManageOne界面方式单个或批量更换证书”章节，根据被吊销的证书名
称，替换APIGateway部件的证书。
步骤3 查看告警是否清除。
●
是，任务结束。
1

## Page 1012

●
否，执行4。
步骤4 保存告警相关信息，并联系技术支持。
1.
在告警列表中，勾选当前处理的告警记录，导出并保存告警信息压缩包。
2.
联系技术支持。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.1.3
设备告警
1.4.1.3.1
ALM-48401-进程未启动
告警解释
API网关的某些组件进程没有启动。
告警属性
告警ID 告警级别 告警类型
48401
紧急 设备告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
告警源组件 故障组件名称
告警源节点IP 故障节点IP地址
附加信息 告警原因 告警原因
对系统的影响
上报告警的组件进程异常，会对连接该组件的相关业务产生影响。
可能原因
组件进程不存在。
1

## Page 1013

处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，查看待处理的告警记录，并记录告警流水号。
4.
单击告警前的“>”展开详细信息，选择“告警帮助”页签，并单击“告警帮助辅
助处理工具”对应的链接。
系统将自动跳转到“自动作业 > 编排管理 > 执行编排”界面。
步骤2 在“执行编排”界面，确认当前告警的流水号CSN后，单击“执行”。
步骤3 在弹出的提示框中，勾选确认信息，并单击“确认”。
系统自动跳转到“作业历史”页面。
步骤4 在“作业历史”列表汇总，查看编排脚本执行状态。该过程大约需要1~2分钟。
●
执行成功，执行步骤5。
●
执行失败，执行7.2。
步骤5 单击执行结果的“报告”，查看告警处理结果。
●
告警处理成功，执行步骤6。
● 告警处理失败，执行步骤7。
步骤6 等待1~3分钟，查看告警是否清除。
●
是，任务结束。
●
否，执行步骤7。
步骤7 获取相关日志，并联系技术支持。
1.
在“自动作业
>
作业历史”页面，单击结果列表中的“下载结果”。
2.
联系技术支持。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.1.3.2
ALM-48402-端口冲突
告警解释
API网关某些组件启动的时候端口已经被占用。
1

## Page 1014

告警属性
告警ID 告警级别 告警类型
48402
紧急 设备告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
告警源组件 告警源组件
告警源节点IP 告警源节点IP地址
附加信息 端口 端口
对系统的影响
上报告警的组件端口冲突，无法正常启动，会对该组件相关的业务产生影响。
可能原因
该组件启动需要监听的端口被占用。
处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警信息。
–
告警源节点IP：表示故障节点IP地址。
–
告警源组件：表示故障组件名称。
–
端口：表示端口号。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 使用PuTTY，登录告警源节点告警源节点IP。
默认帐号： paas，默认密码：从对应版本《华为云Stack 帐户一览表》获取。
1

## Page 1015

步骤3 执行以下命令，切换到root用户。
sudo su - root
默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤4 执行以下命令，防止会话超时退出。
TMOUT=0
步骤5 执行以下命令，查看占用的端口进程号。
netstat -tlnp | grep
端口
步骤6 执行以下命令，查看该进程号对应的进程信息。
ps -ef | grep
进程号
步骤7 判断进程信息中是否包含对应的组件名称告警源组件。
●
是，执行步骤11。
●
否，执行命令结束非法进程：kill 进程号，再执行步骤8。
步骤8 执行以下命令，切换到组件对应的用户，如表1-67所示。
su - 用户名
表1-67 组件与用户的对应关系
组件 用户名 命令
gaussdb apigw_db su - apigw_db
adminportal apigw_portal su - apigw_portal
apigmgr apigw_apimgr su - apigw_apimgr
cassandra apigw_scdb su - apigw_scdb
其他组件（除gaussdb、
adminportal、apigmgr、
cassandra以外的组件）
apigateway su - apigateway
步骤9 执行以下命令，重启组件。该重启操作对系统本身无不良影响。
sh
/opt/apigateway/告警源组件/shell/restart.sh
显示xxx
start
successfully，表示服务启动成功。
步骤10 查看告警是否清除。
●
是，任务结束。
●
否，执行步骤11。
步骤11 获取相关日志，并联系技术支持。
1. 执行如下命令，切换到root用户。
exit
2.
执行如下命令，切换到日志目录。
1

## Page 1016

cd
/var/log/apigateway/告警源组件/runtime
3.
下载日志“Component_shell.log”到本地，并联系技术支持。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.1.3.3
ALM-48409-文件句柄使用率超过门限值
告警解释
当API网关节点的文件句柄使用率过高（超过80%），系统产生此告警。
告警属性
告警ID 告警级别 告警类型
48409
次要 设备告警
告警参数
分类 参数名称 参数说明
定位信息 云服务 云服务名称
告警源节点IP 故障节点IP地址
用户名称 用户名
附加信息 告警原因 告警原因
对系统的影响
文件句柄使用率超过门限值，系统可能会无法创建进程，影响业务性能。
可能原因
网关部署所在的服务器文件句柄使用率达到设置的门限值。
处理步骤
步骤1 查看告警的定位信息。
1.
以admin帐号登录ManageOne运维面。
1

## Page 1017

–
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，
https://oc.type.com:31943。
–
默认帐号密码从对应版本《华为云Stack 帐户一览表》的“A类（Portal）”
页签中获取。
2.
在页面上方的菜单栏中，选择“集中监控
>
告警管理
>
当前告警”。
3.
在告警列表中，找到待处理的告警记录。单击告警对应的“名称”列，弹出“告
警详情和处理建议”窗口。
4.
在“告警详情和处理建议”窗口的“基本信息”中，查看告警的定位信息。
–
告警源节点IP：表示告警源节点IP地址。
–
用户名称：表示产生告警的用户名。
说明
如果未能找到节点信息，返回告警列表，单击告警前的“>”展开详细信息，在“被汇聚告
警”页签中可找到告警的定位信息。
步骤2 使用PuTTY，登录告警源节点告警源节点IP。
默认帐号： paas，默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤3 执行以下命令，切换到root用户。
sudo su - root
默认密码：从对应版本《华为云Stack 帐户一览表》获取。
步骤4 执行以下命令，防止会话超时退出。
TMOUT=0
步骤5 执行以下命令，切换到组件对应的用户，如表1-68所示。
su -
用户名
表1-68 组件与用户的对应关系
组件 用户名 命令
gaussdb apigw_db su - apigw_db
adminportal apigw_portal su - apigw_portal
apigmgr apigw_apimgr su - apigw_apimgr
cassandra apigw_scdb su - apigw_scdb
其他组件（除gaussdb、
adminportal、apigmgr、
cassandra以外的组件）
apigateway su - apigateway
步骤6 执行以下命令，查看当前系统最大句柄设置数，并判断查询结果是否大于
“2000000”。
ulimit -n
●
是，执行步骤8。
1

## Page 1018

●
否，执行步骤7。
步骤7 执行以下步骤，将系统文件句柄数增加到“2000000”。
1.
执行以下命令，切换到root用户。
exit
2.
执行以下命令，修改配置文件中用户用户名称的文件句柄数为“2000000”。
说明
命令中的用户名称需要替换为实际的用户名。
echo
"用户名称
soft nofile 2000000" >> /etc/security/limits.conf
echo
"用户名称
hard nofile 2000000" >> /etc/security/limits.conf
步骤8 执行以下命令，将系统文件数句柄数增加到“4000000”。
1.
执行以下命令，切换到root用户。
exit
2.
执行以下命令，修改配置文件中用户用户名称的文件句柄数为“4000000”。
说明
命令中的用户名称需要替换为实际的用户名。
echo
"用户名称
soft nofile 4000000" >> /etc/security/limits.conf
echo
"用户名称
hard nofile 4000000" >> /etc/security/limits.conf
步骤9 等待1小时，查看告警是否清除。
●
是，任务结束。
●
否，执行步骤10。
步骤10 获取相关日志，并联系技术支持。
1.
执行如下命令，切换到日志目录。
cd /var/log/apigateway/opsagent
2.
下载日志“opsagent.log”到本地，并联系技术支持。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.2 CCS
1

## Page 1019

1.4.2.1 ALM-1320004 ccs
进程异常
告警解释
自定义监控项，系统每隔5分钟检查一次CCS进程是否正常，否则产生此告警。
告警属性
告警ID 告警级别 可自动清除
1320004
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
产生告警的CCS主进程异常，导致上层云服务（例如ECS、EVS、VPC等服务）无法通
过CCS打标签，影响云服务正常使用，需尽快处理告警。
可能原因
CCS服务主进程异常。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
1

## Page 1020

步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”工具，通过步骤4中获取的主机节点IP地址登录产生告警的节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
sudo su
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤7 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤8 执行以下命令，启动服务进程。
su hccs -c "sh /opt/ccs/ccs-service/bin/start.sh"
步骤9 执行以下命令，调用服务整体状态检查脚本，检查CCS业务是否健康。
curl -i -k https://$IP:8889
参数“$IP”是步骤4中获取的主机节点IP。
回显信息中包含“200 OK”，表示CCS业务健康。
●
如果CCS业务健康，等待5分钟，查看告警是否清除。如仍未清除，请联系技术支
持工程师协助解决。
●
如果CCS业务异常，请直接联系技术支持工程师协助解决。
----结束
参考信息
无。
1.4.2.2 ALM-1320019
证书异常
告警解释
自定义监控项，系统每隔五分钟检查一次CCS所使用的证书是否过期，如果过期则产生
此告警。
1

## Page 1021

告警属性
告警ID 告警级别 可自动清除
1320019
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
证书过期后系统不可用，无法提供服务，需尽快处理异常。
可能原因
●
阈值为1：证书即将过期。
●
阈值为2：证书过期。
●
阈值为3：证书无效或者证书不存在。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
● 密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
1

## Page 1022

步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用PuTTY工具，通过步骤4中获取的主机节点IP地址登录产生告警的节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
sudo su - root
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤7 执行以下命令，防止系统超时退出。
TMOUT=0
步骤8 执行以下命令，进入证书文件所在目录并查看文件。
cd /opt/ccs/ccs-service/resources/keystore
ll
步骤9 执行以下命令，停止CCS服务进程。
su hccs -c "sh /opt/ccs/ccs-service/bin/stop.sh"
步骤10 在/opt/ccs/ccs-service/resources/keystore目录下，执行以下命令，修改原证书。
mv server.keystore server.keystore.bak
步骤11 使用网络传输工具（例如“WinSCP”工具），将新的证书拷贝至当前节点的/opt/ccs/
ccs-service/resources/keystore目录下。证书的名字请保持跟原证书一致。
步骤12 执行以下命令，更新证书文件的属主为hccs。
chown hccs:hccs /opt/ccs/ccs-service/resources/keystore/*
说明
新替换的证书文件必须与查看的已有证书文件放在同一目录下。
步骤13 执行以下命令，重新启动CCS服务。
su hccs -c "sh /opt/ccs/ccs-service/bin/start.sh"
查看日志/var/log/hccs/ccs-service.log文件，查看是否有证书未生效或失效日志信息输
出。
步骤14 在其他CCS服务节点上重复执行步骤5~步骤13。
步骤15 观察告警是否清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
1

## Page 1023

参考信息
无。
1.4.3 CPAS
1.4.3.1 ALM-2000266
节点系统时钟跳变超过一分钟
告警解释
云平台仲裁服务使用的Etcd组件强依赖于时间，当节点系统时钟跳变超过一分钟时，
本节点业务不可用，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
2000266
紧急 否
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期的数据。
阈值条件 产生告警的阈值。
对系统的影响
产生告警的节点业务不可用。
可能原因
手动修改了节点的系统时间。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
1

## Page 1024

●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”，通过步骤4中获取的节点管理IP地址登录告警节点。
默认帐号：arbiter
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 执行如下命令，获取NTP服务器信息。
ntpq -p
回显信息中，“remote”列即为NTP服务器IP。
步骤7 使用“PuTTY”，通过步骤6中获取的NTP节点管理IP地址登录NTP节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤8 执行以下命令，确认本节点与上级时钟源的NTP连通性。
ntpdate -q
时钟源地址
●
显示如下信息，确认本节点与上级时钟源的NTP连通。
[root@TDNS-TNTP02 fsp]# ntpdate -q 172.16.0.0
server 172.16.0.0, stratum 11, offset -0.000138, delay 0.02583
25 Jan 10:34:02 ntpdate[4956]: adjust time server 172.16.0.0 offset -0.000138 sec
●
否则，表示无法与上级时钟源的NTP节点连通，请检查网络配置及防火墙后重
试。如仍无法与上级石钟源的NTP节点连通，请联系技术工程师协助解决。
步骤9 使用“PuTTY”，通过步骤4中获取的节点管理IP地址登录告警节点。
默认帐号：arbiter
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤10 执行如下命令，重启NTP进程。
service ntpd restart
步骤11 执行如下命令，同步节点系统时间。
ntpdate
NTP服务器IP
1

## Page 1025

步骤12 执行如下命令，写入硬件时钟。
hwclock -w
步骤13 执行如下命令，重启故障节点。
reboot
步骤14 节点启动后，等待3分钟，查看告警是否自动清除。
●
是，处理完毕。
● 否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.4.3.2 ALM-2001106 Etcd
服务状态异常
告警解释
●
Etcd服务状态异常时，本节点业务不可用，系统产生此告警。
●
此告警提示系统故障或风险，需要处理。
告警属性
告警ID 告警级别 可自动清除
2001106
重要 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期的数据。
阈值条件 产生告警的阈值。
对系统的影响
产生告警的节点业务不可用。
1

## Page 1026

可能原因
●
节点配置的NTP服务器异常，Etcd服务进程无法启动。
●
Etcd配置错误，服务进程无法启动。
●
本节点和其它云平台仲裁服务节点网络中断，导致Etcd服务处于不健康状态。
●
节点异常掉电，Etcd数据库损坏，导致服务进程无法启动。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”，通过步骤4中获取的节点管理IP地址登录告警节点。
默认帐号：arbiter
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 执行如下命令，查看进程状态是否为“active (running)”。
systemctl status arbitration-etcd
根据不同的回显信息，执行相应步骤。
●
回显中包含“active (running)”，执行步骤14。
●
回显中不包含“active (running)”，执行步骤7。
步骤7 执行如下命令，查看NTP服务状态。
ntpq -p
根据不同的回显信息，执行相应步骤。
●
回显包含如下信息：“ntpq:
read: Connection
refused”，表示本节点NTP服务
异常，执行步骤8。
●
回显信息中，“remote”列中NTP服务IP前面没有带“*”时，表示NTP服务状态
异常，执行步骤10。
1

## Page 1027

●
回显信息中，“remote”列中NTP服务IP前面带“*”时，表示NTP服务状态正
常，执行步骤11。
●
其它回显情况，执行步骤8。
步骤8 执行如下命令，重启NTP服务进程。
systemctl restart ntpd
步骤9 等待5分钟，执行如下命令，查看NTP服务状态。
ntpq -p
根据不同的回显信息，执行相应步骤。
●
回显信息中，“remote”列中NTP服务IP前面没有带“*”时，表示NTP服务状态
异常，执行步骤8。
●
回显信息中，“remote”列中NTP服务IP前面带“*”时，表示NTP服务状态正
常，执行步骤11。
●
其它回显情况，执行步骤8。
步骤10 请联系管理员排查本节点与NTP服务器之间的网络是否正常，检查NTP服务器本身是否
正常，连接恢复后，执行步骤8。
步骤11 执行如下命令，重启Etcd服务进程。
systemctl restart arbitration-etcd
步骤12 执行如下命令，查看进程状态是否为“active (running)”。
systemctl status arbitration-etcd
●
回显中包含“active (running)”，执行步骤13。
●
回显中不包含“active (running)”，执行步骤11。
步骤13 等待3分钟，查看告警是否自动清除。
●
是，处理完成。
●
否，执行步骤14。
步骤14 若systemctl
status
arbitration-etcd状态正常，执行以下命令查看health接口。
curl http://127.0.0.1:4001/health
●
回显为{"health":"true"}，则表示接口正常，执行步骤17。
●
回显为其他，则表示接口异常，执行步骤15。
步骤15 执行以下命令，排查网络状态。
python /opt/arbitration-etcd/script/check-etcd.py --etcdips
+仲裁虚拟机的IP
说明
仲裁虚拟机的IP，可在《HUAWEI CLOUD Stack Deploy LLD》表格中获取该IP。
●
回显如下，则表示网络状态正常，执行步骤17。
begin to check etcd cluster health status ...
192.168.42.170: {"health": "true"}
begin to check etcd cluster members ...
192.168.42.170: [{"ip": "192.168.28.195", "id": "73e7360c21a28ca0", "name": "arbitration-etcd0"},
{"ip": "192.168.42.198", "id": "9771513a03c58460", "name": "arbitration-etcd3"}, {"ip":
1

## Page 1028

"192.168.42.167", "id": "a7f46cba81f618fd", "name": "arbitration-etcd1"}, {"ip": "192.168.42.170", "id":
"b0e78dd83d2274bd", "name": "arbitration-etcd2"}, {"ip": "192.168.42.58", "id": "fd3648d689baa04a",
"name": "arbitration-etcd4"}]
check etcd cluster configuration success.
●
若网络不通，请联系网络工程师排查网络。
步骤16 执行以下命令，查看日志，查看etcd选举状态。
grep "starting a new election" /var/log/arbitration-etcd/arbitration-etcd.log
若网络环境、安防设备及存储情况均正常，但etcd大量发起选举，请联系技术支持工
程师。
步骤17 等待3分钟，查看告警是否自动清除。
●
是，处理完成。
●
否，执行步骤6。
步骤18 请联系技术支持工程师处理。
----结束
参考信息
无。
1.4.3.3 ALM-2002101 Monitor
进程异常
告警解释
●
Monitor进程异常时，本节点业务不可用，系统产生此告警。
●
此告警提示系统故障或风险，需要处理。
告警属性
告警ID 告警级别 可自动清除
2002101
重要 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期的数据。
阈值条件 产生告警的阈值。
1

## Page 1029

对系统的影响
产生告警的节点业务不可用。
可能原因
Monitor配置错误，进程无法启动。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”，通过步骤4中获取的节点管理IP地址登录告警节点。
默认帐号：arbiter
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 执行如下命令，重启Monitor进程。
systemctl restart arbitration-monitor
步骤7 执行如下命令，查看进程状态是否为“active (running)”。
systemctl status arbitration-monitor
根据不同的回显信息，执行相应步骤。
●
回显中包含“active (running)”，执行步骤8。
●
回显中不包含“active (running)”，执行步骤9。
步骤8 等待3分钟，查看告警是否自动清除。
●
是，处理完成。
●
否，执行步骤9。
1

## Page 1030

步骤9 收集如下日志文件。
/var/log/arbitration-monitor/arbitration-monitor.log
步骤10 请联系技术支持工程师处理。
----结束
参考信息
无。
1.4.3.4 ALM-2002302 Monitor
与对端站点通信异常
告警解释
Monitor与对端站点配对的节点通信异常，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
2002302
重要 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期的数据。
阈值条件 产生告警的阈值。
对系统的影响
产生告警的节点业务不可用。
可能原因
●
和对端站点网络中断
●
对端站点中存在不可用的云平台仲裁服务节点
1

## Page 1031

处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
● 密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”，通过步骤4中获取的节点管理IP地址登录告警节点。
默认帐号：arbiter
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 执行如下命令，获取与本节点配对的对端站点的节点信息。
python /opt/arbitration-monitor/script/check-monitor.py
回显中与本节点IP以“<->”相连的即为对端站点配对的节点IP。
步骤7 请联系管理员排查本节点与对端站点配对的节点之间的网络是否正常，对端站点配对
的节点是否运行正常，连接恢复后，执行步骤8。
步骤8 等待3分钟，查看告警是否自动清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.4.3.5 ALM-2002501
站点网络状态异常
告警解释
●
站点1与站点2之间网络中断、站点1或者站点2整体失效时，系统产生此告警。
●
此告警提示系统故障或风险，需要处理。
1

## Page 1032

告警属性
告警ID 告警级别 可自动清除
2002501
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期的数据。
阈值条件 产生告警的阈值。
对系统的影响
系统单站点运行，存在可靠性风险。
可能原因
●
站点1与站点2之间网络中断。
●
站点1或站点2整机房下电。
●
站点1或站点2与对端站点以及站点3之间网络全部中断。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
1

## Page 1033

步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”，通过步骤4中获取的节点管理IP地址登录站点1所在虚拟机。
默认帐号：arbiter
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
sudo su
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤7 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤8 执行以下命令查询站点1到站点2的双站点整体网络状态是否正常。
etcdctl -u arbiterClient get /monitor/status/dc001_dc002
步骤9 执行以下命令查询站点2到站点1的私网状态是否正常。
etcdctl -u arbiterClient get /monitor/status/internal/dc002_dc001
步骤10 查看私网状态是否正常。
●
私网状态异常，请执行步骤11。
● 私网状态正常，请执行步骤12。
步骤11 执行以下命令，重启monitor。
systemctl restart arbitration-monitor
●
重启成功，请重新执行步骤8。
●
重启失败，请联系技术支持工程师处理。
步骤12 等待3分钟，查看告警是否自动清除。
●
是，处理完成。
●
否，执行步骤13。
步骤13 请联系技术支持工程师处理。
----结束
参考信息
无。
1.4.3.6 ALM-2001107
第三方站点异常
告警解释
此告警检查动作是从第一、二站点节点ping第三方站点，如果无法ping通则触发此告
警。
1

## Page 1034

告警属性
告警ID 告警级别 可自动清除
2001107
重要 否
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期的数据。
阈值条件 产生告警的阈值。
对系统的影响
云平台仲裁服务不可用， 无法判断主备站点信息。
可能原因
●
第三方站点整机房下电。
●
第三方站点网络异常。
处理步骤
● 第三方站点被下电
a.
请上电第三方站点。
b.
等待3分钟，查看告警是否自动清除。
i.
是，处理完成。
ii.
否，请联系技术支持工程师处理。
●
网络问题
a.
请处理网络故障， 直到从第一、二站点节点能ping通第三方站点的IP地址。
b.
等待3分钟，查看告警是否自动清除。
i.
是，处理完成。
ii.
否，请联系技术支持工程师处理。
参考信息
无。
1

## Page 1035

1.4.4 DMK
1.4.4.1 ALM-8000888 dmk
服务异常
告警解释
系统每隔60秒检查一次ha状态，如果服务异常，产生此告警。
告警属性
告警ID 告警级别 可自动清除
8000888
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 dmk进程监控。
详细信息 最近几个周期的数据。
阈值条件 产生告警的阈值。
对系统的影响
ha进程异常，对业务稳定性影响严重，需要紧急处理。
可能原因
ha进程异常。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
1

## Page 1036

● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用PuTTY工具，通过步骤4中获取的IP地址节点登录告警节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤7 执行以下命令导入环境变量。
source /etc/profile
步骤8 执行以下命令，检查主备状态是否正常。
haStatus
NODE ROLE PHASE RESS VER START
OM-SRV01(OM-SRV01) active Actived normal V100R001C01 2019-02-19 09:47:35
OM-SRV02(OM-SRV02) standby Deactived normal V100R001C01 2019-02-19 09:48:00
--------------------------------------------------------------------------------------------------------
ID RES STAT RET TYPE
OM-SRV01(OM-SRV01): 1 exfloatip Normal Normal Single_active
2 nginx Normal Normal Single_active
3 unicorn Normal Normal Single_active
OM-SRV02(OM-SRV02): 1 exfloatip Normal Stopped Single_active
2 nginx Normal Stopped Single_active
3 unicorn Normal Stopped Single_active
●
是，执行步骤9。
●
否，执行步骤8.a~步骤8.c。
a.
执行以下命令，切换到“root”用户。
sudo su - root
b.
执行以下命令，启动ha进程。
haStartAll -a
[INFO ] reg ha successful
[INFO ] start ha successful
c.
重复执行步骤8，检查主备状态是否正常。
i.
是，处理完毕。
ii.
否，请联系技术支持工程师协助解决。
步骤9 等待10分钟，检查告警是否已自动清除。
1

## Page 1037

●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.4.5 DNS
1.4.5.1 ALM-8000021 DNS named
进程异常
告警解释
系统每隔60秒检查一次DNS服务的named进程，如果进程异常则产生此告警。
告警属性
告警ID 告警级别 可自动清除
8000021
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 业务监控。
详细信息 最近几个周期的数据。
阈值条件 产生告警的阈值。
对系统的影响
产生告警的节点DNS服务异常，无法提供服务，需尽快处理异常。
可能原因
named进程不存在或异常。
1

## Page 1038

处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”，通过步骤4中获取的告警节点管理IP地址登录产生告警的节点。
默认帐户：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 检查是否可以登录成功。
●
是，执行步骤7。
●
否，请联系技术支持工程师协助解决。
步骤7 执行以下命令，切换到root用户。
sudo su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤8 执行以下命令，查看named服务是否正常。
service named status
●
回显中包含“active (running)”，请联系技术支持工程师协助解决。
●
回显中不包含“active (running)”，执行步骤9。
步骤9 执行以下命令，重启服务。
service named restart
步骤10 等待2分钟，执行以下命令，查看named服务是否正常。
service named status
●
回显中包含“active (running)”，执行步骤11。
●
回显中不包含“active (running)”，请联系技术支持工程师协助解决。
1

## Page 1039

步骤11 等待10分钟，检查告警是否清除。
●
是，处理结束。
●
否，请收集上述告警处理过程中的信息，联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.6 GaussDB
1.4.6.1 ALM-1510000 GaussdbHA
服务进程异常
告警解释
数据库正常状态为Primary或者Standby，如果出现其他状态则表示数据库异常上报此
告警。
告警属性
告警ID 告警级别 可自动清除
1510000
重要 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
数据库异常可能导致对应的服务无法访问数据库。
1

## Page 1040

可能原因
网络、磁盘等异常，或者软件缺陷导致的数据库异常。
前提条件
已获取登录产生告警的节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”工具，通过步骤4中获取的节点IP地址登录产生告警的节点。
默认帐号：fsp
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
sudo su
步骤7 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤8 执行如下命令确认数据库状态是否正常。
service gaussdb query|grep DB_STATE
回显信息如下，表示数据库状态正常。
[root@PUB-DB01 ~]# service gaussdb query|grep DB_STATE
DB_STATE : Normal
●
是，请联系技术支持工程师协助解决。
●
否，执行步骤9。
步骤9 执行如下命令停止本节点数据库系统。
1

## Page 1041

source /etc/profile
haStopAll -a
步骤10 执行如下命令启动本节点数据库系统。
haStartAll -a
步骤11 执行如下命令确认数据库状态是否正常。
service gaussdb query|grep DB_STATE
● 回显信息如下，表示数据库状态正常，执行步骤16。
[root@PUB-DB01 ~]# service gaussdb query|grep DB_STATE
DB_STATE : Normal
●
回显信息如下，表示数据库待修复，执行步骤12。
[root@PUB-DB01 ~]# service gaussdb query|grep DB_STATE
DB_STATE : NeedRepair
步骤12 执行如下命令，查看日志文件。
cd /var/log/postgresql/
vim
gaussdb-年-月-日_XXXXXX.log
示例如下:
vim gaussdb-2019-05-31_000000.log
●
如果日志中包含以下语句，执行步骤13。
FATAL: failedto identify consistence at 9/986B94A0: SSL connection has been closedunexpectedly
●
如果日志中未包含如上语句，请联系技术支持工程师协助解决。
步骤13 执行如下命令，与主节点进行同步。
su dbadmin
gs_ctl build
步骤14 执行如下命令，切回root用户。
exit
步骤15 执行步骤11，再次查询数据库状态是否正常。
●
是，执行步骤16。
●
否，请联系技术支持工程师协助解决。
步骤16 等待10分钟，查看告警是否自动清除。
●
是，告警自动清除。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1

## Page 1042

1.4.6.2 ALM-1510002 GaussdbHA
备份失败
告警解释
数据库本地备份失败时会触发此告警。
告警属性
告警ID 告警级别 可自动清除
1510002
重要 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
数据库本地备份失败会导致数据库发生数据异常，出现严重故障时，没有可用的恢复
数据。
可能原因
数据库磁盘空间满等原因。
前提条件
已获取登录产生告警的节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
1

## Page 1043

–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”工具，通过步骤4中获取的节点IP地址登录产生告警的节点。
默认帐号：fsp
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
sudo su
步骤7 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤8 执行如下命令检查备份失败的原因。
cat /home/zabbix/dbAlarmData/backup_zabbix_alarm
执行结果回显信息如下所示，则表示本地备份失败。
b0(backup fail)u1(upload fail)
请执行命令df
-lh /opt/backup/
检查备份目录空间。
Filesystem Size Used Avail Use% Mounted on
/dev/mapper/publicvg-lv3 167G 2.1G 156G 2% /opt/backup
如果备份目录空间充足，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.6.3 ALM-1510003 GaussdbHA
证书异常
告警解释
证书过期、无效和证书即将过期时产生此告警。
1

## Page 1044

告警属性
告警ID 告警级别 可自动清除
1510003
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
数据库证书异常或者证书即将过期。
可能原因
●
阈值为1：证书即将过期。
●
阈值为2：证书过期。
●
阈值为3：证书无效或者证书不存在。
前提条件
●
已获取对应服务的数据库主备节点IP。
●
已获取需要替换的证书，如果没有及时获取可以暂时使用GaussdbHA发布的默认
证书。
一套证书应该包含5个证书文件：
–
cacert.pem表示签发服务器证书和客户端证书的根证书文件；
–
server.crt表示服务端证书文件；
–
server.key表示服务端私钥文件；
–
client.crt表示客户端证书文件；
–
client.key表示客户端私钥文件。
说明
目前GaussdbHA仅支持到三级证书。
●
已经获取证书的其他相关信息，获取的相关信息以变量表示，在后续步骤中会引
用相关的变量请注意按实际信息替换。
1

## Page 1045

表1-69 变量说明
变量名 变量说明 默认证书中的值
CERT_PATH
表示新证书上传到环境
上的临时路径，本文档
已以/home/rts1/certs
为例。需要保证目录有
上传文件的权限。
以实际规划为准
CERT_CN
表示证书生成时的组织
信息。
www.huawei.com
CERT_CLIENT_KEY_PW
D
表示客户端证书私钥的
保护密码，可以为空。
证书client.key的默认密
码
CERT_SERVER_KEY_PW
D
表示服务端证书私钥的
保护密码，可以为空。
证书server.key的默认密
码
●
已准备跨平台远程访问工具，如 “PuTTY”。
●
已准备网络传输工具，如 “WinSCP”。
●
已获取对应服务的数据库安装用户的密码，root用户的密码。
●
已获取登录产生告警的节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
●
已获取登录Gaussdb服务所在节点的默认密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
Service）”页签中，在对应节点下该帐户的默认密码。
● 已获取证书client.key和server.key的默认密码。
默认密码：请参见《华为云Stack
8.1.0
证书一览表》的“FusionSphere
Service”页签中，与子部件名称对应的证书的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
1

## Page 1046

步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”工具，通过步骤4中获取的节点IP地址登录产生告警的节点。
默认帐号：fsp
步骤6 执行如下命令，并按提示输入“root”用户的密码，切换到“root”用户。
sudo su - root
步骤7 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤8 执行以下命令，查询数据库的版本号，确认当前版本是否支持证书替换。
cat /opt/gaussdb/version.json
说明
当前仅高于1.1.9（包含1.1.9）的版本支持替换证书，低版本不需要执行证书替换。
上传证书和停止数据库服务。
步骤9 使用“PuTTY”工具，分别登录数据库的两个节点。
默认帐号：gaussdb
步骤10 切换到root用户下执行如下命令，创建保存新证书的临时目录。
CERT_PATH='/home/rts1/certs'
mkdir -p $CERT_PATH
chmod 777 $CERT_PATH
命令中变量CERT_PATH已经在前提条件中获取，需要替换为对应值，需要保证规划的
目录有上传文件的权限。
步骤11 使用网络传输工具（例如“WinSCP”），将证书文件上传到/home/rts1/certs目录
下，上传目录为步骤10中创建的实际规划目录。
1

## Page 1047

步骤12 使用“PuTTY”工具，登录数据库的两个节点，切换到root用户下执行如下命令，确认
数据库主备节点。
service gaussdb query|grep LOCAL_ROLE
如果回显信息中包含Standby 信息则表示为数据库备节点，如果回显信息中包含
Primary
信息则表示为数据库主节点。
步骤13 根据获取的主备节点信息，分别在数据库备节点、主节点执行如下命令，停止数据
库。
source /etc/profile
haStopAll -a
替换数据库节点的证书
步骤14 替换数据库证书，包含替换数据库主备节点的证书，分别在数据库备节点、主节点执
行如下步骤替换对应节点的证书。
登录数据库节点，在root用户下执行如下命令替换证书文件，命令中变量
CERT_PATH、CERT_CN替换为在前提条件中获取的实际值。变量替换完成后，复制如
下命令并一起执行。
unset HISTFILE
CERT_PATH='/home/rts1/certs'
CERT_CN='www.huawei.com'
alias cp='cp'
mkdir -p /opt/backup/cert_old
cp -fr /opt/gaussdb/data/certs/* /opt/backup/cert_old/
rm -rf /opt/gaussdb/data/certs/*
1

## Page 1048

cp -fr $CERT_PATH/* /opt/gaussdb/data/certs/
cp /opt/gaussdb/data/certs/server* /opt/gaussdb/data/db/
cp /opt/gaussdb/data/certs/cacert.pem /opt/gaussdb/data/db/
su - dbadmin -c "gs_guc set -c repl_force_cert_check=\"'repl_All_peer_cn=
$CERT_CN'\""
chown dbadmin: /opt/gaussdb/data/certs/ -R
chmod 700 /opt/gaussdb/data/certs
chmod 600 /opt/gaussdb/data/certs/*
步骤15 如果在前提条件中获取的CERT_SERVER_KEY_PWD信息不为空，在root用户下执行如
下命令生成服务端证书密码文件，复制如下命令并一起执行，命令执行过程中按提示
输入CERT_SERVER_KEY_PWD信息。
unset HISTFILE
rm -rf /opt/gaussdb/data/db/server.key.rand
rm -rf /opt/gaussdb/data/db/server.key.cipher
su - dbadmin -c "gs_guc encrypt -M server -k"
步骤16 如果在前提条件中获取的CERT_SERVER_KEY_PWD信息不为空，执行如下命令替换服
务端证书密码文件，复制如下命令并一起执行。
cp /opt/gaussdb/data/db/server.key.cipher /opt/gaussdb/data/certs/
cp /opt/gaussdb/data/db/server.key.rand /opt/gaussdb/data/certs/
chown dbadmin: /opt/gaussdb/data/certs/ -R
chmod 700 /opt/gaussdb/data/certs
chmod 600 /opt/gaussdb/data/certs/*
步骤17 如果在前提条件中获取的CERT_CLIENT_KEY_PWD信息不为空，在root用户下执行如
下命令生成客户端证书密码文件，复制如下命令并一起执行，命令执行过程中按提示
输入CERT_CLIENT_KEY_PWD信息。
unset HISTFILE
rm -rf /opt/gaussdb/data/db/client.key.rand
rm -rf /opt/gaussdb/data/db/client.key.cipher
su - dbadmin -c "gs_guc encrypt -M client -k"
步骤18 如果在前提条件中获取的CERT_CLIENT_KEY_PWD信息不为空，执行如下命令替换客
户端证书密码文件，复制如下命令并一起执行。
cp /opt/gaussdb/data/db/client.key.rand /opt/gaussdb/data/certs/
cp /opt/gaussdb/data/db/client.key.cipher /opt/gaussdb/data/certs/
rm -rf /opt/gaussdb/data/db/client.key.rand
rm -rf /opt/gaussdb/data/db/client.key.cipher
chown dbadmin: /opt/gaussdb/data/certs/ -R
1

## Page 1049

chmod 700 /opt/gaussdb/data/certs
chmod 600 /opt/gaussdb/data/certs/*
重启数据库服务
步骤19 分别在数据库主节点、备节点执行如下命令。
source /etc/profile
haStartAll -a
步骤20 在数据库主节点执行如下命令，检查证书替换后数据库状态是否恢复正常。
source /etc/profile
service had query
service gaussdb query
Ha state:
LOCAL_ROLE : Primary
STATIC_CONNECTIONS : 1
DB_STATE : Normal
DETAIL_INFORMATION : Normal
Senders info:
SENDER_PID : 22772
LOCAL_ROLE : Primary
PEER_ROLE : Standby
PEER_STATE : Normal
STATE : streaming
SENDER_SENT_LOCATION : 0/B71326C8
SENDER_WRITE_LOCATION : 0/B71326C8
SENDER_FLUSH_LOCATION : 0/B71326C8
SENDER_REPLAY_LOCATION : 0/B71326C8
RECEIVER_RECEIVED_LOCATION : 0/B71326C8
RECEIVER_WRITE_LOCATION : 0/B71326C8
RECEIVER_FLUSH_LOCATION : 0/B71326C8
RECEIVER_REPLAY_LOCATION : 0/B712D138
SYNC_PERCENT : 99%
SYNC_STATE : async
SYNC_PRIORITY : 0
CHANNEL : 192.168.0.0-->192.168.1.0
Receiver info:
No information
命令查询结果类似上图表示证书替换后数据库服务正常。
删除上传的证书文件
1

## Page 1050

步骤21 登录数据库主备节点执行如下命令。
rm -f /home/rts1/certs/*
须知
/home/rts1/certs/为本文档中的证书文件上传路径，需要以实际操作中的上传路径为
准。
步骤22 观察告警是否清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.6.4 ALM-1510005 GaussdbHA
主备同步异常
告警解释
数据库同步状态显示为99%或者100%都表示主备同步正常，如果出现其他状态则表示
数据库主备同步异常，上报此告警。
告警属性
告警ID 告警级别 可自动清除
1510005
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
1

## Page 1051

参数名称 参数含义
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
数据库异常可能导致对应的服务无法访问数据库。
可能原因
网络、磁盘等异常，或者软件缺陷导致的数据库异常。
前提条件
已获取登录产生告警的节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”工具，通过步骤4中获取的节点IP地址登录产生告警的节点。
默认帐号：fsp
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
sudo su
步骤7 执行以下命令，防止“PuTTY”超时退出。
1

## Page 1052

TMOUT=0
步骤8 执行如下命令确认数据库状态是否正常。
service gaussdb query|grep SYNC_PERCENT
回显信息如下任意一种情况，都表示主备同步状态正常。
情况一：
SYNC_PERCENT : 99%
情况二：
SYNC_PERCENT : 100%
●
是，请联系技术支持工程师协助解决。
●
否，执行步骤9。
步骤9 执行如下命令停止本节点数据库系统。
source /etc/profile
haStopAll -a
步骤10 执行如下命令启动本节点数据库系统。
haStartAll -a
步骤11 执行如下命令确认数据库状态是否正常。
service gaussdb query|grep SYNC_PERCENT
回显信息如下，表示数据库状态正常。
回显信息如下任意一种情况，都表示主备同步状态正常。
情况一：
SYNC_PERCENT : 99%
情况二：
SYNC_PERCENT : 100%
●
是，执行步骤17。
●
否，执行步骤12。
步骤12 使用“PuTTY”工具，通过步骤4中获取的节点IP地址登录产生告警的节点
默认帐号：fsp
步骤13 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
sudo su
步骤14 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤15 执行以下命令，切换到“dbadmin”用户
su dbadmin
1

## Page 1053

步骤16 执行以下命令同步主数据库去恢复
gs_ctl build
回显信息如下，表示同步状态正常
could not change directory to "/root"waiting for server to shut down.... doneserver stoppedgs_ctl: connect to
server, build started.xlog start point: 0/6E000020gs_ctl: starting background WAL receiver1170033/1170033
kB (100%), 1/1 tablespace
xlog end point: 0/6E015638gs_ctl: waiting for background process to finish streaming...gs_ctl: build
completed.server starting.... doneserver started
步骤17 等待10分钟，查看告警是否自动清除。
●
是，告警自动清除。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.6.5 ALM-1510006 GaussdbHA
上传远端备份服务器失败
告警解释
数据库备份上传到sftp服务器失败时会触发此告警。
告警属性
告警ID 告警级别 可自动清除
1510006
重要 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
1

## Page 1054

对系统的影响
数据库备份上传sftp服务器失败会导致数据库发生数据异常，出现严重故障时，没有可
用的恢复数据。
可能原因
sftp服务器未配置或者配置错误。
前提条件
已获取登录产生告警的节点的fsp密码和root密码。
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”工具，通过步骤4中获取的节点IP地址登录产生告警的节点。
默认帐号：fsp
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
sudo su
步骤7 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤8 执行如下命令检查备份失败的原因。
cat /opt/gaussdb_ha/backup/conf/backup_result
执行结果回显信息如下所示，则表示备份文件上传远端存储失败。
local:success
remote:failed
1

## Page 1055

步骤9 请检查当前/opt/gaussdb_ha/backup/conf/upload_server.conf配置文件中是否已配置
远端存储。
●
如果回显信息中远端存储参数值均为空，则表示未配置远端存储。请参考《华为
云Stack
8.1.0
运维指南》中“备份数据
>
备份管理
>
配置备份服务器”章节配
置远端存储。
●
如果回显信息中远端存储参数值不为空，则表示已配置远端存储。请检查配置是
否正确。
–
是，请联系技术支持工程师协助解决。
–
否，请参考《华为云Stack
8.1.0
运维指南》中“备份数据
>
备份管理
>
配
置备份服务器”章节配置远端存储。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.7 HAProxy
1.4.7.1 ALM-2000904 haproxy
服务异常
告警解释
当HAProxy进程异常或HAProxy浮动IP未绑定到对应网卡上时，系统产生此告警，提示
系统故障或者风险。
告警属性
告警ID 告警级别 自动清除
2000904
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
1

## Page 1056

参数名称 参数含义
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
当各服务调用HAProxy服务转发消息时，无法正常转发。
可能原因
●
HAProxy进程异常。
●
HAProxy浮动IP未绑定到对应网卡上。
前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用PuTTY，登录步骤4中确认的虚拟机。
默认帐号：fsp
步骤6 执行以下命令，防止PuTTY超时退出。
TMOUT=0
1

## Page 1057

步骤7 执行以下命令切换到root用户。
sudo su - root
步骤8 执行以下命令，重启HAProxy后观察是否仍有告警。
service haproxy restart
●
是，执行步骤9。
● 否，处理完毕。
步骤9 执行以下命令，检查浮动IP是否绑定成功。
ip a
回显信息中包含告警的不可达的浮动IP，表示已绑定成功。
●
是，执行步骤10。
●
否，重新分配浮动IP。
步骤10 检查浮动IP是否与HAProxy节点HAPROXY01和HAPROXY02在同一个网段。
●
是，执行步骤11。
●
否，重新分配浮动IP。
步骤11 分别在HAProxy两个节点HAPROXY01和HAPROXY02执行以下命令，检查是否都配置
了该浮动IP。
cat /etc/keepalived/keepalived.conf
回显如下所示，表示已配置。
! Configuration File for keepalived
vrrp_script chk_http_port {
script "/home/elb/keepalived/script/check_haproxy.sh"interval 2weight 20
}
vrrp_instance VI_1 {
state BACKUP
nopreempt
interface eth0
virtual_router_id 162
priority 100
advert_int 1
virtual_ipaddress {
10.0.0.0
……
}
track_script {
chk_http_port
}
notify_master "/home/elb/keepalived/script/notify.sh master"
notify_backup "/home/elb/keepalived/script/notify.sh backup"
}
●
是，执行步骤12。
●
否，请在HAProxy的两个节点均配置该浮动IP。
步骤12 执行以下命令，检查浮动IP是否与其他IP冲突。
arping
浮动IP
1

## Page 1058

说明
如果出现两个MAC地址，则表示浮动IP冲突。
●
是，重新分配浮动IP。
●
否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.4.7.2 ALM-2000906 haproxy
的浮动
IP
不可达
告警解释
检查keepalived.conf文件里所有的浮动IP，当出现浮动IP无法ping通时，产生此告警。
告警属性
告警ID 告警级别 自动清除
2000906
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
该浮动IP对应的服务无法通过HAProxy正常转发消息。
可能原因
●
该浮动IP与HAProxy节点的IP不在同一个网段。
●
该浮动IP只在HAProxy的一个节点进行配置，在HAProxy的另一个节点未配置。
1

## Page 1059

前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
● 密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用PuTTY，登录步骤4中确认的虚拟机。
默认帐号：fsp
步骤6 执行以下命令，防止PuTTY超时退出。
TMOUT=0
步骤7 执行以下命令切换到root用户。
sudo su - root
步骤8 执行以下命令，获取已配置的浮动IP。
cat /etc/keepalived/keepalived.conf
回显如下所示，记录virtual_ipaddress中的IP地址。
! Configuration File for keepalived
vrrp_script chk_http_port {
script "/home/elb/keepalived/script/check_haproxy.sh"interval 2weight 20
}
vrrp_instance VI_1 {
state BACKUP
nopreempt
interface eth0
virtual_router_id 162
priority 100
advert_int 1
virtual_ipaddress {
10.0.0.0
……
1

## Page 1060

}
track_script {
chk_http_port
}
notify_master "/home/elb/keepalived/script/notify.sh master"
notify_backup "/home/elb/keepalived/script/notify.sh backup"
}
步骤9 执行以下命令，检查浮动IP是否和步骤8中获取的IP地址一致。
ip a | grep global | grep inet
●
是，请联系技术支持工程师协助解决。
●
否，重新分配浮动IP。
----结束
参考信息
无。
1.4.7.3 ALM-2000908 keepalived
进程不存在
告警解释
keepalived进程异常终止时，生成此告警。
告警属性
告警ID 告警级别 自动清除
2000908
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
对业务影响严重，需紧急处理。
1

## Page 1061

可能原因
keepalived进程无法启动。
前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
● 登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用PuTTY，通过步骤4中确认的IP地址登录虚拟机。
默认帐号：fsp
步骤6 执行以下命令，防止PuTTY超时退出。
TMOUT=0
步骤7 执行以下命令切换到root用户。
sudo su - root
步骤8 执行以下命令，查看keepalived进程是否正常。
service keepalived status
Checking for service keepalived running
●
是，执行步骤9。
●
否，执行步骤10。
步骤9 等待10分钟后，检查告警是否消除。
●
是，处理完毕。
●
否，执行步骤10。
1

## Page 1062

步骤10 重启keepalived进程，等待10分钟后，检查告警是否消除。
service keepalived restart
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.4.7.4 ALM-2000909 haproxy
浮动
IP
端口不可达
告警解释
当执行命令wget VIP:port检测不通时，产生此告警。
告警属性
告警ID 告警级别 自动清除
2000909 紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
该浮动IP对应的服务对接HAProxy配置不成功，无法通过HAProxy正常转发消息。
可能原因
●
该浮动IP与HAProxy节点的IP不在同一个网段。
●
该浮动IP及端口只在HAProxy的一个节点进行配置，在HAProxy的另一个节点未配
置。
1

## Page 1063

前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
● 登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用PuTTY，登录步骤4中确认的虚拟机。
默认帐号：fsp
步骤6 执行以下命令，防止PuTTY超时退出。
TMOUT=0
步骤7 执行以下命令切换到root用户。
sudo su - root
步骤8 执行以下命令，检查浮动IP是否绑定成功。
ip a
●
是，执行步骤9。
●
否，重新配置浮动IP。
步骤9 检查浮动IP是否与HAProxy节点在同一个网段。
● 是，执行步骤10。
●
否，重新分配浮动IP后执行步骤10。
步骤10 分别在HAProxy两个节点执行以下命令，检查是否都配置了该浮动IP。
cat /etc/keepalived/keepalived.conf
! Configuration File for keepalived
vrrp_script chk_http_port {
1

## Page 1064

script "/home/elb/keepalived/script/check_haproxy.sh"interval 2weight 20
}
vrrp_instance VI_1 {
state BACKUP
nopreempt
interface eth0
virtual_router_id 162
priority 100
advert_int 1
virtual_ipaddress {
10.0.0.0
……
}
track_script {
chk_http_port
}
notify_master "/home/elb/keepalived/script/notify.sh master"
notify_backup "/home/elb/keepalived/script/notify.sh backup"
}
●
是，执行步骤12。
●
否，执行步骤11。
步骤11 在keepalived.conf文件配置修改浮动IP。
步骤12 执行以下命令，检查浮动IP是否与其他IP冲突。
arping
浮动IP
说明
如果出现两个MAC地址，则表示浮动IP冲突。
●
是，重新分配浮动IP后执行步骤13。
●
否，执行步骤13。
步骤13 执行以下命令，检查haproxy.conf和keepalived.conf配置文件中对应服务的浮动IP和端
口是否一致。
cat /etc/haproxy/haproxy.cfg
cat /etc/keepalived/keepalived.conf
● 是，请联系技术支持工程师协助解决。
●
否，执行步骤14。
步骤14 执行以下命令，编辑haproxy.conf文件，找到对应的服务，修改为规划后的IP端口。
vim /etc/haproxy/haproxy.cfg
listen service 10.0.0.0:10
其中service表示服务名称，10.0.0.0表示浮动IP，10表示端口号。
步骤15 执行以下命令，重启进程后观察是否仍有告警。
service keepalived restart
service haproxy restart
●
是，请联系技术支持工程师协助解决。
●
否，处理完毕。
----结束
1

## Page 1065

参考信息
无。
1.4.8 LVS
1.4.8.1 ALM-2001101 lvs_keepalived
进程不存在
告警解释
LVS使用keepalived绑定浮动IP，当keepalived进程不存在时，系统产生此告警，提示
系统故障或者风险。
告警属性
告警ID 告警级别 自动清除
2001101
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
当登录或者跳转各个云服务管理控制台界面时访问异常。
可能原因
Keepalived进程停止。
前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
1

## Page 1066

处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
● 登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控 > 告警管理 > 当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”，登录步骤4中确认的虚拟机。
默认帐号：fsp
步骤6 执行以下命令，防止PuTTY超时退出。
TMOUT=0
步骤7 执行下列命令切换到root用户。
sudo su - root
步骤8 执行以下命令，重启keepalived后观察是否仍有告警。
service keepalived restart
●
是，请联系技术支持工程师协助解决。
●
否，处理完毕。
----结束
参考信息
无。
1.4.9 Nginx
1.4.9.1 ALM-2001002 nginx
服务异常
告警解释
当Nginx的进程数量与Nginx配置文件所定义的进程数量不一致，Nginx服务健康检查
失败，上报此告警。
1

## Page 1067

告警属性
告警ID 告警级别 自动清除
2001002
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
当登录或者跳转各个云服务控制台界面时访问异常。
可能原因
Nginx的进程数量与Nginx配置文件所定义的进程数量不一致。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
1

## Page 1068

步骤5 使用“PuTTY”，登录步骤4中确认的虚拟机。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 执行以下命令，防止PuTTY超时退出。
TMOUT=0
步骤7 执行下列命令切换到root用户。
sudo su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤8 执行以下命令，重启Nginx进程后观察是否仍有告警。
sh /opt/onframework/bin/nginx_monitor.sh restart
●
是，请联系技术支持工程师协助解决。
●
否，处理完毕。
----结束
参考信息
无。
1.4.10 SDR
1.4.10.1
计量话单告警参考
1.4.10.1.1 ALM-2000301
计量话单生成话单失败
告警解释
计量话单服务会在每个整点时刻过15分钟后生成话单文件。生成话单文件时，当数据
源异常（数据源无法访问或者本身存在异常）会导致话单生成失败，服务会启动失败
重试机制，当重试次数等于服务设定的阈值时，就会产生此告警。
告警属性
告警ID 告警级别 可自动清除
2000301
紧急 否
1

## Page 1069

告警参数
参数名称 参数含义
定位信息 区域 产生告警信息的区域。
云服务 产生告警信息的云服务。
附加信息 云服务 产生告警信息的云服务。
失败话单总数 生成话单失败的告警次数。
失败资源类型 生成话单失败的资源类型。
失败原因 生成告警的原因，例如“Query
data from
ceilometer
error”。
开始时间 开始时间对应的时间戳。
结束时间 结束时间对应的时间戳。
虚拟机名称 产生告警信息的虚拟机名称。
对系统的影响
计费系统无法采集到本周期话单，影响正常计费。
可能原因
●
数据源异常，数据源有两种：一种是ceilometer提供的；另外一种是非ceilometer
的，即服务自身提供的。
●
上传通道异常，即连接ManageOne的SFTP异常。
前提条件
●
已获取登录PUB-SRV节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
●
已获取Meterticket_admin帐户的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
Service）”页签中，在对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
1

## Page 1070

● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在告警的“定位信息”中获取当时告警所在Region。
步骤5 使用“PuTTY”，登录步骤4中所获取Region下的PUB-SRV-03节点。
说明
PUB-SRV-03节点IP地址请在导出的包含IP地址和参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》的“2.1 工具生成的IP参数”页签搜索“PUB-SRV-03”获取。
默认帐号：fsp
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
sudo su
步骤7 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤8 执行以下命令，切换到root用户。
sudo su
步骤9 执行以下命令，手动生成话单文件并清除告警，并按提示输入Meterticket_admin帐户
的密码。
sh /home/meteradmin/meterticket-controller/bin/handleAlarm.sh
按“Enter”，检查回显信息中是否包含“all
task
successfully”。
●
是，执行步骤10。
●
否，请联系技术支持工程师协助解决。
步骤10 等待一小时，观察告警是否清除。
●
是，处理结束。
●
否，请联系技术支持工程师协助解决。
----结束
参考信息
如无计费需求，请参考1.4.10.2.1 配置屏蔽规则屏蔽本条告警。
1.4.10.1.2 ALM-2000317
计量话单服务异常
告警解释
计量话单健康检查异常，就会产生此告警。
1

## Page 1071

告警属性
告警ID 告警级别 可自动清除
2000317
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
话单文件可能无法正常生成。
可能原因
计量话单进程未启动或者数据库连接异常。
前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用PuTTY，登录PUB-DB01节点。
默认帐号：fsp
步骤2 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤3 执行以下命令，输入root密码，切换到root用户下。
sudo su - root
步骤4 执行以下命令，查询数据库状态。
service had query
1

## Page 1072

●
数据库正常，请执行步骤5。
●
数据库异常，请联系技术支持工程师协助解决。
步骤5 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤6 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤7 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤8 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤9 使用“PuTTY”工具，通过步骤8中获取的节点IP地址登录产生告警的节点。
默认帐号：fsp
步骤10 执行如下命令，并按提示输入“root”用户的密码，切换到“root”用户。
sudo su - root
步骤11 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤12 执行如下命令，切换到“meteradmin”用户。
su - meteradmin
步骤13 执行以下命令，查询服务进程。
ps -ef |grep meteradmin
●
存在，执行步骤14后再执行步骤16。
●
不存在，执行步骤15。
步骤14 执行以下命令，重启服务进程。
sh /home/meteradmin/meterticket-*/bin/stop.sh
sh /home/meteradmin/meterticket-*/bin/startup.sh
步骤15 执行以下命令，启动服务进程。
sh /home/meteradmin/meterticket-*/bin/startup.sh
步骤16 执行如下命令，检查服务进程运行是否正常。
ps -ef |grep meteradmin
1

## Page 1073

●
是，执行步骤17。
●
否，请联系技术支持工程师协助解决。
步骤17 等待10分钟，检查告警是否已自动清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
1.4.10.1.3 ALM-2000327
计量话单证书告警
告警解释
计量话单服务证书过期，就会产生此告警。
告警属性
告警ID 告警级别 可自动清除
2000327
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
影响接口调用。
可能原因
计量话单节点证书已经过期或者三十天之内过期。
前提条件
●
已获取登录产生告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
1

## Page 1074

●
已获取证书的默认密码。
默认密码：请参见《华为云Stack
8.1.0
证书一览表》的“FusionSphere
Service”页签中，与子部件名称对应的证书的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 通过步骤4中获取的节点IP地址判断上报告警的节点。
●
如果是Controller节点，请执行步骤6~步骤19。
●
如果是Agent节点，请执行步骤20~步骤33。
更换Controller节点的证书
步骤6 使用网络传输工具（例如“WinSCP”工具），将获取的证书上传到Controller节点的
“/home/meteradmin”路径下。
步骤7 使用Putty，以“fsp”用户登录Controller节点。
步骤8 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤9 执行以下命令，备份原有证书库文件server.keystore。
mv /home/meteradmin/meterticket-controller/resources/keystore/
server.keystore /home/meteradmin/meterticket-controller/resources/
keystore/server.keystore.bak
步骤10 执行以下命令，临时关闭历史记录，防止history中泄露密码。
set +o history
步骤11 执行以下命令，生成新的证书库文件server.keystore。
keytool -genkey -alias
证书库别名
-keypass
别名密码
-keyalg
算法
-keysize
密钥
长度
-validity
有效期（天）
-keystore
指定生成证书的位置和证书名称
-storepass
获取keystore信息的密码
-dname
"C=单位的两字母国家代码, ST=州或省份名称, L=城
市或区域名称, O=组织名称, OU=组织单位名称, CN=名字与姓氏"
1

## Page 1075

步骤12 执行以下命令，导入根证书。
keytool -import -v -trustcacerts -alias ca_root -file
CA证书名称
-keystore
server.keystore
例如导入ca.crt：
keytool -import -v -trustcacerts -alias ca_root -file ca.crt -keystore
server.keystore
显示如下信息：
Enter keystore password:
说明
如果回显信息显示keytool命令不存在，则需要执行如下命令导入环境变量。
source /etc/profile
步骤13 执行以下命令，开启历史记录。
set -o history
步骤14 输入证书库密码，按“Enter”。
步骤15 输入“yes”，按“Enter”。
显示如下信息时，完成CA证书的导入：
Certificate was added to keystore
[Storing server.keystore]
步骤16 执行以下命令，导入签名后证书。
keytool -import -v -trustcacerts -alias ca_server -file
证书名称
-keystore
server.keystore
例如导入server.crt：
keytool -import -v -trustcacerts -alias ca_server -file server.crt -keystore
server.keystore
显示如下信息：
Enter keystore password:
步骤17 输入证书库密码，按“Enter”。
步骤18 输入“yes”，按“Enter”。
步骤19 证书替换后，如果告警仍未消除，请联系技术支持工程师协助解决。
更换Agent节点的证书
步骤20 使用网络传输工具（例如“WinSCP”工具），将获取的证书上传到Agent节点的“/
home/meteradmin”路径下。
步骤21 使用Putty，以“fsp”用户登录Agent节点。
步骤22 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤23 执行以下命令，备份原有证书库文件server.keystore。
1

## Page 1076

mv /home/meteradmin/meterticket-agent/resources/keystore/
server.keystore /home/meteradmin/meterticket-agent/resources/keystore/
server.keystore.bak
步骤24 执行以下命令，临时关闭历史记录，防止history中泄露密码。
set +o history
步骤25 执行以下命令，生成新的证书库文件server.keystore。
keytool -genkey -alias
证书库别名
-keypass
别名密码
-keyalg
算法
-keysize
密钥
长度
-validity
有效期（天）
-keystore
指定生成证书的位置和证书名称
-storepass
获取keystore信息的密码
-dname
"C=单位的两字母国家代码, ST=州或省份名称, L=城
市或区域名称, O=组织名称, OU=组织单位名称, CN=名字与姓氏"
步骤26 执行以下命令，导入根证书。
keytool -import -v -trustcacerts -alias ca_root -file
CA证书名称
-keystore
server.keystore
例如导入ca.crt：
keytool -import -v -trustcacerts -alias ca_root -file ca.crt -keystore
server.keystore
显示如下信息：
Enter keystore password:
说明
如果回显信息显示keytool命令不存在，则需要执行如下命令导入环境变量。
source /etc/profile
步骤27 执行以下命令，开启历史记录。
set -o history
步骤28 输入证书库密码，按“Enter”。
步骤29 输入“yes”，按“Enter”。
显示如下信息时，完成CA证书的导入：
Certificate was added to keystore
[Storing server.keystore]
步骤30 执行以下命令，导入签名后证书。
keytool -import -v -trustcacerts -alias ca_server -file
证书名称
-keystore
server.keystore
例如导入server.crt：
keytool -import -v -trustcacerts -alias ca_server -file server.crt -keystore
server.keystore
显示如下信息：
Enter keystore password:
步骤31 输入证书库密码，按“Enter”。
1

## Page 1077

步骤32 输入“yes”，按“Enter”。
步骤33 证书替换后，如果告警仍未消除，请联系技术支持工程师协助解决。
----结束
1.4.10.1.4 ALM-2000328
计量话单证书告警
告警解释
计量话单服务证书过期，就会产生此告警。
告警属性
告警ID 告警级别 可自动清除
2000328
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
影响接口调用。
可能原因
计量话单节点证书已经过期或者三十天之内过期。
前提条件
●
已获取登录产生告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
●
已获取证书的默认密码。
默认密码：请参见《华为云Stack
8.1.0
证书一览表》的“FusionSphere
Service”页签中，与子部件名称对应的证书的默认密码。
1

## Page 1078

处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 通过步骤4中获取的节点IP地址判断上报告警的节点。
●
如果是Controller节点，请执行步骤6~步骤17。
●
如果是Agent节点，请执行步骤18~步骤29。
更换Controller节点的证书
步骤6 使用网络传输工具（例如“WinSCP”工具），将获取的证书上传到Controller节点的
“/home/meteradmin”路径下。
步骤7 使用Putty，以“fsp”用户登录Controller节点。
步骤8 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤9 执行以下命令，备份原有证书库文件server.keystore。
mv /home/meteradmin/meterticket-controller/resources/keystore/
server.keystore /home/meteradmin/meterticket-controller/resources/
keystore/server.keystore.bak
步骤10 执行以下命令，生成新的证书库文件server.keystore。
keytool -genkey -alias
证书库别名
-keypass
别名密码
-keyalg
算法
-keysize
密钥
长度
-validity
有效期（天）
-keystore
指定生成证书的位置和证书名称
-storepass
获取keystore信息的密码
-dname
"C=单位的两字母国家代码, ST=州或省份名称, L=城
市或区域名称, O=组织名称, OU=组织单位名称, CN=名字与姓氏"
步骤11 执行以下命令，导入根证书。
keytool -import -v -trustcacerts -alias ca_root -file
CA证书名称
-keystore
server.keystore
例如导入ca.crt：
1

## Page 1079

keytool -import -v -trustcacerts -alias ca_root -file ca.crt -keystore
server.keystore
显示如下信息：
Enter keystore password:
说明
如果回显信息显示keytool命令不存在，则需要执行如下命令导入环境变量。
source /etc/profile
步骤12 输入证书库密码，按“Enter”。
步骤13 输入“yes”，按“Enter”。
显示如下信息时，完成CA证书的导入：
Certificate was added to keystore
[Storing server.keystore]
步骤14 执行以下命令，导入签名后证书。
keytool -import -v -trustcacerts -alias ca_server -file
证书名称
-keystore
server.keystore
例如导入server.crt：
keytool -import -v -trustcacerts -alias ca_server -file server.crt -keystore
server.keystore
显示如下信息：
Enter keystore password:
步骤15 输入证书库密码，按“Enter”。
步骤16 输入“yes”，按“Enter”。
步骤17 证书替换后，如果告警仍未消除，请联系技术支持工程师协助解决。
更换Agent节点的证书
步骤18 使用网络传输工具（例如“WinSCP”工具），将获取的证书上传到Agent节点的“/
home/meteradmin”路径下。
步骤19 使用Putty，以“fsp”用户登录Agent节点。
步骤20 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤21 执行以下命令，备份原有证书库文件server.keystore。
mv /home/meteradmin/meterticket-agent/resources/keystore/
server.keystore /home/meteradmin/meterticket-agent/resources/keystore/
server.keystore.bak
步骤22 执行以下命令，生成新的证书库文件server.keystore。
keytool -genkey -alias
证书库别名
-keypass
别名密码
-keyalg
算法
-keysize
密钥
长度
-validity
有效期（天）
-keystore
指定生成证书的位置和证书名称
-storepass
获取keystore信息的密码
-dname
"C=单位的两字母国家代码, ST=州或省份名称, L=城
市或区域名称, O=组织名称, OU=组织单位名称, CN=名字与姓氏"
1

## Page 1080

步骤23 执行以下命令，导入根证书。
keytool -import -v -trustcacerts -alias ca_root -file
CA证书名称
-keystore
server.keystore
例如导入ca.crt：
keytool -import -v -trustcacerts -alias ca_root -file ca.crt -keystore
server.keystore
显示如下信息：
Enter keystore password:
说明
如果回显信息显示keytool命令不存在，则需要执行如下命令导入环境变量。
source /etc/profile
步骤24 输入证书库密码，按“Enter”。
步骤25 输入“yes”，按“Enter”。
显示如下信息时，完成CA证书的导入：
Certificate was added to keystore
[Storing server.keystore]
步骤26 执行以下命令，导入签名后证书。
keytool -import -v -trustcacerts -alias ca_server -file
证书名称
-keystore
server.keystore
例如导入server.crt：
keytool -import -v -trustcacerts -alias ca_server -file server.crt -keystore
server.keystore
显示如下信息：
Enter keystore password:
步骤27 输入证书库密码，按“Enter”。
步骤28 输入“yes”，按“Enter”。
步骤29 证书替换后，如果告警仍未消除，请联系技术支持工程师协助解决。
----结束
1.4.10.2
参考信息
1.4.10.2.1
配置屏蔽规则
对于设备上报而不需要关注的告警/事件，可以通过创建屏蔽规则，使后续上报且符合
屏蔽规则的告警/事件不会显示在当前告警和事件列表中。
前提条件
●
已具备“告警设置”的操作权限。
1

## Page 1081

●
用户只能对管理对象的规则进行启停、增删改和导入，对非管理对象的规则只能
查看和导出。
背景信息
●
屏蔽规则只会屏蔽建立规则之后上报的告警/事件，对于已上报的告警/事件不会有
影响。
●
停用、删除或修改屏蔽规则后，不会重复上报停用、删除或修改之前已经被屏蔽
的告警/事件。
●
屏蔽规则是以告警的原始属性（重定义前的属性）来进行屏蔽的。如果针对某条
告警既设置了级别重定义规则，又设置了屏蔽规则，则屏蔽规则先起作用，然后
重定义规则才起作用。
●
最多支持创建200条屏蔽规则。
●
同时满足以下条件的屏蔽规则会屏蔽所有告警/事件，将导致告警/事件无法上报。
–
屏蔽规则已启用。
–
屏蔽规则选择了所有告警/事件源。
– 屏蔽规则选择了所有告警/事件级别。
–
屏蔽规则没有选择生效开始时间、生效结束时间。
● 创建事件屏蔽规则与创建告警屏蔽规则的操作类似，本操作以创建告警屏蔽规则
为例，如需创建事件屏蔽规则请在“屏蔽规则”页面中单击“创建” ，选择“ 事
件屏蔽规则”。
操作步骤
步骤1 在主菜单中选择“集中监控
>
告警管理
>
告警设置”。
步骤2 在左侧导航树中选择“屏蔽规则”。
步骤3 在“屏蔽规则”页面中，单击“创建” ，选择“ 告警屏蔽规则”。
步骤4 设置规则的名称、告警源、规则生效的告警级别，用户还可在“指定告警”中选择需
要屏蔽的告警。
说明
●
只有管理对象为所有资源的用户可以选择“所有告警源”。
●
在设置“告警源”时，选择“所有告警源”将对系统自身和所有管理对象产生的符合条件的
告警进行屏蔽，请谨慎使用。
步骤5 在“条件”区域中，设置告警参数条件来筛选需要屏蔽的告警。
例如需要根据告警的定位信息进行筛选，则选择“定位信息”、“包含”，并输入对
应的目标告警的定位信息关键字段。
步骤6 设置规则执行的时间，用户可根据需要选择规则的生效时间和生效周期。
说明
“时间条件”中所有条件缺省为去勾选，表示规则在所有时间下生效。
步骤7 屏蔽后的告警可选择“丢弃”或显示在“被屏蔽告警”列表中。
说明
创建事件屏蔽规则时，被屏蔽的事件只能被丢弃。
1

## Page 1082

步骤8 设置规则的优先级，当两条屏蔽规则屏蔽同一条告警时，优先级高的规则生效。
步骤9 选择是否启用规则，单击“确定”完成配置。
----结束
相关任务
●
若需要重新接收已屏蔽的告警/事件，在主菜单中选择“集中监控
>
告警管理
>
告警设置”。在左侧导航树中选择“屏蔽规则”，在屏蔽规则列表中选择要停止
的屏蔽规则，单击“删除”或“停止”。“删除”将永久删除该屏蔽规则；“停
止”将停止执行该屏蔽规则，在需要重新启用屏蔽规则时可单击“启用”。
●
用户可导入/导出屏蔽规则，以便统计、审核、迁移规则。在“屏蔽规则”页面
中，单击“导入规则”或“导出规则”进行操作。
说明
●
导入的文件格式要求是XLS，大小不能超过1M。最多导入200条规则，若导入的规则名
称已存在，则替代原有规则。
●
导出文件已隐藏第一行，请不要修改第一行的文字，否则会导致导入失败。
任务示例
场景描述
运维人员计划于20XX年4月的每周一凌晨1点对设备A进行调测操作，每次调测在2个小
时以内完成，设备A承载的业务届时会中断。这个期间产生的告警是可预测到的，且不
需要被处理，需要配置屏蔽规则屏蔽这些告警，以避免这些告警被关注。
配置步骤
1.
在“屏蔽规则”页面中，单击“创建”，选择“告警屏蔽规则”。
2.
设置“规则名称”。
3.
选择“自定义告警源”，在自定义告警源中添加设备A。
4.
在“时间条件”区域中，设置“生效时间”为“20XX-04-01 00:00:00到
20XX-04-30
23:59:59”，设置“生效周期”的“按天”为“星期一”，“按时
段”为“01:00到03:00”。
5.
在“动作”区域中，选择“屏蔽后的告警”为“显示在“被屏蔽告警”中”。
6.
其他参数“条件”、“告警级别”、“启用”保持缺省设置。
7.
单击“确定”。
操作结果
设备A在20XX年4月的每周一凌晨1~3点产生的告警在“当前告警”、“告警日志”、
“历史告警”中均不可见。在“被屏蔽告警”页面可查看到这些被屏蔽的告警。
1.4.11 TaskCenter
1.4.11.1 ALM-2000722 taskcenter
服务异常
告警解释
任务中心服务健康检查异常，就会产生此告警。
1

## Page 1083

告警属性
告警ID 告警级别 可自动清除
2000722
紧急 是
告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
创建云服务器时无法正常显示申请状态。
可能原因
任务中心服务异常。
前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
1

## Page 1084

步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”，登录步骤4中确认的虚拟机。
默认帐号：fsp
步骤6 执行如下命令，并按提示输入“root”用户的密码，切换到“root”用户。
sudo su - root
步骤7 执行以下命令，查看任务中心进程是否正常且只存在一个。
ps -ef | grep taskcenter | grep -v grep
回显类似如下，所示则表示进程正常。
apitask 13773 1 0 11:47 ? 00:00:15 /opt/common/jre/bin/java -Dname=taskcenter -classpath ...
●
是，请联系技术支持工程师协助解决。
●
否，执行步骤8。
步骤8 执行如下命令，切换到“apitask”用户。
su - apitask
步骤9 执行以下命令，重启任务中心节点后观察是否仍有告警。
/opt/taskcenter/taskcenter-service/bin/service-restart.sh
●
是，请联系技术支持工程师协助解决。
●
否，处理完毕。
----结束
参考信息
无。
1.4.11.2 ALM-2000724
证书异常
告警解释
当任务中心证书即将过期、已过期、证书无效或不存在时产生此告警。
告警属性
告警ID 告警级别 可自动清除
2000724
紧急 是
1

## Page 1085

告警参数
参数名称 参数含义
定
位
信
息
资源名称 产生告警信息的设备名称。
资源类型 MONITOR。
主机IP 对应主机的IP地址。
附
加
信
息
监控类型 服务监控。
详细信息 最近几个周期数据。
阈值条件 产生告警的阈值。
对系统的影响
任务中心服务不可用。
可能原因
● 阈值为1：证书即将过期。
● 阈值为2：证书过期。
●
阈值为3：证书无效或者证书不存在。
前提条件
●
已获取根证书、签名后证书以及生成证书库时输入的密码。例如，根证书名称为
ca.crt，签名后证书为server.crt。
●
已准备跨平台远程访问工具，如“PuTTY”。
●
已准备网络传输工具，如“WinSCP”。
●
已获取待更换证书的任务中心服务节点的管理IP地址。
●
已获取fsp和root帐户的登录密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
●
已获取taskcenter帐户的默认密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
Service）”页签中，在对应节点下该帐户的默认密码。
●
已获取“server.keystore”证书的默认密码。
默认密码：请参见《华为云Stack
8.1.0
证书一览表》的“FusionSphere
Service”页签中，与子部件名称对应的证书的默认密码。
操作步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
1

## Page 1086

●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用“PuTTY”工具，通过步骤4中获取的节点IP地址登录产生告警的节点。
默认帐号：fsp
步骤6 使用网络传输工具（例如“WinSCP”工具），将获取的证书上传到任务中心服务节点
的“/home/apitask”路径下。
步骤7 执行如下命令，并按提示输入“root”用户的密码，切换到“root”用户。
sudo su - root
步骤8 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤9 执行以下命令，进入证书库所在目录。
cd /opt/taskcenter/taskcenter-service/resources/keystore
步骤10 执行以下命令，备份原有证书库。
mv server.keystore server.keystore.bak
步骤11 执行以下命令，生成新的证书库文件server.keystore。
cd /home/apitask
source /etc/profile
openssl pkcs12 -export -in
证书名称
-inkey
私钥名称
-out server.keystore -name
tomcat_server
例如：
openssl pkcs12 -export -in server.crt -inkey server.key -out server.keystore -
name tomcat_server
步骤12 根据提示两次输入证书库密码，该密码必须和私钥文件密码一致。
步骤13 执行以下命令，导入根证书。
keytool -import -v -trustcacerts -alias ca_root -file
CA证书名称
-keystore
server.keystore
例如导入server.crt：
1

## Page 1087

keytool -import -v -trustcacerts -alias ca_root -file ca.crt -keystore
server.keystore
显示如下信息：
Enter keystore password:
步骤14 输入证书库密码，按“Enter”。
步骤15 输入“yes”，按“Enter”。
显示如下信息时，完成CA证书的导入：
Certificate reply was installed in keystore
[Storing server.keystore]
步骤16 执行以下命令，并按提示输入证书库密码，检查证书是否导入成功。
keytool -list -v -keystore server.keystore
回显中包含如下信息时，表示证书正确导入。
Your keystore contains 2 entries
说明
如果回显信息显示keytool命令不存在，则需要执行命令source /etc/profile导入环境变量。
步骤17 执行以下命令，修改证书库权限。
chmod 600 server.keystore
chown apitask:apitask server.keystore
步骤18 执行以下命令，将导入证书后的证书库server.keystore拷贝到keystore文件夹下。
cp /home/apitask/server.keystore /opt/taskcenter/taskcenter-service/
resources/keystore
步骤19 执行以下命令，删除“/home/apitask”路径下证书文件。
rm server.keystore ca.crt server.crt
步骤20 执行以下命令，加密私钥密码。
cd /opt/taskcenter/taskcenter-service/bin
sh kspass.sh ks
显示如下信息：
Please input the keystore password:
Please input the keystore password again:
Please input the key password (Press 'ENTER' if same as keystore password):
步骤21 输入证书库密码和私钥密码，按“Enter”。
回显信息如下时，表示修改成功。
Result: success.
随机生成的私钥密码的密文同时保存在任务中心服务配置文件中。
步骤22 执行如下命令，切换到“apitask”用户。
su - apitask
1

## Page 1088

步骤23 执行以下命令，重启任务中心服务。
sh stop.sh
sh startup.sh
步骤24 执行以下命令，查看任务中心进程是否正常。
ps -ef | grep taskcenter | grep -v grep
回显类似如下，所示则表示进程正常。
apitask 13773 1 0 11:47 ? 00:00:15 /opt/common/jre/bin/java -Dname=taskcenter -classpath ...
●
是，证书替换成功，执行步骤25。
●
否，请联系技术支持工程师协助解决。
步骤25 观察告警是否消除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.4.12
组合
API
1.4.12.1
组合
API
1.4.12.1.1 ALM-1150001
组合API节点NTP进程状态异常
告警解释
系统每隔60秒检查一次NTP进程是否存在，如果不存在，产生此告警。
告警属性
告警ID 告警级别 可自动清除
1150001
重要 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称。
来源设备名称 产生告警信息的设备名称。
监控系统名称 产生告警信息的监控系统名称。
1

## Page 1089

参数名称 参数含义
来源系统 告警来源。
IP地址 产生告警信息的云服务器的IP地址。
最近发生时间 此条告警信息最近一次发生时间。
附加信息 告警附加信息。
对系统的影响
系统时间跳变会影响Job调度，严重情况下可能导致多个应用节点之间相互误判彼此健
康状况，误触发宕机事件，从而导致服务不可用。
可能原因
NTP进程异常。
前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控 > 告警管理 > 当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用PuTTY，登录步骤4中确认的虚拟机。
默认帐号：fsp
步骤6 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
1

## Page 1090

步骤7 执行如下命令，切换到root用户。
sudo su - root
步骤8 执行如下命令，检查NTP进程是否存在。
ps -ef |grep ntp
回显如下所示时，表示NTP进程存在。
[root@CPT-SRV01 ~]# ps -ef |grep ntp
root 612 1 0 Jan07 ? 00:02:09 /usr/sbin/irqbalance -- foreground -- policyscript=/etc/sysconfig/
irqbalance.rules --hintpolicy=subnet
ntp 28076 1 0 19:42 ? 00:00:00 /usr/sbin/ntpd -u ntp:ntp -g
root 28597 26104 0 19:42 pts/3 00:00:00 grep -- color=auto ntp
●
是，执行步骤9。
●
否，执行步骤11。
步骤9 执行如下命令，重启NTP进程。
service ntp restart
步骤10 检查NTP进程是否重启成功。
回显如下所示时，表示NTP进程重启成功。
[root@CPT-SRV01 ~]# service ntp restart
Redirecting to /bin/systemctl restart ntp.service
●
是，执行步骤13。
●
否，请联系技术支持工程师协助解决。
步骤11 执行如下命令，启动NTP进程。
service ntp start
步骤12 检查NTP进程是否启动成功。
回显如下所示时，表示NTP进程启动成功。
[root@CPT-SRV01 ~]# service ntp start
Redirecting to /bin/systemctl start ntp.service
●
是，执行步骤13。
●
否，请联系技术支持工程师协助解决。
步骤13 等待10分钟，检查告警是否已自动清除。
●
是，处理完毕。
● 否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1

## Page 1091

1.4.12.1.2 ALM-1150002
组合API 节点CPU使用率过高
告警解释
系统每隔1分钟检查一次节点tomcat进程cpu占用是否超过设定的阈值，如果在3分钟
内持续超过阈值，产生此告警。
告警属性
告警ID 告警级别 可自动清除
1150002
重要 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称。
来源设备名称 产生告警信息的设备名称。
监控系统名称 产生告警信息的监控系统名称。
来源系统 告警来源。
IP地址 产生告警信息的云服务器的IP地址。
最近发生时间 此条告警信息最近一次发生时间。
附加信息 告警附加信息。
对系统的影响
对系统正常运行无影响，但后续如果业务量增加，可能导致服务不可用。
可能原因
●
业务压力上升。
●
组合API节点系统异常。
前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
1

## Page 1092

●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用PuTTY，登录步骤4中确认的虚拟机。
默认帐号：fsp
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
sudo su - root
步骤7 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤8 执行以下命令，切换apicom用户。
su -s /bin/bash apicom
步骤9 执行以下命令，获取组合API服务的tomcat进程信息。
ps -ef |grep tomcat |grep apicom|grep -v grep
apicom 3087 1 2 Apr25 ? 00:39:02 /opt/common/jre/bin/java
回显中的“3087”即为tomcat进程的进程号。
步骤10 执行以下命令，停止tomcat进程。
kill -9
进程号
其中进程号为步骤9中获取的进程号。
步骤11 执行以下命令，重新启动进程。
sh /opt/apicom/tomcat/bin/startup.sh
步骤12 观察10分钟，查看该告警是否清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
1

## Page 1093

参考信息
无。
1.4.12.1.3 ALM-1150003
组合API 节点内存使用率过高
告警解释
系统每隔1分钟检查一次节点tomcat进程内存占用是否超过设定的阈值，如果在3分钟
内持续超过阈值，产生此告警。
告警属性
告警ID 告警级别 可自动清除
1150003
重要 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称。
来源设备名称 产生告警信息的设备名称。
监控系统名称 产生告警信息的监控系统名称。
来源系统 告警来源。
IP地址 产生告警信息的云服务器的IP地址。
最近发生时间 此条告警信息最近一次发生时间。
附加信息 告警附加信息。
对系统的影响
对系统正常运行无影响，但后续如果业务量增加，可能导致服务不可用。
可能原因
●
业务压力上升。
●
组合API节点系统异常。
前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
1

## Page 1094

处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用PuTTY，登录步骤4中确认的虚拟机。
默认帐号：fsp
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
sudo su - root
步骤7 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤8 执行以下命令，切换apicom用户。
su -s /bin/bash apicom
步骤9 执行下面命令，获取组合API服务的tomcat进程信息。
ps -ef |grep tomcat |grep apicom|grep -v grep
apicom 3087 1 2 Apr25 ? 00:39:02 /opt/common/jre/bin/java
回显中的“3087”即为tomcat进程的进程号。
步骤10 执行以下命令，停止tomcat进程。
kill -9
进程号
其中进程号为步骤9中获取的进程号。
步骤11 执行以下命令，重新启动进程。
sh /opt/apicom/tomcat/bin/startup.sh
步骤12 观察10分钟，查看该告警是否清除。
1

## Page 1095

●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.4.12.1.4 ALM-1150004
组合API 节点tomcat进程异常
告警解释
组合API节点tomcat进程异常时触发该告警。
告警属性
告警ID 告警级别 可自动清除
1150004
紧急 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称。
来源设备名称 产生告警信息的设备名称。
监控系统名称 产生告警信息的监控系统名称。
来源系统 告警来源。
IP地址 产生告警信息的云服务器的IP地址。
最近发生时间 此条告警信息最近一次发生时间。
附加信息 告警附加信息。
对系统的影响
服务不可用。
可能原因
tomcat进程异常。
前提条件
已获取登录告警节点的fsp密码和root密码。
1

## Page 1096

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
● 密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控 > 告警管理 > 当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用PuTTY，登录步骤4中确认的虚拟机。
默认帐号：fsp
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
sudo su - root
步骤7 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤8 执行以下命令，切换apicom用户。
su -s /bin/bash apicom
步骤9 执行以下命令，查看tomcat进程是否存在。
ps -ef | grep tomcat | grep apicom
apicom 3087 1 2 Apr25 ? 00:39:02 /opt/common/jre/bin/java
回显中的“3087”即为tomcat进程的进程号。
●
是，执行步骤10。
●
否，执行步骤11。
步骤10 执行以下命令，停止tomcat进程。
kill -9
进程号
其中进程号为步骤9中获取的进程号。
1

## Page 1097

步骤11 执行以下命令，重新启动进程。
sh /opt/apicom/tomcat/bin/startup.sh
步骤12 观察1分钟，查看该告警是否清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.4.12.1.5 ALM-1150017
组合API 节点tomcat进程不存在
告警解释
组合API节点tomcat进程不存在时触发该告警。
告警属性
告警ID 告警级别 可自动清除
1150017
紧急 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称。
来源设备名称 产生告警信息的设备名称。
监控系统名称 产生告警信息的监控系统名称。
来源系统 告警来源。
IP地址 产生告警信息的云服务器的IP地址。
最近发生时间 此条告警信息最近一次发生时间。
附加信息 告警附加信息。
对系统的影响
服务不可用。
可能原因
服务未启动。
1

## Page 1098

前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤4 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤5 使用PuTTY，登录步骤4中确认的虚拟机。
默认帐号：fsp
步骤6 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
sudo su - root
步骤7 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤8 执行以下命令，切换apicom用户。
su -s /bin/bash apicom
步骤9 执行命令查看当前tomcat进程是否存在。
ps -ef | grep tomcat | grep apicom
apicom 3087 1 2 Apr25 ? 00:39:02 /opt/common/jre/bin/java
回显中的“3087”即为tomcat进程的进程号。
●
是，执行步骤10。
●
否，执行步骤11。
1

## Page 1099

步骤10 执行以下命令，停止tomcat进程。
kill -9
进程号
其中进程号为步骤9中获取的进程号。
步骤11 执行以下命令，重新启动进程。
sh /opt/apicom/tomcat/bin/startup.sh
步骤12 观察1分钟，查看该告警是否清除。
●
是，处理完毕。
● 否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.4.12.1.6 ALM-1150018
组合API 节点tomcat存在多进程
告警解释
同时存在不止一个tomcat进程时触发该告警。
告警属性
告警ID 告警级别 可自动清除
1150018
紧急 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称。
来源设备名称 产生告警信息的设备名称。
监控系统名称 产生告警信息的监控系统名称。
来源系统 告警来源。
IP地址 产生告警信息的云服务器的IP地址。
最近发生时间 此条告警信息最近一次发生时间。
附加信息 告警附加信息。
对系统的影响
系统服务不可用。
1

## Page 1100

可能原因
手动启动进程。
前提条件
已获取登录告警节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 观察1分钟，查看该告警是否清除。
●
是，处理完毕。
●
否，执行步骤2。
步骤2 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤3 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤4 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页。
步骤5 在“告警详情”页的“定位信息”中获取“主机IP”，即告警节点IP地址。
步骤6 使用PuTTY，登录步骤5中确认的虚拟机。
默认帐号：fsp
步骤7 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
sudo su - root
步骤8 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤9 执行以下命令，切换apicom用户。
su -s /bin/bash apicom
步骤10 执行以下命令 ，查看当前所有tomcat进程。
1

## Page 1101

ps -ef | grep tomcat | grep apicom
apicom 3087 1 2 Apr25 ? 00:39:02 /opt/common/jre/bin/java
回显中的“3087”即为tomcat进程的进程号。
步骤11 执行以下命令，停止所有tomcat进程。
kill -9
进程号
其中进程号为步骤10中获取的进程号。
步骤12 执行以下命令，启动进程。
sh /opt/apicom/tomcat/bin/startup.sh
步骤13 观察1分钟，查看该告警是否清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1.4.12.2
云硬盘
1.4.12.2.1 1060036
evs周期性检测cinder连通性失败
告警解释
EVS周期性检测cinder连通性失败。
告警属性
告警ID 告警级别 可自动清除
1060036
重要 是
告警参数
参数名称 参数含义
告警ID 告警ID
通知类型 告警
1

## Page 1102

参数名称 参数含义
告警级别 告警的严重级别：
1
紧急
2
重要
3
次要
4
提示
最近发生时间 此条告警信息最近一次发生时间。
定位信息 云服务 云服务名
主机地址 发送告警的主机地址
附加信息 云服务 云服务名
服务 服务名
Cinder URL
无法连通的Cinder节点的URL
错误信息 错误信息
对系统的影响
EVS与Cinder连接失败，EVS服务不可用。
可能原因
● Cinder
服务故障。
●
Cinder的网络故障。
● Cinder
URL的配置错误。
处理步骤
步骤1 查看告警附加信息，检查Cinder URL是否正确：
若附加信息中ErrorMessage包含“java.net.ConnectException:
Connection
refused”、“java.net.NoRouteToHostException:
No route to host (Host
unreachable)”、“java.net.UnknownHostException:”、“Name
or service not
known”等描述与Cinder间连接不可达的信息，说明Cinder URL不正确，请申请配置
变更，变更该节点的Cinder URL，具体操作可参考如下步骤：
1.
使用PuTTY，以“Reverse-Proxy”（在参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》中搜索）字段对应的IP地址登录FusionSphere
OpenStack节点。
默认帐号：fsp
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
2.
执行su root命令，输入root帐号密码，切换至root帐号。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
1

## Page 1103

3.
执行以下命令，导入环境变量。
source set_env
导入过程中，请输入1，选择环境变量“openstack
environment variable
(keystone
v3)”，输入dc_admin帐户密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
4.
执行以下命令查询cinder安装部署时的地址，服务名为cinder，接口属于public范
围的URL地址为cinder真实的地址：
openstack endpoint list | grep cinder
5.
使用PuTTY，依次以“CPT-SRV01”字段（在参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》中搜索）对应的IP地址登录“CPT-SRV01”节点，
以“CPT-SRV02”字段（在参数信息汇总文件《xxx_export_all_v2_CN.xlsx》中搜
索）对应的IP地址登录“CPT-SRV02”节点。
默认帐户：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
6.
执行以下命令，输入root帐号密码，切换至root帐号。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
7.
执行以下命令查看到云硬盘配置文件：
vim /opt/apicom/tomcat/taskmgr/WEB-INF/classes/taskmgr-
config.properties
在配置文件中查找“cinder.endpoint.publicurl”配置项的值，即EVS配置的cinder
地址：
对比两者，若不一致，取cinder真实的地址在配置文件中编辑更新该配置项。
步骤2 等待6分钟后，查看告警是否自动清除。
●
是，操作处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
参考信息
无。
1

## Page 1104

1.4.12.2.2
修改配置文件中对接其他组件或服务的帐户密码
操作场景
为了确保组合API与对接的组件或服务正常通信，当对方修改了对接的帐户密码，用户
需要同步修改组合API业务节点的配置文件中记录的对接组件或服务的帐户密码。
当以下组件或服务修改了帐户密码时，需要同步修改组合API业务节点的配置文件中记
录的信息。
●
ServiceOM的告警对接帐户
●
IAM对接帐户
前提条件
●
已准备跨平台远程访问工具，如“PuTTY”。
●
已获取对接组件或服务上配置的对接帐户密码。
● 已获取组合API业务节点的管理IP地址，fsp帐户的登录密码。
操作步骤
步骤1 使用PuTTY，依次以“CPT-SRV01”字段（在参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》中搜索）对应的IP地址登录“CPT-SRV01”节点，以
“CPT-SRV02”字段（在参数信息汇《xxx_export_all_v2_CN.xlsx》中搜索）对应的IP
地址登录“CPT-SRV02”节点。
默认帐户：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤2 执行以下命令，输入root帐号密码，切换至root帐号。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤3 执行以下命令，进入“bin”目录。
cd /opt/root/apicom/bin
步骤4 执行以下命令，修改IAM对接帐号taskmgr_admin的密码。
sh modify_password.sh taskmgr_admin
出现如下系统提示信息：
Enter the password to be encrypted.
根据提示输入新密码，按“Enter”。再次输入新密码，按“Enter”。
New password:
Retype new password:
若执行结果为“Tomcat started.”，则表示修改密码成功。
步骤5 执行以下命令，修改OperationCenter的告警对接帐号thirdparty的密码。
sh modify_password.sh thirdparty
1

## Page 1105

出现如下系统提示信息：
Enter the password to be encrypted.
根据提示输入新密码，按“Enter”。再次输入新密码，按“Enter”。
New password:
Retype new password:
若执行结果为"Tomcat started."，则表示修改密码成功。
步骤6 获取修改后帐号的密码。
●
执行以下命令，查看taskmgr_admin帐号的密码并保存。
获取apicom的taskmgr_admin帐号的密码密文：
cat /opt/apicom/tomcat/taskmgr/WEB-INF/classes/taskmgr-config.properties |
grep iam.auto.password
获取imcs的taskmgr_admin帐号的密码密文：
cat /opt/imcs/tomcat/taskmgr/WEB-INF/classes/taskmgr-config.properties |
grep iam.auto.password
●
执行以下命令，查看thirdparty帐号的密码并保存。
获取apicom的thirdparty帐号的密码密文：
cat /opt/apicom/tomcat/taskmgr/WEB-INF/classes/taskmgr-config.properties |
grep alarm.value
步骤7 在DMK平台上修改apicom上的taskmgr_admin帐号和thirdparty帐号的配置项。
1.
使用浏览器，登录DMK平台。
地址：https://DMK浮动IP:8443。可在HUAWEI
CLOUD Stack
Deploy工具导出的
参数信息汇总文件《xxx_export_all_v2_CN》的“portal”页签中获得登录地址。
默认帐号：apicom
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“A类（Portal）”页签
中，该帐户对应的默认密码。
2.
在左侧导航树中，选择“部署向导”。
3.
在“服务配置”栏，选择“服务”页签，并配置如下参数。
–
选择服务：APICombination。
–
选择版本：当前环境的apicombination服务版本，如8.1.0。
–
选择部署操作：升级。
4.
单击“下一步”，进入“节点和用户配置”页面。
5.
选择所属“组”与预先添加的“帐号”。
“组”选择“ApiCom”，“帐号”选择"apicombination(apicombination)"。
6.
修改配置文件中参数“iam_auto_password”为步骤6获取的apicom的
taskmgr_admin帐户密码密文。修改配置文件中参数“alarm_value”为步骤6获
取的apicom的thirdparty帐户密码密文。
7.
单击“保存”。
步骤8 在DMK平台上修改imcs上的taskmgr_admin帐号的配置项。
1.
使用浏览器，登录DMK平台。
地址：https://DMK浮动IP:8443。可在HUAWEI
CLOUD Stack
Deploy工具导出的
参数信息汇总文件《xxx_export_all_v2_CN》的“portal”页签中获得登录地址。
1

## Page 1106

默认帐号：imcs
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“A类（Portal）”页签
中，该帐户对应的默认密码。
2.
在左侧导航树中，选择“部署向导”。
3.
在“服务配置”栏，选择“服务”页签，并配置如下参数。
–
选择服务：ImageConvert。
–
选择版本：当前环境服务部署的版本，如8.1.0。
–
选择部署操作：升级。
4.
单击“下一步”，系统进入“节点和用户配置”。
5.
选择所属“组”与预先添加的“帐号”。
“组”选择“ApiCom”，“帐号”选择“imageconvert(imageconvert)”。
6.
修改配置文件中参数“iam_auto_password”为步骤6获取的imcs的
taskmgr_admin帐号密码密文。
7.
单击“保存”。
----结束
1.4.12.3
镜像服务
1.4.12.3.1 ALM-1131007
ntp进程不存在
告警解释
镜像转换节点的ntp进程不存在时，就会产生此告警。
告警属性
告警ID 告警级别 可自动清除
1131007
次要 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称。
来源设备名称 产生告警信息的设备名称。
监控系统名称 产生告警信息的监控系统名称。
来源系统 告警来源。
IP地址 产生告警信息的云服务器的IP地址。
最近发生时间 此条告警信息最近一次发生时间。
附加信息 告警附加信息。
1

## Page 1107

对系统的影响
影响镜像服务的功能正常运行，同时，可能导致磁盘中的数据随时会被删除。
可能原因
网络故障、ntp进程异常、ntp服务器下电或故障等。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 单击“登录”。
步骤3 在页面上方的菜单栏，选择“集中告警”，进入“集中告警”页面。
步骤4 在告警列表中，找到待处理的告警记录，单击“名称”列，弹出“告警详情和处理建
议”窗口。
步骤5 查询以下告警信息：
●
告警ID
●
告警来源设备名称
●
在告警信息的可能原因中获取云服务器的IP地址
步骤6 使用“PuTTY”工具，登录CPT-SRV01或CPT-SRV02节点。
登录地址：步骤5中获取的附加信息的IP地址
默认帐号：fsp。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤7 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
sudo su - root
步骤8 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤9 执行以下命令，检查网络是否正常。
ping
NTP服务器的IP地址
1

## Page 1108

●
是，执行步骤10。
●
否，请联系技术支持工程师协助解决。
步骤10 执行以下命令，查看ntp进程是否存在。
ps -ef |grep ntp
●
是，执行步骤11。
●
否，执行步骤12。
步骤11 执行以下命令，终止ntp进程。
kill -9
进程号
其中进程号为步骤10中查询到的进程号。
系统会自动启动ntp进程，如过长时间未自动启动进程，执行步骤12启动进程。
步骤12 执行以下命令，启动进程。
service ntp restart
步骤13 等待3分钟，观察告警通知是否消除？
●
是，任务结束。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.12.3.2 ALM-1131009
tomcat多进程
告警解释
当镜像转换服务器出现两个及以上的tomcat进程时，产生此告警。
告警属性
告警ID 告警级别 可自动清除
1131009
重要 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称。
1

## Page 1109

参数名称 参数含义
来源设备名称 产生告警信息的设备名称。
监控系统名称 对接系统的类型。
来源系统 对接系统的名称。
IP地址 产生告警信息的云服务器的IP地址。
最近发生时间 此条告警信息最近一次发生时间。
附加信息 告警附加信息。
对系统的影响
影响用户创建镜像。
可能原因
镜像转换服务器内部异常。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 单击“登录”。
步骤3 在页面上方的菜单栏，选择“集中告警”，进入“集中告警”页面。
步骤4 在告警列表中，找到待处理的告警记录，单击“名称”列，弹出“告警详情和处理建
议”窗口。
步骤5 查询以下告警信息：
●
告警ID
●
来源设备名称
●
IP地址
步骤6 使用“PuTTY”工具，登录CPT-SRV01或CPT-SRV02节点。
登录地址：步骤5中获取的附加信息的IP地址
默认帐号：fsp。
1

## Page 1110

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤7 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
sudo su - root
步骤8 执行以下命令，切换至“sysadmin”用户。
su sysadmin
步骤9 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤10 执行以下命令，是否有多个tomcat进程。
ps -ef| grep tomcat| grep imcs
●
是，步骤11。
●
否，步骤13。
步骤11 执行以下命令，终止所有tomcat进程。
kill -9
进程号
其中进程号为步骤10中查询到的进程号。
步骤12 执行以下命令，启动tomcat进程。
sh /opt/imcs/tomcat/bin/startup.sh
步骤13 等待3分钟，观察告警通知是否消除？
●
是，任务结束。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无
1.4.12.3.3 ALM-1131011
tomcat进程不存在
告警解释
镜像转换节点tomcat进程不存在，系统产生此告警。
1

## Page 1111

告警属性
告警ID 告警级别 可自动清除
1131011
重要 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称。
来源设备名称 产生告警信息的设备名称。
监控系统名称 对接系统的类型。
来源系统 对接系统的名称。
IP地址 产生告警信息的云服务器的IP地址。
最近发生时间 此条告警信息最近一次发生时间。
附加信息 告警附加信息。
对系统的影响
通过镜像文件创建镜像的功能异常。
可能原因
tomcat进程异常。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 单击“登录”。
步骤3 在页面上方的菜单栏，选择“集中告警”，进入“集中告警”页面。
步骤4 在告警列表中，找到待处理的告警记录，单击“名称”列，弹出“告警详情和处理建
议”窗口。
1

## Page 1112

步骤5 查询以下告警信息：
●
告警ID
●
来源设备名称
●
IP地址
步骤6 使用“PuTTY”工具，登录CPT-SRV01或CPT-SRV02节点。
登录地址：步骤5中获取的附加信息的IP地址。
默认帐号：fsp。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤7 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
sudo su - root
步骤8 执行以下命令，切换至“sysadmin”用户。
su sysadmin
步骤9 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤10 执行以下命令，查看tomcat进程是否存在？
ps -ef| grep tomcat| grep imcs
●
是，执行步骤11。
●
否，执行步骤12。
步骤11 等待3分钟，观察告警通知是否消除？
●
是，任务结束。
● 否，请联系技术支持工程师协助解决。
步骤12 执行如下命令，重启tomcat进程。
sh /opt/imcs/tomcat/bin/startup.sh
步骤13 参考步骤10，查看tomcat进程是否存在？
●
是，则等待3分钟观察告警是否消除。
–
是，处理结束。
–
否，请联系技术支持工程师协助解决。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 1113

参考信息
无。
1.4.12.3.4 ALM-1131012
tomcat进程
down
掉
告警解释
镜像转换节点tomcat进程异常，系统产生此告警。
告警属性
告警ID 告警级别 可自动清除
1131012
重要 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称。
来源设备名称 产生告警信息的设备名称。
监控系统名称 对接系统的类型。
来源系统 对接系统的名称。
IP地址 产生告警信息的云服务器的IP地址。
最近发生时间 此条告警信息最近一次发生时间。
附加信息 告警附加信息。
对系统的影响
通过镜像文件创建镜像的功能异常。
可能原因
tomcat进程异常等。
处理步骤
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
1

## Page 1114

–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 单击“登录”。
步骤3 在页面上方的菜单栏，选择“集中告警”，进入“集中告警”页面。
步骤4 在告警列表中，找到待处理的告警记录，单击“名称”列，弹出“告警详情和处理建
议”窗口。
步骤5 查询以下告警信息：
●
告警ID
●
来源设备名称
●
IP地址
步骤6 使用“PuTTY”工具，登录CPT-SRV01或CPT-SRV02节点。
登录地址：步骤5中获取的附加信息的IP地址
默认帐号：fsp。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤7 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
sudo su - root
步骤8 执行以下命令，切换至“sysadmin”用户。
su sysadmin
步骤9 执行以下命令，防止“PuTTY”超时退出。
TMOUT=0
步骤10 执行以下命令，查看tomcat进程是否存在？
ps -ef| grep tomcat| grep imcs
●
是，执行步骤11。
●
否，执行步骤12。
步骤11 等待3分钟，观察告警通知是否消除？
●
是，任务结束。
●
否，请联系技术支持工程师协助解决。
步骤12 执行如下命令，重启tomcat进程。
sh /opt/imcs/tomcat/bin/startup.sh
步骤13 参考步骤10，查看tomcat进程是否存在？
1

## Page 1115

●
是，则等待3分钟观察告警是否消除。
–
是，处理结束。
–
否，请联系技术支持工程师协助解决。
● 否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.12.4
弹性云服务器
1.4.12.4.1 ALM-1101308
连接ECS 数据库失败
告警解释
当组合 API的 数据库节点因各种原因宕机,或网络故障导致组合
API
节点无法连接数据
库时,产生此条告警。
告警属性
告警ID 告警级别 可自动清除
1101308
紧急 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称
来源设备名称 产生告警信息的设备名称
监控系统名称 对接系统的类型
来源系统 对接系统的名称
IP地址 产生告警信息的业务服务器的IP地址
发生时间 此条告警信息首次发生时间
定位信息
CloudService
云服务名称
HostIP
组合
API
主机
IP
附加信息
CloudService
云服务名称
1

## Page 1116

参数名称 参数含义
Service
服务名称
DatabaseIP
组合
API
数据库
IP
对系统的影响
ECS、EVS、IMS等在组合API中托管的服务无法正常使用。
可能原因
●
组合API的数据库节点服务异常。
●
网络异常。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在页面上方的菜单栏，选择“集中监控
>
告警管理
>
当前告警”。
步骤3 在告警列表中，找到待处理的告警记录，单击待处理告警行左侧的 ，进入“告警详
情”页，查询该告警的附加信息及定位信息。
步骤4 查看告警附加信息的“DatabaseIP”，使用ping命令，检查网络连通性。
步骤5 如果网络连接存在问题，请优先排除网络连接故障。如果经检查网络无故障，参考
1.4.12.4.4
登录FusionSphere OpenStack后台和1.4.12.4.5 导入环境变量，登录
FusionSphere
Openstack后台，执行步骤7。
步骤6 在FusionSphere OpenStack后台，登录数据库虚拟机节点。执行以下命令，查询PUB-
DB-01数据库节点IP。
nova list --all-t | grep PUB-DB-01
执行以下命令，切换到fsp用户。
su fsp
执行以下命令，切换到虚拟机数据库节点。
ssh
gaussdb@数据库节点IP
帐号：gaussdb
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
1

## Page 1117

步骤7 执行以下命令，切换到root用户。
sudo su - root
帐号：root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
执行以下命令，防止会话超时退出。
TMOUT=0
步骤8 执行以下命令，查询当前虚拟机是否为主虚拟机。
service had query
●
如果回显信息中包含“active”，则当前虚拟机为主虚拟机。
●
如果回显信息中不包含“active”，则当前虚拟机为备虚拟机。
回显信息类似如图1-16所示，查看回显信息中，主备节点的状态“STAT”栏是否
均为“Normal”。
图1-16 数据库状态
步骤9 执行以下命令，检查数据库配置是否正确。
service gaussdb query
●
“LOCAL_ROLE”的参数值为“Standby”。
●
“PEER_STATE”的参数值为“Normal”。
● “SYNC_PERCENT”的参数值为“100%”。
回显信息类似如图1-17所示，请关注红框内信息是否正确。
图1-17 数据库配置信息
1

## Page 1118

步骤10 如果数据库服务存在异常，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.12.4.2 ALM-1101312
ECS连接FSP失败
告警解释
ECS服务连接fsp失败时产生此告警，可能原因为ECS的URL配置不正确，需要变更该节
点的URL配置。
告警属性
告警ID 告警级别 可自动清除
1101312
紧急 是
告警参数
参数名称 参数含义
告警名称 此条告警信息的名称
来源设备名称 产生告警信息的设备名称
监控系统名称 对接系统的类型
来源系统 对接系统的名称
IP地址 产生告警信息的业务服务器的IP地址
发生时间 此条告警信息首次发生时间
定位信息
Service
产生此告警的服务名
附加信息 云服务 云服务名
服务 服务名
Fsp组件 组件名
对系统的影响
ECS服务无法正常使用。
1

## Page 1119

可能原因
ECS的URL配置不正确。
前提条件
已获取fsp、root用户的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用PuTTY，以“Reverse-Proxy”（在参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》中搜索）字段对应的IP地址登录FusionSphere
OpenStack节点。
默认帐户：fsp
步骤2 执行以下命令，输入root帐号密码，切换至root帐号。
sudo su root
步骤3 执行以下命令，导入环境变量。导入过程中，请输入1，选择环境变量“openstack
environment variable (keystone
v3)”。
source set_env
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
步骤4 执行以下命令查询
nova
安装部署时的地址。以下图为例，图示中的URL地址为nova
的准确地址：
openstack endpoint list | grep nova
步骤5 使用PuTTY，依次以“CPT-SRV01”和“CPT-SRV02”字段（在参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》中搜索）对应的IP地址登录两个节点。
默认帐户：fsp
步骤6 执行以下命令，输入root帐号密码，切换至root帐号。
sudo su root
步骤7 执行以下命令查看ECS的配置文件：
vim /opt/apicom/tomcat/taskmgr/WEB-INF/classes/taskmgr-config.properties
在配置文件中查找“nova.endpoint.publicurl”配置项的值，即ECS配置的nova地址：
1

## Page 1120

对比步骤4中获取的地址，若不一致，参考步骤4中获取的地址更新该配置项。
步骤8 执行以下命令查询
glance
安装部署时的地址。以下图为例，图示中的URL地址为
glance
的准确地址：
openstack endpoint list | grep glance
步骤9 使用PuTTY，依次以“CPT-SRV01”和“CPT-SRV02”字段（在参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》中搜索）对应的IP地址登录两个节点。
默认帐户：fsp
步骤10 执行以下命令，输入root帐号密码，切换至root帐号
sudo su root
步骤11 执行以下命令查看ECS的配置文件：
vim /opt/apicom/tomcat/taskmgr/WEB-INF/classes/taskmgr-config.properties
在配置文件中查找“glance.endpoint.publicurl”配置项的值，即ECS配置的 glance 地
址：
对比步骤8中获取的地址，若不一致，参考步骤8中获取的地址更新该配置项。
步骤12 执行以下命令，切换至apicom帐号。
su apicom
步骤13 执行如下命令重启apicom的进程：
sh /opt/apicom/tomcat/bin/shutdown.sh
sh /opt/apicom/tomcat/bin/startup.sh
步骤14 等待5分钟后，查看告警是否自动清除。
1

## Page 1121

●
是，操作处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
参考信息
无。
1.4.12.4.3 ALM-6043
主机组内vGPU使用率超过阈值
告警解释
OpenStack周期性（默认5分钟）检测主机组内每个类型的虚拟化GPU使用率，当检测
到某个类型的虚拟化GPU使用个数达到主机组内此类型的虚拟化GPU总个数的85%
时，系统将对此类型虚拟化GPU产生此告警。
当检测到该类型虚拟化GPU使用个数降低到主机组内虚拟化GPU总个数的70%时，告
警清除。
告警属性
告警ID 告警级别 可自动清除
6043
提示 是
告警参数
参数名称 参数含义
定位信息 主机组ID：虚拟化GPU所在的主机组ID
GPU类型：虚拟化GPU类型
附加信息
●
云服务：产生告警的云服务
●
服务：产生告警的服务
●
主机组名称：虚拟化GPU所在的主机组名称
●
虚拟化GPU总量：当前类型的虚拟化GPU总个数
●
虚拟化GPU使用量：当前VGPU类型的已使用的个数
●
阈值：虚拟化GPU分配率的阈值
1

## Page 1122

说明
虚拟化GPU总量、虚拟化GPU使用量及分配率的关系，参考如下示例。
主机组中有20张T4卡，其中，1张虚拟化GPU类型为T4-1Q，已分配了6个T4-1Q的vGPU设备给
虚拟机使用，18张虚拟化GPU类型为T4-2Q，已分配140个T4-2Q的vGPU设备给虚拟机使用，
另外1张卡闲置。
在这种情况下，一共有T4-1Q和T4-2Q两种虚拟化GPU类型。
对于T4-1Q，理论最大分配量为当前GPU卡以及1张闲置的GPU卡，一共2张T4卡，每张T4卡可
创建16个T4-1Q的vGPU设备，则当前T4-1Q的虚拟化GPU总个数16*2=32，当前T4-1Q的虚拟化
GPU使用量为6，分配率为6/32=18.75%。
对于T4-2Q，理论最大分配量为当前18张GPU卡以及1张闲置的GPU卡，一共19张T4卡，每张T4
卡可创建8个T4-2Q的vGPU设备，则当前T4-2Q的虚拟化GPU总个数为8*19=152，当前T4-2Q的
虚拟化GPU使用量为140，分配率为140/152=92.11%。
系统会上报T4-2Q使用率超过阈值。
对系统的影响
资源不足，导致创建虚拟化GPU云服务器失败。
可能原因
●
主机组内虚拟化GPU使用率过高。
●
主机组内的物理GPU卡被其他类型的虚拟化GPU使用。
说明
由于每个物理GPU只能创建同一种类型的vGPU设备，有可能出现主机组内GPU剩余显存还
很多，但是其他卡都已经被虚拟化为其他类型使用，而引发该告警。
处理步骤
步骤1 通过告警信息获取虚拟化GPU类型。
步骤2 参考《华为云Stack
8.1.0
资源发放指南》的“计算服务
>
弹性云服务(ECS)
>
常见问
题
>
支持的GPU虚拟化类型”章节，查询对应的物理GPU型号，增加相应类型的物理
GPU卡。
●
新增物理GPU卡后，执行步骤4。
●
无法新增物理GPU卡时，执行步骤3。
步骤3 当物理机上GPU卡的可用槽位都已经使用且无法增加新的GPU卡时，请参考《华为云
Stack 8.1.0
扩容指南》中的“扩容计算资源池
>
AZ内新增节点
>
AZ内新增KVM计算
节点”章节，扩容计算节点。
步骤4 虚拟化GPU使用率降低到70%时，检查告警是否清除。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决
----结束
告警清除
此告警修复后，系统会自动清除此告警，无需手工清除。
1

## Page 1123

参考信息
无
1.4.12.4.4
登录FusionSphere OpenStack后台
在系统经过SSH安全加固后，禁用了SSH通过口令认证的访问方式。本操作指导用户使
用PuTTY工具和认证所需的私钥，来登录待访问的节点。
前提条件
●
待访问节点已完成SSH的安全加固，包括：
–
启用SSH通过公私钥对认证的方式，且节点已经配置好公钥证书。
–
已禁用SSH通过口令认证的方式。
●
已获取与公钥证书匹配的私钥证书。如果私钥证书为加密证书，还需要获取私钥
证书的密码。
默认的私钥证书获取方式如下：
访问http://support.huawei.com并登录，网页右上角搜索“FusionSphere默认
公私钥”，通过搜索结果中的第一个条目（FusionSphere 默认公私钥【文档】）
获取证书。
操作步骤
步骤1 在当前的本地PC上，是否已经使用PuTTY工具，通过公私钥对认证方式登录过待访问
的节点？
●
是，执行步骤7。
●
否或无法确定，执行步骤2。
步骤2 运行PuTTY工具，在主界面，输入待访问节点的IP地址和SSH端口号（默认为22）。
步骤3 在左侧“Category”区域选择“Connection
> SSH >
Auth”。
进入SSH的认证配置界面。
步骤4 单击“Browse”，在弹出窗口中选择已获取的私钥证书，单击“打开”。
私钥证书文件名为“*.ppk”。当前默认的私钥证书为从版本发布路径获取的
“id_rsa.ppk”。
配置后如下图所示。
1

## Page 1124

图1-18 配置私钥证书
步骤5 在左侧“Category”区域选择“Session”。
进入主界面。
步骤6 为方便后续多次访问，在“Saved Sessions”中自定义会话名称，单击“Save”保存
会话。
如下图所示。
1

## Page 1125

图1-19 保存会话
该步骤执行完成后，跳转至步骤8。
说明
● Host Name (or IP
address)输入框ip（例如192.168.100.101）的获取方式：在“FCD生成的
LLD”文件中，搜索Reverse-Proxy，找到网络平面为external_api对应的IP地址。该IP地址即
为FusionSphere OpenStack的后台节点。
步骤7 选择已保存的会话，单击“Load”加载会话。
步骤8 单击“Open”开启会话。
步骤9 按要求输入访问节点的登录用户名，即可开始访问节点。
如果使用的私钥证书为加密证书，则还要按提示输入私钥证书的密码。
版本配套的默认私钥证书为加密证书
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
说明
● FusionSphere
OpenStack后台节点默认用户为fsp。
● 登录fsp用户后，输入命令su，切换到root用户。
●
切换到root用户后，一般需要参考1.4.12.4.5 导入环境变量，导入环境变量。
----结束
1

## Page 1126

1.4.12.4.5
导入环境变量
系统在安装完成后，默认打开鉴权模式，在执行CPS及OpenStack命令前，需要先导入
环境变量才能操作。系统提供了导入环境变量的快捷脚本，可直接执行脚本即可。
前提条件
●
已完成FusionSphere OpenStack第一台主机的安装。
●
已通过root用户登录主机。
操作步骤
步骤1 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤2 选择鉴权方式。
目前提供四种方式可供用户选择，使用内置DC管理员的Keystone V3鉴权、CPS鉴权、
Keystone
V2鉴权、使用内置云管理员的Keystone V3鉴权。请根据以下详细介绍按照
实际需求选择。
●
使用内置DC管理员的Keystone V3鉴权，输入“1”，按“Enter”，并按提示输
入“OS_USERNAME”的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
密码输入成功后如果有cps host-list和nova list命令的自动回显信息，则表示环
境变量导入成功。导入成功后系统使用内置DC管理员的Keystone V3鉴权。可以
正常执行CPS命令和OpenStack命令。
在OpenStack的Mitaka版本中，Keystone命令行接口做了归一化处理，全部封装
为OpenStack命令。在Identity service注册为V3路径时，原Keystone命令行在执
行tenant/role/service相关命令时会存在兼容性问题。请优先使用Keystone V3鉴
权，并使用同等功能的openstack project/role/service命令。
●
使用CPS的鉴权，输入“2”，按“Enter”，并按提示输入“CPS_USERNAME”
的用户名和密码。
默认帐户：cps_admin
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“cps_admin”帐户对应的默认密码。
输入完成后如果有cps host-list命令的自动回显信息，则表示环境变量导入成功。
使用CPS鉴权导入环境变量后只能执行CPS相关命令，无法执行OpenStack命令，
所以回显信息会在执行完nova list后提示“ERROR...”。
在未完全部署完成FusionSphere OpenStack之前，OpenStack鉴权还未启用，或
Keystone鉴权异常时，可使用CPS鉴权。
●
使用Keystone V2鉴权，输入“3”，按“Enter”，并按提示输入
“OS_USERNAME”的密码。
1

## Page 1127

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
密码输入成功后如果有cps host-list和nova list命令的自动回显信息，则表示环
境变量导入成功。导入成功后系统使用Keystone V2鉴权。可以正常执行CPS命令
和OpenStack命令。
●
使用内置云管理员帐号的Keystone V3鉴权，输入“4”，按“Enter”，并按提示
输入“cloud_admin”（内置的云管理员帐号）的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“cloud_admin”帐户对应的默认密码。
密码输入成功后如果有cps host-list和nova list命令的自动回显信息，则表示环
境变量导入成功。导入成功后系统使用内置云管理员帐号的Keystone V3鉴权。可
以正常执行CPS命令和OpenStack命令。
说明
●
在对接Service OM或ManageOne的情况下，请使用V3版本的鉴权方式。
●
如果执行的操作需要使用“cloud_admin”帐户权限（例如，使用PasswordManager命令
重置GaussDB数据库帐户密码），请使用内置云管理员帐号的OpenStack
Keystone
V3鉴
权。
●
如果导入环境变量时选择使用Keystone鉴权，但环境还未部署nova-api，将导致cps
host-
list回显成功，nova list回显异常，部署nova-api服务后即可正常使用nova相关命令。
步骤3 在多DC场景下，如果每个DC都部署了独立的glance，在每个DC导入环境变量时，还
需要执行以下命令，导入该DC的OS_IMAGE_URL。
export OS_IMAGE_URL=https://image.az.dc.domainname.com:443
az.dc.domainname.com:443为该DC中设置的glance域名。
----结束
1.4.12.4.6
登录Service
OM
界面
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面的“常用链接”导航栏中，单击“Service OM”，选择区域后进入Service
OM
界面。
----结束
1

## Page 1128

1.4.13 CloudScope
公共组件告警
表1-70 CloudScope公共组件告警
公共组件 告警ID 告警说明 参考手册 参考章节
CloudLVS 607004 BasicService_
LVS云服务
keepalived转
发组配置文件
异常
●
企业网：《公
有云运维平台
CloudLVS
20.12.2
版本
文档》
●
运营商：《公
有云运维平台
CloudLVS
20.12.2
版本
文档》
《CloudLVS
20.12.2
工具指导
书》
>
告警处理
607005 BasicService
云服务LVS后
端服务异常
CloudNgi
nx
- BasicService_
Nginx_nolive
upstream_ala
rm
●
企业网：《公
有云运维平台
CloudNginx
20.12.2
版本
文档》
●
运营商：《公
有云运维平台
CloudNginx
20.12.2
版本
文档》
《CloudNginx
20.12.2
工具指导
书》
>
告警处理
- BasicService_
paasnginx_40
4perhigh_alar
m
CloudMid
dleWareZ
ookeeper
CMC_900000
0229
cmw_zookee
per_process
●
企业网：《公
有云运维平台
CloudMiddle
WareZookee
per 1.1.5.1
版
本文档》
●
运营商：《公
有云运维平台
CloudMiddle
WareZookee
per 1.1.5.1
版
本文档》
《CloudMiddle
WareZookeeper
1.1.5.1 工具指导
书》 > 告警处理
CMC_900000
0230
cmw_zookee
per_ruok
1

## Page 1129

1.5
云服务告警
表1-71 HiCloud服务
服务 参考手册 参考章节
HiCloud
《HiCloud-VMware
1.0.14
用户指南》
参考
>
告警参考
Hicloud
《HiCloud-Security
1.0.14
用户指南》
参考
>
告警参考
表1-72 计算服务
服务 参考手册 参考章节
●
弹性云服务器
（ECS）
●
裸金属服务器
（BMS）
●
镜像服务
（IMS）
●
弹性伸缩
（AS）
《 计算服务
8.1.0
维护指南
(for
华为云Stack 8.1.0)》
《计算服务
8.1.0
故障管理(for 华
为云Stack 8.1.0)》
>
告警处理
表1-73 存储服务
服务 参考手册 参考章节
云硬盘（EVS） 《云硬盘(EVS)
8.1.1
维护
指南(for 华为云Stack
8.1.0)》
《云硬盘(EVS)
8.1.1
故障管理
(for
华为云Stack 8.1.0)》
>
告警
处理
弹性文件服务
（SFS）
《弹性文件服务(SFS) 8.1.1
维护指南(for 华为云Stack
8.1.0 )》
《弹性文件服务(SFS) 8.1.1 故障
管理(for 华为云Stack 8.1.0)》 >
告警处理
对象存储服务3.0
（OBS）
《对象存储服务3.0(OBS)
3.21.9.5h&s
维护指南(for
华为云Stack 8.1.0)》
《对象存储服务3.0(OBS)
3.21.9.5h&s
故障管理(for 华为云
Stack
8.1.0)》
>
告警处理
1

## Page 1130

表1-74 网络服务
服务 参考手册 参考章节
●
弹性IP
（EIP）
●
弹性负载均衡
（ELB）
●
云解析服务
（DNS）
● 网络ACL
（Network
ACL）
●
虚拟私有云
（VPC）
●
VPC终端节点
（VPCEP）
●
虚拟专用网络
（VPN）
●
云专线
（DirectConn
ect）
●
云连接服务
（CC）
《网络服务
8.1.0
维护指南
(for
华为云Stack 8.1.0)》
《网络服务
8.1.0
故障管理(for 华
为云Stack 8.1.0)》
>
告警处理
表1-75 灾备服务
服务 参考手册 参考章节
●
云硬盘备份
（VBS）
●
云服务器备份
（CSBS）
《备份服务(CSBS&VBS)
8.2.0
维护指南(for 华为云
Stack
8.1.0)》
《备份服务(CSBS&VBS)
8.2.0
故
障管理(for 华为云Stack 8.1.0)》
>
告警处理
● 云服务器容灾
服务
（CSDR）
●
云服务器高可
用（CSHA）
●
云硬盘高可用
（VHA）
《容灾服务
(CSDR&CSHA&VHA) 8.2.0
维护指南(for 华为云Stack
8.1.0)》
《容灾服务(CSDR&CSHA&VHA)
8.2.0
故障管理(for 华为云Stack
8.1.0)》
>
告警处理
1

## Page 1131

表1-76 容器服务
服务 参考手册 参考章节
云容器引擎服务
（CCE）
《云容器引擎服务(CCE)
21.9.5
维护指南(for 华为云
Stack
8.1.0)》
《云容器引擎服务(CCE)
21.9.5
故障管理(for 华为云Stack
8.1.0)》
>
告警参考
容器镜像服务
（SWR）
《容器镜像服务(SWR)
21.9.0
维护指南(for 华为云
Stack
8.1.0)》
《容器镜像服务(SWR)
21.9.0
故
障管理(for 华为云Stack 8.1.0)》
>
告警处理
应用服务网格
（ASM）
《 应用服务网格(ASM)
21.9.0
维护指南(for 华为云
Stack
8.1.0)》
《应用服务网格(ASM)
21.9.0
故
障管理(for 华为云Stack 8.1.0)》
>
告警处理
表1-77 安全服务
服务 参考手册 参考章节
●
安全指数服务
（SIS）
●
边界防火墙
（EdgeFW）
●
密钥管理服务
（KMS）
● 数据加密服务
（DEW）
●
数据库审计服
务（DBAS）
●
云防火墙
（CFW）
《安全服务(FusionGuard)
8.1.0.SPC1
维护指南(for 华
为云Stack
8.1.0
)》
《安全服务(FusionGuard)
8.1.0.SPC1
故障管理(for 华为云
Stack
8.1.0)》
>
告警参考
Web应用防火墙
（WAF）
《Web应用防火墙(WAF)
1.1.8.1
维护指南(for 华为云
Stack
8.1.0)》
《Web应用防火墙(WAF)
1.1.8.1
故障管理(for 华为云Stack
8.1.0)》
>
告警参考
企业主机安全服
务（HSS）
《企业主机安全(HSS)
1.17.4.1
维护指南(for 华为
云Stack 8.1.0)》
《企业主机安全(HSS)
1.17.4.1
故障管理(for 华为云Stack
8.1.0)》
>
告警参考
云堡垒机
（CBH）
《云堡垒机(CBH)
1.1.4.1
维
护指南(for 华为云Stack
8.1.0)》
《云堡垒机(CBH)
1.1.4.1
故障管
理(for 华为云Stack 8.1.0)》
>
告警参考
计算安全运营平
台(CSP)
《计算安全平台(CSP)
3.0.1.1
维护指南(for 华为云
Stack
8.1.0)》
《计算安全平台(CSP)
3.0.1.1
故
障管理(for 华为云Stack 8.1.0)》
>
告警参考
1

## Page 1132

服务 参考手册 参考章节
安全运营中心
(SOC)
《安全运营中心(SOC)
1.0.2.1
维护指南(for 华为云
Stack
8.1.0)》
《安全运营中心(SOC)
1.0.2.1
故
障管理(for 华为云Stack 8.1.0)》
>
告警参考
安全智能分析平
台服务（ISAP）
《安全智能分析平台(ISAP)
1.0.10.1
维护指南(for 华为
云Stack 8.1.0)》
《安全智能分析平台(ISAP)
1.0.10.1
故障管理(for 华为云
Stack
8.1.0)》
>
告警参考
数据安全中心
（DSC）
《数据安全中心(DSC)
1.1.1
维护指南(for 华为云Stack
8.1.0)》
《数据安全中心(DSC)
1.1.1
故障
管理(for 华为云Stack 8.1.0)》
>
告警参考
表1-78 数据库服务
服务 参考手册 参考章节
云数据库
（GaussDB(for
openGauss)）
《云数据库
GaussDB(for
openGauss) 2.6.7.210
维护
指南(for 华为云Stack
8.1.0)》
《云数据库
GaussDB(for
openGauss) 2.6.7.210
故障管理
(for
华为云Stack 8.1.0)》
>
告
警处理
数据复制服务
（DRS）
《数据复制服务(DRS)
2.6.7.210
维护指南(for 华为
云Stack 8.1.0)》
《数据复制服务(DRS)
2.6.7.210
故障管理(for 华为云Stack
8.1.0)》> 告警处理
文档数据库服务
（DDS）
《文档数据库服务(DDS)
2.6.7.210
维护指南(for 华为
云Stack 8.1.0)》
《文档数据库服务(DDS)
2.6.7.210
故障管理(for 华为云
Stack
8.1.0)》
>
告警处理
云数据库
（RDS）
《云数据库(RDS)
2.6.7.200
维护指南(for 华为云Stack
8.1.0)》
《云数据库(RDS)
2.6.7.200
故障
管理(for 华为云Stack 8.1.0)》
>
告警处理
表1-79 应用服务
服务 参考手册 参考章节
应用与数据集成
平台（ROMA
Connect）
《应用与数据集成平台
(ROMA Connect) 1.7.1
维
护指南(for 华为云Stack
8.1.0)》
《应用与数据集成平台(ROMA
Connect) 1.7.1
故障管理(for 华
为云Stack 8.1.0)》
>
告警处理
分布式缓存服务
（DCS）
《分布式缓存服务(DCS)
1.7.1
维护指南(for 华为云
Stack
8.1.0)》
《分布式缓存服务(DCS)
1.7.1
故
障管理(for 华为云Stack 8.1.0)》
>
告警参考
1

## Page 1133

服务 参考手册 参考章节
应用管理与运维
平台
（ServiceStage
）
《应用管理与运维平台
(ServiceStage) 1.7.1
维护
指南(for 华为云Stack
8.1.0)》
《应用管理与运维平台
(ServiceStage) 1.7.1
故障管理
(for
华为云Stack 8.1.0)》
>
告警
参考
应用运维管理
（AOM）
《应用运维管理(AOM)
1.7.1
维护指南(for 华为云
Stack
8.1.0)》
《应用运维管理(AOM)
1.7.1
故
障管理(for 华为云Stack 8.1.0)》
>
告警参考
区块链服务
（BCS）
《区块链服务(BCS)
1.7.1
维
护指南(for 华为云Stack
8.1.0)》
《区块链服务(BCS)
1.7.1
故障管
理(for 华为云Stack 8.1.0)》
>
告
警参考
应用性能管理
(APM)
《应用性能管理(APM)
1.7.1
维护指南(for 华为云Stack
8.1.0)》
《应用性能管理(APM)
1.7.1
故
障管理(for 华为云Stack 8.1.0)》
>
告警参考
表1-80 EI企业智能服务
服务 参考手册 参考章节
MapReduce服务
（MRS）
《MapReduce服务(MRS)
3.1.2-LTS
维护指南(for 华为
云Stack 8.1.0)》
《MapReduce服务(MRS)
3.1.2-
LTS
故障管理(for 华为云Stack
8.1.0)》
>
告警处理
数据仓库服务
（DWS）
《数据仓库服务(DWS)
8.1.1.5
维护指南(for 华为云
Stack
8.1.0)》
《数据仓库服务(DWS)
8.1.1.5
故障管理(for 华为云Stack
8.1.0)》
>
告警处理
数据湖治理中心
（DGC）
《数据湖治理中心(DGC)
2.9.0.1
维护指南(for 华为云
Stack
8.1.0)》
《数据湖治理中心(DGC)
2.9.0.1
故障管理(for 华为云Stack
8.1.0)》
>
告警处理
ModelArts
《
ModelArts 3.3.0
维护指
南(for 华为云Stack 8.1.0)》
《ModelArts
3.3.0
故障管理(for
华为云Stack 8.1.0)》
>
告警参
考
图引擎服务
（GES）
《图引擎服务(GES)
2.2.23
维护指南(for 华为云Stack
8.1.0)》
《图引擎服务(GES)
2.2.23
故障
管理(for 华为云Stack 8.1.0)》
>
告警处理
表1-81 物联网服务
服务 参考手册 参考章节
IoT设备接入
（IoTDA）
《IoT设备接入(IoTDA)
21.9.0
维护指南(for 华为云
Stack
8.1.0)》
《IoT设备接入(IoTDA)
21.9.0
故障管理(for 华为云Stack
8.1.0)》
>
告警处理
1

## Page 1134

服务 参考手册 参考章节
IoT数据分析
（IoTA）
《IoT数据分析(IoTA)
21.9.0
维护指南(for 华为云Stack
8.1.0)》
《IoT数据分析(IoTA)
21.9.0
故
障管理(for 华为云Stack 8.1.0)》
>
告警处理
路网数字化服务
（DRIS）
《路网数字化服务(DRIS)
21.9.0
维护指南(for 华为云
Stack
8.1.0)》
《路网数字化服务(DRIS)
21.9.0
故障管理(for 华为云Stack
8.1.0)》
>
告警处理
1

## Page 1135

2
故障处理
2.1
通用故障处理
2.1.1
故障处理原则
1.
故障分析、定位和处理原则：
–
以尽快恢复系统为原则。
–
定位故障时，应及时采集故障数据信息，并尽量将采集到的故障数据信息保
存在移动存储介质中或网络中其它计算机中。
–
在确定故障处理的方案时，应先评估影响，优先保证业务的正常传送。
–
第三方的硬件故障，可查看第三方的相关资料或拨打第三方公司的服务电
话。
–
如果无法定位出故障点或无法按手册解决故障，中国区可以拨打华为公司24
小时问题受理电话：400-830-2118，其他地区也可以直接联系当地的华为全
球TAC服务中心，以获取技术支持，最大程度减少业务中断时间。
2.
定位处理前注意事项：
–
严格遵守操作规程和行业安全规程，确保人身安全与设备安全。
–
应先分析故障现象，定位原因后再进行处理。在原因不明的情况下应避免盲
目操作，导致问题扩大化。
–
在处理故障前，需要保留好故障现场的任何记录，不能随意删除数据或日
志。
–
在处理故障时，为了确保客户网络的安全和隐私，如果需要采集相关故障日
志，请事先得到客户的同意。
–
在进行任何修改前，应先通过脚本导出、手工备份等方式备份数据。
– 更换和维护设备部件过程中，要做好防静电措施，佩戴防静电腕带。
–
在维护过程中遇到的任何问题，应详细记录各种原始信息。
–
所有的重大操作，如重启进程均应作记录，并在操作前仔细确认操作的可行
性，在作好相应的备份、应急和安全措施后，方可由有资格的操作人员执
行。
–
在系统恢复后，必须对运行情况进行观察，确认故障已经排除并及时填写相
关的处理报告。
2

## Page 1136

–
慎重使用高危操作及命令，详情请参见《华为云Stack
8.1.0
运维指南》中的
“高危操作”章节。
3.
对维护人员的要求：
–
具备网络设备、操作系统和数据库基础知识，掌握其常用的操作命令，并能
熟练使用它们开展维护工作。
–
熟知现场华为云Stack业务系统的逻辑结构、华为云Stack业务系统各部件和
现场设备的对应关系以及现场设备之间的物理连接关系。
–
熟悉华为云Stack业务流程、系统结构，能熟练操作业务相关的部件。
–
了解基本故障相关定位和处理方法。
–
掌握远程接入方式的使用。
2.1.2
故障处理流程和方法
故障处理总体流程主要分为四个过程：信息收集、判断、定位和排除。
说明
处理重大故障前，请先联系技术支持工程师协助解决。
在故障处理过程中，维护人员可能需要执行修改配置数据、重启虚拟机等重大操作，为确保数据
安全，首先应该保存现场数据，备份相关数据库、告警信息和日志文件等。
2

## Page 1137

图2-1 故障处理流程
故障信息收集
故障信息是故障处理的重要依据，系统维护人员应尽可能多的收集故障信息。
故障判断
排除故障之前，系统维护人员根据收集的故障详细信息，对故障范围和类型进行判
断。
故障定位
故障定位是指从众多可能原因中找出故障原因的过程。通过一定的方法或手段分析、
比较各种可能的故障成因，不断排除非可能因素，最终确定故障发生的具体原因。
以下是故障定位的常用方法：在ManageOne运维面查看告警、日志信息。
2

## Page 1138

故障排除
故障排除是指根据不同的故障原因清除故障的过程。故障排除包括检修网络线路、修
改配置数据、重启相关进程、重启服务器等。
说明
当系统维护人员无法自行排除故障时，请联系技术支持工程师协助解决。
确认故障是否被排除
通过查询设备状态和告警等方法确认系统已正常运行，并进行相关业务调测以确保业
务正常。
记录故障处理过程
故障排除后应记录故障处理要点，给出针对此类故障的防范和改进措施，避免同类故
障再次发生。
联系华为技术支持
●
客户服务邮箱：support@huawei.com
●
技术支持网站：http://support.huawei.com/enterprise
说明
当地办事处联系方式请查阅技术支持网站。
2.1.3
操作过程关键信息获取
为了简化资料规模，针对如何获取登录过程中需要的虚拟机IP等公共操作内容，并未
在具体步骤中体现，在本章节进行统一介绍，具体如表2-1所示。
说明
在获取IP、帐号密码等参数信息时，由于单Region和多Region场景在部署架构上存在差异，软
件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》在每个Region的安装过程中，都会导出一份，请参考以下指引获
取。
●
Global级别的组件，如ManageOne、云服务Console、LVS、Nginx等。
● 在非CSDR（管理面跨Region容灾）场景下，请从首Region获取参数。
●
在CSDR（管理面跨Region容灾）场景下，请区分主Region和备Region，分别获取参
数。
●
Region级别的组件，如FusionSphere OpenStack、Service OM、云服务Service、DMK、
HAProxy等，请从每个Region分别获取参数。
表2-1 关键信息
序号 操作中关键信息 具体获取途径
1
xxx面 请参考软件安装阶段HUAWEI
CLOUD Stack
Deploy导出
的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》的
“portal”页签搜索节点对应的xxx面登录信息。
2

## Page 1139

序号 操作中关键信息 具体获取途径
2
虚拟机/节点IP 请参考软件安装阶段HUAWEI
CLOUD Stack
Deploy导出
的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》的
“VM信息总览”页签搜索虚拟机对应的IP信息。
3
常用的IP参数 请参考软件安装阶段HUAWEI
CLOUD Stack
Deploy导出
的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》的
“工具生成的IP参数”页签搜索IP参数信息。
例如：Reverse-Proxy参数请使用“工具生成的IP参数”
页签查找。
4
物理机IP 请参考项目LLD获取。
5
帐号默认密码 默认密码请参考《华为云Stack
8.1.0
帐户一览表》。
说明
● 华为云Stack默认部署完成，进入运维阶段后，默认用户使用
《华为云Stack 8.1.0 帐户一览表》进行后续运维操作。
●
因运维阶段安全要求，系统要求用户定期更改默认密码，用
户系统管理员需定期刷新《华为云Stack
8.1.0
帐户一览
表》。
2.1.4
收集故障信息
2.1.4.1
声明
在信息收集操作过程中，请严格遵守以下原则：
●
任何维护操作必须得到客户的授权，禁止进行超出客户审批范围的任何维护操
作。
●
将问题定位数据传出客户网络必须得到客户的授权。
2.1.4.2
基本信息收集
●
收集局点信息
故障发生后，作为问题定位的首要条件，通过收集局点信息，让技术支持及研发人员
快速了解现场的情况，同时，反馈现场工程师的联系电话，保证联络渠道的畅通。
需收集的局点信息如表2-2所示。
表2-2 局点信息收集表
运营商或企业 局点 组网图附件 现场工程师姓
名/电话
客户姓名/电话
版本信息
- - - -
远程维护信息
- - - -
2

## Page 1140

●
收集基本故障信息
通过基本故障信息，可大概了解现场发生的问题、目前的状态、产生故障前的设备状
态和引起故障的可能因素。具体信息如表2-3所示。
表2-3 基本故障信息收集表
待收集现场 现场反馈结果
故障现象描述
-
故障出现时间
-
故障出现的频率
-
业务影响程度
-
当前故障是否已经处理
-
问题出现时，是否有相关系统进行过调
整或者任何操作
-
对维护过程中出现的问题所实施的操作
-
问题出现后，是否采用什么措施进行处
理
-
对问题进行处理后，达到的效果
-
现场有无明显的告警信息
-
现场告警信息是否已经收集
-
2.1.4.3
告警信息收集
在ManageOne运维面上查看和收集告警信息，具体告警信息请参见《华为云Stack
8.1.0
运维指南》。
2.1.4.4
基于
AutoOps
故障场景信息收集列表
本章节适用于ManageOne故障场景信息收集，在ManageOne运维面上收集故障场景
信息。具体的故障场景编排清单请参见《ManageOne
AutomationScripts
使用指
南》中“故障编排清单”章节。
2.2
典型故障场景及常用故障工具
2.2.1
云平台故障诊断（调用链）
本章节通过查看操作日志、集中告警、收集日志等，诊断云服务发放失败和云服务实
例操作失败问题。
2

## Page 1141

说明
● HCS
Online场景，不支持云平台故障诊断（调用链）功能。
●
华为云Stack场景，云平台故障诊断（调用链）不支持纳管的IaaS OpenStack资源池和两级
运维场景。
现象描述
●
云服务发放失败，如创建弹性云服务器、云硬盘、创建虚拟网络失败等。
●
云服务实例操作失败，如挂载云硬盘失败、挂载虚拟网卡失败等。
可能原因
●
资源池中计算、存储、网络资源不足。
●
弹性云服务器、云硬盘等配置错误。
2

## Page 1142

诊断流程
前提条件
●
ManageOne完成资源池接入。
2

## Page 1143

●
已部署LogCenter服务。
●
操作用户所属角色为“Administrators”角色或具有故障诊断的“资源查询权限”
和“列设置”权限。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“日常运维
>
故障诊断
>
云平台故障诊断（调用链）”，进入云平台
故障诊断（调用链）页面。
排查操作日志
步骤3 在左侧导航栏中单击“操作日志”，进入操作日志界面，查看操作日志，具体方法请
参见《ManageOne
8.1.0
运维指南》中“租户操作日志”章节。
步骤4 输入“操作日志ID”，查询本次失败的操作日志。操作日志ID请参见3.12 操作日志ID
的获取方法进行获取。
如果查询结果为空，请联系技术支持工程师协助解决。
步骤5 在存在故障的日志行左侧，单击 ，查看日志详情。
步骤6 是否可以解决故障。
●
是，处理完毕。
●
否，执行步骤7。
步骤7 单击当前处理日志行右侧的调用链链接，进入本次“拓扑”页面，通过该页面可以查
看组件的调用关系，确定异常组件，实现问题定界。相关说明如表2-4所示。
图2-2 拓扑信息
2

## Page 1144

表2-4 拓扑信息
参数 展示说明 相关操作
正常 绿色光圈的节点表示正常的节点，代
表无错误的组件。
单击红色光圈节点弹出对
应组件的异常信息，单击
绿色光圈节点弹出对应组
件的IP地址。
异常 红色光圈的节点表示异常的节点，代
表有错误的组件。
首节点 灰色背景的节点表示首节点，代表调
用的起始组件。
All
当前服务在本次操作请求的总次数。
-
error
当前服务在本次操作请求失败次数。
-
步骤8 单击红色光圈节点，弹出对应组件的“异常信息”数据。
步骤9 单击任意异常数据，可跳转到本次“Trace详情”页面。关键参数和对应操作如表2-5
所示。
表2-5 Trace详情
展示名称 相关说明
ID
指Trace ID，是一次业务调用产生的Trace信息的
唯一标识。
URL
服务打点的入口处URL。
方法 执行方法。
响应 服务入口处调用返回的http响应码。
耗时 整个调用耗费的时间。
生成时间 服务调用的起始时间。
服务名称 服务的名称。
状态
详细信息中“状态”列为 表示日志正常，为
表示日志异常。
操作/URL 操作方法与服务打点的入口处URL。
时间轴 业务执行时请求响应的时长。
步骤10 单击指定“操作/URL”的链接，弹出“详情”窗口，如图2-3所示。
2

## Page 1145

图2-3 详情
步骤11 单击“异常分析”页签可以查看并分析本次调用及调用异常的详细信息，如图2-4所
示。
“Request ID”和“Job ID”是关联业务日志的ID。
图2-4 异常分析
步骤12 在当前日志信息不足以支撑定位的情况下，执行步骤13~步骤14下载日志并排查分
析。
步骤13 单击“Trace详细信息”页面的“日志收集”页签，进入日志收集页面。
步骤14 单击“日志收集”，下发日志收集任务 ，等任务状态为100%之后，单击“日志下
载”进行下载日志。
2

## Page 1146

步骤15 根据下载的日志进行故障分析并处理故障，如果无法找出故障原因，请联系技术支持
工程师协助解决。
步骤16 故障是否已解决。
●
是，处理完毕。
●
否，执行步骤17。
排查告警信息
步骤17 在“云平台故障诊断（调用链）”页面，单击左侧导航栏中“集中告警”，进入集中
告警页面。
步骤18 排查是否存在相关未恢复的告警，根据告警在线帮助处理告警。
步骤19 故障是否解决。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决，提供步骤15中已经收集的Trace日志，执行
步骤20。
步骤20 技术支持人员通过分析已经提供的Trace日志，制定故障处理方案。
根据技术人员的方案是否可以解决故障。
●
是，处理完毕。
●
否，执行步骤21。
收集日志信息
步骤21 在“云平台故障诊断（调用链）”页面，单击左侧导航栏中“日志收集”，进入日志
收集页面。
进行日志收集，根据技术支持给出的日志收集方案收集日志。
说明
收集日志的操作，请参见《ManageOne
8.1.0
运维指南》中“下载管理侧运行日志”章节收集
日志。
步骤22 是否可以解决故障。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
2.2.2 ECS
网络故障诊断
本章节通过执行拨测、业务流抓包等操作，诊断弹性云服务器在云平台内部的网络不
通问题。
说明
● HCS
Online场景，不支持ECS网络故障诊断功能。
●
华为云Stack场景，仅支持FusionSphere OpenStack资源池。
2

## Page 1147

现象描述
●
租户业务流量不通，网络断流问题。
●
租户业务流量时断时续，网络丢包问题。
可能原因
●
弹性云服务器下电。
●
弹性云服务器配置错误。
● 弹性云服务器所在主机存在问题。
●
外部物理网络不通。
●
网关服务器存在问题导致流量中断或者丢包。
前提条件
●
ManageOne已成功对接FusionSphere OpenStack。
●
已安装网络诊断工具。
●
操作用户所属角色为“Administrators”角色或具有故障诊断的“资源查询权限”
和“列设置”权限。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“日常运维 > 故障诊断 > ECS网络故障诊断”。
进入ECS网络故障诊断页面。
步骤3 单击“诊断”，进入CloudNetDebug“任务管理”页面。
●
批量诊断
a.
在“ECS网络故障诊断”界面，勾选 选中多个目标弹性云服务器。
b.
单击页面左上方的“诊断”，进入CloudNetDebug“任务管理”页面。
●
单个诊断
a.
选择搜索类型，输入关键字，按“Enter”。查找出目标弹性云服务器。
b.
单击“操作”列下的“诊断”，进入CloudNetDebug“任务管理”页面。
步骤4 选择网络诊断任务场景，具体操作方法请参见《CloudNetDebug
8.1.0
工具指导书》
中的“使用指南
>
工具功能介绍
>
任务管理”章节。
----结束
2.2.3 ECS
存储故障诊断
本章节通过查看弹性云服务器详细信息、收集弹性云服务器关联的告警、云硬盘性能
监控数据等，诊断弹性云服务器云硬盘的I/O性能问题。
2

## Page 1148

说明
● HCS
Online场景，不支持ECS存储故障诊断功能。
● 华为云Stack场景，仅支持FusionSphere OpenStack资源池。
现象描述
弹性云服务器的云硬盘I/O读写慢，虚拟机业务运行受损。
可能原因
●
弹性云服务器配置错误。
●
存储设备问题，例如存储设备故障、存储设备性能不足等问题。
●
存储链路问题。
诊断流程
2

## Page 1149

前提条件
●
ManageOne已成功对接FusionSphere OpenStack。
●
操作用户所属角色为“Administrators”角色或具有故障诊断的“资源查询权限”
和“列设置”权限。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“日常运维
>
故障诊断
>
ECS存储故障诊断”，进入ECS存储故障诊断
页面。
步骤3 选择搜索类型，输入关键字，按“Enter”。查找出目标弹性云服务器。
步骤4 单击“操作”列的“诊断”，进入诊断页面。
步骤5 在“ECS详细信息”区域右侧查看弹性云服务器的状态是否存在异常。
●
是，请参见3.11 虚拟机状态异常进行异常处理。
●
否，执行步骤6。
步骤6 在“ECS告警信息”区域排查是否存在告警。
●
是，根据告警在线帮助处理告警。
● 否，执行步骤7。
步骤7 在“分析云硬盘性能监控数据”区域查看目标云设备的性能是否存在异常。
说明
●
如果支持查看历史性能指标，可单击“操作”列的“历史性能”，查看当前资源某个时间段
内的历史性能指标。
●
如果支持查看实时性能指标，可单击“操作”列的“实时性能”，查看当前资源实时性能指
标。
●
单击“操作”列“资源同步”，可同步更新云硬盘的历史和实时性能监控数据。
●
是，请联系技术支持工程师协助解决。
●
否，处理完毕。
----结束
2.2.4 ManageOne
工具箱
集中管理维护常用的工具，提升自主运维的能力。常用的工具包含启停一个或多个应
用实例、处理日常故障。
2.2.4.1
启停应用实例
当发现某一个或多个应用实例运行状态异常时，管理员可以通过ManageOne工具箱的
启停操作工具启动、停止或重启一个或者多个应用实例，及时降低风险。
2

## Page 1150

前提条件
●
管理员具有ManageOne工具箱管理权限。
●
已登录ManageOne运维面。
操作步骤
步骤1 在主菜单中选择“日常运维
>
故障诊断
>
ManageOne工具箱”。
步骤2 进入“ManageOne工具箱”页面，单击“启停操作”。
步骤3 勾选需要启动、停止或者重启的应用实例。
●
单击“启动”，启动应用实例。
●
单击“停止”，停止应用实例。
●
单击“重启”，重启应用实例。
----结束
2.2.4.2
维护操作案例
日常维护中，需要使用ES数据平台维护（包括查询数据、删除索引、查询索引的配
置、查询全量索引、查询集群信息、查询异常索引、分片强制恢复和查询未分配的分
片）、三方系统接入校验等维护操作时，管理员可以在ManageOne工具箱，选择“故
障处理”工具，根据维护操作的案例名称搜索案例，执行案例，辅助处理相应故障。
前提条件
●
管理员具有ManageOne工具箱管理权限。
●
已登录ManageOne运维面。
操作步骤
步骤1 在主菜单中选择“日常运维
>
故障诊断
>
ManageOne工具箱”。
步骤2 进入“ManageOne工具箱”页面，单击“故障处理”。
步骤3 在右侧搜索框可以根据故障“案例名称”搜索具体的维护操作案例。
目前支持的案例名称及使用场景见表2-6中所示。
表2-6 案例描述及使用场景
案例名称 使用场景 系统影响
ES数据平台维护-查
询数据
当容量、报表、大屏、服务监控页面查询
数据慢，或者查询无数据时，用来查询某
个或某几个索引下的数据。
对系统没有影
响。
ES数据平台维护-查
询全量索引
当容量、报表、大屏、服务监控页面查询
数据慢，或者查询无数据时，用来查询ES
的索引数，以及查询某个或者某些索引的
健康状态。
对系统没有影
响。
2

## Page 1151

案例名称 使用场景 系统影响
ES数据平台维护-查
询索引的配置
当容量、报表、大屏、服务监控页面查询
数据慢，或者查询无数据时，用来查询某
索引的配置信息。
对系统没有影
响。
ES数据平台维护-删
除索引
当索引损坏无法恢复的情况下，需要删除
索引对应的数据恢复集群状态。
该操作会引起数
据丢失，请谨慎
操作。
ES数据平台维护-查
询集群信息
当容量、报表、大屏、服务监控页面查询
数据慢，或者查询无数据时，用来查询检
查ES的健康状况，或者查询ES的所有节点
时使用。
对系统没有影
响。
三方系统接入用户校
验
当三方系统对接ManageOne运维面失败
时，用来校验对接帐户的密码是否正确。
对系统没有影
响。
ES数据平台维护-查
询异常索引
当容量、报表、大屏、服务监控页面查询
数据异常或者查询无数据时，用来查询ES
当前所有状态异常的索引名。
对系统没有影
响。
ES数据平台维护-分
片强制恢复
当索引分片未分配且ES无法恢复的情况
下，执行强制恢复操作，修复索引状态。
该操作会引起数
据丢失，请谨慎
操作。
ES数据平台维护-查
询未分配的分片
当容量、报表、大屏、服务监控页面查询
数据异常或者查询无数据时，用来查询某
索引的分片未分配信息。
对系统没有影
响。
步骤4 在案例列表中，选择搜索到的案例，单击“操作”列中对应的“执行”。
步骤5 如果该案例需要配置基本参数，进入参数列表页面，根据界面提示配置基本参数。
不同的案例参数不同，下图中只是一种举例。单击“立即执行”。
步骤6 提示执行该案例产生的影响，确认是否继续执行该案例，单击“确定”，执行案例。
执行过程中，页面下方会显示当前案例执行过程的日志信息。
●
等待执行完成，提示如下信息时，说明执行成功。
2

## Page 1152

●
等待执行完成，提示如下信息时，说明执行失败。
说明
不同的案例，产生的影响会不同，提示信息会有差异。
步骤7 单击“是”，下载执行结果包。结果包中包含收集的日志文件、配置文件等信息。
●
如果需要查看结果包，下载后保存至本地，可查看执行结果包。
●
如果案例执行失败，下载后保存结果包，联系技术支持工程师协助解决。
●
如果需要删除该案例，单击“操作”列中对应的“删除”。
● 如果需要查看该案例执行的详细信息以及历史记录，单击“操作”列中对应的
“查看详情”。
说明
每个案例最多保存100条历史记录，超期历史任务将被自动删除。
–
详细信息包含案例名称、描述以及操作影响。
–
历史执行记录包含执行开始时间、执行结束时间、执行状态等。
▪
单击“下载结果包”，可下载案例执行的结果包。
▪
单击“查看日志详情”，可查看案例执行的日志详情。
----结束
导入案例
当管理员有新增的维护操作案例时，可以联系技术支持制作案例文件和签名文件，按
照如下方法导入案例至系统中。
步骤1 在主菜单中选择“日常运维
>
故障诊断
>
ManageOne工具箱”。
步骤2 进入“ManageOne工具箱”页面，单击“故障处理”。
步骤3 在故障处理页面，单击“导入案例”。
2

## Page 1153

步骤4 分别单击“浏览”，选择要上传的案例文件和签名文件，单击“确定”。
说明
案例文件仅支持zip格式，签名文件仅支持asc格式。
步骤5 在案例列表，查看新导入的案例。
----结束
相关操作
当管理员需要执行案例时，却无法登录ManageOne运维面，请执行以下操作执行案
例。
步骤1 使用PuTTY工具以sopuser用户登录MOMaintenanceService服务所在的节点。
说明
MOMaintenanceService服务所在的节点为ManageOne-Service01/02节点或ManageOne-
AppServer0X的任意一个节点。
默认帐户：sopuser。
默认密码：请参考《华为云Stack
8.1.0
帐户一览表》中“A类（后台）”页签中，
ManageOne产品中该帐户的默认密码。
步骤2 执行如下命令，切换至ossadm帐户。
su - ossadm
默认密码：请参考《华为云Stack
8.1.0
帐户一览表》中“B类（ManageOne）”页签
中该帐户的默认密码。
步骤3 执行如下命令，切换目录。
cd /opt/oss/Product/apps/MOMaintenanceService/bin/
说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
步骤4 输入如下命令，执行故障案例脚本。
sh shootCase.sh
显示所有案例信息，第一列为案例ID，第二列为案例名称。案例信息如下：
Case List:
----------------------------------------------------------+----------------------------------------------
Case Id | Case Name
----------------------------------------------------------+----------------------------------------------
manageOne_es_query_index | ES数据平台维护-查询数据
----------------------------------------------------------+----------------------------------------------
manageOne_es_delete_index | ES数据平台维护-删除索引
----------------------------------------------------------+----------------------------------------------
manageOne_es_index_setting | ES数据平台维护-查询索引的配置
----------------------------------------------------------+----------------------------------------------
manageOne_es_all_indices | ES数据平台维护-查询全量索引
----------------------------------------------------------+----------------------------------------------
manageOne_third_party_user_check | 三方系统接入用户校验
----------------------------------------------------------+----------------------------------------------
manageOne_es_cluster_info | ES数据平台维护-查询集群信息
----------------------------------------------------------+----------------------------------------------
2

## Page 1154

步骤5 选择要执行的案例，输入对应案例ID并按“Enter”。
例如：要执行“三方系统接入用户校验”这个案例，需要输入
manageOne_third_party_user_check。
Please enter the case ID: manageOne_third_party_user_check
●
如果案例有参数，显示相关参数。
●
如果案例无参数，案例直接执行。
步骤6 输入案例参数。
以执行“三方系统接入用户校验”这个案例为例，需要输入参数信息如下。
Please enter a value for parameter userName:TestUser
Please enter a value for parameter ThirdPartyPasswd:
输入对应参数值并按“Enter”，案例开始执行。
●
如果案例执行成功，显示如下信息。
start to execute case:
[INFO]读取输入信息成功。
[INFO]开始校验用户。
[INFO] Response status: 200
[INFO]校验成功。
●
如果案例执行失败，请收集相应的日志信息联系技术工程师协助解决。
----结束
2.2.5
巡检工具
FusionCare
FusionCare是为技术支持工程师和维护工程师提供的一套健康检查和信息收集工具。
具体操作指导请参考FusionCare中对应版本的FusionCare工具资料。
2.2.6
网络诊断工具
CloudNetDebug
CloudNetDebug是面向运维人员的虚拟网络领域的网络诊断工具。CloudNetDebug集
成了拨测和抓包两个功能，用于处理数据中心内可能出现的各种网络问题，通过拨测
功能可自动化检测业务网络是否出现断流，是否出现丢包，通过抓包功能可实现自动
化抓包，支持基于业务流的多点协同抓包，支持灵活的单点虚拟机网卡抓包和主机网
卡抓包。
通过CloudNetDebug工具，可用于检测网络断流，丢包问题；当网络故障时，可用于
定界虚拟网络和物理网络的故障边界，可自动化定界是哪个网元节点的问题；当无法
确认是应用还是网络的问题时，可用于排除网络问题。
具体操作指导请参考CloudNetDebug中对应版本的配置调测工具指导书。
2.2.7
调用链工具
G-ray
G-ray实时跟踪业务请求，串联各组件、各节点，可视化的还原请求在分布式系统中的
执行轨迹和状态，支撑故障和性能瓶颈的快速定界定位。
具体操作指导请参考G-ray中对应版本的使用指南。
2.3
硬件故障
在系统告警及日常巡检中发现硬件故障时，请参考表2-7进行处理。
2

## Page 1155

说明
●
这里仅针对《华为云Stack
8.1.0
版本配套表》中的几种典型硬件故障进行说明，如果客户
现场使用的硬件设备不在表2-7的范围中，请联系技术支持工程师协助解决。
●
如果在硬件故障的处理过程中，涉及到更换硬件，请参考《华为云Stack
8.1.0
运维指南》
中的“部件更换”章节。
表2-7 硬件故障
设备类型 处理方法
交
换
机
CloudEngine
12800系列 参考《CloudEngine 12800系列交换机
V200R020C10
产品文档》中的“运维与故障处
理”章节。
CloudEngine
6800系列 参考《CloudEngine
8800, 7800, 6800,
5800系
列交换机
V200R005C10
产品文档》中的“运维
与故障处理”章节。
服
务
器
机架服务器：2288H
V5、RH2288H
V3
参考《华为服务器 故障处理》。
刀片服务器：E9000
CH222 V3
TaiShan 200
服务器（型
号：2280）
参考《TaiShan
200
服务器 维护与服务指南 (型
号 2280)》中的“故障处理指导”章节。
存储 参考《云硬盘(EVS)
8.1.1
维护指南(for 华为云
Stack
8.1.0)》中“《华为云Stack
8.1.0
云硬盘
(EVS)故障管理》
>
云硬盘故障”章节。
2.4
资源池故障
2.4.1 FusionSphere OpenStack
故障
2.4.1.1
信息收集
2.4.1.1.1
收集故障信息
操作场景
当系统异常时，维护工程师可使用以下两种方式进行信息收集：
●
现场环境不能使用FusionCare或者需要加速处理故障时，可采用FusionSphere 的
故障信息快速采集功能进行信息收集，具体操作请见2.4.3.2 通过FusionSphere
OpenStack快速采集故障信息。
●
FusionCare对系统的运行信息进行收集，以便定位故障原因。
2

## Page 1156

说明
如果此时还未安装FusionCare，可通过如下方式获取软件及对应文档，完成FusionCare的
安装和使用。
软件包“FusionCare-V100R005C00SPC614-linux-x86_64.zip”企业用户点此前往，运营
商用户点此前往，文档《FusionCare
V100R005C00SPC614
工具资料》。
前提条件
●
已完成FusionCare的安装及配置。
●
浏览器要求为“Internet
Explorer
11.0”、“Firefox27.0~38.0”、“Google
Chrome
30.0~41.0”的正式版本。
●
已获取FusionCare系统的IP地址、用户名、密码。
操作步骤
步骤1 使用浏览器登录并进入FusionCare界面。
登录地址：https://FusionCare系统的IP地址:8803/hct/index.action。
默认帐号：admin
说明
●
如果FusionCare部署在本机windows上，也可以在浏览器地址栏输入https://
localhost:8803/hct/index.action。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（Portal）”页签中，该帐
户对应的默认密码。
● 首次登录需要修改密码，请根据界面提示修改登录密码。
步骤2 是否已配置OpenStack的检查节点。
●
是，执行步骤6。
●
否，执行步骤3。
步骤3 （可选）如果没有配置域名服务器，请配置域名映射。
1.
登录Fusioncare后台。
默认帐户：fusioncare
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
2.
执行以下命令，切换root用户。
sudo su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
3.
编辑 /etc/hosts配置文件, 以下面格式保存域名映射信息。
Keystone所在AZ的反向代理IP地址 Keystone服务的域名
info-collect所在AZ的反向代理IP地址 info-collect服务的域名
upgrade所在AZ的反向代理IP地址 upgrade服务的域名
cps所在AZ的反向代理IP地址 cps服务的域名
举例：执行vi /etc/hosts，打开hosts文件，将下面的内容保存在hosts文件。
2

## Page 1157

fc00:0:0:501::20 identity.NFV-AZ-HDHZ-01A-HW-50-AZ1.NFV-RP-HDHZ-01A-
HW-50.armipv6.com
fc00:0:0:501::20 info-collect.NFV-AZ-HDHZ-01A-HW-50-AZ1.NFV-RP-
HDHZ-01A-HW-50.armipv6.com
fc00:0:0:501::20 upgrade.NFV-AZ-HDHZ-01A-HW-50-AZ1.NFV-RP-HDHZ-01A-
HW-50.armipv6.com
fc00:0:0:501::20 cps.NFV-AZ-HDHZ-01A-HW-50-AZ1.NFV-RP-HDHZ-01A-
HW-50.armipv6.com
4.
按“Esc”，执行:wq!命令，保存并退出编辑模式。
步骤4 返回至FusionCare界面，选择“系统管理
>
环境配置”，单击“向导式添加环境”，
进入“配置向导”界面。
步骤5 根据提示，在“添加项目”和“添加环境”界面分别输入符合规则的项目名称和环境
名称，单击“下一步”。
步骤6 在“选择产品”界面勾选“FusionSphereOpenStack”，单击“下一步”，添加产品
信息。
步骤7 在“添加节点FusionSphere OpenStack产品信息 ”界面分别设置如下信息：
● “OpenStack节点”：“组件类型”为“KeyStone”，“URL”填写KeyStone服
务的组件域名，服务的组件域名的格式为“服务类型名.域名”，域名为安装主机
时设置的AZ域名。
●
“OpenStack OM节点”：“组件类型”为“OpenStack OM”，根据实际情况
确定是否勾选“虚拟化部署”。如勾选，输入节点的External_API平面或
External_OM平面的IP，输入“用户名”（默认的用户名已经填好，如有需要可根
据实际情况更改），输入对应用户名的“密码”，完成组件信息的填写后，单击
“下一步”。如不勾选，直接单击“下一步”。
说明
多AZ场景下，需要多次执行“添加节点”操作，为每个AZ添加一行配置，并且需要先配置
keystone服务所在AZ的节点信息。
步骤8 如果所添加的环境信息通过校验，则可以进入到“添加完成”界面。单击“完成”，
完成项目、环境信息的添加。
步骤9 在“信息收集”页签单击“创建任务”。
步骤10 在“设置收集时间段”页签，输入“任务名称”、“开始时间”、“结束时间”，选
择“按日志收集”或“按场景收集”，单击“下一步”。
●
任务名称：该信息收集的名称，当信息收集完成后，此名称会显示在信息收集记
录列表中。
●
开始时间、结束时间：收集此时间段内的日志信息和主机运行状态。
须知
信息收集一次最多能够收集5个节点，收集时间最多为2天。
步骤11 在“选择节点”页签，勾选需要收集信息的节点，单击“下一步”。
列表显示需要收集信息的节点。
2

## Page 1158

步骤12 在“选择收集项”页签，勾选各节点需要收集的项目，单击“完成”。
步骤13 在提示界面上，单击“是”开始收集日志。
提示“添加任务成功”，单击“确定”。FusionCare系统开始执行信息收集，信息收
集根据节点数和收集项的不同，所需时间不同。当信息收集进度为100%时系统会提示
信息收集完成。
步骤14 单击“下载”，将收集的信息下载到本地。
下载到本地的文件为“zip”格式，联系技术支持工程师协助解决，辅助问题定位。
----结束
2.4.1.1.2
回传故障信息
操作场景
当系统异常时，维护工程师通过FusionCare对系统信息进行收集得到的压缩包，只回
传关键信息，以缩短回传时间，便于快速定位。
必备事项
已通过FusionCare获取到信息收集的压缩包。
操作步骤
步骤1 解压缩获得的zip压缩包，得到“log_*”文件夹。
步骤2 进入“log_*\fsp”目录。
会有级别信息压缩包，如下图所示：
按日志级别整体回传多个节点的日志信息
步骤3 根据步骤2得到的三个压缩包，选择对应级别文件，发送给技术人员，建议首次只回传
“error.zip”日志信息。
分模块发送error级别信息
前提：技术人员会提供需要的节点名列表与模块名列表。如下表所示：
节点名
007487FD-FBDD-E411-A88B
403A62B2-F7DD-E411-A5A6
模块
cps
2

## Page 1159

rabbitmq
log
步骤4 解压缩步骤2得到的“error.zip”，并进入得到“error”文件夹。如下图所示，红框内
即为节点名：
步骤5 解压缩名称含有“007487FD-FBDD-E411-A88B”的压缩包，并进入解压缩后得到的
文件夹，可以看到以模块命名的文件夹。如下图所示：
步骤6 创建“info-collect_error”文件夹以及子文件夹“007487FD-FBDD-E411-A88B”，用
来存储要回传的信息。
步骤7 将步骤5中的相关模块文件夹（例如：cps、log、rabbitmq）复制到步骤6创建的
“007487FD-FBDD-E411-A88B”文件夹中。
步骤8 重复执行步骤5~步骤7，将其他节点信息的相关模块也复制到“info-collect_error”文
件夹下。
2

## Page 1160

步骤9 压缩“info-collect_error”文件夹，将压缩包发送给技术人员。
分模块发送info级别信息
前提：
技术人员根据error级别信息无法定位故障原因，需要info级别信息进行定位。技术人
员会提供需要的节点名列表与模块名列表。如下表所示：
节点名
007487FD-FBDD-E411-A88B
403A62B2-F7DD-E411-A5A6
模块
cps
rabbitmq
log
步骤10 解压缩步骤2得到的“info.zip”，并进入得到“info”文件夹。如下图所示，红框内即
为节点名：
步骤11 解压缩名称含有“007487FD-FBDD-E411-A88B”的压缩包，并进入解压缩后得到的
文件夹，可以看到以模块命名的文件夹。如下图所示：
2

## Page 1161

步骤12 创建“info—collect_info”文件夹以及子文件夹“007487FD-FBDD-E411-A88B”，
用来存储要回传的信息。
步骤13 将步骤11中的相关模块文件夹（例如：cps
log
rabbitmq）复制到步骤12创建的
“007487FD-FBDD-E411-A88B”文件夹中。如下图所示：
步骤14 重复执行步骤10~步骤13，将其他节点信息的相关模块也复制到“info-collect_info”
文件夹下。
步骤15 压缩“info-collect_info”文件夹，将压缩包发送给技术支持工程师协助解决。
----结束
2.4.1.2
节点类故障
2.4.1.2.1
故障主机上虚拟机的恢复
现象描述
故障主机上虚拟机故障，参考本章节完成故障主机上虚拟机的恢复。
对系统的影响
不涉及。
2

## Page 1162

可能原因
●
故障主机上业务虚拟机故障。
●
管理节点虚拟机故障。
操作步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 执行如下命令查询故障主机上部署的虚拟机信息。
1.
执行如下命令，采用安全方式操作。
runsafe
显示如下信息：
Input command:
2.
执行如下命令查询并记录故障主机上部署的虚拟机信息。
nova list --all-t --host host_id
–
若存在业务虚拟机。
▪
密集存储型弹性云服务器和超高I/O型弹性云服务器不支持虚拟机HA，
请参考恢复主机业务章节。
▪
故障主机上的其他虚拟机，执行步骤6，进行异地重建虚拟机。
–
若存在管理节点虚拟机，包括FSM虚拟机、Service OM等虚拟机，根据虚拟
机类型分别执行步骤7、步骤8。
+--------------------------------------+---------------+----------------------------------+--------+------------
+-------------+-------------------------------------------------------------------------------------------+
| ID | Name | Tenant ID | Status | Task State | Power State
| Networks
2

## Page 1163

|+--------------------------------------+---------------+----------------------------------+--------+------------
+-------------+------------------------------------------------------------------------------------------+
| 81d658ee-6bc9-43be-ae54-b6fb27ccba80 | ecs-94a0 | db64de4fd1374dbca116c4bef5623562 |
ERROR | - | Running |
subnet-6ba9=192.168.2.61 |
| 90a229e3-d8cd-458d-a2b5-28277c09845d | ecs-ac39-0001 | 002e778a7c874b38823270e77e39946c |
ERROR | - | Shutdown |
subnet-228c=192.168.0.74 |
| 8069733b-c464-4e77-9ec7-bfa4d951af48 | ecs-ac39-0002 | 002e778a7c874b38823270e77e39946c |
ERROR | - | Shutdown |
subnet-228c=192.168.0.32 |
| 9a6c19fa-95af-4f82-8a8f-76d4bcc54961 | ecs-ac39-0003 | 002e778a7c874b38823270e77e39946c |
ERROR | - | Shutdown |
subnet-228c=192.168.0.161 |
| 75bddcdd-896c-4390-8fff-ced3a8938a8a | ecs-hdd | db64de4fd1374dbca116c4bef5623562 |
ERROR | - | Running |
subnet-6ba9=192.168.2.220 |
| 9a3ab47c-9c02-4a28-94ad-594715ab2214 | ecs-ssd | db64de4fd1374dbca116c4bef5623562 |
ERROR | - | Running |
subnet-6ba9=192.168.2.10 |
+--------------------------------------+---------------+----------------------------------+--------+------------
+-------------+-------------------------------------------------------------------------------------------+
步骤6 重建步骤5.2中记录的虚拟机。
具体操作请参见异地重建虚拟机。
步骤7 如果故障主机上部署了FSM虚拟机，则按照以下步骤进行恢复操作。
●
恢复FusionStorage Manager单个VM：
a.
FSM单虚拟机故障，请参见《海量存储 块服务维护宝典》中“其他
>
维护案
例
>
HCS解决方案场景下，单个FSM虚拟机故障后，虚拟机重建方法”章节
进行恢复操作。
b.
恢复FSM软件，请参见《海量存储 块服务维护宝典》中“基础业务
>
管控面
>
应急处理
>
双FSM部署，单FSM故障应急指导”章节进行恢复操作。
●
恢复FusionStorage Manager2个VM：
a.
FSM主备虚拟机同时故障，请参见《海量存储 块服务维护宝典》中“其他
>
维护案例
>
HCS解决方案场景下，主备虚拟机故障后，虚拟机重建方法”章
节进行恢复操作。
b.
恢复FSM软件，请参见《海量存储 块服务维护宝典》中“基础业务
>
管控面
>
应急处理
>
FSM主备同时故障的应急处理指导”章节进行恢复操作。
步骤8 如果故障主机上部署了Service OM虚拟机，参考2.4.2.1.2 主备部署时单个Service
OM虚拟机故障重建故障的Service OM虚拟机。
----结束
2.4.1.2.2
主机操作系统故障
现象描述
当主机操作系统故障时，需要为主机重装操作系统并重建主机上的虚拟机。主机操作
系统故障的场景包括：
计算节点操作系统故障。
单个控制节点操作系统故障。
说明
网络节点操作系统故障参考2.4.1.2.8 网络节点主机操作系统故障（Region
Type
I）。
2

## Page 1164

可能原因
操作系统文件异常。
前提条件
请先确认故障主机上的虚拟机已经在其他主机上由HA机制恢复，若没有，请先进行异
地重建虚拟机操作。
异地重建虚拟机的操作具体操作请根据实际场景参考2.4.1.2.1 故障主机上虚拟机的恢
复进行处理。
处理步骤
计算节点操作系统故障，请参考 计算节点操作系统故障。
单个控制节点操作系统故障，请参考 单个控制节点操作系统故障。
●
计算节点操作系统故障
步骤1 登录FusionSphere OpenStack的安装部署界面。
具体操作请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）。
步骤2 在FusionSphere OpenStack安装部署界面，选择“运维
>
扩容”，将“自动PXE主
机”设置为开启状态。
说明
●
服务器操作系统安装过程中，支持硬盘直通的RAID卡会直接找到挂载的直通硬盘作为安装
盘；而不支持硬盘直通的RAID卡，在操作系统安装过程中，只能找到该RAID卡下已经配置
好的虚拟磁盘作为安装盘。
●
请在主机PXE操作前确认将JBOD Mode设置为关闭并重启主机，等待PXE操作进度完成90%
以上卡顿或者100%后再次打开重启主机。
具体操作请参见《FusionServer
Pro
机架服务器
V100R005
产品文档》中“专题资料
>
专
题资料（通用）
>
华为V5服务器
RAID
控制卡 用户指南（V5） ”中对应型号RAID卡“硬盘
直通”章节。
步骤3 手动启动故障主机，重装主机操作系统。
●
可使用键盘显示器直连服务器，在服务器启动过程中手动选择启动方式为PXE启
动。
●
可使用服务器BMC系统的远程控制功能，执行如下操作。
a.
选择“电源与能耗
>
电源控制”，单击“下电”。
b.
选择“配置
>
系统启动项”，“引导介质有效期”设置为“单次有效”，且
“引导介质”设置为“PXE”；单击“保存”。
c.
选择“远程控制
>
集成远程控制台”，单击“远程虚拟控制台(共享模
式)”。
d.
在远程控制台上，单击“上电”，启动故障主机进行PXE，主机重新安装耗时
约为10~15分钟。
2

## Page 1165

说明
如果重新安装后磁盘的盘符发生了变化，从而导致安装失败（操作系统已安装成功，但服务不能
正常恢复），可能是由于以下原因引起，需要参考2.4.3.4 如何处理盘符变化处理。
●
对主机的RAID进行过调整，包括：重组RAID组、重新创建RAID组、删除RAID组。
●
用户对FusionSphere OpenStack的系统磁盘或磁盘分区做过调整，包括：扩容磁盘、扩容分
区等。
如果主机之前并未经历上述调整，仍出现安装失败的现象，请联系技术支持工程师协助解决。
重装主机操作系统后，操作系统帐户（root、fsp）密码会重置为默认密码。
步骤4 如果节点采用华为分布式块存储融合场景，则执行以下步骤安装ES3000驱动。
根据存储软件对应版本的《OceanStor Pacific系列
8.1.1
版本配套表》中ES3000的驱
动版本和获取路径下载对应驱动，并参考《OceanStor
Pacific 9520, 9540, 9940
8.1.1
网卡，ES3000，RAID卡固件驱动升级指南》中的“NVMe盘固件驱动安装升
级”章节进行安装。
步骤5 如果节点采用华为分布式块存储融合场景，请先恢复FSM虚拟机和华为分布式块存储
存储，请参考恢复华为分布式块存储《华为云Stack
8.1.0
运维指南》中“部件更换
>
更换主机及配件
>
计算节点（KVM)
>
更换主机
>
恢复华为分布式块存储”章节进行
操作。
步骤6 在FusionSphere OpenStack安装部署“概要”界面查看主机的安装进度，确认主机是
否安装完成。
当故障主机所在行的“进度”显示100%时，表示主机启动成功。
●
是，执行步骤7。
●
否，联系技术支持工程师协助解决。
说明
业务口平面映射类型为用户态OVS网桥或者硬件加速用户态OVS网桥的计算节点，主机部署进度
会卡在94%-96%左右，请在概要界面，重启该主机。待“进度”显示100%时，表示主机启动
成功。
步骤7 在已登录的安装部署界面，选择“运维
>
扩容”，进入扩容页面，关闭“自动PXE主
机”功能。
步骤8 在FusionSphere OpenStack的安装部署的“概要”界面，选择新安装的主机，单击
“重启”。
说明
主机安装成功后，会自动同步系统的配置信息，部分高级配置需重启主机才能生效（例如内核配
置等）。
为保证所有配置均能正常生效，请安装主机成功后将主机重启一遍。
步骤9 在Service OM界面，选择“监控
>
告警
>
告警列表”，查看是否有关于重新安装主机
的告警。
●
是，执行步骤10。
●
否，执行步骤11。
步骤10 在告警所在行的“操作”列单击“清除”，弹出“确认要消除该条告警?”对话框，单
击“确认”。
步骤11 在FusionSphere OpenStack安装部署首页，选择“配置
>
磁盘”，查看故障主机所在
计算组是否使用远端存储。
2

## Page 1166

●
是，判断节点类型。
–
若节点是华为分布式块存储融合部署，执行步骤12。
–
若节点是SAN存储，执行步骤13-步骤20。
●
否，执行步骤20。
步骤12 删除故障主机卷信息。本操作不可恢复，操作前请先确认待删除的卷是否为残留卷，
具体操作请联系技术支持工程师。故障主机卷信息删除完成后，执行步骤20。
操作步骤请参见《OceanStor Pacific系列
8.1.1
产品文档》中“配置
>
块服务基础业
务配置指南
>
管理基础业务
>
管理卷
>
延迟删除卷”章节。
步骤13 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤14 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤15 执行TMOUT=0防止会话超时退出。
步骤16 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤17 执行以下命令，获取故障主机哈希ID。
python -c 'from cinder.volume.drivers.huawei.huawei_utils import
str_hash_py27 as hash;print(hash("hostid"))'
hostid为故障主机ID，回显信息即故障主机哈希ID。
步骤18 执行以下命令，获取主机上重新对接的远端LUN的wwn号列表：
cat /etc/huawei/fusionsphere/osConfig.storage/cfg/osConfig.storage.cfg.effect
| python -mjson.tool | grep lun_wwn
回显举例如下：
"lun_wwn": "6487b6b1004bc09524031c1e0000003d"
步骤19 登录DeviceManager，在“资源分配>主机”中按名称搜索主机哈希ID，逐个查看每个
LUN，如果WWN号不在步骤18获取的wwn号列表中，则属于待清理LUN，记录下
来，在DeviceManager管理界面将这些LUN从对应LUN组移除后删除LUN，具体操作
请参见OceanStor对应型号的产品文档。
2

## Page 1167

步骤20 安装MOICAgent，具体操作请参见2.5.7.17 安装MOICAgent异常。
----结束
●
单个控制节点操作系统故障
步骤1 登录FusionSphere OpenStack的安装部署界面。
具体操作请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）。
步骤2 在FusionSphere OpenStack安装部署界面，选择“运维
>
扩容”，将“自动PXE主
机”设置为开启状态。
说明
●
服务器操作系统安装过程中，支持硬盘直通的RAID卡会直接找到挂载的直通硬盘作为安装
盘；而不支持硬盘直通的RAID卡，在操作系统安装过程中，只能找到该RAID卡下已经配置
好的虚拟磁盘作为安装盘。
●
请在主机PXE操作前确认将JBOD Mode设置为关闭并重启主机，等待PXE操作进度完成90%
以上卡顿或者100%后再次打开重启主机。
具体操作请参见《FusionServer
Pro
机架服务器
V100R005
产品文档》中“专题资料
>
专
题资料（通用）
>
华为V5服务器
RAID
控制卡 用户指南（V5） ”中对应型号RAID卡“硬盘
直通”章节。
步骤3 手动启动故障主机，重装主机操作系统。
● 可使用键盘显示器直连服务器，在服务器启动过程中手动选择启动方式为PXE启
动。
●
可使用服务器BMC系统的远程控制功能，执行如下操作。
a.
选择“电源与能耗
>
电源控制”，单击“下电”。
b.
选择“配置
>
系统启动项”，“引导介质有效期”设置为“单次有效”，且
“引导介质”设置为“PXE”；单击“保存”。
c.
选择“远程控制
>
集成远程控制台”，单击“远程虚拟控制台(共享模
式)”。
d.
在远程控制台上，单击“上电”，启动故障主机进行PXE，主机重新安装耗时
约为10~15分钟。
2

## Page 1168

说明
如果重新安装后磁盘的盘符发生了变化，从而导致安装失败（操作系统已安装成功，但服务不能
正常恢复），可能是由于以下原因引起，需要参考2.4.3.4 如何处理盘符变化处理。
●
对主机的RAID进行过调整，包括：重组RAID组、重新创建RAID组、删除RAID组。
●
用户对FusionSphere OpenStack的系统磁盘或磁盘分区做过调整，包括：扩容磁盘、扩容分
区等。
如果主机之前并未经历上述调整，仍出现安装失败的现象，请联系技术支持工程师协助解决。
重装主机操作系统后，操作系统帐户（root、fsp）密码会重置为默认密码。
步骤4 如果节点采用华为分布式块存储融合场景，则执行以下步骤安装ES3000驱动。
根据存储软件对应版本的《OceanStor Pacific系列
8.1.1
版本配套表》中ES3000的驱
动版本和获取路径下载对应驱动，并参考《OceanStor
Pacific 9520, 9540, 9940
8.1.1
网卡，ES3000，RAID卡固件驱动升级指南》中的“NVMe盘固件驱动安装升
级”章节进行安装。
步骤5 如果节点采用华为分布式块存储融合场景，请先恢复FSM虚拟机和华为分布式块存储
存储，请参考《华为云Stack
8.1.0
运维指南》中“部件更换
>
更换主机及配件
>
管
理节点
>
更换主机
>
恢复华为分布式块存储”章节进行操作。
步骤6 在FusionSphere OpenStack的安装部署界面的“概要”界面查看主机的安装进度，确
认主机是否安装完成。
当故障主机所在行的“进度”显示100%时，表示主机启动成功。
说明
如果重装操作系统的主机是安装FusionSphere OpenStack时的首节点，则需要在“运维 > 扩
容”页面查看该主机的安装状态（此阶段“概要”页面一直显示主机为故障状态）。安装至
70%以后，才会在“概要”页面的原故障主机上正常显示安装进度。
● 是，执行步骤7。
●
否，联系技术支持工程师协助解决。
步骤7 在FusionSphere OpenStack的安装部署界面，选择“运维
>
组件维护”，选择要恢复
的主机ID，单击“查看组件”。
2

## Page 1169

步骤8 查看故障主机的“swift”服务状态是否为“fault”。
●
是，执行步骤9。
● 否，执行步骤16。
步骤9 控制节点目前采用华为分布式块存储融合场景，存储没恢复之前进度也不能达到
100%，需要先恢复存储。如果故障的KVM主机已经对接了华为分布式块存储，则需要
先进行存储的恢复（此时服务器操作系统已恢复，请勿重复安装），恢复存储请执行
步骤5。
步骤10 在FusionSphere OpenStack的安装部署界面，选择“配置
>
磁盘”，选择故障的主机
节点，查看是否存在“配置失败，单击主机状态查看详情”的提示。
●
是，单击扩容存储中的确认按钮 ，执行步骤11。
●
否，执行步骤16。
步骤11 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤12 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤13 执行TMOUT=0防止会话超时退出。
步骤14 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤15 执行以下命令，查看swift组件是否恢复正常。
cps template-instance-list --service swift swift-store
+------------+---------------+--------+--------------------------------------+---------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+--------+--------------------------------------+---------------+
| 0 | swift-store | active | B06A0195-3FF0-3283-EA11-1D85CA2D8FA3 | 162.129.2.226 |
| 1 | swift-store | active | E9652C65-FD30-EC8C-EA11-3B85220CCF14 | 162.129.2.235 |
| 2 | swift-store | active | 9E602C65-FD30-569E-EA11-2A85A4146CAD | 162.129.3.99 |
+------------+---------------+--------+--------------------------------------+---------------+
cps template-instance-list --service swift swift-proxy
+------------+---------------+--------+--------------------------------------+---------------+
| instanceid | componenttype | status | runsonhost | omip |
2

## Page 1170

+------------+---------------+--------+--------------------------------------+---------------+
| 0 | swift-proxy | active | B06A0195-3FF0-3283-EA11-1D85CA2D8FA3 | 162.129.2.226 |
| 1 | swift-proxy | active | E9652C65-FD30-EC8C-EA11-3B85220CCF14 | 162.129.2.235 |
| 2 | swift-proxy | active | 9E602C65-FD30-569E-EA11-2A85A4146CAD | 162.129.3.99 |
+------------+---------------+--------+--------------------------------------+---------------+
●
是，执行步骤16 。
●
否，联系技术支持工程师协助解决。
步骤16 在已登录的安装部署界面，选择“运维
>
扩容”，进入扩容页面，关闭“自动PXE主
机”功能。
步骤17 选择新安装的主机，单击“重启”。
说明
主机安装成功后，会自动同步系统的配置信息，部分高级配置需重启主机才能生效（例如内核配
置等）。
为保证所有配置均能正常生效，请安装主机成功后将主机重启一遍。
步骤18 在Service OM界面，选择“监控
>
告警
>
告警列表”，查看是否有关于重新安装主机
的告警。
●
是，执行步骤19。
●
否，执行步骤20。
步骤19 在告警所在行的“操作”列单击“清除”，弹出“确认要消除该条告警?”对话框，单
击“确认”。
步骤20 在FusionSphere OpenStack安装部署首页，选择“配置
>
磁盘”，查看故障主机所在
管理组是否使用远端存储。
●
是，判断节点类型。
–
若节点是华为分布式块存储融合部署，执行步骤21。
–
若节点是SAN存储，执行步骤22-步骤25。
● 否，执行步骤25。
步骤21 删除故障主机卷信息。本操作不可恢复，操作前请先确认待删除的卷是否为残留卷，
具体操作请联系技术支持工程师。故障主机卷信息删除完成后，执行步骤25。
2

## Page 1171

操作步骤请参见《OceanStor Pacific系列
8.1.1
产品文档》中“配置
>
块服务基础业
务配置指南
>
管理基础业务
>
管理卷
>
延迟删除卷”章节。
步骤22 在OpenStack控制节点，执行以下命令，获取故障主机哈希ID。
python -c 'from cinder.volume.drivers.huawei.huawei_utils import
str_hash_py27 as hash;print(hash("hostid"))'
hostid为故障主机ID，回显信息即故障主机哈希ID。
步骤23 执行以下命令，获取主机上重新对接的远端LUN的wwn号列表：
cat /etc/huawei/fusionsphere/osConfig.storage/cfg/osConfig.storage.cfg.effect
| python -mjson.tool | grep lun_wwn
回显举例如下：
"lun_wwn": "6487b6b1004bc09524031c1e0000003d"
步骤24 登录DeviceManager，在“资源分配>主机”中按名称搜索主机哈希ID，逐个查看每个
LUN，如果WWN号不在步骤23获取的wwn号列表中，则属于待清理LUN，记录下
来，在DeviceManager管理界面将这些LUN从对应LUN组移除后删除LUN，具体操作
请参见OceanStor对应型号的产品文档。
步骤25 安装MOICAgent，具体操作请参见2.5.7.17 安装MOICAgent异常。
----结束
2.4.1.2.3
主机硬件故障
若为硬件故障，参考2.4.1.2.1 故障主机上虚拟机的恢复异地恢复虚拟机后，参考《华
为云Stack
8.1.0
运维指南》中“更换主机”章节对硬件进行恢复。
2.4.1.2.4
多个控制主机故障
现象描述
●
无法通过PuTTY登录FusionSphere OpenStack的主机，或者登录系统后执行CLI命
令无响应。
●
存在两台控制主机（部署zookeeper角色的controller节点超过半数故障），无法
通过BMC地址登录主机操作系统。
2

## Page 1172

●
所有主机网络连接正常，不存在网络故障。
可能原因
●
控制主机硬件故障。
●
控制主机操作系统故障。
处理步骤
消除环境中存在的硬件故障
步骤1 通过控制主机的BMC地址，登录存在问题的主机，确认故障现象。
登录地址：https://服务器iBMC管理网口的IP地址。
默认帐户：Administrator
说明
服务器iBMC管理网口的IP地址、默认帐户、默认密码请参考《华为云Stack
8.1.0
集成设计套
件》中《华为云Stack
8.1.0
LLD模板》(Region
Type
I)的“4.1设备初始化配置”页签获取。
● 若无法通过BMC地址登录控制主机，根据对应服务器的产品手册，检测是否存在
硬件问题。
–
是，执行步骤2。
–
否，联系技术支持工程师协助解决。
●
若可以通过BMC地址登录控制主机，但是无法登录其操作系统，执行步骤8。
步骤2 根据对应服务器的产品手册，替换故障硬件或者整个服务器。
须知
替换故障硬件或者整个服务器时，必须替换成同型号同规格的备件或服务器，否则可
能引起环境恢复失败。
●
如果仅替换了服务器上的某些配件，如内存、CPU等，而未进行服务器整机替
换，则执行步骤3。
●
否则，执行步骤8。
步骤3 使用PuTTY通过反向代理的IP地址登录FusionSphere OpenStack的主机。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
是否可以登录FusionSphere OpenStack的主机。
2

## Page 1173

●
是，执行步骤4。
●
否，执行步骤8。
步骤4 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤5 执行TMOUT=0防止会话超时退出。
步骤6 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤7 执行以下命令，判断是否能正常执行CLI命令。
cps host-list
●
是，主机已恢复，任务结束。
● 否，执行步骤8。
获取备份包
步骤8 参考备份文件名和路径进行获取。
请确认是否能够获取到满足要求的备份包。
●
是，执行步骤9。
●
否，联系技术支持工程师协助解决。
更换故障主机
步骤9 通过控制主机的BMC地址，登录剩余正常的控制主机，打开远程控制台登录操作系
统。
1.
操作系统登录帐号：“root”
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
2.
执行以下命令，防止会话超时退出。
TMOUT=0
3.
执行以下命令，导入环境变量。
source set_env
选择“2”使用CPS鉴权，提示输入CPS_USERNAME和CPS_PASSWORD，此时分
别输入“cps_admin”以及对应的正确密码即可。
步骤10 执行以下命令，开始恢复FusionSphere OpenStack组件。
cps-fast-recover
●
若系统回显如下信息，执行步骤11。
End wait template:gaussdb recover status normal
End recover gaussdb
Start board replacement on webui
2

## Page 1174

●
若系统长时间未响应或出现报错，请联系技术支持工程师协助解决。
步骤11 更换故障主机并同步主机配置。
具体操作请参考《华为云Stack
8.1.0
运维指南》中“同步主机配置”章节，执行至所
有配置项按顺序同步完成后，单击“结束流程”步骤。待一台故障主机更换完成后，
依次更换其余故障主机并同步主机配置。
清理主机残留信息
步骤12 在FusionSphere OpenStack安装部署界面，单击“概要”，在概要标签页，勾选故障
主机，单击“删除”。弹出警告对话框中选择“删除”，然后在执行结果弹窗选择
“完成”。
步骤13 等待步骤10中cps-fast-recover命令执行完毕。
●
若系统回显如下信息，命令执行完毕，执行步骤14。
Start board replacement on webui
Begin change zk from standalone to cluster
End change zk from standalone to cluster
Begin wait template:cbs-server recover status normal
End wait template:cbs-server recover status normal
Begin wait template:haproxy recover status normal
End wait template:haproxy recover status normal
end
●
若系统长时间未响应或出现报错，请联系技术支持工程师协助解决。
步骤14 在FusionSphere OpenStack安装部署界面，单击“概要”，在概要标签页，勾选一台
更换的主机，单击“重启”。
说明
●
主机安装成功后，会自动同步系统的配置信息，部分高级配置需重启主机才能生效（例如内
核配置等）。
● 为保证所有配置均能正常生效，请安装主机成功后将主机重启一遍。
●
第一台主机重启成功，并且CPS命令可用后，才可以重启下一台主机。
步骤15 执行以下命令，判断是否能正常执行CLI命令。
cps host-list
●
是，执行步骤16。
●
否，请联系技术支持工程师协助解决。
步骤16 参考步骤14~步骤15，重启其余更换的主机。待所有更换的主机全部重启完成后，执
行步骤17。
步骤17 在FusionSphere OpenStack安装部署界面，选择“运维
>
主机更换”，单击“开始主
机更换”，将“自动PXE主机”设置为“关闭”，单击“退出页面”。
步骤18 在FusionSphere OpenStack安装部署界面，选择“运维
>
系统检查”，选择“初始安
装全量检查”，单击“执行用例”。
步骤19 界面提示“用例执行完成”后，查看“状态”列下是否显示执行成功。
●
是，任务结束。
●
否，联系技术支持工程师协助解决。
2

## Page 1175

说明
执行失败的用例查看用例详情，排除故障主机误报。融合部署等场景下，可能存在组件fault等
异常问题，恢复云服务后再执行一次“系统检查”，云服务虚拟机请参考对应的产品文档对其进
行恢复。
----结束
2.4.1.2.5
计算节点磁盘分区故障恢复
现象描述
●
租户启动虚拟机故障。
●
备数据库升主异常处理失败。
可能原因
image分区只读或文件系统损坏、数据异常，导致虚拟机无法正常启动。
处理步骤
●
若对接远端存储，请参考2.4.1.3.3 服务对接的远端存储故障处理。
●
若对接的本地存储，请参考本章节操作进行处理。
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行TMOUT=0防止会话超时退出。
步骤3 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤4 执行以下命令，查看分区是否为只读。
cat /proc/mounts | grep -w "ro," | grep /dev/mapper/cpsVG-image
若显示“ro”则表示分区为只读状态。
●
是，继续执行步骤5。
●
否，请联系技术支持工程师协助解决。
步骤5 执行以下命令，卸载只读分区。
umount /dev/mapper/cpsVG-image
2

## Page 1176

若卸载失败并回显如图2-5所示，说明该分区有程序正在使用，请联系技术支持工程师
协助解决。
图2-5 回显信息
步骤6 执行以下命令，修复文件系统。
fsck.ext3 /dev/mapper/cpsVG-image
说明
若分区使用ext3以外的其他文件系统类型，使用fsck的其他文件系统修复命令，如ext2文件系统
使用fsck.ext2。
执行完命令后，如果回显信息中没有报错等失败信息，则表示修复成功。
●
自动修复成功，继续执行步骤7。
●
自动修复失败，系统分区损坏，请联系技术支持工程师协助解决。
说明
如果修复失败，还可以使用fsck
-y
/dev/mapper/cpsVG-image强制修复文件系统，但是
有可能会修复错误，导致丢失或损坏数据。
步骤7 执行以下命令挂载分区。
mount /dev/mapper/cpsVG-image /opt/HUAWEI/image
/opt/HUAWEI/image为分区挂载的目录，用户可以根据实际情况指定。
----结束
2.4.1.2.6
NAT网关业务下发故障（Region
Type
I）
现象描述
ManageOne租户面无法下发新的NAT网关业务。
可能原因
NAT网关数据面是主备部署，当NAT网关主节点上控制组件neutron-nat-data-agent
出现异常状态变为fault时，会导致NAT网关数据面无法接收新的业务。
定位思路
查找状态为fault的neutron-nat-gw-data-agent组件所在的节点是否为NAT网关主节
点。
●
是，手动进行主备倒换。
●
否，联系技术支持工程师协助解决。
2

## Page 1177

处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 执行以下命令，查找状态为fault的neutron-nat-gw-data-agent组件所在的节点。
cps template-instance-list --service nat-gateway neutron-nat-gw-data-agent
+----------------+---------------------------+--------+--------------------------------------+----------------+
| instanceid | componenttype | status | runsonhost | omip |
+----------------+---------------------------+--------+--------------------------------------+----------------+
| agt_0000000001 | neutron-nat-gw-data-agent | active | 53034D15-B603-084B-82D6-AAB15E9F3503 |
192.168.43.169 |
| agt_0000000000 | neutron-nat-gw-data-agent | fault | 45EBDB95-711D-7640-8B5C-EE3D98561285 |
192.168.43.158 |
+----------------+---------------------------+--------+--------------------------------------+----------------+
步骤6 使用PuTTY，通过步骤5查询的IP地址登录NAT网关节点。
默认帐号：fsp
说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤7 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
2

## Page 1178

步骤8 执行TMOUT=0防止会话超时退出。
步骤9 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤10 执行以下命令，根据回显信息判断是否为NAT网关主节点。查看status是否为
MASTER。
/usr/sbin/ugw_shell vrrp show all
===============================================
vrrpid enable status ha-link
-----------------------------------------------
1 yes MASTER eth0.2038
===============================================
●
是，执行步骤11。
●
否，联系技术支持工程师协助解决。
步骤11 执行以下命令，手动进行主备倒换。
cps host-template-instance-operate --service nat-gateway neutron-nat-gw-
dataplane --action stop --host hostid
+--------------------------+--------------------------------------+--------+---------+
| template | runsonhost | action | result |
+--------------------------+--------------------------------------+--------+---------+
| neutron-nat-gw-dataplane | 45EBDB95-711D-7640-8B5C-EE3D98561285 | stop | success |
+--------------------------+--------------------------------------+--------+---------+
cps host-template-instance-operate --service nat-gateway neutron-nat-gw-
dataplane --action start --host hostid
+--------------------------+--------------------------------------+--------+---------+
| template | runsonhost | action | result |
+--------------------------+--------------------------------------+--------+---------+
| neutron-nat-gw-dataplane | 45EBDB95-711D-7640-8B5C-EE3D98561285 | start | success |
+--------------------------+--------------------------------------+--------+---------+
hostid为步骤5查询的主机ID，回显success表示主备倒换成功。
----结束
2.4.1.2.7
AZ内误接入主机的处理方法
现象描述
AZ内主机在未下电的情况下接入网络系统且后续未重新安装，可能导致主机误接入。
为避免不必要告警，需要及时删除误接入的主机。主机误接入现象如图2-6所示。
图2-6 AZ内误接入主机
2

## Page 1179

处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 执行以下命令查询主机列表。
cps host-list
步骤6 登录FusionSphere OpenStack的安装部署界面。
具体操作请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）。
步骤7 在“概要”页面查询主机列表。
步骤8 对比后台和前台查询到主机列表的区别。
如果后台查询结果中有状态为“fault”的主机，且前台查询结果中无此主机，说明该
主机是误接入的主机，记录该主机的“hostid”。
说明
若存在多个IP地址相同的主机满足此条件，需根据hostid区分该主机是管理员正常安装但由于其
他原因导致了主机故障，还是误接入。
步骤9 执行以下命令，查询有关该主机的规则列表“hostcfg”的信息。
cps hostcfg-list
查询结果如下图所示：
+---------------+---------------------+-----------------------------------------------------------+--------------------+
| type | name | hosts | metadata |
+---------------+---------------------+-----------------------------------------------------------+--------------------+
| site | default | hostid: | |
| | | | |
2

## Page 1180

| storage | control_control-001 | hostid:66D8C5E1-1800-BFBC-B211-D21D68236435, 66D8C5E1-180 |
grouptype:control, |
| | | 0-F1AF-B211-D21D861EC533, 66D8C5E1-1800-AF8D-B211- |
cpufamily:aarch64 |
| | | D21D76870734 | |
| | | | |
| storage | default | default:all | |
| | | | |
| storage | compute_compute-002 | | grouptype:compute, |
| | | | cpufamily:aarch64 |
| | | | |
| storage | default_sdi | capability:{boardtype: SDI} | boardtype:SDI, |
| | | | cpufamily:aarch64 |
| | | | |
| storage | compute_compute-003 | hostid:39153105-1920-DA99-B211-D21DF64F0B3D |
grouptype:compute, |
| | | | cpufamily:aarch64 |
| | | | |
| resgrp-define | control_group1 | hostid:66D8C5E1-1800-BFBC-B211-D21D68236435, 66D8C5E1-180 |
grouptype:control, |
| | | 0-F1AF-B211-D21D861EC533, 66D8C5E1-1800-AF8D-B211- |
cpufamily:aarch64 |
| | | D21D76870734 | |
| | | | |
| resgrp-define | compute_group1 | hostid:66D8C5E1-1800-088E-B211-D21D2EE43636, 66D8C5E1-180 |
grouptype:compute, |
| | | 0-01A7-B211-D21DF08CF336, 39153105-1920-DA99-B211- |
cpufamily:aarch64 |
| | | D21DF64F0B3D | |
| | | | |
+---------------+---------------------+-----------------------------------------------------------+--------------------+
步骤10 执行如下命令，在hostcfg规则列表中删除误接入主机的信息。
cps hostcfg-host-delete --host hostid=hostid --type type name
“hostid”为误接入主机ID。
“type”和“name”为hostcfg规则列表中误接入的主机对应字段的值。
步骤11 执行如下命令，查询有关该主机的role的名称。
cps host-role-list hostid
步骤12 执行如下命令，删除该主机的role。
cps role-host-delete --host hostid role_name
cps commit
"hostid"为步骤8中记录的“hostid”，"role_name"为步骤11中查询到的role名称。
步骤13 执行如下命令，删除误接的主机。
cps host-delete --host hostid
cps commit
----结束
2

## Page 1181

2.4.1.2.8
网络节点主机操作系统故障（Region
Type
I）
现象描述
当网络节点主机操作系统故障时（网络节点指vrouter、nat-server所在节点），需要
为主机重做操作系统，并重新部署和配置组件。网络节点故障的现象为执行cps
host-
show
<host_id>，发现主机状态为“fault”。
可能原因
网络节点主机操作系统被高危、异常操作破坏。
前提条件
●
除网络节点操作系统故障外，其他节点和功能一切正常。
● 已获取操作系统故障节点的主机ID或者虚机名。
●
能正常登录ManageOne运维面界面和FusionSphere OpenStack的安装部署界面
（FusionSphere OpenStack的安装部署界面）。
●
能通过终端命令行正常登录其中一个节点。
●
以下步骤针对一台主机操作系统故障的场景，如果有多个主机系统故障，请针对
每个故障主机分别执行一次。
处理步骤
步骤1 查询故障主机上的虚拟机，以及对应虚拟化出来的主机ID。具体操作请参见《华为云
Stack 8.1.0
运维指南》中的“查询网络虚拟机信息”。
步骤2 登录FusionSphere OpenStack的安装部署界面。
具体操作请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）。
步骤3 在FusionSphere OpenStack安装部署界面，选择“运维 > 扩容”，将“自动PXE主
机”设置为开启状态。
说明
●
服务器操作系统安装过程中，支持硬盘直通的RAID卡会直接找到挂载的直通硬盘作为安装
盘；而不支持硬盘直通的RAID卡，在操作系统安装过程中，只能找到该RAID卡下已经配置
好的虚拟磁盘作为安装盘。
● 请在主机PXE操作前确认将JBOD Mode设置为关闭并重启主机，等待PXE操作进度完成90%
以上卡顿或者100%后再次打开重启主机。
具体操作请参见《FusionServer
Pro
机架服务器 产品文档》中“华为服务器 RAID控制卡
用户指南 (V5)”中对应型号RAID卡“硬盘直通”章节。
步骤4 手动启动故障主机，重装主机操作系统。
●
可使用键盘显示器直连服务器，在服务器启动过程中手动选择启动方式为PXE启
动。
●
可使用故障服务器BMC系统的远程控制功能，执行如下操作。
a.
选择“电源与能耗
>
电源控制”，单击“下电”。
b.
选择“配置
>
系统启动项”，“引导介质有效期”设置为“单次有效”，且
“引导介质”设置为“PXE”；单击“保存”。
2

## Page 1182

c.
选择“远程控制
>
集成远程控制台”，单击“远程虚拟控制台(共享模
式)”。
d.
在远程控制台上，单击“上电”，启动故障主机进行PXE，主机重新安装耗时
约为10~15分钟。
说明
●
如果重新安装后磁盘的盘符发生了变化，从而导致安装失败（操作系统已安装成功，但服务
不能正常恢复），可能是由于以下原因引起，需要2.4.3.4 如何处理盘符变化。
–
对主机的RAID进行过调整，包括：重组RAID组、重新创建RAID组、删除RAID组。
–
用户对FusionSphere OpenStack的系统磁盘或磁盘分区做过调整，包括：扩容磁盘、
扩容分区等。
如果主机之前并未经历上述调整，仍出现安装失败的现象，请联系技术支持工程师协助解
决。
●
重装主机操作系统后，操作系统帐户（root、fsp）密码会重置为默认密码。
步骤5 等待15分钟左右，在重启主机完成后，登录FusionSphere OpenStack安装部署“概
要”界面，确认主机是否安装完成。
当故障主机所在行的“进度”显示100%时，表示主机启动成功。
●
是，执行步骤6。
●
否，联系技术支持工程师协助解决。
步骤6 在已登录的FusionSphere OpenStack安装部署界面，选择“运维
>
扩容”，进入扩容
页面，关闭“自动PXE主机”功能。
步骤7 在“概要”界面，选择新安装的主机，单击“重启”。
待主机重启成功后，继续执行步骤8。
说明
主机安装成功后，会自动同步系统的配置信息，部分高级配置需重启主机才能生效（例如内核配
置等）。为保证所有配置均能正常生效，请在安装主机成功后将主机重启一遍。
步骤8 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤9 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
2

## Page 1183

步骤10 执行TMOUT=0防止会话超时退出。
步骤11 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤12 执行以下命令，查询并记录故障主机上配置config_drive的虚拟机。
nova list --all-t --host
主机ID
--field name,config_drive
+--------------------------------------+---------------------------------+--------------+
| ID | Name | Config Drive |
+--------------------------------------+---------------------------------+--------------+
| 6d82e49c-82d6-440d-8e3e-411004070030 | br_vm_az0_dc0_group1_0 | |
| ed4e92be-9cda-42f7-ba57-dd72e5cc9830 | elbv3_cvs_vm_az0_dc0_group1_0 | |
| 3cf2d63d-cdde-4bd4-b0a6-87faaf110955 | elbv3_nginx_vm_az0_dc0_group1_0 | |
| bda34934-3fc1-41d5-b619-c8fa1a09754e | etcd_vm_az0_dc0_group1_0 | |
| bed84086-882f-4251-98ba-052ae6fdf997 | ipsec_vm_az0_dc0_group1_1 | |
| 99cf474d-dbb4-4fcf-a184-16ae3d435a59 | ipu_vm_az0_dc0_group1_0 | |
| b663591f-c6f9-4f37-a9c1-7dd2e331c8df | omu_vm_az0_dc0_group1_0 | |
| 6024db1b-9b9e-406c-8a0c-a60e47095ae7 | vrouter_vm_az0_dc0_group1_1 | |
+--------------------------------------+---------------------------------+--------------+
步骤13 执行如下命令重建步骤12中“config_drive”为“true”的虚拟机，如果没有则执行步
骤16。
nova reschedule <vm_id>
其中，vm_id为待重建虚拟机的uuid。
步骤14 执行以下命令，查询虚拟机重建是否成功。
nova show <vm_id>
其中，vm_id为待重建虚拟机的uuid。
查询回显信息中，“status”和“task_state”两个字段状态。
●
“status”状态为“ACTIVE”，“task_state”为“-”：虚拟机重建成功，可检
查虚拟机是否能正常登录。
●
“status”状态为“ERROR”，“task_state”为“-”：重建失败，可能由于资
源不足，可重复步骤13再试一次，仍然失败请联系技术支持工程师协助解决。
●
“task_state”不为“-”，管理员再等待5分钟，再重复此步骤，查看虚拟机重建
是否成功。若“task_state”一直不为“-”，再执行步骤13一次重建虚拟机。如
果一直未重建成功，请联系技术支持工程师协助解决。
步骤15 执行如下命令，重启步骤12中查询到的config_drive为空的虚拟机
nova reboot --hard vm_id
其中，vm_id为虚拟机的uuid
步骤16 执行以下命令，查询故障主机上虚拟机的状态。
nova list --all-t --host host_id
如果虚拟机状态都已经是“avtice”，则执行步骤17，如果不是，请等待几分钟后重
试。如果超过10分钟，还未恢复“avtice”，请联系技术支持工程师协助解决。
步骤17 登录FusionSphere OpenStack安装部署界面，确认步骤1中记录的虚拟机对应的host
主机状态已经为normal。如果超过半个小时，主机还未恢复正常，请联系技术支持工
程师协助解决。
2

## Page 1184

步骤18 登录Service OM界面。
具体操作请参见3.3 登录和注销Service OM界面。
步骤19 在Service OM界面，选择“监控
>
告警
>
告警列表”，查看是否有关于重新安装主机
的告警。
●
是，执行步骤20。
●
否，操作结束。
步骤20 在告警所在行的“操作”列单击“清除”，弹出“确认要消除该条告警?”对话框，单
击“确认”。
----结束
2.4.1.2.9
虚拟机冷迁移或变更规格失败处理
现象描述
●
创建虚拟机的时候启动盘是本地磁盘，带有数据卷的虚拟机进行冷迁移/变更规格
后，并且更换了主机。在更换的目的主机上，连接数据卷失败，从而冷迁移/变更
规格失败，虚拟机变更为ERROR状态。
●
因此针对这种场景，可以通过执行扩展命令行nova
ext-resize-revert server
migration_id，进行回滚来恢复虚拟机。
操作步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤3 执行如下命令，获取vm_id。
nova list --all-t|grep vm_name
说明
vm_name为故障虚拟机名称。
vm_id为故障虚拟机vm_name的id。
步骤4 在已登录的控制节点执行以下命令，查看虚拟机状态。
nova show vm_id| grep status
2

## Page 1185

●
显示虚拟机状态为ERROR，执行步骤6。
●
显示虚拟机状态为其他，联系技术支持工程师协助解决。
步骤5 执行以下命令查看实例进行的所有变更记录，确认是冷迁移/变更规格导致的虚拟机
ERROR。
nova instance-action-list vm_id
●
migrate示例如下：
●
变更规格示例如下：
步骤6 执行如下命令，查看是否有回显。
nova migration-list |grep vm_id |grep finish_resize_failed
冷迁移和变更规格都是执行此命令获取migration_id
说明
migration_id为“nova migration-list”命令查询到的id，步骤6中查询得到migration_id为
“19”。
●
是，获取migration_id，执行步骤7。
●
否，联系技术支持工程师协助解决。
步骤7 执行如下命令，恢复虚拟机状态为ACTIVE。
nova ext-resize-revert server migration_id
等待2min，执行步骤8。
2

## Page 1186

说明
server为虚拟机的id，migration_id在步骤6获取。
示例：
nova ext-resize-revert 826bae25-51e1-4a05-9076-1cde12f2618a 19
步骤8 执行如下命令，观察虚拟机的状态是否恢复为active。
nova show vm_id| grep status
●
是，执行结束。
● 否，联系技术支持工程师协助解决。
----结束
2.4.1.2.10
跨存储迁移异常处理
现象描述
在跨存储迁移过程中，如果发生服务异常（例如数据拷贝阶段cinder服务异常，存储链
路异常等），会产生跨存储拷贝异常，此时虚拟机状态异常变为
“LIVE_VOLUME_MIGRATE_FAIL”或者“VOLUME_MIGRATE_FAIL”，被迁移卷状
态变为“maintenance”，此时不能对该状态下的虚拟机或被迁移卷进行任何操作。
本章节用于在这种场景下对虚拟机和被迁移卷状态进行处理。
对系统的影响
不涉及。
可能原因
在跨存储迁移过程中，发生服务异常，例如数据拷贝阶段cinder服务异常，存储链路异
常等。
操作步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
2

## Page 1187

说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 执行如下命令，查询状态异常的VM_ID。
nova list --all-t
+---------------------------------------+------------+----------------------------------+--------------------------
+------------+-------------+--------------------------------------------------------------------------------+
| ID | Name | Tenant ID | Status | Task State | Power
State | Networks |
+---------------------------------------+------------+----------------------------------+--------------------------
+------------+-------------+--------------------------------------------------------------------------------+
| 7f186ff9-198b-40e2-9657-d14829c00f4c | cj | 59259b3cd86c4eb98f62155f9d4189b1 |
LIVE_VOLUME_MIGRATE_FAIL | - | Running | subnet-
e404=192.168.0.30 |
+---------------------------------------+------------+----------------------------------+--------------------------
+------------+-------------+--------------------------------------------------------------------------------+
说明
在虚拟机列表中，查找状态异常为“LIVE_VOLUME_MIGRATE_FAIL”或者
“VOLUME_MIGRATE_FAIL”的虚拟机，记录其ID为VM_ID。
步骤6 执行如下命令，查询状态为“maintenance”的被迁移卷名称，记录为
Volume_NAME。
cinder list --all-t | grep VM_ID
| 27fb8e53-3ab4-4fc5-acee-f5a8bab2f634 | 59259b3cd86c4eb98f62155f9d4189b1 | in-use | cj-
volume-0001 | 10 | business_type_01 | false | False | 7f186ff9-198b-40e2-9657-d14829c00f4c |
| 5ef81eb0-f9e8-4feb-beca-7b1154d091d6 | 59259b3cd86c4eb98f62155f9d4189b1 | maintenance | cj-
volume-0000 | 8 | business_type_01 | true | False | 7f186ff9-198b-40e2-9657-d14829c00f4c |
VM_ID在步骤5中查询得到。
步骤7 执行如下命令，查询状态为“maintenance”的被迁移卷ID，记录为Volume_ID和
migrated_Volume_ID。
cinder list --all-t | grep Volume_NAME
| 5ef81eb0-f9e8-4feb-beca-7b1154d091d6 | 59259b3cd86c4eb98f62155f9d4189b1 | maintenance | cj-
volume-0000 | 8 | business_type_01 | true | False | 7f186ff9-198b-40e2-9657-d14829c00f4c |
| bbb82ec2-c605-48e7-91b7-78e2a37b1557 | 59259b3cd86c4eb98f62155f9d4189b1 | maintenance |
migrated_cj-volume-0000 | 8 | cj | true | False | |
步骤8 执行如下命令，恢复状态异常的虚拟机和被迁移卷。
nova ext-volume-migrate-recover VM_ID Volume_ID
示例：
nova ext-volume-migrate-recover 7f186ff9-198b-40e2-9657-d14829c00f4c
5ef81eb0-f9e8-4feb-beca-7b1154d091d6
待命令生效后，执行步骤9。
2

## Page 1188

步骤9 执行如下命令，查看虚拟机状态和相关卷状态是否已经恢复正常。
nova list --all-t | grep VM_ID
7f186ff9-198b-40e2-9657-d14829c00f4c | cj | 59259b3cd86c4eb98f62155f9d4189b1
| ACTIVE | - | Running | subnet-e404=192.168.0.30
cinder list --all-t | grep Volume_NAME
| 5ef81eb0-f9e8-4feb-beca-7b1154d091d6 | 59259b3cd86c4eb98f62155f9d4189b1 | in-use | cj-
volume-0000 | 8 | cj | true | False | 7f186ff9-198b-40e2-9657-d14829c00f4c |
| bbb82ec2-c605-48e7-91b7-78e2a37b1557 | 59259b3cd86c4eb98f62155f9d4189b1 | reserved |
migrated_cj-volume-0000 | 8 | business_type_01 | true | False |
说明
●
虚拟机状态正常，“Status”字段为 ACTIVE或SHUTOFF。
●
被迁移卷状态正常，“Status”字段为“in-use”。
●
预留卷状态正常，“Status”字段为“reserved”。
●
是，执行步骤10。
●
否，请联系技术支持工程师协助解决。
步骤10 登录弹性云服务器确认迁移后用户数据是否完整。
●
是，任务结束。
●
否，请联系华为技术支持工程师。
说明
登录操作请根据Region Type类型参考对应版本的“登录弹性云服务器”章节。
● Region Type
I：请参考《弹性云服务器(ECS)
8.1.0
使用指南(for 华为云Stack 8.1.0)》中
的《弹性云服务器(ECS)
8.1.0
用户指南(for 华为云Stack 8.1.0)》“登录弹性云服务器”章
节。
----结束
2.4.1.2.11
整机冷迁移异常处理
现象描述
●
在虚拟机整机冷迁移过程中，如果发生服务异常（例如nova-compute服务被重启
等），导致卷状态变为“maintenance”，此时不能对虚拟机做任何操作，本章
节用于在这种场景下对卷状态进行处理。
● 若虚拟机整机冷迁移后，未删除虚拟机源磁盘，但是虚拟机被手动删除，导致预
留状态的卷残留，执行本章节“处理卷状态”的步骤8进行处理。
●
在虚拟机整机冷迁移过程中，neutron-server组件异常，整机冷迁移失败，虚拟机
和磁盘的az已经变为目的az，但是port的az还是旧az，需要手动更新。
操作步骤
处理卷状态
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
2

## Page 1189

说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 执行以下命令，查询虚拟机挂载的卷名称。
cinder list --all-t | grep VM_ID| awk '{print $8}'
其中“VM_ID”为虚拟机ID，可以从Service OM上获取。
对查询到的每个卷，依次执行步骤6-步骤8。
步骤6 执行以下命令，获取卷的名称与ID。
cinder list --all-t | grep VOLUME_NAME | awk '{print $8" "$2}'
migrated_test_vol c2910ef2-2c02-40c0-9e27-bfe37257d83a
test_vol ca5ba71d-8394-432b-849b-d8e8031e8b86
其中“VOLUME_NAME”为步骤5中获取的卷名称。
步骤7 执行以下命令恢复虚拟机挂载的卷状态。
cinder reset-state --state in-use --reset-migration-status volumd_id
其中“volume_id”为步骤6获取的不以“migrated_”开头的卷ID。
步骤8 执行以下命令，删除残留卷。
cinder reset-state --reset-migration-status --attach-status detached volumd_id
cinder delete volumd_id
其中“volume_id”为步骤6获取的以migrated_开头的卷ID或者操作场景•若虚拟机整
机冷迁移后，未删除虚拟机源磁盘，但是...中的残留卷ID。
步骤9 执行如下命令，查看卷状态是否为in-use。
cinder list --all-t | grep VM_ID
●
是，任务结束。
2

## Page 1190

●
否，联系技术支持工程师协助解决。
----结束
更新Port的AZ信息
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 执行以下命令，查看虚拟机的port信息。
nova interface-list VM_ID
其中“VM_ID”为虚拟机的uuid。
对查询到的每个Port ID，执行步骤6。
步骤6 执行以下命令，查看port信息。
neutron port-show PORT_ID
●
若回显中binding:profile的值没有az信息，执行7.1。
●
若回显中binding:profile的值有az信息，执行7.2。
步骤7 更新port的AZ信息。
1.
执行以下命令，更新AZ信息。
mytoken=`openstack token issue | grep -w id | awk '{print $4}'`;
curl -ik -X PUT https://network.localdomain.com:8020/v2.0/ports/
PORT_ID.json -H "User-Agent: python-neutronclient" -H "Content-Type:
application/json" -H "Accept: application/json" -H "X-Auth-Token:
$mytoken" -d '{"port": {"device_owner": "compute:az2.dc2"}}'
其中，PORT_ID为步骤5查询到的Port ID，az2.dc2替换为虚拟机迁移的目标AZ。
2

## Page 1191

2.
执行以下命令，更新AZ信息。
mytoken=`openstack token issue | grep -w id | awk '{print $4}'`;
curl -ik -X PUT https://network.localdomain.com:8020/v2.0/ports/
PORT_ID.json -H "User-Agent: python-neutronclient" -H "Content-Type:
application/json" -H "Accept: application/json" -H "X-Auth-Token:
$mytoken" -d '{"port": {"device_owner": "compute:az2.dc2",
"binding:profile": {"availability_zone": "az2.dc2"}}}'
其中，PORT_ID为步骤5查询到的Port ID，az2.dc2替换为虚拟机迁移的目标AZ。
----结束
2.4.1.2.12
虚拟机系统卷损坏后无法登录的救援方法
现象描述
虚拟机系统磁盘损坏后，可能导致虚拟机无法登录。本操作指导工程师对虚拟机进行
救援恢复。
操作步骤
从镜像启动的虚拟机，需要使用rescue命令救援，从卷启动的虚拟机，要使用虚拟机
进行救援。可通过nova
show
VM_ID命令查看虚拟机从卷启动或从镜像启动。
查询虚拟机启动方式
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 查看虚拟机从镜像启动或从卷启动。
1.
执行如下命令，采用安全方式操作。
2

## Page 1192

runsafe
显示以下信息：
Input command:
2.
执行以下命令，查看被救援的虚拟机ID。
nova list --all-t
回显如下信息：
3.
执行如下命令，查询虚拟机属性。
nova show VM_ID
其中，VM_ID为被救援虚拟机ID。
– 回显以下类似信息，表明虚拟机是从镜像启动，括号内信息为镜像ID。请执
行步骤6 ～ 步骤10进行救援恢复。
| image | cirros (d0bd0551-07f2-45f6-8516-f481e0152715)|
若回显以下信息，表明虚拟机是从卷启动。请执行步骤11 ～ 步骤19进行救
援恢复。
| image | Attempt to boot from volume - no image supplied|
从镜像启动虚拟机的救援方法
步骤6 上传救援镜像并完成镜像注册，具体操作请参见《华为云Stack
8.1.0
运维指南》中
“注册镜像”章节。
说明
● 建议救援镜像文件无需过大，能引导虚拟机正常启动，满足救援条件即可。
●
建议救援镜像命名容易识别，以方便救援操作时选择救援镜像。
步骤7 使虚拟机进入救援模式。
使虚拟机进入救援模式，可以指定镜像，也可以不指定镜像，用户根据需要选择一种
来操作。
●
不指定镜像救援
a.
执行命令nova
rescue
VM_ID，使虚拟机进入救援模式。
其中，VM_ID为被救援虚拟机ID。
b.
执行命令nova
list
--all-t，可以看到被救援的虚拟机状态已经变为
“RESCUE”。
2

## Page 1193

●
指定镜像救援
a.
执行命令glance image-list，查看可用镜像及镜像ID。
其中，“Name”为“cirros”的镜像为步骤6中注册的救援镜像。
b.
执行命令nova
rescue --image IMAGE_ID
VM_ID，使虚拟机进入救援模
式。
其中，VM_ID为被救援虚拟机ID，IMAGE_ID 为7.a中查到的镜像ID。这里的
镜像可以选择Linux镜像，也可以选择Windows镜像，以下操作以Linux镜像
为例。
c.
执行命令nova
list
--all-t，可以看到被救援的虚拟机状态已经变为
“RESCUE”。
步骤8 执行以下命令，并使用回显信息中的Url登录虚拟机。
nova get-vnc-console VM_ID novnc
其中，VM_ID为被救援虚拟机ID。
回显如下信息：
将回显信息中Url的“nova-novncproxy.az1.dc1.domainname.com”替换成
OpenStack环境的反向代理IP地址登录虚拟机。如：“https://192.168.11.11:8002/
vnc_lite.html?token=be540cf4-0185-4992-bafc-60bf6db48191&lang=EN”。
使用替换后的Url在浏览器中登录被救援的虚拟机。
步骤9 输入虚拟机的用户名和密码登录虚拟机，然后执行修复受损系统卷的指令。
●
进入救援模式前，虚拟机的系统盘为“vda”（Linux虚拟机通常为“vda”/
“sda”，Windows虚拟机通常为“C”，挂载点需根据具体情况而定）。
2

## Page 1194

●
进入救援模式后，虚拟机的系统盘盘符向后顺延。
说明
rescue接口本身就是用来修复系统卷的，所以在“rescue”状态下，只能看到系统盘。如果待救
援的虚拟机数据卷也损坏了，在系统卷修复后，虚拟机正常启动再去修复数据卷即可。
步骤10 救援操作完成后，执行命令nova
unrescue
VM_ID，虚拟机状态即可恢复
“ACTIVE”。
其中，VM_ID为被救援虚拟机ID。
当虚拟机可以登录，并且开、关机等操作正常时，表示虚拟机救援恢复成功。
从卷启动虚拟机的救援方法
步骤11 登录FusionSphere OpenStack管理控制台的租户视图，在“资源
>
计算 >计算实例
>
虚拟机”中，找到要救援的虚拟机。
步骤12 在“虚拟机”界面，单击“创建”，创建救援虚拟机。
救援虚拟机的可用分区、规格、镜像等参数要与被救援虚拟机保持一致。
步骤13 在被救援虚拟机所在行，选择“更多
>
关闭”，关闭被救援的虚拟机。
步骤14 将被救援虚拟机的系统卷挂载到新创建的救援虚拟机上。
1.
执行步骤1 ～ 步骤4，登录AZ内第一台主机并导入环境变量。
导入环境变量
2.
执行命令nova
list
--all-t，可以看到被救援的虚拟机状态为“SHUTOFF”，记录
其ID，以及救援虚拟机的ID。
3.
执行命令nova
show
VM_ID，查询被救援虚拟机的系统卷ID和系统卷设备名称。
其中，VM_ID为被救援虚拟机ID。
2

## Page 1195

4.
执行命令nova
volume-detach VM_ID
VOLUME_ID，卸载被救援虚拟机的系统
卷。
其中，VM_ID为被救援虚拟机ID，VOLUME_ID为被救援虚拟机的系统卷ID。
5.
执行命令nova
volume-attachments
VM_ID，查看被救援虚拟机挂载的卷，发
现系统卷已卸载。
其中，VM_ID为被救援虚拟机ID。
6.
执行命令nova
volume-attach VM_ID
VOLUME_ID，将被救援虚拟机的系统卷
挂载到救援虚拟机上。
其中，VM_ID为救援虚拟机ID，VOLUME_ID为被救援虚拟机的系统卷ID。
7.
执行命令nova
volume-attachments
VM_ID，查看救援虚拟机挂载的卷，发现
被救援虚拟机的系统卷已挂载。
其中，VM_ID为救援虚拟机ID。
步骤15 执行以下命令，并使用回显信息中的Url登录救援虚拟机。
nova get-vnc-console VM_ID novnc
2

## Page 1196

其中，VM_ID为救援虚拟机ID。
回显如下信息：
将回显信息中Url的“nova-novncproxy.az1.dc1.domainname.com”替换成
OpenStack环境的反向代理IP地址登录虚拟机。如：“https://192.168.11.11:8002/
vnc_lite.html?token=7c640a6b-e23a-4885-a651-e6df097f12eb&lang=EN”。
使用替换后的Url在浏览器中登录救援虚拟机。
步骤16 根据具体情况执行修复受损文件系统的指令或操作。
步骤17 修复完成后，在FusionSphere OpenStack管理控制台的“虚拟机”界面，在救援虚拟
机所在行，选择“更多
>
关闭”，关闭救援虚拟机。
步骤18 在FSP后台执行以下操作，将救援虚拟机上卸载修复完成的系统卷，重新挂载到被救援
虚拟机上。
1.
执行命令nova
volume-detach VM_ID
VOLUME_ID，将救援虚拟机上修复完成
的系统卷卸载。
其中，VM_ID为救援虚拟机ID，VOLUME_ID为被救援虚拟机的系统卷ID。
2.
执行命令nova
volume-attachments
VM_ID，查看救援虚拟机挂载的卷，发现
修复完成的系统卷已被卸载。
其中，VM_ID为救援虚拟机ID。
3.
执行命令nova
volume-attach VM_ID VOLUME_ID
VOLUME_NAME，将修复完
成的系统卷重新挂载到被救援虚拟机上。
其中，VM_ID为被救援虚拟机ID，VOLUME_ID为被救援虚拟机的系统卷ID，
VOLUME_NAME为被救援虚拟机的系统卷设备名称。
4. 执行命令nova volume-attachments VM_ID，查看被救援虚拟机挂载的卷。
其中，VM_ID为被救援虚拟机ID
步骤19 在FusionSphere OpenStack管理控制台的“虚拟机”界面，在被救援虚拟机所在行，
单击“启动”，将被救援虚拟机启动。
被救援虚拟机的状态从“已停止”变为“运行中”，表示虚拟机救援恢复成功。
----结束
2

## Page 1197

2.4.1.2.13
虚拟机卸载系统磁盘后发生故障的恢复方法
现象描述
卸载虚拟机的系统磁盘后，虚拟机出现故障，此时无法完成新的系统磁盘的挂载。
可能原因
●
主机下电或主机故障
●
虚拟机状态异常
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 执行以下命令查询故障虚拟机所在的主机。
nova show
故障虚拟机ID
| grep host
其中，故障虚拟机的ID可以从FusionSphere OpenStack管理控制台中查询。
记录回显结果中OS-EXT-SRV-ATTR:host的值，即故障虚拟机所在主机的ID。
步骤6 执行以下命令查看主机状态是否正常。
cps host-list | grep
主机ID
其中主机ID为故障虚拟机所在主机的ID。
回显信息中显示“normal”表示主机状态正常。
●
主机状态正常，执行步骤9。
2

## Page 1198

●
主机状态异常，执行步骤7。
如果主机状态异常，需要记录该主机的内部管理IP地址。
步骤7 使用以下方式尝试恢复主机：
1.
先执行su
-
fsp切换到“fsp”用户，通过命令ssh fsp@主机IP地址登录主机，并
切换到root用户。
按照提示输入系统私钥密码，如果已生成并替换了新的公私钥文件，请输入新私
钥密码。或者直接按“Enter”后按照提示输入fsp用户的密码登录。
2.
通过reboot命令重启该主机。
如果主机故障导致主机网络无法连通，则请使用主机BMC系统等方式对主机重
启。
可通过步骤6的方法查看主机状态，10分钟内，主机状态变为“normal”表示主
机恢复成功。
步骤8 主机是否可以恢复。
●
是，执行步骤9。
●
否，执行步骤13，通过重建虚拟机方式恢复虚拟机。
说明
使用该方法会导致虚拟机的ID、网络信息等发生变化，如果虚拟机使用本地磁盘，则磁盘信息也
会丢失。
步骤9 执行以下命令查看虚拟机的状态。
nova show
故障虚拟机ID
| grep status
●
状态为“SHUTOFF”，执行步骤12。
●
其他状态，执行步骤10。
步骤10 执行以下命令停止虚拟机。
nova stop
故障虚拟机ID
步骤11 参考步骤9再次查看虚拟机状态。
●
状态为“SHUTOFF”，执行步骤12。
●
其他状态，请联系技术支持工程师协助解决。
步骤12 为虚拟机挂载新的系统磁盘。
●
挂载成功，任务结束。
●
挂载失败，请联系技术支持工程师协助解决。
步骤13 执行以下命令查看并记录虚拟机的详细状态。
nova show
故障虚拟机ID
需记录虚拟机的各项属性值，如表2-8所示。
2

## Page 1199

表2-8 虚拟机属性值说明
属性 说明 取值样例
os-extended-
volumes:volume
s_attached
虚拟机挂载的磁盘的ID，可能
有多个
8458dbff-1acd-4445-
a3ea-751b6c4a8d80
tenant_id
虚拟机所在的租户ID
bca6f4e8b2034d3eb93e7c94e
897d619
user_id
创建虚拟机的用户ID
3cf46a44f05642149c1c927391
3429cc
config_drive
文件注入是否使用congfig
drive盘
空或者True
flavor
虚拟机所用的规格
m1.tiny (1)
metadata
是否指定metadata
{}
name
虚拟机名称
Test01
security_groups
安全组信息
default
tags
Tag信息
[]
步骤14 根据查询到的租户ID，导入环境变量。
export tenant_id=tenant_id
步骤15 使用vi编辑器，新建文件，命名为“d.json”，写入如下内容：
{
"auth": {
"identity": {
"methods": [
"password"
],
"password": {
"user": {
"domain": {
"name": "vdc_name"
},
"name": "username",
"password": "password"
}
}
},
"scope": {
"project": {
"domain": {
"name": "vdc_name"
},
"name": "vpc_name"
}
}
}
}
其中：
2

## Page 1200

●
“username”：使用默认管理员cloud_admin帐户登录FusionSphere
OpenStack
管理控制台，在“系统
>
用户管理”中，查看ID列，找到与虚拟机user_id一致的
用户信息，此处填写该用户的用户名。
●
“password”：该username对应用户的访问密码。
●
“vdc_name”：联系管理员，在具体使用的业务发放工具中，查看虚拟机的
username是否属于某个VDC。如果是，则填写为该VDC的名称；如果不属于任何
VDC，则填写为“Default”。
●
“vpc_name”：联系管理员，在具体使用的业务发放工具中，依次查看各VPC的
ID，找到与虚拟机tenant_id一致的VPC，此处填写该VPC名称。如果未找到
tenant_id对应的VPC，则在已登录的FusionSphere OpenStack系统中，执行命令
openstack project list | grep
tenant_id查询，回显信息中，第二个字段即为要
填写的vpc_name。
说明
如果无法查询到具体的username、vdc_name、以及vpc_name，请联系技术支持工程师协助解
决。
步骤16 执行以下命令导入Token环境变量。
export TOKEN=$(curl -ki -d @d.json -H "Content-type: application/json"
https://identity.localdomain.com:8023/identity/v3/auth/tokens | awk '/X-
Subject-Token/ {print $2}' | tr -d '\r')
说明
为保证用户帐户信息安全，请在此步骤后，删除步骤15创建的json文件。
步骤17 执行以下命令查看虚拟机的网络信息，并记录虚拟机所用网络的ID。
nova interface-list
虚拟机ID
显示类似如下信息：
+------------+--------------------------------------+--------------------------------------+--------------
+-------------------+
| Port State | Port ID | Net ID | IP addresses | MAC Addr |
+------------+--------------------------------------+--------------------------------------+--------------
+-------------------+
| ACTIVE | 60b5961f-8afb-4735-9f3c-368d414857d2 | 04c20a58-b01f-4d18-b3e9-6c49ce78a22c |
192.168.211.6| fa:16:3e:56:d3:71 |
+------------+--------------------------------------+--------------------------------------+--------------
+-------------------+
虚拟机可能使用了多个网络，需记录所有网络ID。
步骤18 在原虚拟机所用到的网络中创建新的port，并记录port的ID。
curl -i --insecure -X POST https://network.localdomain.com:8020/v2.0/
ports.json -H "User-Agent: python-neutronclient" -H "Content-Type:
application/json" -H "Accept: application/json" -H "X-Auth-Token: $TOKEN" -
d '{"port":{"network_id": "Net_ID", "tenant_id": "'tenant_id'",
"binding:vnic_type": "vNIC_type", "name": "port_name", "admin_state_up":
true}}'
其中，vNIC_type根据网络类型（硬直通，EVS或者OVS），硬直通为direct，EVS和
OVS均为normal。
例如：
2

## Page 1201

curl -i --insecure -X POST https://network.localdomain.com:8020/v2.0/
ports.json -H "User-Agent: python-neutronclient" -H "Content-Type:
application/json" -H "Accept: application/json" -H "X-Auth-Token: $TOKEN" -
d '{"port": {"network_id": "04c20a58-b01f-4d18-b3e9-6c49ce78a22c",
"tenant_id": "'$tenant_id'", "binding:vnic_type": "normal", "name": "lt-test",
"admin_state_up": true}}'
记录生成的port的ID，例如“3f7ebd45-9a96-474c-88e6-5e3bf6e018cc”。
步骤19 执行以下命令为原虚拟机的磁盘做快照，并记录快照ID。
curl -i --insecure -X POST https://volume.localdomain.com:8776/v2/$
{tenant_id}/snapshots -H "User-Agent: python-cinderclient" -H "Content-
Type: application/json" -H "Accept: application/json" -H "X-Auth-Token:
$TOKEN" -d '{"snapshot": {"description": description, "metadata": {metadata},
"force": "True", "name": "snapshot_name", "volume_id": "volume_id"}}'
例如：
curl -i --insecure -X POST https://volume.localdomain.com:8776/v2/$
{tenant_id}/snapshots -H "User-Agent: python-cinderclient" -H "Content-
Type: application/json" -H "Accept: application/json" -H "X-Auth-Token:
$TOKEN" -d '{"snapshot": {"description": null, "metadata": {}, "force": "True",
"name": "data_snap01", "volume_id": "8458dbff-1acd-4445-
a3ea-751b6c4a8d80"}}'
记录生成的快照ID，例如“1e5b7681-faa1-4de0-9d80-ee3e2a606eeb”。
执行以下命令直到快照的“status”变成“available”，表示快照创建成功。
cinder snapshot-show
快照ID
如果虚拟机有多个磁盘，则需要对多个磁盘依次做快照。
步骤20 执行以下命令，使用创建出的磁盘快照创建新的磁盘。
curl -i --insecure -X POST https://volume.localdomain.com:8776/v2/$
{tenant_id}/volumes -H "User-Agent: python-cinderclient" -H "Content-Type:
application/json" -H "Accept: application/json" -H "X-Auth-Token: $TOKEN" -
d '{"volume": {"name": "new_volume_name", "availability_zone":
AZname,"metadata": {metadata},"snapshot_id": "snapshot_id"}}'
其中，AZname表示磁盘的AZ信息，可以通过cinder
show
磁盘ID命令查询原虚拟机
的磁盘AZ，新的磁盘AZ与之保持一致。
例如：
curl -i --insecure -X POST https://volume.localdomain.com:8776/v2/$
{tenant_id}/volumes -H "User-Agent: python-cinderclient" -H "Content-Type:
application/json" -H "Accept: application/json" -H "X-Auth-Token: $TOKEN" -
d '{"volume": {"name": "data01_volume", "availability_zone":
null,"metadata": {},"snapshot_id": "1e5b7681-faa1-4de0-9d80-
ee3e2a606eeb"}}'
记录生成的新的磁盘的ID，例如“2ffa5677-0a13-4ea6-bcdc-1575b40780a8”。
如果有多个磁盘快照，需要依次生成新的磁盘。
步骤21 在业务发放系统中创建新的虚拟机。
2

## Page 1202

要求虚拟机的磁盘为云磁盘，并且虚拟机的相关属性以及使用的网络需要与原故障虚
拟机一致。
如果无法通过业务发放系统创建，可使用如下命令：
curl -i --insecure 'https://compute.localdomain.com:8001/v2/'$tenant_id'/os-
volumes_boot' -X POST -H "Accept: application/json" -H "Content-Type:
application/json" -H "User-Agent: python-novaclient" -H "X-Auth-Token:
$TOKEN" -d '"server": {"name": "vm_name", "imageRef": "",
"block_device_mapping_v2": [{"source_type": "source_type",
"destination_type": "destination_type", "boot_index": "boot_index", "uuid":
"source_id", "volume_size": "volume_size"}], "flavorRef": "flavorRef",
"max_count": max_count, "min_count": min_count, "networks": [{"port":
"port_id"}], "config_drive": false}}'
例如：
curl -i --insecure 'https://compute.localdomain.com:8001/v2/'$tenant_id'/os-
volumes_boot' -X POST -H "Accept: application/json" -H "Content-Type:
application/json" -H "User-Agent: python-novaclient" -H "X-Auth-Token:
$TOKEN" -d '"server": {"name": "new_vm_02", "imageRef": "",
"block_device_mapping_v2": [{"source_type": "image", "destination_type":
"volume", "boot_index": "0", "uuid":
"5f6a4b1d-1815-4c33-9c50-710fac909cc0", "volume_size": "1"}], "flavorRef":
"1", "max_count": 1, "min_count": 1, "networks": [{"port":
"3f7ebd45-9a96-474c-88e6-5e3bf6e018cc"}], "config_drive": false}}'
创建虚拟机后，会返回虚拟机的ID，需记录该ID。执行如下命令直到虚拟机的
“vm_state”变成“active”，表示虚拟机创建成功。
nova show
虚拟机ID
步骤22 在业务发放系统中，将步骤20创建的磁盘挂载到新的虚拟机上。
如果无法通过业务发放系统创建，可使用如下方式：
1.
导入虚拟机ID的环境变量。
export uuid=vm_id
2. 执行以下命令为虚拟机挂载磁盘。
curl -i --insecure "https://
compute.localdomain.com:8001/v2/$TENANT_ID/servers/${uuid}/os-
volume_attachments" -X POST -H "X-Auth-Project-Id: service" -H "X-Auth-
Token: $TOKEN_ID" -H "Content-Type: application/json" -H "Accept:
application/json" -H "User-Agent: python-novaclient" -d
'{"volumeAttachment": {"volumeId": "volumeId"}}'
例如：
curl -i --insecure "https://
compute.localdomain.com:8001/v2/$TENANT_ID/servers/${uuid}/os-
volume_attachments" -X POST -H "X-Auth-Project-Id: service" -H "X-Auth-
Token: $TOKEN_ID" -H "Content-Type: application/json" -H "Accept:
application/json" -H "User-Agent: python-novaclient" -d
'{"volumeAttachment": {"volumeId": "3f28cb04-c9f9-4ae4-
b350-6dd6da80f41d"}}'
步骤23 新创建的虚拟机业务功能正常后，可删除原故障虚拟机。
2

## Page 1203

原故障虚拟机的磁盘，以及重建磁盘时制作的磁盘快照，请评估不再使用后，也可做
删除处理。
----结束
2.4.1.3
基础设施类故障
2.4.1.3.1
CPS服务不可用
现象描述
执行CPS的CLI命令，没有成功返回，或者返回错误“Connection refused!”。例如执
行cpssafe命令进入安全模式，选择1,按照提示输入用户名和密码后再按照提示输入命
令查看主机的状态。
cps host-list
命令执行后没有返回，或者提示如下信息：
Connection refused!
可能原因
●
网络故障。
●
鉴权模式打开情况下，配置DNS错误，导致cps命令不可用。
●
控制节点所在主机提供CPS服务的socket端口异常。
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
2

## Page 1204

步骤5 执行如下命令，查询提供CPS服务的IP是否能够ping通。
ping
CPS服务所在主机的管理IP
CPS服务所在主机的管理IP：CPS服务所在主机的IP地址固定为“172.28.8.130”。
●
是，执行步骤7。
●
否，执行步骤6。
步骤6 联系运维人员恢复网络。重新执行CPS命令，查看是否能正常运行。
●
是，执行结束。
●
否，执行步骤7。
步骤7 执行以下命令通过ssh登录控制节点主机。
一般控制节点主机为安装时最先安装的三台主机，此时IP地址依次为172.28.0.2、
172.28.0.3、172.28.0.4，具体请从管理员处获取。如果管理员未记录，请联系技术支
持工程师协助解决。
su - fsp
ssh
fsp@IP地址
按照提示输入系统私钥密码，如果已生成并替换了新的公私钥文件，请输入新私钥密
码。或者直接按“Enter”后按照提示输入fsp用户的密码登录。
然后执行su
-
root并输入root用户密码切换到root用户。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤8 执行以下命令强制关闭鉴权模式。
sed -i 's/"auth_mode": "True"/"auth_mode": "False"/g' /etc/huawei/
fusionsphere/cps.cps-client/cfg/cps.cps-client.cfg
sed -i 's/"auth_mode": "True"/"auth_mode": "False"/g' /etc/huawei/
fusionsphere/cps.cps-server/cfg/cps.cps-server.cfg
sed -i 's/auth_mode = True/auth_mode = False/g' /usr/local/bin/cps-client/
cps_client/cps_client.ini
sed -i 's/auth_mode = True/auth_mode = False/g' /usr/local/bin/cps-server/
cps_server/cps-server.ini
步骤9 执行以下命令关闭CPS服务进程。
kill -9 `ps -eo pid,cmd ww | grep ' /usr/local/bin/cps-server/cps_server/
cpsserver.py'| grep -v grep| awk '{print $1}'`
步骤10 重复执行步骤7～步骤9，在另外两台控制节点主机进行操作。
步骤11 在当前登录的任意一台主机执行cps host-list命令，显示完整主机列表则表示cps服务
已自动重启成功。
步骤12 执行以下命令查看当前DNS配置。
cps template-params-show --service dns dns-server
显示类似如下信息：
2

## Page 1205

+----------+------------------------------------------+
| Property | Value |
+----------+------------------------------------------+
| address | /az1.dc1.domainname.com/192.168.211.10,/ |
| | identity.az1.dc1.domainname.com/192.168. |
| | 211.10,/image.az1.dc1.domainname.com/192 |
| | .168.211.10 |
| network | [] |
| server | |
+----------+------------------------------------------+
步骤13 查看所配置的DNS信息所对应的IP地址，如果有误，使用如下命令修改。
cps template-params-update --service dns dns-server --parameter address=/
address/IP
多条DNS信息中间用英文“,”分隔。DNS地址的详细说明可参见《华为云Stack 8.1.0
运维指南》 中“产品管理 > FusionSphere OpenStack > 系统 > 修改系统配置”章
节。
步骤14 执行以下命令提交配置。
cps commit
步骤15 执行以下命令确认配置已正确写入配置文件。
cat /etc/dnsmasq.conf | grep address=
步骤16 待配置正确后，执行以下命令重新开启鉴权模式。
sed -i 's/"auth_mode": "False"/"auth_mode": "True"/g' /etc/huawei/
fusionsphere/cps.cps-client/cfg/cps.cps-client.cfg
sed -i 's/"auth_mode": "False"/"auth_mode": "True"/g' /etc/huawei/
fusionsphere/cps.cps-server/cfg/cps.cps-server.cfg
sed -i 's/auth_mode = False/auth_mode = True/g' /usr/local/bin/cps-client/
cps_client/cps_client.ini
sed -i 's/auth_mode = False/auth_mode = True/g' /usr/local/bin/cps-server/
cps_server/cps-server.ini
步骤17 执行以下命令关闭CPS服务进程。
kill -9 `ps -eo pid,cmd ww | grep ' /usr/local/bin/cps-server/cps_server/
cpsserver.py'| grep -v grep| awk '{print $1}'`
步骤18 重复执行步骤16～步骤17，在另外两台控制节点主机进行操作。
步骤19 再次开启鉴权模式后，重新执行CPS命令，查看是否能正常运行。
●
是，执行结束。
●
否，执行步骤20。
步骤20 执行以下操作，登录CPS服务所在的主机。
ssh
fsp@管理IP
su - root
步骤21 导入环境变量。
具体操作请参见导入环境变量。
2

## Page 1206

步骤22 执行如下命令，查询CPS服务监听的端口状态。
netstat -anp | grep 8000 | grep 130
显示结果类似如下：
tcp 0 0 172.28.8.130:8000 0.0.0.0:* LISTEN -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58434 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59575 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59759 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58449 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58437 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59765 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58439 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58451 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58450 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59748 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58243 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58441 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58245 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58443 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59749 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58444 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59750 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58250 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59755 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59758 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59751 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59760 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58442 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.3:49066 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58436 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59763 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59754 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59752 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59762 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.3:47725 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58446 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58438 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59572 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59753 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59764 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59578 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58445 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58440 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59757 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58435 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58452 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58448 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59561 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59761 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:59756 TIME_WAIT -
tcp 0 0 172.28.8.130:8000 172.28.0.2:58248 TIME_WAIT -
检查上述结果中的倒数第二列，是否存在大量的SYN_RECV或CLOSE_WAIT状态。
●
是，执行步骤23。
●
否，执行步骤26。
步骤23 执行如下命令，获取CPS服务的进程ID。
ps -ef | grep cpsserver.py | grep -v grep | awk -F ' ' '{print $2}'
能够成功得到进程ID，类似如下结果：
25567
●
是，执行步骤24。
2

## Page 1207

●
否，执行步骤26。
步骤24 执行如下命令，关闭查询到的所有服务进程。
kill -9
进程ID
echo $?
进程ID：为步骤23操作得到的进程id。
判断显示命令执行结果为0，如下显示：
0
●
是，执行步骤25。
●
否，执行步骤26。
步骤25 等待1分钟，执行cpssafe命令进入安全模式，选择1，按照提示输入密码后再按照提示
输入命令，验证修复结果。
cps host-list
能够显示如下信息。
+--------------------------------------+-----------+----------------------+--------+------------+------+
| id | boardtype | roles | status | manageip | omip |
+--------------------------------------+-----------+----------------------+--------+------------+------+
| D826749C-FD53-118E-8567-000000821800 | BC21THSA | auth, | normal | 172.28.6.1 | |
| | | blockstorage-driver, | | | |
| | | compute, | | | |
| | | controller, | | | |
| | | database, | | | |
| | | image, | | | |
| | | measure, | | | |
| | | rabbitmq, | | | |
| | | router, | | | |
| | | sys-server | | | |
| 57CB4932-E26B-1167-8567-000000821800 | BC21THSA | auth, | normal | 172.28.0.2 | |
| | | blockstorage-driver, | | | |
| | | compute, | | | |
| | | controller, | | | |
| | | database, | | | |
| | | image, | | | |
| | | measure, | | | |
| | | router, | | | |
| | | sys-server | | | |
+--------------------------------------+-----------+----------------------+--------+------------+------+
●
是，执行结束。
● 否，执行步骤26。
步骤26 联系技术支持工程师协助解决。
----结束
2.4.1.3.2
主备服务出现双备故障
现象描述
正常情况下为主备状态的服务出现双备。主备服务出现双备的场景包括：执行cps
template-instance-list --service service_name
template_name，发现所有的实例
状态为“standby”，且持续时间超过5分钟。
2

## Page 1208

可能原因
zookeeper数据不一致。需要重新触发该服务的主备仲裁，恢复其主备状态。
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 执行以下命令，查询zookeeper服务器的IP地址段。
ip addr show | grep zk-s | awk -F '/' '{print $1}' | awk -F ' ' '{print $2}' | awk -F
'.' '{print $1"."$2"."$3}'
回显如下类似信息：
172.28.8
根据上述查询到的IP地址段，分别得到zookeeper的IP地址为172.28.8.121、
172.28.8.122、172.28.8.123。
步骤6 执行如下命令，登录对应的zookeeper服务器，其中的server_ip为上一步中获取到的
zookeeper三个IP地址中的第一个IP地址。
export JAVA_HOME=/usr/lib/jre
sh /usr/local/bin/zookeeper/zookeeper/bin/zkCli.sh -server server_ip:9880
步骤7 执行以下命令设置zookeeper的acl认证数据。
addauth digest zookeeper:password
其中password为zookeeper帐户的默认密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
2

## Page 1209

步骤8 执行以下命令查询出现双备的服务的仲裁节点队列。
ls /cps/runtime/srvdeploy/service_name.template_name/haarbitration
其中service_name和template_name分别对应服务名和组件名，如haproxy.haproxy，
显示信息如下：
[10000000004, 10000000003]
步骤9 执行以下命令退出登录的zookeeper服务器。
quit
步骤10 重复执行步骤6～步骤9，依次使用zookeeper的三个IP地址登录对应的服务器，查询对
应的仲裁节点序列。
步骤11 比较不同的服务器中的仲裁节点序列是否一致。
●
是，执行步骤12。
●
否，联系技术支持工程师协助解决。
步骤12 依次登录三个控制节点，执行以下命令：
export JAVA_HOME=/usr/lib/jre
sh /usr/local/bin/zookeeper/zookeeper/bin/zkServer.sh status /usr/local/bin/
zookeeper/zookeeper/conf/zoo_Clusters.cfg
回显如下类似信息：
JMX disabled by user request
Using config: /usr/local/bin/zookeeper/zookeeper/conf/zoo_Clusters.cfg
Mode: leader
待查询出来的“Mode”为“leader”时，则可以进行下一步操作。
步骤13 执行以下命令，停止zookeeper进程。
kill -9 `ps -ef | grep -v grep | grep /usr/local/bin/zookeeper | awk -F ' ' '{print
$2}'`
步骤14 等待zookeeper服务停止成功，等待5秒执行如下命令。
export JAVA_HOME=/usr/lib/jre
sh /usr/local/bin/zookeeper/zookeeper/bin/zkServer.sh status /usr/local/bin/
zookeeper/zookeeper/conf/zoo_Clusters.cfg
回显如下类似信息：
JMX disabled by user request
Using config: /usr/local/bin/zookeeper/zookeeper/conf/zoo_Clusters.cfg
Mode: follower
回显信息是否如上所示。
●
是，执行步骤15。
●
否，可等待2分钟，若仍无法显示，联系技术支持工程师协助解决。
步骤15 执行以下命令，查询服务的主备状态。
cps template-instance-list --service service name template name
service
name和template name分别代表服务名和组件名。
2

## Page 1210

例如，查询haproxy服务的主备状态，执行命令如下：
cps template-instance-list --service haproxy haproxy
回显如下类似信息，表示主备状态正常。
+------------+---------------------------------+---------+------------+
| instanceid | componenttype | status | runsonhost |
+------------+---------------------------------+---------+------------+
| 0 | haproxy-2015.1.521-1.noarch.rpm | standby | 106control |
| 1 | haproxy-2015.1.521-1.noarch.rpm | active | 107control |
+------------+---------------------------------+---------+------------+
可每隔10秒查询一次，查看是否恢复主备。
●
是，结束。
●
否，若查询状态全部为“standby”超过5分钟，联系技术支持工程师协助解决。
----结束
2.4.1.3.3
服务对接的远端存储故障
现象描述
服务（包括image、image-cache）对接的远端存储的磁盘故障。
可能原因
远端存储硬件故障导致服务所使用的LUN无法读写数据。
处理步骤
步骤1 参考所使用的远端存储的故障处理手册，处理远端存储自身的故障。
步骤2 删除各主机上所有使用本地镜像启动的虚拟机。
使用本地镜像启动的虚拟机包括通过FusionSphere OpenStack创建的所有管理虚拟
机，可通过FusionSphere OpenStack安装部署界面删除。
步骤3 查询当前系统中各主机使用的磁盘规则。
1.
在FusionSphere OpenStack安装部署界面的“配置
>
磁盘”页面查询各主机分
组，找出使用了故障远端存储的主机分组，并记录该分组下的主机ID。
2.
使用“PuTTY”，通过External OM平面IP地址登录FusionSphere OpenStack控制
节点。
帐号：fsp
说明
– 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2 使用PuTTY通过公私钥对认证方式登录节点。
– External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP
参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，
在对应节点下该帐户的默认密码。
3.
执行以下命令切换到“root”用户。
su - root
2

## Page 1211

4.
执行TMOUT=0防止会话超时退出。
5. 导入环境变量。
具体操作请参见3.1 导入环境变量。
6.
执行以下命令查看系统中配置的磁盘规则。
cps hostcfg-list --type storage
显示类似如下信息：
+---------+-------------------+--------------------------------+
| type | name | hosts |
+---------+-------------------+--------------------------------+
| storage | default | default:all |
| | | |
| storage | control_group0 | hostid:first-node, second-node |
| | | |
| storage | compute_group0 | hostid:forth-node |
| | | |
| storage | control_group1 | hostid:third-node |
+---------+-------------------+--------------------------------+
其中，hosts列表示磁盘规则匹配条件，目前支持的匹配条件优先级：mac
>
hostid > boardtype > role > default:all
根据主机ID的对应关系，找到需要处理的磁盘规则。
7.
执行以下命令查询并记录该磁盘规则中各服务所占用磁盘分区大小。
cps hostcfg-show --type storage ${hostcfg_name}
其中，
–
“${hostcfg_name}”为查询到需要处理的磁盘规则的名称。
–
image、image-cache服务对应的分区名称分别为image、image-cache，需
记录这两个分区的大小。
步骤4 删除磁盘规则中使用的远端存储。
cps hostcfg-item-delete --item logical-volume --lvname ${lv_name} --type
storage ${hostcfg_name}
cps commit
其中，
●
image、image-cache服务对应的“${lv_name}”分别为image、image-cache。
●
“${hostcfg_name}”为查询到需要处理的磁盘规则的名称。
步骤5 手动重启使用该磁盘规则的所有主机。
如果多台主机都使用了该规则，则需要依次重启，即一台主机重启成功且服务运行正
常后，再重启下一台主机。
步骤6 在FusionSphere OpenStack安装部署界面的“配置
>
磁盘”页面重新配置远端存储。
步骤7 在已登录的主机，创建新的磁盘规则。
如果主机均被重启，需要使用PuTTY重新登录。
cps hostcfg-add --type storage ${new_hostcfg_name}
cps commit
新的磁盘规则名称需要以“control_”开头。
2

## Page 1212

说明
如果涉及的主机有多种不同配置（只有型号、硬件配置、硬件规格、所用槽位号等完全一致的主
机才能被认为是相同配置），需要创建多个磁盘规则，数量与主机种类数量相同。
步骤8 配置新的磁盘规则与原磁盘规则一致。
cps hostcfg-item-update --item logical-volume --lvname image --size ${size} --
type storage ${new_hostcfg_name}
cps commit
cps hostcfg-item-update --item logical-volume --lvname image-cache --size $
{size} --type storage ${new_hostcfg_name}
cps commit
cps hostcfg-item-update --item logical-volume --lvname ceilometer-data --
size ${size} --type storage ${new_hostcfg_name}
cps commit
其中，“${size}”对应原规则中分区的大小。
步骤9 更新分区的后端存储类型为远端存储。
cps hostcfg-item-update --item logical-volume --lvname image --backendtype
remote --type storage ${new_hostcfg_name}
cps commit
cps hostcfg-item-update --item logical-volume --lvname image-cache --
backendtype remote --type storage ${new_hostcfg_name}
cps commit
cps hostcfg-item-update --item logical-volume --lvname ceilometer-data --
backendtype remote --type storage ${new_hostcfg_name}
cps commit
步骤10 将应用原磁盘规则的主机从原规则中删除，添加到新的磁盘规则中。
cps hostcfg-host-delete --type storage --host hostid=${hostid} --type storage $
{hostcfg_name}
cps hostcfg-host-add --type storage --host hostid=${hostid} --type storage $
{new_hostcfg_name}
多个主机ID之间使用英文“,”隔开。
说明
● 不同配置的主机需要加入到不同的磁盘规则中。
●
原规则中主机全部移除后，需要在FusionSphere OpenStack安装部署界面的“配置
>
磁
盘”页面手动删除该主机分组。
步骤11 等待片刻，执行以下命令查询分区配置。
df -h
2

## Page 1213

创建分区需要对分区进行格式化，因此分区容量越大，分区时间越长，需等待新配置
的分区全部能够显示，表示分区成功。新的分区分别显示为extend_vg-image、
extend_vg-image--cache、extend_vg-ceilometer--data。
步骤12 在FusionSphere OpenStack安装部署界面的“配置
>
磁盘”页面查看新的主机分组的
各项配置是否正常。
●
是，处理完毕。
●
否，联系技术支持工程师协助解决。
----结束
2.4.1.3.4
Swift分区拉远到远端存储后上传、下载镜像失败
现象描述
Swift分区拉远到远端存储后上传、下载镜像失败，后台登录到swift-store组件所在节
点，执行“ls /opt/HUAWEI/swift”命令，提示“Input/output error”。
可能原因
网络或远端存储出现异常。
操作步骤
步骤1 处理远端存储自身故障，具体操作请参见远端存储对应型号的产品文档。
步骤2 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
● 系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 执行如下命令停止swift-store服务。
cps host-template-instance-operate --action stop --service swift swift-store
2

## Page 1214

步骤6 执行如下命令查看swift服务所在的节点。
cps template-instance-list --service swift swift-store
步骤7 依次登录到步骤6输出的每个节点，执行以下命令进行修复。
cd /home/fsp
umount /opt/HUAWEI/swift
mount /dev/mapper/extend_vg-swift /opt/HUAWEI/swift
步骤8 修复完成后，执行如下命令启动swift-store服务。
cps host-template-instance-operate --action start --service swift swift-store
----结束
2.4.1.4 Gaussdb
数据库故障
2.4.1.4.1
故障定位流程
当发生故障时，应遵循如下的步骤进行分析处理。最好不要在故障原因和解决方案很
明确之前采取一些措施，以免引发其他问题。
明确环境
首先应明确发生故障的环境配置信息。包括：
●
操作系统类型和详细版本号。
●
数据库部署方案是一主一备，单实例还是多个实例。
●
GaussDB数据库的详细版本号。
● FusionSphere
OpenStack详细版本号。
定位分析
定位过程需要包含以下活动：
1.
明确问题，以及受影响的范围。故障发生后，哪些业务功能受到影响。
2.
查看日志，包括数据库日志、操作系统日志，数据库控制脚本日志，则可能还需
要检查主备仲裁组件的日志。
3.
还需要明确故障发生的频率，例如是偶然现象，还是有规律的间隔一段时间等。
4.
如果需要现场外的人员协助，则还应整理好故障相关的资料。
形成处理方案
根据故障原因，形成可行的处理方案，这个方案必须是已经验证过的，或者需要搭建
环境重现问题后测试验证，确认没有问题的方案。
解决方案不仅应解决现有故障，而且需要保证不能引发新的问题。
解决方案应包含问题处理步骤，以及回退步骤。一旦实施后没有效果或引发其他问
题，应能快速回退到实施前的状态。
2

## Page 1215

处理故障
根据处理方案进行故障处理。处理过程中，应确保每个步骤都成功执行。最后应验
证、观测实施效果。
总结分析
故障处理后，应分析故障发生的原因，并对手册或方案等作出相应的调整，避免今后
出现同样的问题。或者应形成FAQ或案例，供今后参考。
2.4.1.4.2
数据库状态异常处理
现象描述
查看数据库控制脚本日志中有如下错误提示信息：
server starting.... stopped waiting
gs_ctl: could not start server
Examine the log output: /opt/gaussdb/data/pg_log/gs_ctl-current.log or the log directory configured by
parameter "log_directory" in postgresql.conf
可能原因
●
主机磁盘空间占满。参考主机磁盘空间占满处理。
●
数据库文件权限异常。参考数据库文件权限异常处理。
●
系统资源不足。参考系统资源不足处理。
●
备用服务器重建时主用服务器下电。参考备用服务器重建时主用服务器下电处
理。
●
主机暴力下电，重新上电后数据库组件故障。参考主机暴力下电，重新上电后数
据库组件故障处理。
主机磁盘空间占满
步骤1 登录到故障数据库所在主机。具体操作请参见2.4.3.3.2 登录数据库所在节点。其中，
“选择鉴权方式”固定选择2。
步骤2 执行df -h命令，查看数据库分区是否正常建立。
正常现象如下图所示：
2

## Page 1216

磁盘利用率达到100%后，会导致数据库状态为fault，可以采取参考步骤2~步骤20优
先扩容磁盘空间，让环境暂时可用，然后联系技术支持工程师协助解决定位根本原
因。
----结束
临时扩容磁盘的方法如下：
步骤1 登录故障数据库所在节点， 具体操作请参见2.4.3.3.2 登录数据库所在节点。
步骤2 执行vgs命令，查看主机上可用磁盘空间大小。
步骤3 登录“FusionSphere OpenStack的安装部署界面”，选择“配置
>
磁盘”，查看是否
有磁盘扩容任务在进行。
●
有，等待其他的磁盘扩容任务完成后，执行步骤4。
●
没有，执行步骤4。
步骤4 磁盘剩余空间足够，执行以下命令扩容磁盘空间：
cps hostcfg-item-update --item logical-volume --lvname database --size lv_size
--volumegroup vg_name --type storage hostcfg_name
cps commit
其中：
●
hostcfg_name为创建的分区规则的名称，可以通过命令cps
hostcfg-list --type
storage来查询hostid对应的storage名称，回显信息的“name”列即为storage名
称。
回显如下类似信息：
+---------+-----------------+-----------------------------------------------------------+
| type | name | hosts |
+---------+-----------------+-----------------------------------------------------------+
| storage | default | default:all |
| | | |
| storage | control_group_3 | hostid:139D2E64-1DD2-11B2-920A-000000821800 |
| | | |
| storage | control_group_2 | hostid:13A3B054-1DD2-11B2-B425-000000821800 |
| | | |
| storage | compute_group0 | hostid:13D9A9F2-1DD2-11B2-99C9-000000821800, 138DC820-1DD |
| | | 2-11B2-BEC5-000000821800 |
| | | |
| storage | control_group_1 | hostid:13934E58-1DD2-11B2-AAC6-000000821800 |
| | | |
+---------+-----------------+-----------------------------------------------------------+
● database是已存在主机中数据库逻辑分区的名称，可以通过cps hostcfg-show --
type storage hostcfg_name命令来查询。
●
lv_size可以根据实际使用场景所需要的大小来配置，必须小于磁盘可用空间，比
如50g。
●
vg_name默认是“cpsVG”，可以通过执行vgs命令查询。
2

## Page 1217

说明
FusionSphere
OpenStack系统中进行磁盘扩容时，为串行操作，如果同一时间内有多个扩容的
任务时，则需要等前一个任务完全成功后，才会开始执行下一个，所以如果在此次扩容前，系统
中已经有扩容的任务时，此次扩容的时间消耗较长。请避免同时进行扩容磁盘分区的操作。
步骤5 数据库如果是主备部署，并且主备数据库节点在不同分区规则下，可执行以下命令，
来查询待扩容磁盘的主机ID，从而通过上述步骤4进行另一节点的扩容。
cps hostcfg-list --type storage |grep hostid
“hostid”是待扩容磁盘的主机ID。
步骤6 在已登录的数据库节点，执行以下命令，查看占用空间最多的文件。
su - gaussdba
cd $GAUSSDATA
du -sh *
回显信息如图2-7所示。
图2-7 回显信息
2

## Page 1218

查看base大小是否大于扩容前数据磁盘空间的70%。
●
是，执行步骤7。
● 否，联系技术支持工程师协助解决。
说明
执行步骤6~步骤20，定位是否由token表占用引起，如是，可以选择清理token表磁盘空间。
注意对token表进行清理会阻塞业务对该表的操作，而不对token表清理，token占用的磁盘空间
则不会立即释放。
步骤7 执行以下命令，进入base目录，查看占用磁盘空间最多的目录。
cd base
du -sh *
回显信息如图2-8所示。
图2-8 回显信息
从此回显信息中可以看出“16390”目录占用的磁盘空间最大，该数字表示
“database”的“oid”。
步骤8 执行以下命令，登录数据库。
gsql postgres
按照提示输入数据库帐户密码，如果有修改过密码，则使用修改后的密码登录。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
步骤9 执行以下命令，查询对应的数据库名称。
select datname from pg_database where oid = 16390;
16390为步骤7中查询出的占用磁盘空间最多目录的“oid”。
回显信息如图2-9所示。
2

## Page 1219

图2-9 回显信息
通过此回显信息可以判断占用磁盘空间最多的是keystone数据库。
步骤10 执行以下命令，退出数据库。
\q
步骤11 执行以下命令，切换到root权限。
exit
步骤12 执行以下命令，登录keystone数据库。
su gaussdba
gsql keystone
按照提示输入数据库帐户密码，如果有修改过密码，则使用修改后的密码登录。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
步骤13 执行以下命令查询所有对象的大小。
SELECT nspname || '.' || relname AS "relation",
pg_size_pretty(pg_total_relation_size(C.oid)) AS "size"
FROM pg_class C
LEFT JOIN pg_namespace N ON (N.oid = C.relnamespace)
WHERE nspname NOT IN ('PG_CATALOG',
'INFORMATION_SCHEMA','PG_TOAST')
ORDER BY pg_total_relation_size(C.oid) DESC
LIMIT 20;
回显信息如图2-10所示。
2

## Page 1220

图2-10 回显信息
例如，占据磁盘空间最大的表为keystone数据库下的token表。
步骤14 执行以下命令，查询token表对应的大小。
select pg_total_relation_size('table_name')::bigint/1024/1024 MB;
table_name为上一步查询出的表名称。
回显信息如图2-11所示。
图2-11 回显信息
步骤15 执行以下命令，退出数据库。
\q
步骤16 执行以下命令，切换到root权限。
exit
步骤17 执行以下命令，查询可用磁盘空间大小。
df -h
2

## Page 1221

此处查询出的当前数据库分区剩余磁盘是否大于步骤14查询到的所需空间。
●
是，执行步骤19。
●
否，执行步骤18。
例如，此处查询出当前数据库分区剩余磁盘116MB，小于步骤14查询到的所需空
间18615MB，则需要扩容。
步骤18 重复执行步骤2～步骤5，扩容磁盘空间。
需要确保扩容后的磁盘空间大于步骤14查询到的空间。
步骤19 执行以下命令，登录keystone数据库。
su gaussdba
gsql keystone
按照提示输入数据库帐户密码，如果有修改过密码，则使用修改后的密码登录。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
步骤20 执行以下命令，对token表进行磁盘碎片清理。
vacuum full token
说明
vacuum
full操作会阻塞其他业务对该表的操作，消耗系统IO，请在业务量较小的时间点进行，
13G的token空间，耗时约10分钟，命令回显“VACUUM”表示执行完毕。
步骤21 执行以下命令，退出数据库。
\q
步骤22 执行以下命令，切换到root权限。
exit
步骤23 执行以下命令，停止gaussdb数据库。
cps host-template-instance-operate --service gaussdb gaussdb --action stop
须知
该操作会停止gaussdb数据库，请确保期间不会下发业务。
步骤24 重复执行如下命令查询gaussdb数据库状态，直到查询到的gaussdb数据库状态均为
fault。
cps template-instance-list --service gaussdb gaussdb
+------------+---------------+---------+--------------------------------------+---------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+---------------+
| 0 | gaussdb | fault | 42309170-0261-512F-DF77-0507589D4C3D | 192.168.35.15 |
| 1 | gaussdb | fault | 4230A856-E289-AAB3-15F3-82B46C8EFDCC | 192.168.35.78 |
+------------+---------------+---------+--------------------------------------+---------------+
步骤25 执行以下命令，启动gaussdb数据库。
2

## Page 1222

cps host-template-instance-operate --service gaussdb gaussdb --action start
步骤26 重复执行如下命令查询gaussdb数据库状态，直到查询到的gaussdb数据库状态为
active、standby。
cps template-instance-list --service gaussdb gaussdb
+------------+---------------+---------+--------------------------------------+---------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+---------------+
| 0 | gaussdb | active | 42309170-0261-512F-DF77-0507589D4C3D | 192.168.35.15 |
| 1 | gaussdb | standby | 4230A856-E289-AAB3-15F3-82B46C8EFDCC | 192.168.35.78 |
+------------+---------------+---------+--------------------------------------+---------------+
----结束
数据库文件权限异常
步骤1 执行命令cd /opt/fusionplatform/data/gaussdb_data/data切换目录。
步骤2 排查目录下，是否有放置非数据库文件。
数据库目录所有文件应如下图所示。如果有非数据库文件，则将文件删除。
-rw------- 1 gaussdba dbgrp 200 Jan 19 21:18 backup_label.old
drwx------ 18 gaussdba dbgrp 4096 Jan 19 21:18 base
-rw------- 1 gaussdba dbgrp 0 Jan 19 21:18 build_completed.done
-rw------- 1 gaussdba dbgrp 1448 Jan 19 21:18 ca.crt
-rw------- 1 gaussdba dbgrp 922 Jan 19 21:18 dblink.conf
-rw------- 1 gaussdba dbgrp 16 Jan 22 22:15 gaussdb.state
drwx------ 2 gaussdba dbgrp 4096 Jan 22 22:49 global
-rw------- 1 gaussdba dbgrp 1 Jan 19 21:18 gs_build.pid
drwx------ 2 gaussdba dbgrp 4096 Jan 23 00:00 pg_audit
drwx------ 2 gaussdba dbgrp 4096 Jan 21 22:03 pg_blackbox
drwx------ 2 gaussdba dbgrp 4096 Jan 22 01:16 pg_clog
drwx------ 2 gaussdba dbgrp 4096 Jan 22 22:15 pg_confile_backup
-rw------- 1 gaussdba dbgrp 0 Jan 22 22:15 pg_ctl.lock
-rw------- 1 gaussdba dbgrp 4733 Jan 22 22:15 pg_hba.conf
-rw------- 1 gaussdba dbgrp 1024 Jan 19 21:18 pg_hba.conf.lock
-rw------- 1 gaussdba dbgrp 1636 Jan 19 21:18 pg_ident.conf
drwx------ 2 gaussdba dbgrp 4096 Jan 19 21:18 pg_log
drwx------ 4 gaussdba dbgrp 4096 Jan 19 21:18 pg_multixact
drwx------ 2 gaussdba dbgrp 4096 Jan 21 22:03 pg_notify
drwx------ 2 gaussdba dbgrp 4096 Jan 19 21:18 pg_serial
drwx------ 2 gaussdba dbgrp 4096 Jan 19 21:18 pg_snapshots
drwx------ 2 gaussdba dbgrp 4096 Jan 23 00:01 pg_stat_tmp
drwx------ 2 gaussdba dbgrp 4096 Jan 22 20:49 pg_subtrans
drwx------ 2 gaussdba dbgrp 4096 Jan 19 21:18 pg_tblspc
drwx------ 2 gaussdba dbgrp 4096 Jan 19 21:18 pg_twophase
-rw------- 1 gaussdba dbgrp 4 Jan 19 21:18 PG_VERSION
drwx------ 2 gaussdba dbgrp 4096 Jan 19 21:18 pg_wallet
drwx------ 3 gaussdba dbgrp 4096 Jan 22 23:45 pg_xlog
-rw------- 1 gaussdba dbgrp 27486 Jan 22 22:15 postgresql.conf
-rw------- 1 gaussdba dbgrp 1024 Jan 17 01:04 postgresql.conf.lock
-rw------- 1 gaussdba dbgrp 84 Jan 22 22:15 postmaster.opts
-rw------- 1 gaussdba dbgrp 97 Jan 22 22:15 postmaster.pid
-rw------- 1 gaussdba dbgrp 1241 Jan 17 01:04 server.crt
-rw------- 1 gaussdba dbgrp 1766 Jan 17 01:04 server.key
-r-------- 1 gaussdba dbgrp 1064 Jan 17 01:04 server.key.cipher
-r-------- 1 gaussdba dbgrp 24 Jan 17 01:04 server.key.rand
步骤3 排查目录下，文件权限是否全是gaussdba: dbgrp。
如果有文件的权限不正确，则执行以下命令重新设置文件权限：
2

## Page 1223

chown gaussdba:dbgrp filename
----结束
系统资源不足
观察数据库服务端日志，查看是否有类似如下信息：
gaussmaster 8620 FATAL: could not create shared memory segment: Invalid argument
gaussmaster 8620 DETAIL: Failed system call was shmget(key=5432016, size=1206730752, 03600).
gaussmaster 8620 HINT:
The PostgreSQL documentation contains more information about shared memory configuration.
或者
gaussmaster 20059 FATAL: could not create semaphores: No space left on device
The PostgreSQL documentation contains more information about configuring your system for PostgreSQL.
如果有上述信息，排查系统CPU利用率、系统内存、系统的IO繁忙状态，这些都可能
导致gaussdb响应速度延迟较高，甚至异常。
此现象的处理方法如下：
步骤1 登录故障主机，分别执行top、iostat命令，查看系统共享内存消耗量以及CPU使用
率、系统IO。
2

## Page 1224

步骤2 查看系统messages日志，具体操作可参见2.4.3.3.1 定位所需的日志路径。确认资源隔
离功能是否自动停止了gaussdb进程，即查看日志中是否有如下信息：
Memory cgroup out of memory: Kill *****gaussdb sacrifice child
步骤3 查看UVP日志，具体操作可参见2.4.3.3.1 定位所需的日志路径。确认故障发生时系统
资源是否异常。
步骤4 联系技术支持工程师协助解决，结合上述步骤收集到的信息，排查系统异常原因。
----结束
备用服务器重建时主用服务器下电
数据库主备服务器状态异常，主数据库已经被下电或停止。查看备数据库控制脚本日
志，日志显示备用服务器一直接收到升主操作，但是日志中提示有尚未完成的build操
作，无法启动为主用服务器。
登录数据库备服务所在主机，执行以下命令：
su gaussdba
gs_ctl querybuild
显示如下信息，DETAIL_INFORMATION字段为 BuildFailed表示备用服务此时出现了
故障，需要重建，重建失败。
Ha state:
LOCAL_ROLE : Unknown
STATIC_CONNECTIONS : 2
DB_STATE : NeedRepair
DETAIL_INFORMATION : BuildFailed
此现象的处理方法如下：
步骤1 上电主数据库。
如果主数据库存在异常，则需要参考本文档中其他故障处理方法将主数据库所在主机
恢复正常。
步骤2 等待备机重建完成，在gaussdb用户权限下，再次使用gs_ctl querybuild命令查询服
务状态。
DB_STATE显示为normal表示备用服务状态恢复正常。
----结束
主机暴力下电，重新上电后数据库组件故障
步骤1 登录到故障数据库所在主机。具体操作请参见2.4.3.3.2 登录数据库所在节点。
步骤2 执行以下命令，使用vi编辑器打开并查看故障数据库服务端日志。
vi /var/log/fusionsphere/component/gaussdb/gaussdb.log
有如下错误提示信息则表示属于此种故障场景：
[2015-11-10 08:48:38.171 CST] startup 14076 LOG: open dataxlogchk file success "global/
pg_dataxlogchk"
[2015-11-10 08:48:38.175 CST] startup 14076 LOG: at least one crc passed,
minRecoveryPoint=[75/821CC000]
[2015-11-10 08:48:38.175 CST] startup 14076 FATAL: end of error record LSN [75/82000108] LE
minRecoveryPoint [75/821CC000]
2

## Page 1225

[2015-11-10 08:48:38.198 CST] gaussmaster 14066 LOG: startup process (PID 14076) exited with exit
code 1
[2015-11-10 08:48:38.198 CST] gaussmaster 14066 LOG: aborting startup due to startup process failure
[2015-11-10 08:48:38.268 CST] gaussmaster 14066 LOG: StreamDoUnlink sockpath =/tmp/.s.PGSQL.2345
[2015-11-10 08:48:38.268 CST] gaussmaster 14066 LOG: UnlinkLockFile socket_lock_file
=/tmp/.s.PGSQL.2345.lock
步骤3 执行以下命令，获取gaussdb挂载路径。
df -h
回显信息如下图所示。
步骤4 执行以下命令，进入gaussdb挂载路径。
cd /opt/fusionplatform/data/gaussdb_data
步骤5 执行如下命令，移除旧的检查文件。
该文件移除后数据库起来时会重新创建。
mv data/global/pg_dataxlogchk /home/fsp
步骤6 等待一分钟，执行以下命令，查看gaussdb组件状态。
cps template-instance-list --service gaussdb gaussdb
gaussdb根据实际的数据库情况填写，如果nova或者neutron存在分库场景，则此处为
gaussdb_neutron或gaussdb_nova。
回显信息显示“status”是“active”和“standby”则表示数据库组件状态正常。
+------------+---------------+---------+--------------------------------------+----------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+----------------+
| 0 | gaussdb | active | 200BC798-E58C-0000-1000-1DD200001220 | 192.168.35.105 |
| 1 | gaussdb | standby | CCCC8177-46D4-0000-1000-1DD200009B80 | 192.168.35.37 |
+------------+---------------+---------+--------------------------------------+----------------+
如果数据库组件状态仍然异常，联系技术支持工程师协助解决。
----结束
2.4.1.4.3
数据库组件访问失败
IP
监听问题
步骤1 执行以下命令查询数据库服务所在主机。
cps template-instance-list --service gaussdb gaussdb
回显信息中，状态为active的服务所在主机为主用数据库服务所在主机；状态为
standby的服务所在主机为备用数据库服务所在主机。
2

## Page 1226

步骤2 登录数据库所在节点，执行以下命令。
ip addr show | grep gau
主数据库服务所在主机上有两个IP地址，一个用于提供服务，一个用于主备数据库间
同步数据：
备数据库服务所在主机上有一个IP地址，用于主备数据库间同步数据。
步骤3 查看主数据库服务所在主机是否监听浮动IP地址，即用于提供服务的IP地址。
执行comp-ip-get all可以获取所有数据库的浮动IP。
步骤4 查看数据库是否绑定浮动IP，执行以下命令。
netstat -anp | grep 浮动IP地址
是：非IP监听问题，继续排查其他故障场景。
否：联系技术支持工程师协助解决，排查数据库IP是否被非法占用。
----结束
数据库连接数异常
查看是否有数据库连接达到阈值告警。
如果有，则参考“ALM-73405 gaussdb连接数超过阈值 ” 章节的处理方法，完成对
告警的恢复。
数据库数据间不同步
查看是否有主备数据库数据不同步告警。
如果有，则参考“ALM-73403 gaussdb主备数据不同步 ” 章节的处理方法，完成对
告警的恢复。
2

## Page 1227

2.4.1.4.4
数据库单节点主机系统故障
单主机
OS(database
所在节点)故障
登录FusionSphere OpenStack安装部署界面，找到gaussdb主备服务所在的主机，即
部署database角色（或者database_nova，database_neutron，database_cinder，
database_keystone）的主机，是否为故障状态。
如果主机故障，则参见2.4.1.2.2 主机操作系统故障进行恢复。
两个主机
OS(database
所在节点)故障
登录FusionSphere OpenStack安装部署界面，找到gaussdb主备服务所在的主机，即
部署database角色（或者database_nova，database_neutron，database_cinder，
database_keystone）的主机，是否同一数据库角色所在的两台主机同时故障。
如果同一数据库角色所在的两台主机同时故障且两个主机独立部署了数据库角色，则
参考2.4.1.4.6 数据库双节点主机系统故障进行恢复。
2.4.1.4.5
主数据库故障，备数据库升主异常处理
现象描述
主gaussDB所在节点故障，无法正常运行，则希望备升为主。但备GaussDB由于网络
故障、被下电等没有正常从主同步数据，将会拒绝升主。可使用CPS命令“cps
template-instance-list --service gaussdb
gaussdb”，查看是否升主成功。
故障定位
主gaussDB无法启动，登录备gaussDB所在节点，查看日志文件“/var/log/
fusionsphere/component/gaussdbControl/gaussdbControl_error.log
”，如果在周期
打印NotAllowActiveException:
time diff too
big或者NotAllowActiveException:
ha_status is not
normal，则说明是本问题。
处理步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
2

## Page 1228

说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 执行以下命令修改gaussDB的配置项，设置主备倒换策略为normal，即不检查备数据
是否同步。
cps template-params-update --service gaussdb gaussdb --parameter
ha_strategy=normal
cps commit
步骤6 等待1–3分钟，执行以下命令查询备gaussDB是否成功升主。
cps template-instance-list --service gaussdb gaussdb
回显信息如下：
564D28B3-FCD4-EE16-01F5-0FC0B8A9AD69:/var/log/fusionsphere/component/gaussdbControl # cps
template-instance-list --service gaussdb gaussdb
+------------+---------------+---------+--------------------------------------+------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+------------+
| 0 | gaussdb | standby | 564D34D7-0F0A-F8FE-70F2-BA0AA0FB7E41 | 10.9.1.96 |
| 1 | gaussdb | active | 564D28B3-FCD4-EE16-01F5-0FC0B8A9AD69 | 10.9.2.169 |
+------------+---------------+---------+--------------------------------------+------------+
若回显信息中原备gaussDB的status显示为active,则表明备gaussDB升主成功，否则请
联系技术支持工程师协助解决，进行原因排查。
步骤7 根据备gaussDB未正常同步数据的时间长度，决定是否执行备份数据恢复。
若备gaussDB未正常同步数据超过一天，建议恢复。具体恢复操作请参考《华为云
Stack 8.1.0
运维指南》的“恢复FusionSphere OpenStack”章节。
步骤8 主备都恢复正常后，执行以下命令将主备倒换策略再设置回advance。
cps template-params-update --service gaussdb gaussdb --parameter
ha_strategy=advance
cps commit
----结束
2.4.1.4.6
数据库双节点主机系统故障
现象描述
独立部署数据库节点的场景，主备数据库服务所独占的主机同时故障时，创建虚拟机
失败，Keystone鉴权失败，访问数据库失败。
可能原因
●
数据库节点硬件故障。
2

## Page 1229

●
数据库节点操作系统故障。
处理步骤
步骤1 如果是硬件故障（主机整机故障或硬盘故障），应先更换故障主机，或在故障主机下
电状态更换故障的硬盘。
更换的备件要与被更换的对象规格、型号均一致，更换步骤参见 《华为云Stack
8.1.0
运维指南》中“更换主机及配件”章节。
说明
部分型号的RAID卡要求单个硬盘也需要组成RAID 0，否则无法被操作系统识别，例如Lsi
1078、Lsi 2208或Lsi 3108。
因此，使用这些RAID卡的主机如果更换单个硬盘后，需要先对硬盘配置RAID。
具体RAID卡的要求，以及配置硬盘RAID的方法，请参考对应的硬件产品文档。
如果无法确认RAID卡要求，建议对主机上所有单独使用的硬盘均分别组成RAID 0。
步骤2 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤4 执行TMOUT=0防止会话超时退出。
步骤5 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤6 根据故障节点的处理方式，判断操作。
●
更换主机整机或者更换故障主机上的磁盘，执行步骤7。
●
重装故障主机操作系统，执行步骤8。
步骤7 执行以下命令查询数据库组件的主备状态。
cps template-instance-list --service gaussdb_service gaussdb_template
其中gaussdb_service和gaussdb_template分别是故障数据库组件的service和
template。
2

## Page 1230

需要反复查询，直到数据库组件正常后，执行步骤9。
步骤8 参考2.4.1.4.4 数据库单节点主机系统故障，依次恢复两台故障的数据库节点。
步骤9 执行以下命令查看备份服务的主节点。
cps template-instance-list --service backup backup-server
回显信息中，状态为“active”的节点，为备份服务主节点，记录其主机ID。
步骤10 查询备份服务主节点的管理IP地址。
cps host-list | grep
备份服务主节点ID
步骤11 获取可用的备份包。
系统会每天自动执行备份，并将备份包保存到backup-server所在主节点上。如果配置
了第三方备份服务器，则备份包还会保存在第三方备份服务器上。本地备份路径为
“/opt/backup/backupfile”，第三方备份服务器备份路径在设定备份策略时指定。
GaussDB备份包名称格式为“gaussdb-YYYY-MM-DD-HH-MM-SS-COUNT-
TYPE.tar.gz”
在数据库分库场景下，GaussDB的数据包又细分为gaussdb_neurton、
gaussdb_nova、gaussdb_keystone、gaussdb_cinder四个包，名称格式例如
“gaussdb_neurton-YYYY-MM-DD-HH-MM-SS-COUNT-TYPE.tar.gz”
●
COUNT：备份包计数。
●
TYPE：备份包类型，取值为single或者all。
–
single指单个服务进行备份得到的备份包。
–
all指所有服务进行备份得到的备份包。
1.
使用“PuTTY”工具，通过备份服务主节点的管理IP地址，先用帐号“fsp”登
录，然后使用su
-
root命令切换到帐号“root”。
说明
–
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
– External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP
参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，
在对应节点下该帐户的默认密码。
2.
将“/opt/backup/backupfile”路径下的备份包保存到本地。
步骤12 将已获取的gaussdb备份包，上传到备份服务主节点。
可使用“winSCP”等工具，通过备份服务主节点的管理IP地址，以“root”用户访问
备份服务主节点，将备份包上传到主节点的“/opt/backup”目录下。
步骤13 以“root”用户登录备份服务主节点，执行以下命令修改备份包的所有者为backup用
户。
chown backup:cps
/opt/backup/备份包
步骤14 执行以下命令手动恢复gaussdb。
restore execute --file
备份包名称
--path
备份包保存路径
--service gaussdb
2

## Page 1231

数据库分库场景，需在命令后指定gaussdb备份包所属组件：
restore execute --file
备份包名称
--path
备份包保存路径
--service
gaussdb_组件
其中：
●
备份包名称，例如“gaussdb-2015-10-17-14-26-11-87-all.tar.gz”。
数据库分库场景，备份包名称例如
“gaussdb_neurton-2015-10-17-14-26-11-87-all.tar.gz”
●
备份包保存路径，例如“/opt/backup”。
可通过restore
progress-get --service
gaussdb（数据库分库场景为具体服务的
gaussdb名称，例如“gaussdb_neutron”）来查看恢复进度。
●
result为“SUCCESS”，表明已经恢复完成，执行15。
●
result为“FAILED”，请等待15分钟后再次执行恢复命令，如果仍为“FAILD”，
则联系技术支持工程师协助解决。
●
result为“DOING”，表明还在恢复过程中，请等待5分钟再次查询。
例如，
gaussdb未分库时，恢复完整的gaussdb：
restore execute --file gaussdb-2015-10-17-14-26-11-87-all.tar.gz --path /
home/fsp --service gaussdb
gaussdb分库时，恢复neutron服务的gaussdb：
restore execute --file gaussdb_neutron-2015-10-17-14-26-11-87-all.tar.gz
--path /home/fsp --service gaussdb_neutron
说明
恢复gaussdb时，如果是使用的keystone鉴权，查询命令会短暂不可用，是正常现象。待
gaussdb恢复成功后，查询进度命令恢复正常。
步骤15 恢复gaussdb完成后，执行以下命令删除步骤12上传的备份包。
rm
/opt/backup/备份包名称
----结束
2.4.2 Service OM
故障
2.4.2.1
管理节点故障
2.4.2.1.1
主备Service
OM
虚拟机同时故障
现象描述
Service
OM主备虚拟机同时故障，且重启该虚拟机后业务仍无法恢复时，需要参考本
故障处理操作，使业务快速恢复正常。
2

## Page 1232

说明
恢复Service OM主备节点虚拟机前，必须先从备份路径下获取备份文件，并将备份文件拷贝至
本地PC上。
具体路径参见《华为云Stack
8.1.0
运维指南》中的“恢复数据
>
恢复资源池数据
>
恢复
Service
OM”章节。
对系统的影响
● 无法新增业务，如创建虚拟机。
●
无法对外提供监控告警、配置等运维服务。
操作步骤
检查Service OM虚拟机是否部署在后端存储
步骤1 在FusionSphere OpenStack的安装部署界面上，选择“云化服务
> FusionSphere
OpenStack
OM”，查看虚拟机列表栏中“启动源”的值是否为“后端存储”。
●
是，执行步骤2。
● 否，执行步骤3。
步骤2 查看Service OM虚拟机所在主机是否存在“ALM-6023 主机存储链路中断” 和
“ALM-6026 主机光纤通道中断”的告警。
说明
若后端对接的存储是华为分布式块存储，请对设备当前的状态进行检视，确保华为分布式块存储
软件功能正常。具体操作，请参考《OceanStor Pacific系列
8.1.1
产品文档》中“操作与维护
>
管理员指南
>
巡检和信息收集
>
SmartKit健康检查”章节。
●
是，参考ALM-6023 主机存储链路中断或ALM-6026 主机光纤通道中断处理完告
警后，执行步骤10。
●
否，执行步骤10。
检查主机image分区是否使用远端存储
主机image分区存在Service OM虚拟机，且image分区使用远端存储，存储中断或存
储中断恢复后image挂载异常，导致Service OM虚拟机无法启动。
步骤3 在FusionSphere OpenStack的安装部署界面上，选择“配置
>
磁盘”。
步骤4 在“扩容存储”区域框中查看image磁盘分区是否使用远端存储。
●
是，执行步骤5。
●
否，执行步骤10。
步骤5 查看Service OM虚拟机所在主机是否存在“ALM-6023 主机存储链路中断” 或
“ALM-6026 主机光纤通道中断”的告警。
●
是，参考ALM-6023 主机存储链路中断或ALM-6026 主机光纤通道中断处理完告
警后，执行步骤6。
●
否，执行步骤6。
说明
若后端对接的存储是华为分布式块存储，请对设备当前的状态进行检视，确保华为分布式块存储
软件功能正常。具体操作，请参考《OceanStor Pacific系列
8.1.1
产品文档》中“操作与维护
>
管理员指南
>
巡检和信息收集
>
SmartKit健康检查”章节。
2

## Page 1233

步骤6 以root权限登录Service OM虚拟机所在主机。
步骤7 执行以下命令，查看image分区是否存在。
mount | grep '/opt/HUAWEI/image '
显示如下回显信息，表示存在image分区。
/dev/mapper/extend_vg-image on /opt/HUAWEI/image type ext3
(rw,relatime,errors=continue,user_xattr,acl,barrier=1,data=ordered)
●
是，执行步骤8。
●
否，执行步骤9。
步骤8 执行以下命令，查看image分区是否为只读。
mount | grep '/opt/HUAWEI/image '
/dev/mapper/extend_vg-image on /opt/HUAWEI/image type ext3
(rw,relatime,errors=continue,user_xattr,acl,barrier=1,data=ordered)
显示如下回显信息，表示image分区为只读。
/dev/mapper/extend_vg-image on /opt/HUAWEI/image type ext3
(ro,relatime,errors=continue,user_xattr,acl,barrier=1,data=ordered)
●
是，执行步骤9。
●
否，请联系技术支持工程师协助解决。
步骤9 迁移主机上的业务虚拟机，并重启主机使image分区恢复正常。
任务结束。
重置状态恢复虚拟机
步骤10 使用PuTTY，通过Service OM节点管理IP地址，登录Service OM主节点。
默认帐号：fsp
说明
● Service
OM节点管理IP地址请参考软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数
信息汇总文件《xxx_export_all_v2_CN.xlsx》的“2.1 工具生成的IP参数”页签搜索对应参数
名称获取。参数名称为：OM-externalOM-Float-IP。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤11 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤12 执行TMOUT=0防止会话超时退出。
步骤13 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤14 执行以下命令，将故障虚拟机状态设置为“error”。
2

## Page 1234

nova reset-state uuid
说明
可通过nova
list --all-t | grep
fm命令，查询虚拟机信息，根据故障虚拟机的名称确定并记录该
虚拟机的ID。
步骤15 虚拟机所在的主机是否为故障主机。
●
是，执行步骤18。
●
否，执行步骤16。
步骤16 执行以下命令，关闭虚拟机，并观察虚拟机状态。
nova stop uuid
nova show uuid | grep OS-EXT-STS:vm_state
其中的uuid为虚拟机uuid。
步骤17 待虚拟机状态变为“stopped”时，执行以下命令，启动虚拟机，并观察虚拟机状态。
nova start uuid
nova show uuid | grep OS-EXT-STS:vm_state
步骤18 虚拟机状态是否为“active”。
●
是，执行步骤19。
●
否，执行步骤42。
登录故障虚拟机
步骤19 登录FusionSphere OpenStack的安装部署界面。
具体操作请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）。
步骤20 选择“云化服务
> FusionSphere OpenStack
OM”。
步骤21 在故障Service OM虚拟机的所在行，单击 ，登录任意一台故障虚拟机。
若开机出现如下异常显示，请参考如何处理虚拟机异常上下电导致的磁盘异常进行处
理。
systemd-fsck[605]: /dev/sda2: UNEXPECTED INCONSISTENCY; RUN
fsck MANUALLY.
systemd-fsck[605]: (i.e., without -a or -p options)
[ 13.652068] systemd-fsck[605]: fsck failed with error code
4.
Welcome to emergency mode. Use "systemctl default"
or ^D to activate default mode.
Give root password for maintenance
(or type Control-D to continue):
以“fsp”用户登录操作系统。
步骤22 在故障Service OM虚拟机的所在行，单击 ，登录虚拟机。
以“fsp”用户登录操作系统。
步骤23 执行以下命令切换到“root”用户。
su - root
2

## Page 1235

步骤24 执行TMOUT=0防止会话超时退出。
步骤25 登录是否成功。
●
是，执行步骤26。
●
否，登录的节点发生故障，执行步骤42重新安装故障节点。
步骤26 执行以下命令，查看目录“/opt/goku/data/db”的使用率是否超过98%。
df -h
Filesystem Size Used Avail Use% Mounted on
/dev/sda1 6.0G 1017M 4.7G 18% /
...
/dev/sda13 36G 177M 34G 1% /opt/goku/data
/dev/sda11 15G 408M 14G 3% /opt/goku/data/db
/dev/sda2 7.9G 147M 7.4G 2% /sysback
...
/dev/sda6 9.9G 239M 9.2G 3% /var/log/goku
●
是，请联系技术支持工程师协助解决。
●
否，执行步骤27。
启动HA服务
步骤27 执行以下命令，查看节点的HA状态。
QueryHaState
回显以下类似信息。
LOCAL_HOST=FMN01
LOCAL_STATE=unknow
LOCAL_IP=192.168.0.79
REMOTE_HOST=FMN02
REMOTE_STATE=unknow
REMOTE_IP=192.168.0.80
步骤28 判断回显中“LOCAL_STATE”的值是否为“unknow”。
●
是，执行步骤29。
●
否，执行步骤36。
步骤29 执行以下命令，启动HA服务。
startALL
步骤30 是否提示心跳IP冲突。
回显以下类似信息时，说明心跳IP冲突。
The heartbeat IP address
{IP地址}
of the system conflicts with another IP address.
●
是，执行步骤31。
●
否，执行步骤34。
步骤31 当前网络中是否有多套Service OM，且IP相同。
● 是，执行步骤32。
●
否，执行步骤33。
步骤32 停止网络中其他的Service OM服务，或下电其他的Service OM节点。
2

## Page 1236

步骤33 按“Enter”，继续启动HA服务。
步骤34 等待1分钟，执行以下命令，查询节点的HA状态。
QueryHaState
步骤35 “LOCAL_STATE”的值是否仍为“unknow”。
●
是，请联系技术支持工程师协助解决。
●
否，执行步骤36。
步骤36 恢复Service OM另一节点的HA服务。
恢复的方法请参见步骤19～步骤35。
步骤37 使用PuTTY，通过Service OM节点管理IP地址，登录Service OM主节点。
默认帐号：fsp
说明
● Service
OM节点管理IP地址请参考软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数
信息汇总文件《xxx_export_all_v2_CN.xlsx》的“2.1 工具生成的IP参数”页签搜索对应参数
名称获取。参数名称为：OM-externalOM-Float-IP。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤38 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤39 执行以下命令，防止会话超时退出。
TMOUT=0
步骤40 等待10分钟，执行以下命令，查看Service OM的状态。
galaxmanager status
步骤41 状态是否都为“normal”。
●
是，处理完毕。
●
否，请联系技术支持工程师协助解决。
删除主备Service OM虚拟机
步骤42 登录FusionSphere OpenStack的安装部署界面。
具体操作请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）。
步骤43 选择“云化服务
> FusionSphere OpenStack
OM”。
步骤44 在Service OM虚拟机所在区域，单击 ，按照提示删除Service OM虚拟机。
重新安装故障的Service OM节点
2

## Page 1237

步骤45 在FusionSphere OpenStack的安装部署界面上重新上传Service OM软件包，等待上传
结束。
步骤46 备份并替换FusionSphere OpenStack相关配置文件，具体操作可参考本故障处理的
“相关任务”中替换FusionSphere OpenStack...小节内容。
步骤47 安装故障的Service OM节点，具体操作请参见《华为云Stack
8.1.0
运维指南》 中的
“安装与维护服务适配包”章节。
说明
●
重新安装的Service OM版本必须与故障前保持一致，如不一致，请重新安装或者升级到相同
版本后再进行数据恢复。
● Region Type
I场景下，在使用cloud-init的场景下，若计划将Service OM虚拟机重新部署在
计算节点，还需要做如下配置：
1.
选择一个计算节点，并查询它的cluster信息。
cps cluster-list
查询获得的控制节点的cluster名称为manage_cluster，计算节点（假设为host1）所在的
cluster假设为compute_cluster。若计算节点未加入任何cluster，则无需执行47.b，直接
执行47.c。
2.
《华为云Stack
8.1.0
运维指南》中“配置资源对接”将这个计算节点从旧cluster移除。
cps cluster-update --name compute_cluster host1
3.
将这个计算节点加入管理集群。
cps cluster-update --name manage_cluster host1
cps commit
计算节点加入管理集群后，该计算节点的虚拟机将无法使用cloud-init功能。
步骤48 配置Service OM和FusionSphere OpenStack的对接，具体操作请参见《华为云Stack
8.1.0
运维指南》中“配置资源对接”。
恢复故障的Service OM节点数据
步骤49 登录FusionSphere OpenStack安装部署界面，在“云化服务
> FusionSphere
OpenStack
OM”界面的虚拟机列表中查询主、备Service OM虚拟机External OM网
络的IP地址。
步骤50 使用PuTTY，通过Service OM节点管理IP地址，登录Service OM主节点。
默认帐号：fsp
说明
● Service
OM节点管理IP地址请参考软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数
信息汇总文件《xxx_export_all_v2_CN.xlsx》的“2.1 工具生成的IP参数”页签搜索对应参数
名称获取。参数名称为：OM-externalOM-Float-IP。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤51 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
2

## Page 1238

步骤52 执行以下命令，防止会话超时退出。
TMOUT=0
步骤53 拷贝备份文件至Service OM主、备节点虚拟机的如下路径之一。
● 手动备份的文件，拷贝至“/opt/gmbackup/db”
●
每日自动备份的文件，拷贝至“/opt/gmbackup/db/”
●
每月自动备份的文件，拷贝至“/opt/gmbackup/db/autobakm/”
步骤54 VNC登录Service OM主、备节点虚拟机。
登录方法：在“云化服务
> FusionSphere OpenStack
OM”界面，在Service OM虚拟
机所在行，单击 。
进入虚拟机界面后，根据提示输入“fsp”用户和密码。
步骤55 执行以下命令切换到“root”用户。
su - root
步骤56 执行TMOUT=0防止会话超时退出。
步骤57 在主节点上执行以下命令，禁止主备倒换。
ha_switch -f MODIFY_DB 86400
步骤58 在备节点上执行以下命令，停止所有进程。
stopALL
显示如下信息，表示进程停止成功。
Stop all services success.
备节点进程停止成功后，在主节点上执行命令停止进程：
stopALL
显示如下信息，表示进程停止成功。
Stop all services success.
步骤59 在主节点上执行以下命令，恢复主节点数据。
restoreFusionManager -f
备份文件路径+备份文件名
备份文件名：“gmdb-YYYY-MM-DD-sn.dump”，“YYYY-MM-DD”表示备份日
期，“sn”表示序列号。
例如：restoreFusionManager
-f /opt/gmbackup/db/gmdb-2014-12-02-5.dump
显示如下信息，表示恢复数据成功。
[INFO ] Check conflict backup or restore task...
...
[INFO ] Restore FusionManager ok
步骤60 在主节点上执行以下命令，配置HA功能。
initGmn4Restore
显示如下信息，表示配置成功。
2

## Page 1239

[INFO ] configure in HA mode
[INFO ] check configuration success
[INFO ] configure ip success
[INFO ] start configure ha, it will take about 1~2 minuters
[INFO ] configure ha success
[INFO ] init successful
[INFO ] init for restore successful
步骤61 参考步骤59～步骤60，在Service OM备节点上恢复数据和配置HA功能。
步骤62 配置Service OM主备节点网络信息。
在Service OM主节点上执行以下命令：
rm /opt/goku/services/ha/conf/noneAllInOne/iscpsconfig;python /opt/goku/
services/csm/install/system/fmninit.py > /dev/null 2>&1;echo $?
回显如下信息，表示命令执行成功：
init finished. -> 0
主节点上执行成功后，在备节点上执行以下命令：
rm /opt/goku/services/ha/conf/noneAllInOne/iscpsconfig;python /opt/goku/
services/csm/install/system/fmninit.py > /dev/null 2>&1;echo $?
回显如下信息，表示命令执行成功：
init finished. -> 0
步骤63 等待大约5分钟，在Service OM主节点上执行以下命令，查看当前Service OM主备节
点状态。
QueryHaState
显示类似如下信息：
LOCAL_HOST=FMN01
LOCAL_STATE=active
LOCAL_IP=192.168.0.79
REMOTE_HOST=FMN02
REMOTE_STATE=standby
REMOTE_IP=192.168.0.80
当Service OM节点的状态分别为“active”和“standby”时，表示主备状态正常。
步骤64 在Service OM主节点上，执行以下命令，取消禁止主备倒换。
ha_switch -c MODIFY_DB
说明
Region Type
I场景下，在使用cloud-init的场景下，若将Service OM虚拟机重新部署在计算节
点，还需要做如下配置：
1.
将这个计算节点（假设为host1）从manage_cluster移除。
cps cluster-update --name manage_cluster host1
2.
将这个计算节点（假设为host1）加入原cluster（假设为compute_cluster）。若计算节点原
来未加入任何cluster，则直接执行64.3。
3. 提交修改。
cps commit
步骤65 恢复FusionSphere OpenStack上OM相关配置文件，具体操作可参考本故障处理的
“相关任务”中的“替换FusionSphere OpenStack...”小节。
2

## Page 1240

步骤66 在Service OM主节点上执行如下命令，解锁FSPRest用户。
unlockSysAccount FSPRest
步骤67 配置FusionSphere OpenStack告警上报。
配置FusionSphere OpenStack告警上报，具体操作请参见《华为云Stack
8.1.0
运维指
南》中“配置FusionSphere OpenStack告警上报”章节。
----结束
相关任务
替换FusionSphere OpenStack相关配置文件
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
此处请固定输入“1”，导入keystone V3环境变量。
步骤5 执行以下命令，查询CPS服务所在主机，并记录主节点ID及External OM平面IP地址。
cps template-instance-list --service cps cps-server
回显信息中“runsonhost”即为CPS服务所在主机的ID。
“status”为“active”的主机为主CPS服务所在主机，“omip”列的IP地址即为该节
点的External OM平面IP地址。
步骤6 参考步骤1-步骤4，登录主CPS服务所在主机。
su - fsp
ssh
fsp@主机External OM平面IP地址
2

## Page 1241

步骤7 备份并替换OM相关数据。
判断Service OM是否已经重新安装结束。
●
是，则执行以下命令，然后执行步骤8。
cd /home/fsp
cp /etc/huawei/fusionsphere/3rdvms/ca.crt /home/fsp/ca.crt.bak
cp /etc/huawei/fusionsphere/3rdvms/fusionmanager-init.ini /home/fsp/
fusionmanager-init.ini.bak
cp /etc/huawei/fusionsphere/3rdvms/ca-default.crt /home/fsp/ca.crt
cp /etc/huawei/fusionsphere/3rdvms/fusionmanager-init-default.ini /
home/fsp/fusionmanager-init.ini
●
否，则执行以下命令，然后执行步骤8。
cd /home/fsp
cp /home/fsp/ca.crt.bak /home/fsp/ca.crt
cp /home/fsp/fusionmanager-init.ini.bak /home/fsp/fusionmanager-
init.ini
步骤8 依次执行以下命令，恢复配置文件。
upgrade repo-upload --repo-path $(upgrade repo-list | grep fusionmanager-
init.ini) --local-path /home/fsp/fusionmanager-init.ini
回显类似如下信息，表示FusionSphere OpenStack配置更换成功。
% Total % Received % Xferd Average Speed Time Time Time Current
Dload Upload Total Spent Left Speed
0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0
100 256 0 0 100 256 0 1497 --:--:-- --:--:-- --:--:-- 1497
HTTP/1.1 100 Continue
HTTP/1.1 201 Created
Content-Type: text/html; charset=UTF-8
Content-Length: 0
Etag: 5b19a19b91209e9f09cb9f32b0f30b14
Last-Modified: Wed, 21 Jul 2021 19:30:02 GMT
X-Trans-Id: tx2846bbf99a0d4dbabb096-0060f875b9
Date: Wed, 21 Jul 2021 19:30:01 GMT
Connection: close
回显信息异常时，执行以下命令，导入FusionSphere OpenStack配置。
upgrade repo-upload --repo-path $(upgrade repo-list | grep ca.crt) --local-
path /home/fsp/ca.crt
回显类似如下信息，表示导入FusionSphere OpenStack成功。
% Total % Received % Xferd Average Speed Time Time Time Current
Dload Upload Total Spent Left Speed
0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0
100 3567 0 0 100 3567 0 18015 --:--:-- --:--:-- --:--:-- 18015
HTTP/1.1 100 Continue
HTTP/1.1 201 Created
Content-Type: text/html; charset=UTF-8
Content-Length: 0
Etag: b19664d5edb2e164db27f5874e33ee08
Last-Modified: Wed, 21 Jul 2021 19:29:54 GMT
X-Trans-Id: tx75ee5c90867e41e69ac21-0060f875b1
2

## Page 1242

Date: Wed, 21 Jul 2021 19:29:53 GMT
Connection: close
步骤9 分别在CPS服务所在主机执行以下命令，删除环境里以下两个目录中的旧配置。
rm /etc/huawei/fusionsphere/3rdvms/ca.crt > /dev/null 2>&1
rm /etc/huawei/3rdvms/ca.crt> /dev/null 2>&1
rm /etc/huawei/fusionsphere/3rdvms/fusionmanager-init.ini > /dev/null 2>&1
rm /etc/huawei/3rdvms/fusionmanager-init.ini> /dev/null 2>&1
----结束
2.4.2.1.2
主备部署时单个Service OM虚拟机故障
现象描述
Service
OM主备部署时，单个Service OM虚拟机故障，且重启该虚拟机后业务仍无法
恢复时，需要参考本故障处理操作，使业务快速恢复正常。
可能原因
● Service OM虚拟机文件系统被破坏。
● Service
OM虚拟机所在主机操作系统故障。
处理步骤
检查Service OM虚拟机是否部署在后端存储
步骤1 在FusionSphere OpenStack的安装部署界面上，选择“云化服务
> FusionSphere
OpenStack
OM”，查看虚拟机列表栏中“启动源”的值是否为“后端存储”。
●
是，执行步骤2。
●
否，执行步骤3。
步骤2 查看Service OM虚拟机所在主机是否存在“ALM-6023 主机存储链路中断” 和
“ALM-6026 主机光纤通道中断”的告警。
说明
若后端对接的存储是华为分布式块存储，请对设备当前的状态进行检视，确保华为分布式块存储
软件功能正常。具体操作，请参考《OceanStor Pacific系列
8.1.1
产品文档》中“操作与维护
>
管理员指南
>
巡检和信息收集
>
SmartKit健康检查”章节。
●
是，参考“ALM-6023 主机存储链路中断” 或 “ALM-6026 主机光纤通道中断”
章节处理完告警后，执行步骤10。
●
否，执行步骤10。
检查主机image分区是否使用远端存储
主机image分区存在Service OM虚拟机，且image分区使用远端存储，存储中断或存
储中断恢复后image挂载异常，导致Service OM虚拟机无法启动。
步骤3 在FusionSphere OpenStack的安装部署界面上，选择“配置
>
磁盘”。
步骤4 在“扩容存储”区域框中查看image磁盘分区是否使用远端存储。
2

## Page 1243

●
是，执行步骤5。
●
否，执行步骤10。
步骤5 查看Service OM虚拟机所在主机是否存在“ALM-6023 主机存储链路中断” 或
“ALM-6026 主机光纤通道中断”的告警。
●
是，参考“ALM-6023 主机存储链路中断” 或 “ALM-6026 主机光纤通道中断”
章节处理完告警后，执行步骤10。
●
否，执行步骤10。
说明
若后端对接的存储是华为分布式块存储，请对设备当前的状态进行检视，确保华为分布式块存储
软件功能正常。具体操作，请参考《OceanStor Pacific系列
8.1.1
产品文档》中“操作与维护
>
管理员指南
>
巡检和信息收集
>
SmartKit健康检查”章节。
步骤6 以root权限登录Service OM虚拟机所在主机。
步骤7 执行以下命令，查看image分区是否存在。
mount | grep '/opt/HUAWEI/image '
显示如下回显信息，表示存在image分区。
/dev/mapper/extend_vg-image on /opt/HUAWEI/image type ext3
(rw,relatime,errors=continue,user_xattr,acl,barrier=1,data=ordered)
步骤8 执行以下命令，查看image分区是否为只读。
mount | grep '/opt/HUAWEI/image '
/dev/mapper/extend_vg-image on /opt/HUAWEI/image type ext3
(rw,relatime,errors=continue,user_xattr,acl,barrier=1,data=ordered)
显示如下回显信息，表示image分区为只读。
/dev/mapper/extend_vg-image on /opt/HUAWEI/image type ext3
(ro,relatime,errors=continue,user_xattr,acl,barrier=1,data=ordered)
●
是，执行步骤9。
●
否，请联系技术支持工程师协助解决。
步骤9 迁移主机上的业务虚拟机，并重启主机使image分区恢复正常。
任务结束。
重置状态恢复虚拟机
步骤10 执行以下命令，将故障虚拟机状态设置为“error”。
nova reset-state uuid
说明
可通过nova
list --all-t | grep
fm命令，查询虚拟机信息，根据故障虚拟机的名称确定并记录该
虚拟机的ID。
步骤11 执行以下命令，关闭虚拟机，并观察虚拟机状态。
nova stop uuid
nova show uuid | grep OS-EXT-STS:vm_state
其中的uuid为虚拟机uuid。
2

## Page 1244

步骤12 待虚拟机状态变为“stopped”时，执行以下命令，启动虚拟机，并观察虚拟机状态。
nova start uuid
nova show uuid | grep OS-EXT-STS:vm_state
步骤13 虚拟机状态是否为“active”。
●
是，执行步骤14。
●
否，执行步骤35。
登录故障虚拟机
步骤14 登录FusionSphere OpenStack的安装部署界面。
具体操作请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）。
步骤15 选择“云化服务
> FusionSphere OpenStack
OM”。
步骤16 在故障Service OM虚拟机的所在行，单击 ，登录虚拟机。
若开机出现如下异常显示，请参考“如何处理虚拟机异常上下电导致的磁盘异常”进
行处理。
systemd-fsck[605]: /dev/sda2: UNEXPECTED INCONSISTENCY; RUN
fsck MANUALLY.
systemd-fsck[605]: (i.e., without -a or -p options)
[ 13.652068] systemd-fsck[605]: fsck failed with error code
4.
Welcome to emergency mode. Use "systemctl default"
or ^D to activate default mode.
Give root password for maintenance
(or type Control-D to continue):
以“fsp”用户登录操作系统。
步骤17 在故障Service OM虚拟机的所在行，单击 ，登录虚拟机。
以“fsp”用户登录操作系统。
步骤18 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤19 执行以下命令，防止会话超时退出。
TMOUT=0
步骤20 登录是否成功。
●
是，执行步骤21。
●
否，登录的节点发生故障，执行步骤35。
步骤21 执行以下命令，查看目录“/opt/goku/data/db”的使用率是否超过98%。
df -h
2

## Page 1245

Filesystem Size Used Avail Use% Mounted on
/dev/sda1 6.0G 1017M 4.7G 18% /
...
/dev/sda13 36G 177M 34G 1% /opt/goku/data
/dev/sda11 15G 408M 14G 3% /opt/goku/data/db
/dev/sda2 7.9G 147M 7.4G 2% /sysback
...
/dev/sda6 9.9G 239M 9.2G 3% /var/log/goku
●
是，请联系技术支持工程师协助解决。
●
否，执行步骤22。
启动HA服务
步骤22 执行以下命令，查看节点的HA状态。
QueryHaState
回显以下类似信息。
LOCAL_HOST=Service OM01
LOCAL_STATE=unknow
LOCAL_IP=192.168.0.79
REMOTE_HOST=Service OM02
REMOTE_STATE=unknow
REMOTE_IP=192.168.0.80
步骤23 判断回显中“LOCAL_STATE”的值是否为“unknow”。
●
是，执行步骤24。
●
否，执行步骤31。
步骤24 执行以下命令，启动HA服务。
startALL
回显以下类似信息时，说明心跳IP冲突。
The heartbeat IP address
{IP地址}
of the system conflicts with another IP address.
步骤25 查看是否提示心跳IP冲突。
●
是，执行步骤26。
●
否，执行步骤29。
步骤26 当前网络中是否有多套Service OM，且IP相同。
●
是，执行步骤27。
●
否，执行步骤28。
步骤27 停止网络中其他的Service OM服务，或下电其他的Service OM节点。
步骤28 按“Enter”，继续启动HA服务。
步骤29 等待1分钟，执行以下命令，查询节点的HA状态。
QueryHaState
步骤30 “LOCAL_STATE”的值是否仍为“unknow”。
●
是，请联系技术支持工程师协助解决。
●
否，执行步骤31。
2

## Page 1246

步骤31 使用PuTTY，通过Service OM节点管理IP地址，登录Service OM主节点。
默认帐号：fsp
说明
● Service
OM节点管理IP地址请参考软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数
信息汇总文件《xxx_export_all_v2_CN.xlsx》的“2.1 工具生成的IP参数”页签搜索对应参数
名称获取。参数名称为：OM-externalOM-Float-IP。
● 默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤32 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤33 执行以下命令，防止会话超时退出。
TMOUT=0
步骤34 等待10分钟，执行以下命令，查看Service OM的状态是否都为“normal”。
galaxmanager status
●
是，处理完毕。
● 否，请联系技术支持工程师协助解决。
重建故障的Service OM虚拟机
步骤35 在“云化服务
> FusionSphere OpenStack
OM”界面，导入当前版本对应的版本包。
步骤36 单击“更新镜像”，更新Service OM镜像。
步骤37 在“云化服务
> FusionSphere OpenStack
OM”界面，单击故障虚拟机后面的 ，
重建故障的FusionSphere
OpenStack
OM虚拟机。
等待60分钟左右，在虚拟机列表中，查看两台虚拟机的业务状态分别变为“主节点”
和“备节点”，且故障虚拟机rebuild状态为“成功”表示故障恢复成功。
步骤38 使用"PuTTY"，登录被重建的虚拟机后台。
默认帐号：fsp。
步骤39 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤40 执行以下命令对被重建的虚拟机的数据库做build操作。
su - dbadmin -c "gs_ctl build"
2

## Page 1247

步骤41 等待5分钟，获取数据库帐户dbadmin的密码，执行以下命令检查返回结果“Ha
state:”的数据LOCAL_ROLE是否为Standby，DB_STATE和DETAIL_INFORMATION是
否为Normal。
set +o history
su - dbadmin -s /bin/bash -c "gs_ctl -P
数据库帐户dbadmin的密码
query"
set -o history
● 是，虚拟机重建结束。
●
否，请联系技术支持工程师协助解决。
说明
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
●
若用户已修改数据库帐户dbadmin的密码，请在修改记录中查找数据库帐户dbadmin的密
码。
----结束
2.4.2.1.3
主备部署时Service OM主节点磁盘I/O启动无响应导致备节点无法升主故障
现象描述
由于Service OM主节点磁盘I/O启动无响应，导致主节点无法登录且备节点无法升主。
可能原因
Service
OM主节点磁盘I/O启动无响应，已配置的浮动IP地址无法主动释放，备节点由
于检测到浮动IP依旧可以访问， 无法触发升主操作。
处理步骤
步骤1 登录FusionSphere OpenStack的安装部署界面。
具体操作请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）。
步骤2 选择“云化服务
> FusionSphere OpenStack
OM”。
步骤3 在虚拟机列表“FusionSphere
OpenStack
管理控制台”中，获取“业务状态”为“备
节点”的虚拟机对应的IP地址。
步骤4 使用PuTTY，通过Service OM节点管理IP地址，登录Service OM主节点。
默认帐号：fsp
说明
● Service
OM节点管理IP地址请参考软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数
信息汇总文件《xxx_export_all_v2_CN.xlsx》的“2.1 工具生成的IP参数”页签搜索对应参数
名称获取。参数名称为：OM-externalOM-Float-IP。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
2

## Page 1248

步骤5 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤6 执行以下命令，防止会话超时退出。
TMOUT=0
步骤7 执行以下命令，查看主备节点状态。
QueryHaState
[root@allinonefml ~]# QueryHaState
LOCAL_HOST=allinonefml
LOCAL_STATTE=standby
LOCAL_IP=10.22.21.111
REMOTE_HOST=allinonefm0
REMOVE_STATE=unknow
REMOVE_IP=10.35.56.117
ServiceOM当前节点状态“standby”,主节点状态“unknow”。
步骤8 执行以下命令查看浮动IP。
getFMFloatingIp
步骤9 执行以下命令PING浮动IP，查看是否可以PING通。
ping
浮动IP
●
是，执行步骤10。
●
否，请联系技术支持工程师协助解决。
步骤10 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤11 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
2

## Page 1249

步骤12 执行以下命令，防止会话超时退出。
TMOUT=0
步骤13 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤14 执行以下命令强制关闭主节点虚拟机。
nova stop --hard allinonefm1
其中，allinonefm1为步骤7中REMOTE_STATE=unknow对应的REMOTE_HOST。
步骤15 在Service OM备节点上，执行以下命令，查看备节点状态。
QueryHaState
●
状态为“active”，执行步骤16。
●
状态非“active”，请联系技术支持工程师协助解决。
步骤16 在OpenStack主节点上，执行以下命令，重启主节点故障虚拟机。
nova start allinonefm1
----结束
2.4.2.2
常用操作
2.4.2.2.1
系统时间错误
现象描述
维护工程师在以下场景时，需要参考本故障处理进行全局时间调整，使系统时间恢复
正常。
●
系统未部署精确外部时钟源，长时间运行后系统整体时间出现了累积偏差。
●
人为误操作调整了Service OM的系统时间。
●
系统时间同步失败，导致Service OM的系统时间出现了偏差。
须知
修改后的系统时间，不能早于加载License的时间。
对系统的影响
●
时间调整过程中，需中断所有业务，但不影响用户正在使用的虚拟机。
●
如果将时间调整到当前时间之前的时间点，则需要中止该时间点到当前时间这一
段时间的业务受理（如订单和用户审批）。如要将时间从00:00调整为23:00，则
需要提前1小时停止业务受理。
●
如果是将时间调整到当前时间之前的时间点，可能会覆盖掉系统历史的备份文件
和日志文件。建议先修复与时间无关的业务告警，再调整时间。
2

## Page 1250

前提条件
● 若具备NTP服务器，则要求NTP服务器和Service OM的通信正常。
●
若具备NTP服务器，则要求NTP服务器可以提供时间服务。
操作步骤
查看时间配置信息
步骤1 登录Service OM界面，详细可参考登录和注销Service OM界面章节。
步骤2 选择“系统 >系统管理
>
时间”。
进入“时间”界面。
步骤3 在“时间管理”区域，查看是否已配置时间服务器。
●
是，执行步骤4。
●
否，执行步骤13。
调整时间
步骤4 登录FusionSphere OpenStack的安装部署界面。
具体操作请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）。
步骤5 选择“云化服务
> FusionSphere OpenStack
OM”。
步骤6 在虚拟机列表“FusionSphere
OpenStack
管理控制台”中，获取“业务状态”为“备
节点”的虚拟机对应的IP地址。
步骤7 使用PuTTY，通过Service OM节点管理IP地址，登录Service OM备节点。
默认帐号：fsp。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤8 执行以下命令切换到“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤9 执行TMOUT=0防止会话超时退出。
步骤10 执行以下命令，修改为上级时钟源的时间。
setDate
"修改后的时间 修改后的日期"
例如，执行以下命令，将时间修改为“2013-4-3 15:00:00”。
setDate "15:00:00 2013-4-3"
步骤11 输入“N”退出。
步骤12 修改前后的时间差是否大于1分钟。
●
是，执行步骤13。
2

## Page 1251

●
否，任务结束。
步骤13 在“时间管理”界面，单击“强制时间同步”。
时间同步过程中，会重启Service OM，耗时约10～15分钟。
步骤14 登录Service OM界面。
步骤15 在“时间管理”页面，查看时间同步是否成功。
●
是，执行步骤16。
●
否，联系技术支持工程师协助解决。
说明
如果提示NTP服务器故障，请先查看NTP服务器的状态，并保证NTP服务器和Service OM能正常
通信。
步骤16 使用“Putty”，登录Service OM备节点。
以“fsp”用户登录操作系统。
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在对应节点
下该帐户的默认密码。
步骤17 执行以下命令切换到“root”用户。
su - root
步骤18 执行TMOUT=0防止会话超时退出。
步骤19 执行以下命令，查看Service OM备节点时间。
date
步骤20
Service
OM备节点时间是否与主节点相同。
●
是，任务结束。
●
否，执行步骤21。
步骤21 执行以下命令，停止备节点NTP服务。
service ntp stop
步骤22 执行以下命令，将备节点时间更新为主节点的当前时间。
ntpdate
主节点IP
步骤23 执行以下命令，启动备节点NTP服务。
service ntp start
----结束
2.4.2.2.2
获取Service
OM
根证书
现象描述
Service
OM作为服务端与FusionSphere之外的其他网元和通过SSL方式通信时，该网
元作为客户端需要对Service OM的身份进行认证，因此要获取Service OM的根证书并
2

## Page 1252

导入到该网元的信任库。如果该网元没有导入Service OM的根证书，会导致连接
Service
OM失败。
前提条件
●
已准备跨平台远程访问工具，如“PuTTY”。
●
已获取Service OM的管理IP地址，“fsp”用户密码。
●
文件传输工具，如WinSCP。
操作步骤
步骤1 使用PuTTY，通过Service OM节点管理IP地址，登录Service OM主节点。
默认帐号：fsp
说明
● Service
OM节点管理IP地址请参考软件安装阶段HUAWEI
CLOUD Stack
Deploy导出的参数
信息汇总文件《xxx_export_all_v2_CN.xlsx》的“2.1 工具生成的IP参数”页签搜索对应参数
名称获取。参数名称为：OM-externalOM-Float-IP。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 执行以下命令，导出Service OM根证书。
exportFMRootCert
显示如下回显信息时，表示导出成功。
export Root CA successfully
步骤5 使用文件传输工具，如WinSCP工具，进入“/opt/goku/data/upload”目录下，获取
Service
OM的根证书“fsRoot.crt”。
----结束
2.4.3
附录
2.4.3.1
虚拟机状态异常
现象描述
租户虚拟机状态异常或虚拟机状态与电源状态不一致。
2

## Page 1253

可能原因
●
对虚拟机进行操作时指定了不合法的参数。
●
对虚拟机进行的操作类型只有部分操作系统支持。
●
对虚拟机同时进行两种或以上操作，如同时进行挂载卷、卸载卷、挂载网卡、卸
载网卡与重建、迁移、修改规格中的任意两种操作。
●
对虚拟机进行操作过程中出现系统内部异常或网络异常。
处理步骤
在FusionSphere的版本发布路径获取系统审计文档进行审计，并对审计异常进行恢
复。
参考“系统审计”章节。
表2-9 虚拟机状态异常及处理方法
虚拟机异常状态 异常处理方法
虚拟机ERROR状态告警
ALM-70102
虚拟机ERROR状态告警
虚拟机HA中间态告警 ALM-70106 虚拟机HA中间态告警
虚拟机目录文件异常
ALM-70108
虚拟机目录文件异常
虚拟机HA失败 ALM-70130 虚拟机HA失败
虚拟机发生反复重启故障
ALM-73107
虚拟机发生反复重启故障
2.4.3.2
通过
FusionSphere OpenStack
快速采集故障信息
现象描述
FusionSphere内部集成了提供事故场景信息采集功能，可以不依赖于外部FusionCare
工具，加速事故场景的日志收集。
前提条件
浏览器要求为“Internet
Explorer
11.0”、“Firefox 27.0~38.0”、“Google
Chrome
30.0~41.0” 的正式版本。
操作步骤
步骤1 登录FusionSphere OpenStack的安装部署界面。
具体操作请参见3.4 登录FusionSphere OpenStack安装部署界面（ManageOne方
式）。
步骤2 在已登录的FusionSphere OpenStack安装部署界面，选择“运维
>
日常维护”，进入
“日常维护”页面。
2

## Page 1254

图2-12 故障信息快速采集
步骤3 在“故障信息快速采集”中，单击“导出”按钮。
步骤4 弹出告警对话框，提示“该操作将采集FusionSphere信息、主机配置信息、虚拟机信
息等，耗时较长，请谨慎操作。”，单击“确认”。
步骤5 等待约5分钟左右，系统生成“FusionSphere_CollectData.tar.gz”压缩文件，则故障
信息收集并导出成功。
----结束
2.4.3.3
数据库操作
2.4.3.3.1
定位所需的日志路径
数据库服务端日志路径：
2.4.3.3.2
登录数据库所在节点，在“/var/log/fusionsphere/component/gaussdb”目
录获取。
数据库控制脚本日志路径：
2.4.3.3.2
登录数据库所在节点，在“/var/log/fusionsphere/component/
gaussdbControl”目录获取。
系统日志
2.4.3.3.2
登录数据库所在节点，在“/var/log/uvp-getosstat”目录获取UVP记录的系
统状态日志；在“/var/log/messages”获取系统操作日志。
主备仲裁组件日志
2.4.3.3.2
登录数据库所在节点，在“/var/log/fusionsphere/component/cps-server”
目录获取cps-server日志；在“/var/log/fusionsphere/component/cps-client”目录获
取cps-client日志。
2

## Page 1255

2.4.3.3.2
登录数据库所在节点
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见3.2 使
用PuTTY通过公私钥对认证方式登录节点。
● External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜
索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令切换到root用户。
su - root
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，在对应节
点下该帐户的默认密码。
步骤3 执行TMOUT=0防止会话超时退出。
步骤4 导入环境变量。
具体操作请参见3.1 导入环境变量。
步骤5 使用cps
template-instance-list --service gaussdb
gaussdb命令，查询数据库所在
主机，active对应数据库主节点所在hostid，standby对应为备节点hostid，“omip”
列的IP地址即为该节点的External OM平面IP地址。回显信息如下所示。
+------------+---------------+---------+--------------------------------------+-------------+
| instanceid | componenttype | status | runsonhost | omip |
+------------+---------------+---------+--------------------------------------+-------------+
| 0 | gaussdb | active | 40E3DF67-12BF-E411-8135-000000821800 | 192.168.3.7 |
| 1 | gaussdb | standby | 201A5510-FBDD-E411-A9B3-000000821800 | 192.168.3.4 |
+------------+---------------+---------+--------------------------------------+-------------+
步骤6 执行如下命令，登录数据库所在节点。
su fsp
ssh
fsp@主机External OM平面IP地址
按照提示输入系统私钥密码。如果已生成并替换了新的公私钥文件，请输入新私钥密
码。或者直接按“Enter”后按照提示输入fsp用户的密码登录。
例如：
ssh fsp@172.28.6.3
先用帐号“fsp”登录，然后使用“su
-
root”切换到帐号“root”。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
----结束
2

## Page 1256

2.4.3.4
如何处理盘符变化
现象描述
在故障处理场景中，主机经过了PXE重新安装，安装后磁盘配置跟环境中实际不一致，
导致系统安装失败。
处理步骤
1.
使用“PuTTY”登录盘符异常的主机所在AZ内的任意节点。
以“fsp”用户，通过External OM平面登录。
说明
●
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
● External OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI CLOUD Stack
Deploy导出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP
参数”页签搜索“参数名称”为Reverse-Proxy的数据，获取对应的IP地址。
●
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》中的“A类（后台）”页签中，
在对应节点下该帐户的默认密码。
2.
执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
3.
执行以下命令，防止系统超时退出。
TMOUT=0
4.
导入环境变量。
导入环境变量
此处请固定输入“4”，通过“cloud_admin”帐户导入keystone V3环境变量。
5.
执行以下命令查看当前主机是否在磁盘组中。
cps hostcfg-list
查看盘符异常的主机ID，是否存在于某个“storage”类型的组中。
–
是，记录该主机所在“storage”类型的组的名称（下文以“$hostgroup1”
指代该名称），即，在命令回显中，查找“hosts”列为主机ID且“type”列
为“storage”的项，记录其“name”列的值，执行6。
–
否，联系技术支持工程师协助解决。
6.
执行以下两条命令将主机从原“storage”类型的组中删除。
cps hostcfg-host-delete --host hostid=$hostid --type storage $hostgroup1
cps commit
其中，“$hostid”为盘符异常主机的ID。
7.
执行以下三条命令，将主机添加到一个新的“storage”类型的组中。
cps hostcfg-add --type storage $hostgroup2
cps hostcfg-host-add --host hostid=$hostid --type storage $hostgroup2
cps commit
其中，“$hostgroup2”为新的“storage”类型的组的名称。需按主机的类型，
参照以下原则命名：
–
主机为控制节点，命名为“control_group_xxx”。
2

## Page 1257

–
主机为计算节点，命名为“compute_group_xxx”。
xxx为数字，需大于当前系统内主机数量，建议设置为1000以上，避免与自动
创建的组名冲突。
8.
重启盘符异常的主机，选择PXE启动安装，等待安装完成。
9.
参考《华为云Stack
8.1.0
软件安装指南》“释放HUAWEI
CLOUD Stack Deploy
到计算节点池”章节的配置磁盘步骤，配置该主机的磁盘、以及逻辑磁盘使用的
远端存储。
10.
如果故障主机上原先部署有gaussdb或image-cache，且gaussdb或image-cache
配置为使用独立的硬盘（SCSI磁盘，含SSD盘），应分别在“配置
>
磁盘”页面
重新配置分区。
11.
如果故障主机分组原来有配置swap分区，在FusionSphere OpenStack安装部署界
面选择“配置
>
磁盘”，单击故障主机所在的主机组，在“逻辑磁盘”区域单击
，配置swap分区，分区大小和原来保持一致，建议选择独立使用的卷组。在
“扩容存储”区域单击 提交修改。
2.5
云管平台故障
2.5.1 NTP
服务故障
2.5.1.1
系统时间与
NTP
时间不一致
现象描述
●
服务器操作系统时间与NTP（Network
Time
Protocol）时钟源的时间不完全一
致，无法从NTP时钟源同步时间。
● 在部署面主菜单中选择“维护 > 时间管理 > 配置NTP”，在“配置NTP”页面
中，NTP服务器的时间同步状态为“失效”。
●
登录部署面时，用户被频繁退出，回到登录页面。
前提条件
●
已获取待修改时间节点的sopuser、ossadm和root用户的密码。
●
已获取NTP时钟源的IP地址。
操作须知
时间同步过程中需要重启待修改时间节点的产品服务和数据库，请在业务量低的时期
执行以下操作。
处理步骤
强制同步时区时间的方法分为界面方式和手工方式两种，使用界面方式执行强制同步
的操作后，系统会缓慢调整同步时间，不会发生时间跳变；使用手工方式执行强制同
步操作后，系统立即强制同步时间，会发生时间跳变，时间跳变对时间要求较高的功
能会造成影响（如：备份恢复功能）。请根据实际情况选择适合的方式进行时区时间
的同步方式。
2

## Page 1258

界面方式
步骤1 对于异地容灾场景，需删除主备站点间的异地容灾关系，具体操作请参见《华为云
Stack 8.1.0
运维指南》中“删除异地容灾系统（华为云Stack场景）”章节。
步骤2 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤3 在部署面主菜单中选择“维护
>
时间管理
>
配置时区时间”。
步骤4 在“配置时区时间”界面，单击“强制同步”。
说明
● 如果强制同步时区时间后，还需要做其他需要重启产品服务或产品数据库的配置操作，请取
消选中“警告”对话框中的“强制同步时区时间完成后自动启动产品数据库和产品服务”，
则强制同步完成后不会自动启动产品数据库和产品服务，避免产品服务或产品数据库被多次
重启。
●
对于异地容灾场景，如果强制同步的时区时间是备站点的时区时间，请取消选中“警告”对
话框中“强制同步时区时间完成后自动启动产品数据库和产品服务”，避免备站点上的产品
服务被重启，造成双主运行的异常状态。
●
如果强制同步时区时间后，同步后和同步前的时间差，超出会话自动注销等待时间，客户端
会话会自动注销。
步骤5 在部署面主菜单选择“系统
>
任务列表”，等待（大约1～15分钟）“强制同步时区
时间”任务执行成功。
步骤6 查看服务器操作系统时间与NTP时钟源的时间是否精确一致。
●
是，则故障已恢复。
●
否，请联系技术支持工程师定位处理。
步骤7 对于异地容灾场景，故障修复后需建立主备站点间的异地容灾关系，具体操作请参见
《华为云Stack
8.1.0
运维指南》中“配置异地容灾系统（华为云Stack场景）”章
节。
----结束
手工方式
步骤1 对于异地容灾场景，需删除主备站点间的异地容灾关系，具体操作请参见《华为云
Stack 8.1.0
运维指南》中“删除异地容灾系统（华为云Stack场景）”章节。
步骤2 使用PuTTY工具以sopuser用户通过SSH方式登录待修改时间节点。获取节点IP地址的
方法请参见3.13 如何查找节点对应的IP地址。
步骤3 执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
步骤4 执行以下命令，停止该节点的服务。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd stopnode
2

## Page 1259

说明
当部署面应用程序和数据处于故障，未恢复状态时，请跳过此步骤。
系统提示如下类似回显信息，所有进程都提示“success”，则说明该节点所有服务停
止成功，否则请联系技术支持工程师协助解决。
...
Stopping process mcdrrouteragent-1-0 ... success
Stopping process testdummyagent-1-0 ... success
Stopping process uniepservice-1-0 ... success
...
步骤5 执行以下命令，判断NTP服务使用的组件。
bash /usr/local/osconfig/os/bin/getsupportntptype.sh
●
若如下类似回显信息，则表示NTP服务使用的是ntpd组件。
["ntpd"]
●
若如下类似回显信息，则表示NTP服务使用的是chrony组件。
["ntpd", "chrony"]
步骤6 执行以下命令，切换到root用户。
sudo su root
Password:root用户的密码
步骤7 根据步骤5查询的组件类型选择对应的操作，停止待修改时间节点的NTP服务。
●
ntpd组件
service ntpd stop
●
chrony组件
systemctl stop chronyd
步骤8 执行以下命令，从NTP时钟源同步系统时间。
ntpdate
时钟源IP地址
timedatectl set-local-rtc 0
hwclock --systohc -u
echo $?
当回显为0表示从NTP时钟源同步系统时间成功。否则，联系技术支持工程师协助解
决。
0
说明
命令中的“时钟源IP地址”请替换为实际规划的IP地址，若待修改时间的服务器为部署节点，则
替换为NTP时钟源的IP地址；若为产品节点，则替换为ManageOne-Deploy01节点的IP地址。
步骤9 执行以下命令，查看当前服务器的时间，并查看是否与NTP时钟源的时间精确一致。
date
系统回显如下类似信息：
Tue May 26 19:46:12 CST 2019
2

## Page 1260

●
若待修改时间的为部署节点，则节点的时间需与NTP时钟源时间精确一致。
●
若待修改时间的为产品节点，则节点的时间需与部署节点的时间精确一致。
如果时间精确一致，执行步骤10，否则请联系技术支持工程师协助解决。
步骤10 根据步骤5查询的组件类型选择对应的操作，启动待修改节点的NTP服务。
●
ntpd组件
service ntpd start
●
chrony组件
systemctl start chronyd
步骤11 执行以下命令，退出root用户。
exit
步骤12 执行以下命令，启动节点上的服务。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd startnode
说明
当部署面应用程序和数据处于故障，未恢复状态时，请跳过此步骤。
系统提示如下类似回显信息，所有进程都提示“success”，则说明该节点所有服务启
动成功，否则请联系技术支持工程师协助解决。
...
Starting process testdummyagent-1-0 ... success
Starting process mcdrrouteragent-1-0 ... success
Starting process mcir-1-0 ... success
...
步骤13 对于异地容灾场景，故障修复后需建立主备站点的异地容灾关系，具体操作请参见
《华为云Stack
8.1.0
运维指南》中“配置异地容灾系统（华为云Stack场景）”章
节。
----结束
2.5.1.2 NTP
服务器状态异常
现象描述
在部署面主菜单中选择“维护 > 时间管理 > 配置NTP”，在“配置NTP”页面，添加
完NTP服务器后，在NTP服务器列表中，检查NTP服务器的“时间同步状态”为“失
效”。
前提条件
已获取部署节点的sopuser和root用户的密码。
操作步骤
步骤1 对于异地容灾场景，需删除主备站点间的异地容灾关系，具体操作请参见《华为云
Stack 8.1.0
运维指南》中“删除异地容灾系统（华为云Stack场景）”章节。
2

## Page 1261

步骤2 检查部署节点与上级NTP服务器间的网络连接是否正常。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录部署节点。
说明
请分别登录所有部署节点执行以下操作。获取节点IP地址的方法请参见3.13 如何查找节点
对应的IP地址。
2.
执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
3.
执行以下命令，判断NTP服务使用的组件。
bash /usr/local/osconfig/os/bin/getsupportntptype.sh
–
若如下类似回显信息，则表示NTP服务使用的是ntpd组件。
["ntpd"]
–
若如下类似回显信息，则表示NTP服务使用的是chrony组件。
["ntpd", "chrony"]
4.
执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
5.
根据步骤2.3查询的组件类型选择对应的操作，检查部署节点与上级NTP服务器间
的网络连接是否正常。
–
ntpd组件
ntpq -np
remote refid st t when poll reach delay offset jitter
============================================================================
==
* x.x.x.x LOCAL(0) 6 u 90 128 377 0.199 -0.024 0.043
▪
若系统回显信息中“reach”、“delay”、“offset”和“jitter”的值均
不为0，代表部署节点与上级NTP服务器间的网络连接正常。
▪
若系统回显信息中“reach”、“delay”、“offset”和“jitter”的值均
为0，代表部署节点与上级NTP服务器间的网络连接异常。
–
chrony组件
chronyc -n sources
M S Name/IP address Stratum Poll Reach LastRx Last sample
============================================================================
===
^ ? x.x.x.x 0 10 0 - +0ns[ +0ns] +/- 0ns
▪
若系统回显信息中“S”的值为“*”，代表部署节点与上级NTP服务器
间的网络连接正常。
▪
若系统回显信息中“S”的值为“?”，代表部署节点与上级NTP服务器
间的网络连接异常。
6.
执行以下命令，退出root用户。
exit
步骤3 检查上级NTP服务器的NTP服务是否正常。
联系NTP端工程师，确认NTP服务器的NTP服务状态，确保NTP服务已启动且已为部署
面提供NTP服务。
2

## Page 1262

步骤4 检查部署节点的NTP服务是否正常。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录部署节点。
说明
请分别登录所有部署节点执行以下操作。
2. 执行以下命令，切换到root用户。
sudo su root
Password:root用户的密码
3. 根据步骤2.3查询的组件类型选择对应的操作，检查是否存在运行的NTP服务。
– ntpd组件
service ntpd status
▪
若系统回显信息中包含“active (running)”字样的信息，说明节点的
NTP服务已启动。
▪
否则，说明节点的NTP服务未启动，执行以下命令启动NTP服务。
service ntpd start
–
chrony组件
systemctl status chronyd
▪
若系统回显信息中包含“active (running)”字样的信息，说明节点的
NTP服务已启动。
▪
否则，说明节点的NTP服务未启动，执行以下命令启动NTP服务。
systemctl start chronyd
4.
执行以下命令，退出root用户。
exit
步骤5 如果以上检查结果都正常但NTP服务器的时间同步状态仍处于“失效”状态，请继续
执行以下操作。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“维护
>
时间管理
>
配置NTP”，在“配置NTP”界面单
击“重新配置”。
3.
弹出“确认”对话框，单击“是”。
4.
在部署面主菜单中选择“维护
>
时间管理
>
配置时区时间”，在“配置时区时
间”界面，单击“强制同步”。
2

## Page 1263

说明
–
如果强制同步时区时间后，还需要做其他需要重启产品服务或产品数据库的配置操作，
请取消选中“警告”对话框中的“强制同步时区时间完成后自动启动产品数据库和产品
服务”，则强制同步完成后不会自动启动产品数据库和产品服务，避免产品服务或产品
数据库被多次重启。
– 对于异地容灾场景，如果强制同步的时区时间是备站点的时区时间，请取消选中“警
告”对话框中“强制同步时区时间完成后自动启动产品数据库和产品服务”，避免备站
点上的产品服务被重启，造成双主运行的异常状态。
–
如果强制同步时区时间后，同步后和同步前的时间差超出会话自动注销等待时间，客户
端会话会自动注销。
5.
在部署面主菜单中选择“系统
>
任务列表”，等待“强制同步时区时间”任务执
行成功。
6.
任务执行完成后，若NTP服务器的时间同步状态仍为“失效”，执行以下操作。
a.
若步骤2.3查询的组件为chrony组件，则执行步骤5.6.b，若为ntpd组件请联
系技术支持工程师定位处理。
b.
在部署面主菜单中选择“维护
>
时间管理
>
配置NTP”。
c.
当加密方式选择“NTP v4认证”时，在“配置NTP”界面修改该NTP服务器
的“Key值”，结合界面上该值的配置规则根据实际情况修改。
d.
执行步骤5.4～步骤5.5强制同步时区时间。
7.
对于异地容灾场景，故障修复后需建立主备站点的异地容灾关系，具体操作请参
见《华为云Stack
8.1.0
运维指南》中“配置异地容灾系统（华为云Stack场
景）”章节。
----结束
2.5.2
节点故障
2.5.2.1
约束限制
●
该章节仅支持华为云Stack场景下，除100000 VM管理规模场景、Global独立部署
场景、两级运维场景以外的其他部署场景。
●
该章节不适用于eSight和FusionCare组件。
●
ManageOne-AutoOps-DMZ-Service-Agent01和ManageOne-AutoOps-DMZ-
Service-Agent02节点不支持故障恢复。
●
ManageOne-SubRegion-Static01和ManageOne-SubRegion-Static02虚拟机节点
的数据盘故障时，请参见2.5.2.5 单节点故障进行恢复。
2.5.2.2
操作前准备
●
已获取到ManageOne所在Region的FusionSphere OpenStack的首节点后台地
址、fsp用户、root用户的密码。
●
已获取到ServiceOM的web地址和用户密码。
●
联系技术支持工程师获取对应版本的故障处理软件包
“ManageOne_Independent_Deploy_Supplement.zip”至本地PC。
●
上传故障处理软件包“ManageOne_Independent_Deploy_Supplement.zip”至
FusionSphere
OpenStack控制节点的/home/fsp目录下，并执行以下命令解压所
需脚本文件。
2

## Page 1264

unzip /home/fsp/ManageOne_Independent_Deploy_Supplement.zip
"openstack/*" -d /tmp && dos2unix /tmp/openstack/*
软件包数字签名文件
为了防止软件包在传递过程或存储期间被恶意篡改，下载软件包时需下载对应的数字
签名文件用于完整性验证。
在软件包下载之后，请参考《OpenPGP签名验证指南》，对从Support网站下载的软
件包进行PGP数字签名校验。如果校验失败，请不要使用该软件包，先联系华为技术
支持工程师解决。
使用软件包安装/升级之前，也需要按上述过程先验证软件包的数字签名，确保软件包
未被篡改。
运营商客户请访问：https://support.huawei.com/carrier/digitalSignatureAction
企业客户请访问：https://support.huawei.com/enterprise/zh/tool/pgp-verify-
TL1000000054
2.5.2.3
系统盘故障
故障恢复时长
若虚拟机的系统盘故障时，通过本章节进行系统盘故障恢复，系统盘故障恢复整个流
程参考时长大概需要30分钟，实际操作时长可能受环境、故障虚拟机的节点类型、系
统盘大小等因素影响会有所偏差。
前提条件
除ManageOne-LogCenter、ManageOne-CloudMarket虚拟机外，ManageOne中至
少有一个虚拟机的系统盘正常。
2.5.2.3.1
重建故障系统盘
当虚拟机的系统盘故障要进行恢复时，首先需要使用对应的正常虚拟机的系统盘进行
快照操作。
●
若ManageOne-SubRegion-Static01/02虚拟机故障时，只能用另一台正常
ManageOne-SubRegion-Static01/02虚拟机的系统盘进行快照操作，若
ManageOne-SubRegion-Static01/02虚拟机均为故障状态时，请联系技术工程师
协助解决。
●
若非ManageOne-SubRegion-Static01/02虚拟机故障时，需要用除ManageOne-
LogCenter01/02、ManageOne-CloudMarket01/02之外的正常虚拟机的系统盘
进行快照操作。
操作步骤
步骤1 使用PuTTY工具以fsp用户通过SSH方式登录FusionSphere OpenStack控制节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换至root用户。
su root
2

## Page 1265

默认密码为：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对
应节点下该帐户的默认密码。
步骤3 执行以下命令，导入环境变量。
source set_env
选择1。
根据提示输入密码，默认密码请参见《华为云Stack
8.1.0
帐户一览表》的“B类
（FusionSphere OpenStack）”页签中，在对应节点下该帐户的默认密码。
步骤4 执行以下命令，重建故障系统盘。
TMOUT=0 && bash /tmp/openstack/create_system_cinder.sh
故障的虚拟机名称
正常虚拟机名称 新建磁盘名称
8
说明
●
故障的虚拟机名称：当前故障的虚拟机名称。
●
正常虚拟机名称：
–
若故障虚拟机为ManageOne-SubRegion-Static01/02虚拟机时，正常虚拟机名称为另
一台正常的ManageOne-SubRegion-Static01/02虚拟机名称。
–
若故障虚拟机为非ManageOne-SubRegion-Static01/02虚拟机时，正常虚拟机名称为
除ManageOne-LogCenter01/02、ManageOne-CloudMarket01/02之外的任意一台正
常虚拟机名称。
●
新建磁盘名称：需要自定义新建磁盘的名称。
●
8：磁盘大小的固定值。
步骤5 执行以下命令，删除上传的压缩文件和创建的文件夹。
rm -f /home/fsp/ManageOne_Independent_Deploy_Supplement.zip && rm -
rf /tmp/openstack/
步骤6 继续执行2.5.2.3.2 修改虚拟机网卡配置，修改虚拟机的网卡配置。
----结束
2

## Page 1266

2.5.2.3.2
修改虚拟机网卡配置
背景介绍
本章节中的虚拟机的指代有两种情况：
●
当只有虚拟机的系统盘故障时，虚拟机指的是系统盘故障的虚拟机。
●
当单节点故障时，虚拟机指的是新建虚拟机。
操作步骤
步骤1 修改虚拟机网卡配置。
1.
登录ServiceOM界面。
–
使用浏览器，通过本地方式登录ServiceOM界面。
登录地址：https://Service OM的网络地址:端口号。例如，https://
192.168.0.1:553。
默认帐号：admin。
–
通过ManageOne运维面首页的单点登录方式。
i.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地
址:31943”，登录ManageOne运维面。
○
密码方式：输入帐号和密码。默认帐号“admin”。
○
USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证
书，并输入PIN码。
ii.
在运维面首页的常用链接区域单击ServiceOM，单击所需登录的区域，
例如：华北，跳转至ServiceOM界面。
说明
– 环境部署后，工具已默认配置ServiceOM基于ManageOne运维面的单点登录。
–
若单点登录失败，需取消ServiceOM的单点登录，通过本地方式登录ServiceOM界面，
具体操作请参见3.24 取消与恢复ServiceOM基于ManageOne运维面的单点登录。
2.
在主菜单中选择“服务列表
>
资源
>
计算资源”，进入“计算资源”页面。
3.
选择“虚拟机”页签，找到需要恢复的虚拟机，单击“VNC登录”。
a.
使用root用户，登录该虚拟机。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签
中，在对应节点下该帐户的默认密码。
b.
执行以下命令，删除网卡配置文件。
rm -f /etc/udev/rules.d/50-persistent-net.rules
c.
执行以下命令，删除ifcfg-eth1文件。
rm -f /etc/sysconfig/network-scripts/ifcfg-eth1
d.
执行以下命令，删除AllowUsers配置项和监听IP。
cp -p /etc/ssh/sshd_config /etc/ssh/sshd_config.bak
sed -i '/AllowUsers/d' /etc/ssh/sshd_config
sed -i 's/^ListenAddress.*/ListenAddress
该虚拟机IP/g'
/etc/ssh/
sshd_config
sed -i '/Match Group .*/d' /etc/ssh/sshd_config
2

## Page 1267

sed -i '/ChrootDirectory .*/d' /etc/ssh/sshd_config
步骤2 执行以下命令，修改hostname。
hostname
虚拟机的hostname
echo > /etc/hostname && echo
虚拟机的hostname
> /etc/hostname
说明
虚拟机的hostname：为虚拟机名称，需要与恢复前保持一致。例如：MOC-ManageOne-
DB01。
步骤3 执行以下命令，重启需要恢复的虚拟机，该操作过程大概需要等待2分钟。
reboot
步骤4 继续执行2.5.2.3.3 修复加固配置项，修复加固配置项。
----结束
2.5.2.3.3
修复加固配置项
操作步骤
步骤1 通过PuTTY工具以sopuser用户登录需要进行恢复的虚拟机。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换至root用户。
sudo su root
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤3 配置加固项。
说明
如果故障节点为ManageOne-Service03或ManageOne-Service04节点，需要在ManageOne-
Service03和ManageOne-Service04节点都执行步骤3.1~步骤3.4。
1.
上传故障处理软件包“ManageOne_Independent_Deploy_Supplement.zip”至
对应节点的/tmp目录下。
2.
执行以下命令，创建文件夹。
mkdir -p /tmp/fault_recorve
mkdir -p /tmp/fault_recorve_execute
3. 执行以下命令，将故障处理软件包放至新建的文件中。
unzip
/tmp/故障处理软件包
-d /tmp/fault_recorve
find /tmp/fault_recorve -name "*.sh"|xargs dos2unix
4.
修改/tmp/fault_recorve和/tmp/fault_recorve_execute目录及文件的权限。
chmod -R 777 /tmp/fault_recorve* && TMOUT=0
2

## Page 1268

5.
获取ManageOne所有节点的固定IP地址、ManageOne部署面浮动IP地址、运维
面浮动IP地址和运营面浮动IP地址，获取结果为iplist="ip1
ip2
ip3..."，执行
iplist="ip1 ip2
ip3..."。
iplist="192.168.0.1 192.168.0.2..."
6.
根据虚拟机的节点类型进行加固项配置。
根据虚拟机的节点类型，执行对应的命令对虚拟机进行加固项配置。虚拟机的节
点类型与对应的命令操作请参见表2-10。
2

## Page 1269

表2-10 不同节点类型对应的加固项配置操作
节点类型 加固项配置操作
ManageOn
e-Deploy01
或者
ManageOn
e-Deploy02
节点
1.
执行以下命令，配置/etc/ssh/sshd_config。
cp -f /tmp/fault_recorve/deploy/sshd_config.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/sshd_config.sh
"$iplist"
2.
执行以下命令，配置节点的iptables。
cp -f /tmp/fault_recorve/common/
config_iptables_for_ssh_listen_float_ip.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/
config_iptables_for_ssh_listen_float_ip.sh
当前节点IP地址
部署面浮动IP地址
3.
增加其他虚拟机和ManageOne-Deploy01，ManageOne-
Deploy02节点互信。
a.
执行以下命令，切换为ossadm用户。
su ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的
“B类（ManageOne）”页签中，在对应节点下该帐户的
默认密码。
b.
配置互信。
a.
执行以下命令，删除/home/ossadm/.ssh/下的公私钥。
rm -rf /home/ossadm/.ssh/id_rsa*
b.
执行以下命令，创建公私钥文件。
ssh-keygen -f ~/.ssh/id_rsa -N '' -m PEM -t rsa -q -
b 4096
c.
执行以下命令，查看公钥文件内容。
cat /home/ossadm/.ssh/id_rsa.pub
d.
依次使用sopuser用户登录除当前节点外的
ManageOne所有节点，并切换为ossadm用户，将步骤
3.6.c.ii.3)中查询到的公钥内容追加到/home/
ossadm/.ssh/authorized_keys文件中。
说明
若authorized_keys文件不存在则需要先新建该文件，再将步骤
3.6.c.ii.3)中查询到的公钥内容追加到/home/ossadm/.ssh/
authorized_keys文件中，并执行以下命令修改权限。
chmod 640 /home/ossadm/.ssh/authorized_keys
chown ossadm:ossgroup /home/ossadm/.ssh/
authorized_keys
2

## Page 1270

节点类型 加固项配置操作
ManageOn
e-Service01
或者
ManageOn
e-Service02
节点
1.
执行以下命令，配置/etc/ssh/sshd_config。
cp -f /tmp/fault_recorve/service01/sshd_config.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/sshd_config.sh
"$iplist"
2.
执行以下命令，配置节点的iptables。
cp -f /tmp/fault_recorve/common/
config_iptables_for_ssh_listen_float_ip.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/
config_iptables_for_ssh_listen_float_ip.sh
当前节点IP地址
运维面浮动IP地址
2

## Page 1271

节点类型 加固项配置操作
ManageOn
e-Service03
或者
ManageOn
e-Service04
节点
1.
执行以下命令，创建sftp用户。
cp -f /tmp/fault_recorve/common/create_user.sh /tmp/
fault_recorve_execute
cp -f /tmp/fault_recorve/service03/
create_sftp_user.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/create_sftp_user.sh
2.
执行以下命令，配置sftp用户工作目录。
cp -f /tmp/fault_recorve/common/
create_directory.sh /tmp/fault_recorve_execute
cp -f /tmp/fault_recorve/service03/
create_sftp_user_directory.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/
create_sftp_user_directory.sh
3.
执行以下命令，配置/etc/ssh/sshd_config。
cp -f /tmp/fault_recorve/service03/sshd_config.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/sshd_config.sh
"$iplist"
4.
执行如下命令，配置句柄数。
cp -f /tmp/fault_recorve/service03/conf_port.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/conf_port.sh
5.
执行以下命令，配置节点的iptables。
cp -f /tmp/fault_recorve/common/
config_iptables_for_ssh_listen_float_ip.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/
config_iptables_for_ssh_listen_float_ip.sh
当前节点IP地址
运营面浮动IP地址
6.
配置ManageOne-Service03和ManageOne-Service04节点的
sftp用户互信。ManageOne-Service03和ManageOne-
Service04互为对端节点。
a.
执行以下命令，修改文件权限。
cd /tmp/fault_recorve/service03;chmod 755
config_ssh_trust.get_keys.sh
config_ssh_trust.autorun.sh
b.
依次在ManageOne-Service03或ManageOne-Service04节
点上执行以下命令，修改MatchGroup配置。
sed -i 's/^Match Group/#Match Group/g' /etc/ssh/
sshd_config
sed -i 's/[^#]ChrootDirectory/
#ChrootDirectory/g' /etc/ssh/sshd_config
sed -i 's/^ChrootDirectory/
#ChrootDirectory/g' /etc/ssh/sshd_config
2

## Page 1272

节点类型 加固项配置操作
sed -i 's/^AllowUsers/#AllowUsers/g' /etc/ssh/
sshd_config
service sshd restart
c.
依次在ManageOne-Service03和ManageOne-Service04节
点上执行以下命令，配置所有的sftp用户互信。
bash config_ssh_trust.get_keys.sh
sftp用户 对端IP地址
本端IP地址 对端sftp用户密码 本端sftp用户密码
说明
○
sftp用户：需要根据查询出来的实际sftp用户进行替换、依次
执行步骤步骤3.6.f.iii。
○
当对端节点同时损坏时，sftp用户有"meteradmin",
"taskfileadmin", "autoopsadmin",
"fdsftpadm","attachadm", "logctadm", "eappadm",
"cloudmarketadm",
"rcaccessservice"。
○
当对端节点未损坏时，登录对端节点，执行ls /home命令
得到的回显信息中，所有属于"meteradmin",
"taskfileadmin", "autoopsadmin",
"fdsftpadm","attachadm", "logctadm", "eappadm",
"cloudmarketadm",
"rcaccessservice"中的用户，即为所
有sftp用户。
○
在ManageOne-Service03节点上执行步骤步骤3.6.f.iii时：
○
对端IP地址：指ManageOne-Service04节点的IP地址。
○
本端IP地址：指ManageOne-Service03节点的IP地址。
○
对端sftp用户密码、本端sftp用户密码：请参见《华为云
Stack 8.1.0
帐户一览表》的“B类（ManageOne）”页签
中，在对应节点下该帐户的默认密码。
○
在ManageOne-Service04节点上执行步骤步骤3.6.f.iii时：
○
对端IP地址：指ManageOne-Service03节点的IP地址。
○
本端IP地址：指ManageOne-Service04节点的IP地址。
○
对端sftp用户密码、本端sftp用户密码：请参见《华为云
Stack 8.1.0
帐户一览表》的“B类（ManageOne）”页签
中，在对应节点下该帐户的默认密码。
d.
依次在ManageOne-Service03和ManageOne-Service04节
点上执行以下命令，改回MatchGroup原配置。
sed -i 's/#Match Group/Match Group/g' /etc/ssh/
sshd_config
sed -i 's/#ChrootDirectory/
ChrootDirectory/g' /etc/ssh/sshd_config
sed -i 's/#AllowUsers/AllowUsers/g' /etc/ssh/
sshd_config
service sshd restart
2

## Page 1273

节点类型 加固项配置操作
ManageOn
e-Tenant01
或者
ManageOn
e-Tenant02
节点
1.
执行以下命令，配置/etc/ssh/sshd_config。
获取当前Region上的OM-SRV所有节点的ip为srv_ips="ip1
ip2
ip3..."，执行srv_ips="ip1
ip2
ip3..."。
cp -f /tmp/fault_recorve/tenant01/sshd_config.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/sshd_config.sh
"$srv_ips" "$iplist"
2.
在B2B场景下，还需要执行以下命令，配置节点的iptables。
cp -f /tmp/fault_recorve/common/
config_iptables_for_ssh_listen_float_ip.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/
config_iptables_for_ssh_listen_float_ip.sh
当前节点IP地址
运营租户侧浮动IP地址
2

## Page 1274

节点类型 加固项配置操作
ManageOn
e-
LogCenter0
1节点
1.
执行以下命令，对ManageOne-LogCenter01节点进行加固。
cp -f /tmp/fault_recorve/common/create_user.sh /tmp/
fault_recorve/common/create_directory.sh /tmp/
fault_recorve/logcenter01/
config_logcenter01_node.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/
config_logcenter01_node.sh "$iplist"
2.
配置sftp服务器指纹信息。
a.
执行以下命令，进入主机ssh密钥目录。
cd /etc/ssh
b.
执行以下命令，备份主机ssh密钥。
cp -fp /etc/ssh/ssh_host_ecdsa_key /etc/ssh/
ssh_host_ecdsa_key."$(date +%Y%m%d)"
c.
执行以下命令，创建ssh密钥。
echo -e 'y'|ssh-keygen -q -t ecdsa -f /etc/ssh/
ssh_host_ecdsa_key -C "" -N ""
d.
执行以下命令，查看SSH公钥文件内容。
cat /etc/ssh/ssh_host_ecdsa_key.pub
e.
依次使用sopuser用户登录除当前节点外的ManageOne所
有节点，并切换为ossadm用户，将步骤3.6.b.iv中查询到
的公钥内容，追加到/home/ossadm/.ssh/known_hosts文
件中，并执行以下命令。
sed -i
"/ManageOne-LogCenter01节点的ip/d"
/home/
ossadm/.ssh/known_hosts
echo
“ManageOne-LogCenter01节点的IP地址 公钥内
容”
>> /home/ossadm/.ssh/known_hosts
说明
若known_hosts文件不存在则需要先新建该文件，再将步骤
3.6.b.iv中查询到的公钥内容，追加到/home/ossadm/.ssh/
known_hosts文件中，并执行以下命令。
chmod 600 /home/ossadm/.ssh/known_hosts
chown ossadm:ossgroup /home/ossadm/.ssh/known_hosts
sed -i "/ManageOne-LogCenter01节点的ip/d" /home/
ossadm/.ssh/known_hosts
echo “ManageOne-LogCenter01节点的IP地址 公钥内容” >> /
home/ossadm/.ssh/known_hosts
2

## Page 1275

节点类型 加固项配置操作
ManageOn
e-
CloudMark
et01或者
ManageOn
e-
CloudMark
et02节点
1.
执行以下命令，配置/etc/ssh/sshd_config。
cp -f /tmp/fault_recorve/CloudMarket/
sshd_config.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/sshd_config.sh
"$iplist"
2.
执行以下命令，创建nfs服务端目录。
cp -f /tmp/fault_recorve/common/
create_directory.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/create_directory.sh
"/opt/sftpfile" "ossuser:ossgroup" "550"
bash /tmp/fault_recorve_execute/create_directory.sh
"/opt/sftpfile/hcmshare" "ossuser:ossgroup" "750"
ManageOn
e-
LogCenter0
2
1.
执行以下命令，对节点进行加固配置。
cp -f /tmp/fault_recorve/common/
create_directory.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/create_directory.sh
"/opt/sftpfile" "ossuser:ossgroup" "550"
bash /tmp/fault_recorve_execute/create_directory.sh
"/opt/sftpfile/logctshare" "ossuser:ossgroup" "750"
2.
执行以下命令，配置/etc/ssh/sshd_config。
cp -f /tmp/fault_recorve/logcenter02/
sshd_config.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/sshd_config.sh
"$iplist"
ManageOn
e其他节点
在故障节点执行以下命令，配置/etc/ssh/sshd_config。
cp -f /tmp/fault_recorve/logcenter02/sshd_config.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/sshd_config.sh "$iplist"
步骤4 若故障虚拟机的节点类型不是ManageOne-Deploy01/02节点，需要分别在
ManageOne-Deploy01和ManageOne-Deploy02节点上执行以下操作。
1.
执行以下命令，切换至ossadm用户。
su ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（ManageOne）”
页签中，在对应节点下该帐户的默认密码。
2.
执行以下命令，删除故障虚拟机的原指纹信息并重新生成。
sed -i
'/当前故障的虚拟机IP地址
.*/d' /home/ossadm/.ssh/known_hosts
ssh
当前故障的虚拟机IP地址
根据回显提示输入：yes。
2

## Page 1276

步骤5 配置MODataNebula和MOLog服务最大线程数。
在MODataNebula和MOLog服务所在节点，执行如下命令。
sed -i '/^vm.max_map_count/d' /etc/sysctl.conf
echo 'vm.max_map_count=524288' >> /etc/sysctl.conf
sysctl -p
说明
● MODataNebula和MOLog服务所在节点IP地址的获取方式请参见3.15 如何查找服务所在节
点的IP地址。
●
单节点故障进行恢复时，跳过此步骤。
步骤6 根据系统盘故障的虚拟机节点类型配置NFS。
●
若系统盘故障的虚拟机的节点类型为ManageOne-LogCenter01、ManageOne-
LogCenter02、ManageOne-CloudMarket01、ManageOne-CloudMarket02、
ManageOne-Service03或者ManageOne-Service04节点，需要配置NFS客户端或
者服务端，不同节点类型对应的配置NFS操作具体请参见表2-11。
表2-11 不同节点类型对应的配置NFS操作
节点类型 配置NFS服务端/客户端
ManageOne-
LogCenter01节点
配置NFS服务端：
1.
执行以下命令，关闭防火墙。
systemctl stop firewalld
2.
配置NFS。
a.
执行以下命令，移动conf_nfs.sh文件到执行目
录下。
cp -f /tmp/fault_recorve/common/
conf_nfs.sh /tmp/fault_recorve_execute
b.
配置NFS。
bash /tmp/fault_recorve_execute/
conf_nfs.sh
ManageOne-Service03节点的IP地
址
/opt/sftpfile/logctshare
2

## Page 1277

节点类型 配置NFS服务端/客户端
ManageOne-
CloudMarket01节点
配置NFS服务端：
1.
执行以下命令，关闭防火墙。
systemctl stop firewalld
2.
配置NFS。
a.
执行以下命令，移动conf_nfs.sh文件到执行目
录下。
cp -f /tmp/fault_recorve/common/
conf_nfs.sh /tmp/fault_recorve_execute
b.
配置NFS。
bash /tmp/fault_recorve_execute/
conf_nfs.sh
ManageOne-Service03节点的IP地
址
/opt/sftpfile/hcmshare
ManageOne-
LogCenter02节点
配置NFS服务端：
1.
执行以下命令，关闭防火墙。
systemctl stop firewalld
2.
配置NFS。
a.
执行以下命令，移动conf_nfs.sh文件到执行目
录下。
cp -f /tmp/fault_recorve/common/
conf_nfs.sh /tmp/fault_recorve_execute
b.
配置NFS。
bash /tmp/fault_recorve_execute/
conf_nfs.sh
ManageOne-Service04节点的IP地
址
/opt/sftpfile/logctshare
ManageOne-
CloudMarket02节点
配置NFS服务端：
1.
执行以下命令，关闭防火墙。
systemctl stop firewalld
2.
配置NFS。
a.
执行以下命令，移动conf_nfs.sh文件到执行目
录下。
cp -f /tmp/fault_recorve/common/
conf_nfs.sh /tmp/fault_recorve_execute
b.
配置NFS。
bash /tmp/fault_recorve_execute/
conf_nfs.sh
ManageOne-Service04节点的IP地
址
/opt/sftpfile/hcmshare
2

## Page 1278

节点类型 配置NFS服务端/客户端
ManageOne-
Service03节点
配置NFS客户端：
1.
执行以下命令，移动conf_nfs_client.sh文件到执行
目录下。
cp -f /tmp/fault_recorve/common/
conf_nfs_client.sh /tmp/fault_recorve_execute
2.
执行以下命令，配置ManageOne-LogCenter01节
点的客户端NFS。
bash /tmp/fault_recorve_execute/
conf_nfs_client.sh
ManageOne-LogCenter01节
点的IP地址
/opt/sftpfile/logctshare /opt/
sftpfile/opt/sftpfile/logcenter/logctshare
3.
执行以下命令，配置ManageOne-CloudMarket01
节点的客户端NFS。
bash /tmp/fault_recorve_execute/
conf_nfs_client.sh ManageOne-CloudMarket01
节点的IP地址
/opt/sftpfile/hcmshare /opt/
sftpfile/opt/sftpfile/hcmservice/hcmshare
ManageOne-
Service04节点
配置NFS客户端：
1.
执行以下命令，移动conf_nfs_client.sh文件到执行
目录下。
cp -f /tmp/fault_recorve/common/
conf_nfs_client.sh /tmp/fault_recorve_execute
2.
执行以下命令，配置ManageOne-LogCenter02节
点的客户端NFS。
bash /tmp/fault_recorve_execute/
conf_nfs_client.sh
ManageOne-LogCenter02节
点的IP地址
/opt/sftpfile/logctshare /opt/
sftpfile/opt/sftpfile/logcenter/logctshare
3.
执行以下命令，配置ManageOne-CloudMarket02
节点的客户端NFS。
bash /tmp/fault_recorve_execute/
conf_nfs_client.sh ManageOne-CloudMarket02
节点的IP地址
/opt/sftpfile/hcmshare /opt/
sftpfile/opt/sftpfile/hcmservice/hcmshare
●
若系统盘故障的虚拟机的节点类型为其他节点，执行步骤8。
步骤7 配置ManageOne-LogCenter01/02和ManageOne-CloudMarket01/02节点的防火墙。
说明
若节点类型为ManageOne-LogCenter01/02、ManageOne-CloudMarket01/02节点，则执行该
步骤配置防火墙，否则跳过该步骤。
1.
获取ManageOne中除过ManageOne-Tenant01、ManageOne-Tenant02和
ManageOne-TenantConsole-IP节点的所有节点IP地址以及浮动IP地址，结果为
ips="ip1 ip2
ip3..."，执行ips="ip1
ip2
ip3..."，示例如下：
ips="192.168.0.1 192.168.0.2..."
2

## Page 1279

2.
获取除过ManageOne-Tenant01/02节点的子网掩码为netmask。
netmask="255.255.255.0"
3.
获取ManageOne-Tenant01、ManageOne-Tenant02节点以及ManageOne-
TenantConsole-IP节点的IP地址，结果为tenant_ips="ip1
ip2
ip3"，执行
tenant_ips="ip1 ip2
ip3"，示例如下：
tenant_ips="192.168.0.1 192.168.0.2..."
说明
若没有ManageOne-TenantConsole-IP节点，则无需获取该节点的IP地址。
4.
获取ManageOne-Tenant01/02节点的子网掩码为tenant_netmask。
tenant_netmask="255.255.255.0"
5.
执行以下命令，配置节点防火墙策略。
a.
移动conf_firewall.sh文件到执行目录下。
cp -f /tmp/fault_recorve/common/conf_firewall.sh /tmp/
fault_recorve_execute
b.
配置节点的防火墙。
根据虚拟机的节点类型，执行对应的命令配置防火墙。虚拟机的节点类型与
对应的命令操作请参见表2-12。
表2-12 不同节点类型对应的配置防火墙操作
节点类型 执行以下命令
ManageOne-
LogCenter01或者
ManageOne-
LogCenter02节点
bash /tmp/fault_recorve_execute/
conf_firewall.sh "$ips" "$netmask"
"$tenant_ips" "$tenant_netmask"
27300-27499
ManageOne-
CloudMarket01或者
ManageOne-
CloudMarket02节点
bash /tmp/fault_recorve_execute/
conf_firewall.sh "$ips" "$netmask"
"$tenant_ips" "$tenant_netmask"
步骤8 在当前虚拟机中执行以下命令，删除已安装的Agent文件。
rm -rf /usr/local/CloudAgent/plugins/MOOpsAgent/*
删除成功后，需要卸载并重新安装Agent，如何卸载安装Agent具体操作请参见
《ManageOne
8.1.0
运维指南》中的“自动作业
>
设备管理
>
安装Agent”章节。
步骤9 执行以下命令，删除上传的压缩文件和创建的文件夹。
rm -rf
/tmp/故障处理软件包
/tmp/fault_recorve /tmp/fault_recorve_execute
----结束
2.5.2.4
数据盘故障
故障恢复时长
若虚拟机的数据盘故障时，通过本章节进行数据盘故障恢复，数据盘故障恢复整个流
程参考时长大概需要1小时，实际操作时长可能受环境、故障虚拟机的节点类型、数据
量大小等因素影响会有所偏差。
2

## Page 1280

前提条件
●
提供备份恢复的SFTP服务器正常。
●
SFTP备份服务器上必须有部署面和产品的备份文件及其签名，否则数据盘上的数
据无法恢复。
2.5.2.4.1
创建新的虚拟机
当虚拟机的数据盘故障要进行恢复时，首先需要创建一个新的虚拟机。
操作步骤
步骤1 新建虚拟机。
1.
登录ServiceOM界面。
–
使用浏览器，通过本地方式登录ServiceOM界面。
登录地址：https://Service OM的网络地址:端口号。例如，https://
192.168.0.1:553。
默认帐号：admin。
–
通过ManageOne运维面首页的单点登录方式。
i.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地
址:31943”，登录ManageOne运维面。
○
密码方式：输入帐号和密码。默认帐号“admin”。
○
USB Key方式：插入已预置用户证书的USB Key，选择设备和用户证
书，并输入PIN码。
ii.
在运维面首页的常用链接区域单击ServiceOM，单击所需登录的区域，
例如：华北，跳转至ServiceOM界面。
说明
–
环境部署后，工具已默认配置ServiceOM基于ManageOne运维面的单点登录。
–
若单点登录失败，需取消ServiceOM的单点登录，通过本地方式登录ServiceOM界面，
具体操作请参见3.24 取消与恢复ServiceOM基于ManageOne运维面的单点登录。
2.
在主菜单中选择“服务列表
>
资源
>
计算资源”，进入“计算资源”页面。
3.
单击右上方的“创建虚拟机”。
4.
选择可用分区，具体配置操作请参见表2-13，配置完成后在右下方单击“下一
步”，在弹出的提示框中单击“确定”。
表2-13 选择可用分区的参数及说明
参数 说明 操作说明
项目 新建虚拟机所在的项
目。
-
可用分区 新建虚拟机的可用分
区。
选择：manage-az。
5.
选择所需镜像。
根据实际情况选择数据盘故障的虚拟机所用镜像，配置完成后在右下方单击“下
一步”。
2

## Page 1281

6.
选择虚拟机规格，具体配置操作请参见表2-14，配置完成后在右下方单击“下一
步”。
表2-14 选择虚拟机规格的参数及说明
参数 说明 操作说明
磁盘类型 新建虚拟机的磁盘类
型。包括：云磁盘和本
地磁盘。
选择：云硬盘。
系统盘 新建虚拟机的系统盘。 8（根据实际需要设置）。
选择规格 新建虚拟机的规格。 根据实际情况选择所需规格。例如：
选择名称为ManageOne-Service01
的规格。
7.
选择存储，单击存储SLA名称 为“manager.fsa.csg”左侧的 ，选中该存储，在
右下方单击“下一步”。
8.
选择网络，具体配置操作请参见表2-15，在右下方单击“下一步”。
表2-15 选择网络的参数及说明
参数 说明 操作说明
端口类
型
新建虚拟机的端口类
型。
-
共享类
型
新建虚拟机的共享类
型。包括：非共享网
络和共享网络。
选择：非共享类型。
选择网
络
新建虚拟机的网络。
–
项目：选择“service”。
–
网络：选择“external_om”。
说明
▪
B2B场景下：
○
ManageOne-Tenant虚拟机的网络平面
为“DMZ_Service”。
○
其他的虚拟机网络平面都为
“external_om ”。
▪
非B2B场景下：所有虚拟机的网络平面都
为“external_om ”。
IPv4子
网
是否指定新建虚拟机
所在的IPv4子网。选
择：指定。
子网：-
IP地址：根据实际情况输入当前网段未被占
用的IP地址。
浮动IP地址：-
安全组 新建虚拟机所在的安
全组。
选择：关闭。
2

## Page 1282

9.
配置新建虚拟机的基本信息，具体配置操作请参见表2-16，配置完成后在右下方
单击“下一步”。
表2-16 基本信息的参数及说明
参数 说明 操作说明
虚拟机名称 新建虚拟机的名称。 根据界面提示输入。
主机 是否指定新建虚拟机所
在的主机。
-
虚拟机组 是否指定新建虚拟机的
虚拟机组。选择：不指
定。
-
附加信息 附加信息说明。 -
描述 相关描述说明。
-
10.
确认已配置的所有信息，单击“确认”。
11.
在弹出“确认”对话框，单击“确定”，进入任务中心页面。
12.
完成创建虚拟机任务。返回计算资源页面的虚拟机页签，当该虚拟机的状态为
“运行中”时表示虚拟机创建成功。
步骤2 继续执行2.5.2.4.2 创建新的数据盘，新建数据盘。
----结束
2.5.2.4.2
创建新的数据盘
创建新的数据盘，并将其挂载至新建的虚拟机中。
操作步骤
步骤1 使用PuTTY工具以fsp用户通过SSH方式登录FusionSphere OpenStack控制节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换至root用户。
su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，导入环境变量。
source set_env
选择1。
2

## Page 1283

根据提示输入密码，默认密码请参见《华为云Stack
8.1.0
帐户一览表》的“B类
（FusionSphere OpenStack）”页签中，在对应节点下该帐户的默认密码。
步骤4 执行以下命令，防止系统超时退出。
TMOUT=0
步骤5 执行以下命令，创建新的数据盘。
bash /tmp/openstack/create_data_cinder.sh
故障的虚拟机名称 新建磁盘名称 新
建虚拟机名称
说明
●
故障的虚拟机名称：当前故障的虚拟机名称。
●
新建磁盘名称：需要自定义新建磁盘的名称。
●
新建虚拟机名称：表2-16中新建的虚拟机名称。
步骤6 继续执行2.5.2.4.3 对新建数据盘进行磁盘划分，对新建数据盘进行磁盘划分。
----结束
2.5.2.4.3
对新建数据盘进行磁盘划分
新建数据盘完成后，需要对新建数据盘进行磁盘划分。
操作步骤
步骤1 使用Putty工具以root用户登录新建虚拟机。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，防止系统超时退出。
TMOUT=0
步骤3 上传故障处理软件包“ManageOne_Independent_Deploy_Supplement.zip”到对应
节点的/tmp目录下。
步骤4 执行以下命令，新建文件夹。
mkdir -p /tmp/fault_recorve
mkdir -p /tmp/fault_recorve_execute
步骤5 执行以下命令，将故障处理软件包放至新建的文件中。
2

## Page 1284

unzip
/tmp/故障处理软件包
-d /tmp/fault_recorve
find /tmp/fault_recorve -name "*.sh"|xargs dos2unix
步骤6 修改/tmp/fault_recorve和/tmp/fault_recorve_execute目录及文件的权限。
chmod -R 777 /tmp/fault_recorve*
步骤7 对新建虚拟机的数据盘进行磁盘画卷。
根据新建虚拟机的节点类型，执行对应的命令对新建虚拟机的数据盘进行磁盘画卷。
虚拟机的节点类型与对应的命令操作请参见表2-17。
表2-17 不同节点类型对应的磁盘画卷命令操作
节点类型 执行以下命令 说明
ManageOne-
Deploy01和
ManageOne-
Deploy02节点
cp -f /tmp/fault_recorve/common/
create_vol_euler_for_deploy_node.sh
/tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/
create_vol_euler_for_deploy_node.sh
/dev/vdb
●
若回显信息中包含
“create
volumn
success.”字样的
信息时，表示画卷
成功。
●
若回显信息中不包
含“create
volumn
success.”
字样的信息时，表
示画卷失败，请联
系技术支持工程师
协助解决。
ManageOne-
LogCenter01和
ManageOne-
LogCenter02节
点
cp -f /tmp/fault_recorve/common/
create_vol_euler_for_logcenter.sh /tm
p/fault_recorve_execute
bash /tmp/fault_recorve_execute/
create_vol_euler_for_logcenter.sh /de
v/vdb
●
若回显信息中包含
“create
volumn
success.”字样的
信息时，表示画卷
成功。
●
若回显信息中不包
含“create
volumn
success.”
字样的信息时，表
示画卷失败，请联
系技术支持工程师
协助解决。
2

## Page 1285

节点类型 执行以下命令 说明
ManageOne-
CloudMarket0
1和
ManageOne-
CloudMarket0
2节点
cp -f /tmp/fault_recorve/common/
create_vol_euler_for_cloudmarket.sh
/tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/
create_vol_euler_for_cloudmarket.sh
/dev/vdb
●
若回显信息中包含
“create
volumn
success.”字样的
信息时，表示画卷
成功。
●
若回显信息中不包
含“create
volumn
success.”
字样的信息时，表
示画卷失败，请联
系技术支持工程师
协助解决。
ManageOne-
SubRegion-
Static01和
ManageOne-
SubRegion-
Static02节点
cp -f /tmp/fault_recorve/common/
create_vol_euler_for_static.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/
create_vol_euler_for_static.sh /dev/vd
b
●
若回显信息中包含
“create
volumn
success.”字样的
信息时，表示画卷
成功。
●
若回显信息中不包
含“create
volumn
success.”
字样的信息时，表
示画卷失败，请联
系技术支持工程师
协助解决。
ManageOne其
他节点
cp -f /tmp/fault_recorve/common/
create_vol_euler.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/
create_vol_euler.sh /dev/vdb
●
若回显信息中包含
“create
volumn
success.”信息的
字样时，表示画卷
成功。
●
若回显信息中不包
含“create
volumn
success.”
信息的字样时，表
示画卷失败，请联
系技术支持工程师
协助解决。
步骤8 执行以下命令，删除/etc/fstab文件中的挂载点信息。
sed -i "/opt_vol/d" /etc/fstab
sed -i "/sftp_vol/d" /etc/fstab
sed -i "/optlog_vol/d" /etc/fstab
步骤9 继续执行2.5.2.4.4 恢复数据盘，恢复数据盘。
----结束
2

## Page 1286

2.5.2.4.4
恢复数据盘
在FusionSphere
OpenStack
控制节点后台恢复数据盘。
操作步骤
步骤1 执行以下命令，将分区好的新建磁盘挂载至数据盘故障的虚拟机。
bash /tmp/openstack/restore_data_cinder.sh
数据盘故障的虚拟机名称 新建磁盘
名称 新建虚拟机名称
说明
●
数据盘故障的虚拟机名称：当前数据盘故障的虚拟机名称。
●
新建磁盘名称：需要自定义新建磁盘的名称。
●
新建虚拟机名称：表2-16中新建的虚拟机名称。
步骤2 使用PuTTY工具通过sopuser用户登录数据盘故障的虚拟机。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，切换为root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤4 执行以下命令，防止系统超时退出。
TMOUT=0
步骤5 恢复故障的数据盘。
1.
上传故障处理软件包“ManageOne_Independent_Deploy_Supplement.zip”到
对应节点的/tmp目录下。
2.
执行以下命令，新建文件夹。
mkdir -p /tmp/fault_recorve
mkdir -p /tmp/fault_recorve_execute
3.
执行以下命令，将故障处理软件包放至新建的文件中。
unzip
/tmp/故障处理软件包
-d /tmp/fault_recorve
find /tmp/fault_recorve -name "*.sh"|xargs dos2unix
4.
修改/tmp/fault_recorve和/tmp/fault_recorve_execute目录及文件的权限。
chmod -R 777 /tmp/fault_recorve*
5.
恢复数据盘故障的虚拟机目录权限。
根据数据盘故障的虚拟机的节点类型，执行对应的命令恢复虚拟机的目录权限。
虚拟机的节点类型与对应的命令操作请参见表2-18。
2

## Page 1287

表2-18 不同节点类型对应的恢复目录权限操作
节点类型 执行以下命令
ManageOne-
LogCenter01和
ManageOne-
LogCenter02节点
cp -f /tmp/fault_recorve/logcenter01/
config_log.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/config_log.sh
ManageOne-
CloudMarket01和
ManageOne-
CloudMarket02节点
cp -f /tmp/fault_recorve/CloudMarket/
config_cloudmarket.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/
config_cloudmarket.sh
ManageOne-
Service03和
ManageOne-
Service04节点
1.
执行以下命令。
cp -f /tmp/fault_recorve/service03/
config_service.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/
config_service.sh
2.
执行以下命令，配置sftp用户工作目录。
cp -f /tmp/fault_recorve/common/
create_directory.sh /tmp/fault_recorve/
service03/create_sftp_user_directory.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/
create_sftp_user_directory.sh
ManageOne其他节点
cp -f /tmp/fault_recorve/common/
config_other_nodes.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/
config_other_nodes.sh
步骤6 根据数据盘故障的虚拟机节点类型配置NFS。
●
若数据盘故障的虚拟机的节点类型为ManageOne-LogCenter01、ManageOne-
LogCenter02、ManageOne-CloudMarket01、ManageOne-CloudMarket02、
ManageOne-Service03或者ManageOne-Service04节点，需要配置NFS客户端或
者服务端，不同节点类型对应的配置NFS操作具体请参见表2-19。
2

## Page 1288

表2-19 不同节点类型对应的配置NFS操作
节点类型 配置NFS服务端/客户端
ManageOne-
LogCenter01节点
配置NFS服务端：
1.
执行以下命令，关闭防火墙。
systemctl stop firewalld
2.
配置NFS。
a.
执行以下命令，移动conf_nfs.sh文件到执行目录
下。
cp -f /tmp/fault_recorve/common/
conf_nfs.sh /tmp/fault_recorve_execute
b.
配置NFS。
bash /tmp/fault_recorve_execute/conf_nfs.sh
ManageOne-Service03节点的IP地址
/opt/
sftpfile/logctshare
ManageOne-
CloudMarket01节点
配置NFS服务端：
1.
执行以下命令，关闭防火墙。
systemctl stop firewalld
2.
配置NFS。
a.
执行以下命令，移动conf_nfs.sh文件到执行目录
下。
cp -f /tmp/fault_recorve/common/
conf_nfs.sh /tmp/fault_recorve_execute
b.
配置NFS。
bash /tmp/fault_recorve_execute/conf_nfs.sh
ManageOne-Service03节点的IP地址
/opt/
sftpfile/hcmshare
ManageOne-
LogCenter02节点
配置NFS服务端：
1.
执行以下命令，关闭防火墙。
systemctl stop firewalld
2.
配置NFS。
a.
执行以下命令，移动conf_nfs.sh文件到执行目录
下。
cp -f /tmp/fault_recorve/common/
conf_nfs.sh /tmp/fault_recorve_execute
b.
配置NFS。
bash /tmp/fault_recorve_execute/conf_nfs.sh
ManageOne-Service04节点的IP地址
/opt/
sftpfile/logctshare
2

## Page 1289

节点类型 配置NFS服务端/客户端
ManageOne-
CloudMarket02节点
配置NFS服务端：
1.
执行以下命令，关闭防火墙。
systemctl stop firewalld
2.
配置NFS。
a.
执行以下命令，移动conf_nfs.sh文件到执行目录
下。
cp -f /tmp/fault_recorve/common/
conf_nfs.sh /tmp/fault_recorve_execute
b.
配置NFS。
bash /tmp/fault_recorve_execute/conf_nfs.sh
ManageOne-Service04节点的IP地址
/opt/
sftpfile/hcmshare
ManageOne-
Service03节点
配置NFS客户端：
1.
执行以下命令，移动conf_nfs_client.sh文件到执行目
录下。
cp -f /tmp/fault_recorve/common/
conf_nfs_client.sh /tmp/fault_recorve_execute
2.
执行以下命令，配置ManageOne-LogCenter01节点
的客户端NFS。
bash /tmp/fault_recorve_execute/
conf_nfs_client.sh
ManageOne-LogCenter01节点
的IP地址
/opt/sftpfile/logctshare/opt/
sftpfile/opt/sftpfile/logcenter/logctshare
3.
执行以下命令，配置ManageOne-CloudMarket01节
点的客户端NFS。
bash /tmp/fault_recorve_execute/
conf_nfs_client.shManageOne-CloudMarket01节
点的
IP地址
/opt/sftpfile/hcmshare/opt/sftpfile/opt/
sftpfile/hcmservice/hcmshare
2

## Page 1290

节点类型 配置NFS服务端/客户端
ManageOne-
Service04节点
配置NFS客户端：
1.
执行以下命令，移动conf_nfs_client.sh文件到执行目
录下。
cp -f /tmp/fault_recorve/common/
conf_nfs_client.sh /tmp/fault_recorve_execute
2.
执行以下命令，配置ManageOne-LogCenter02节点
的客户端NFS。
bash /tmp/fault_recorve_execute/
conf_nfs_client.sh
ManageOne-LogCenter02节点
的IP地址
/opt/sftpfile/logctshare/opt/
sftpfile/opt/sftpfile/logcenter/logctshare
3.
执行以下命令，配置ManageOne-CloudMarket02节
点的客户端NFS。
bash /tmp/fault_recorve_execute/
conf_nfs_client.shManageOne-CloudMarket02节
点的IP地址
/opt/sftpfile/hcmshare/opt/
sftpfile/opt/sftpfile/hcmservice/hcmshare
●
若数据盘故障的虚拟机的节点类型为其他节点，执行步骤7。
步骤7 恢复数据盘故障的虚拟机的产品。
根据数据盘故障的虚拟机的节点类型，执行对应的操作恢复虚拟机产品。虚拟机的节
点类型与对应的操作请参见表2-20。
表2-20 不同节点类型对应的恢复产品操作
节点类型 恢复新建虚拟机产品的方式
ManageOne-Deploy01、
ManageOne-Deploy02和
ManageOne-Service04节点
1.
单节点发生故障，请参见3.21.1 单个共部署
节点故障。
2.
多个节点发生故障，请参见3.21.2 多个共部
署节点故障。
ManageOne-SubRegion-
Static01和ManageOne-
SubRegion-Static02节点
请参见3.39 如何恢复ManageOne-
SubRegion-Static虚拟机的产品。
ManageOne其他节点
1.
若数据盘故障的虚拟机的节点类型为数据库
节点，请参见《华为云Stack
8.1.0
运维指
南》中“恢复数据库应用程序”章节，恢复
数据库应用程序。
2.
若数据盘故障的虚拟机的节点类型为非数据
库节点，请参见《华为云Stack
8.1.0
运维指
南》中“恢复产品应用程序”章节，恢复产
品应用程序。
步骤8 执行以下命令，删除上传的压缩文件和创建的文件夹。
2

## Page 1291

rm -rf
/tmp/故障处理软件包
/tmp/fault_recorve /tmp/fault_recorve_execute
----结束
2.5.2.5
单节点故障
现象描述
当虚拟机出现故障无法使用，或者虚拟机被删除的情况下，参见此章节恢复故障的虚
拟机。
故障恢复时长
●
若单个虚拟机节点故障时，通过本章节进行单节点故障恢复，单节点故障恢复整
个流程参考时长大概需要2小时，实际操作时长可能受环境、故障虚拟机的节点类
型、磁盘大小、数据量大小等因素影响会有所偏差。
●
若单个虚拟机节点故障时，为了避免业务长时间中断，会有其相对应的备节点自
动升为主节点的机制来进行数据同步倒换，以保障用户业务的正常稳定运行，在
备节点自动升为主节点期间，依赖这些节点的业务会受一定的影响。其中不同虚
拟机节点的主备节点数据倒换所需的恢复时长如表2-21所示。
表2-21 不同虚拟机节点故障所需的主备节点数据倒换恢复时长
节点 主备节点倒换恢复时
长
受影响的业务
ManageOne-Deploy
<3分钟 ManageOne管理面业
务。包括：安装、部
署、升级、备份恢复
等。
ManageOne-DB
<5秒 ManageOne所有业务。
ManageOne-Service01/02
<5秒 运维所有业务。
ManageOne-Service03/04
<5秒 运营所有业务。
ManageOne-Tenant
<5秒 Console框架上所有云服
务业务。
ManageOne-ES 0
全局3W VM管理规模场
景下的Elasticsearch集群
节点。
单节点故障不影响业务
运行，但性能数据、报
表数据、日志数据性能
可能降低。
ManageOne-IAM 0
IAM服务集群。
单节点故障不影响业务
运行，但IAM的处理性能
可能降低。
2

## Page 1292

节点 主备节点倒换恢复时
长
受影响的业务
ManageOne-vAPP 0
服务构建器业务集群。
单节点故障不影响业务
运行，但服务构建器的
处理性能可能降低。
ManageOne-AutoOps 0
AutoOps业务集群。
单节点故障不影响业务
运行，但AutoOps的处理
性能可能降低。
ManageOne-
CloudMarket
0
管理混合云市场业务集
群。
单节点故障不影响业务
运行，但管理混合云市
场的处理性能可能降
低。
ManageOne-Portal 0
统一门户后台服务集
群。
单节点故障不影响业务
运行，但统一门户的访
问性能可能降低。
收集信息
在通过本章节进行虚拟机故障恢复操作前，需要提前收集以下信息。
表2-22 收集的信息与收集方式
收集的信息 收集方式
当前故障虚拟机的部署规模。 虚拟机的部署规模请参见3.38 如何设置
ManageOne虚拟机规格。
故障虚拟机的主机ID。
-
故障虚拟机的磁盘容量。 虚拟机的磁盘容量请参见3.38 如何设置
ManageOne虚拟机规格。
故障虚拟机的IP地址。 节点的IP地址请参见3.13 如何查找节点
对应的IP地址。
ManageOne-LogCenter01、
ManageOne-LogCenter02节点的IP地
址。
ManageOne-CloudMarket01、
ManageOne-CloudMarket02节点的IP地
址。
ManageOne-Service03节点的IP地址。
2

## Page 1293

收集的信息 收集方式
ManageOne-Service04节点的IP地址。
前提条件
●
提供备份恢复的SFTP服务器正常。
●
SFTP备份服务器上必须有部署面和产品的备份文件及其签名，否则数据盘上的数
据无法恢复。
●
该故障虚拟机已经删除。
●
了解ManageOne所在OpenStack底座的网络规划。
●
联系技术支持工程师获取对应版本的故障处理软件包
“ManageOne_Independent_Deploy_Supplement.zip”至本地PC。
软件包数字签名文件
为了防止软件包在传递过程或存储期间被恶意篡改，下载软件包时需下载对应的数字
签名文件用于完整性验证。
在软件包下载之后，请参考《OpenPGP签名验证指南》，对从Support网站下载的软
件包进行PGP数字签名校验。如果校验失败，请不要使用该软件包，先联系华为技术
支持工程师解决。
使用软件包安装/升级之前，也需要按上述过程先验证软件包的数字签名，确保软件包
未被篡改。
运营商客户请访问：https://support.huawei.com/carrier/digitalSignatureAction
企业客户请访问：https://support.huawei.com/enterprise/zh/tool/pgp-verify-
TL1000000054
操作步骤
步骤1 新建虚拟机，具体操作请参见3.25 创建虚拟机。
说明
新建的虚拟机名称需要和当前故障的虚拟机名称保持一致。
步骤2 新建磁盘，具体操作请参见3.26 创建磁盘。
步骤3 挂载新建磁盘至新建虚拟机，具体操作请参见3.27 挂载磁盘。
步骤4 格式化新建虚拟机的数据盘。
1.
使用Putty工具以root用户登录新建虚拟机。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在
对应节点下该帐户的默认密码。
2.
执行以下命令，防止系统超时退出。
TMOUT=0
3.
上传故障处理软件包“ManageOne_Independent_Deploy_Supplement.zip”到
对应节点的/tmp目录下。
2

## Page 1294

4.
执行以下命令，新建文件夹。
mkdir -p /tmp/fault_recorve
mkdir -p /tmp/fault_recorve_execute
5.
执行以下命令，将故障处理软件包放至新建的文件中。
unzip
/tmp/故障处理软件包
-d /tmp/fault_recorve
find /tmp/fault_recorve -name "*.sh"|xargs dos2unix
6.
修改/tmp/fault_recorve和/tmp/fault_recorve_execute目录及文件的权限。
chmod -R 777 /tmp/fault_recorve*
7.
对新建虚拟机的数据盘进行磁盘画卷。
根据新建虚拟机的节点类型，执行对应的命令对新建虚拟机的数据盘进行磁盘画
卷。虚拟机的节点类型与对应的命令操作请参见表2-23。
表2-23 不同节点类型对应的磁盘画卷命令操作
节点类型 执行以下命令 说明
ManageOne-
Deploy01和
ManageOne-
Deploy02节点
cp -f /tmp/fault_recorve/
common/
create_vol_euler_for_deploy_nod
e.sh /tmp/fault_recorve_execute
bash /tmp/
fault_recorve_execute/
create_vol_euler_for_deploy_nod
e.sh /dev/vdb
–
若回显信息中包
含“create
volumn
success.”字样的
信息时，表示画
卷成功。
–
若回显信息中不
包含“create
volumn
success.”字样的
信息时，表示画
卷失败，请联系
技术支持工程师
协助解决。
ManageOne-
LogCenter01和
ManageOne-
ManageOne-
LogCenter02节
点
cp -f /tmp/fault_recorve/
common/
create_vol_euler_for_logcenter.s
h /tmp/fault_recorve_execute
bash /tmp/
fault_recorve_execute/
create_vol_euler_for_logcenter.s
h /dev/vdb
–
若回显信息中包
含“create
volumn
success.”字样的
信息时，表示画
卷成功。
–
若回显信息中不
包含“create
volumn
success.”字样的
信息时，表示画
卷失败，请联系
技术支持工程师
协助解决。
2

## Page 1295

节点类型 执行以下命令 说明
ManageOne-
CloudMarket01
和ManageOne-
CloudMarket02
节点
cp -f /tmp/fault_recorve/
common/
create_vol_euler_for_cloudmarke
t.sh /tmp/fault_recorve_execute
bash /tmp/
fault_recorve_execute/
create_vol_euler_for_cloudmarke
t.sh /dev/vdb
–
若回显信息中包
含“create
volumn
success.”字样的
信息时，表示画
卷成功。
–
若回显信息中不
包含“create
volumn
success.”字样的
信息时，表示画
卷失败，请联系
技术支持工程师
协助解决。
ManageOne-
SubRegion-
Static01和
ManageOne-
SubRegion-
Static02节点
cp -f /tmp/fault_recorve/
common/
create_vol_euler_for_static.sh /t
mp/fault_recorve_execute
bash /tmp/
fault_recorve_execute/
create_vol_euler_for_static.sh /d
ev/vdb
–
若回显信息中包
含“create
volumn
success.”字样的
信息时，表示画
卷成功。
–
若回显信息中不
包含“create
volumn
success.”字样的
信息时，表示画
卷失败，请联系
技术支持工程师
协助解决。
ManageOne其他
节点
cp -f /tmp/fault_recorve/
common/
create_vol_euler.sh /tmp/
fault_recorve_execute
bash /tmp/
fault_recorve_execute/
create_vol_euler.sh /dev/vdb
–
若回显信息中包
含“create
volumn
success.”信息的
字样时，表示画
卷成功。
–
若回显信息中不
包含“create
volumn
success.”信息的
字样时，表示画
卷失败，请联系
技术支持工程师
协助解决。
步骤5 恢复新建虚拟机的系统盘，具体操作请参见2.5.2.3 系统盘故障。
2

## Page 1296

说明
恢复系统盘后，不需要执行2.5.2.3.3 修复加固配置项中的步骤9，即不用删除上传的压缩文件和
创建的文件夹。
步骤6 恢复新建虚拟机的数据盘。
1.
使用PuTTY工具通过sopuser用户登录新建虚拟机。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在
对应节点下该帐户的默认密码。
2.
执行以下命令，切换为root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在
对应节点下该帐户的默认密码。
3.
恢复新建虚拟机的目录权限。
根据新建虚拟机的节点类型，执行对应的命令恢复新建虚拟机的目录权限。虚拟
机的节点类型与对应的命令操作请参见表2-24。
表2-24 不同节点类型对应的恢复目录权限操作
节点类型 执行以下命令
ManageOne-
LogCenter01和
ManageOne-
LogCenter02节点
cp -f /tmp/fault_recorve/logcenter01/
config_log.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/config_log.sh
ManageOne-
CloudMarket01和
ManageOne-
CloudMarket02节
点
cp -f /tmp/fault_recorve/CloudMarket/
config_cloudmarket.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/
config_cloudmarket.sh
ManageOne-
Service03和
ManageOne-
Service04节点
1.
执行以下命令。
cp -f /tmp/fault_recorve/service03/
config_service.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/config_service.sh
2.
执行以下命令，配置sftp用户工作目录。
cp -f /tmp/fault_recorve/common/
create_directory.sh /tmp/fault_recorve/service03/
create_sftp_user_directory.sh /tmp/
fault_recorve_execute
bash /tmp/fault_recorve_execute/
create_sftp_user_directory.sh
ManageOne其他
节点
cp -f /tmp/fault_recorve/common/
config_other_nodes.sh /tmp/fault_recorve_execute
bash /tmp/fault_recorve_execute/
config_other_nodes.sh
步骤7 恢复新建虚拟机的产品。
2

## Page 1297

根据新建虚拟机的节点类型，执行对应的操作恢复新建虚拟机产品。虚拟机的节点类
型与对应的操作请参见表2-25。
表2-25 不同节点类型对应的恢复产品操作
节点类型 恢复新建虚拟机产品的方式
ManageOne-Deploy01、ManageOne-
Deploy02和ManageOne-Service04节点
1.
单节点发生故障，具体操作请参见
3.21.1
单个共部署节点故障。
2.
多个节点发生故障，具体操作请参见
3.21.2
多个共部署节点故障。
ManageOne-SubRegion-Static01和
ManageOne-SubRegion-Static02节点
请参见3.39 如何恢复ManageOne-
SubRegion-Static虚拟机的产品恢复虚
拟机产品。
ManageOne其他节点
1.
若新建虚拟机的节点类型为数据库节
点，请参见《华为云Stack
8.1.0
运维
指南》中“恢复数据库应用程序”章
节，恢复数据库应用程序。然后执行
以下命令，恢复/opt/signtool。
mkdir -p /opt/signtool;cp -
rfp /usr/local/signtool/* /opt/
signtool/;chmod 700 /opt/
signtool/
2.
若新建虚拟机的节点类型为非数据库
节点，请参见《华为云Stack
8.1.0
运
维指南》中“恢复产品应用程序”章
节，恢复产品应用程序。
步骤8 恢复新建虚拟机节点的MORabbitMQService服务。
说明
若节点类型为ManageOne-Service03或者ManageOne-Service04，请参见3.40 如何恢复
MORabbitMQService服务故障恢复MORabbitMQService服务，否则跳过该步骤。
步骤9 执行以下命令，删除上传的压缩文件和创建的文件夹。
rm -rf
/tmp/故障处理软件包
/tmp/fault_recorve /tmp/fault_recorve_execute
----结束
2.5.3
最小恢复系统
2.5.3.1
重新安装
IAM
应用程序
现象描述
当IAM应用程序出现文件权限错乱、内容被篡改、服务无法正常启停、接口无法响应
等无法恢复的异常情况时，通过ManageOne的部署面重新安装IAM应用程序。
2

## Page 1298

故障恢复时长
若IAM应用异常时，通过本章节进行恢复，恢复的整个流程参考时长大概需要20分
钟，实际操作时长可能受环境、虚拟机的I/O性能等因素影响会有所偏差。
前提条件
●
已获取到ManageOne部署面的web地址和用户密码。
● ManageOne部署面登录正常。
●
IAM服务所在的ManageOne虚拟机正常登录。
●
ManageOne部署面中已存在ManageOne-IAM部件包。
操作步骤
卸载或缩容IAM部署特性
步骤1 对于异地容灾场景，需删除主备站点间的异地容灾关系，具体操作请参见《华为云
Stack 8.1.0 运维指南》中“删除异地容灾系统（华为云Stack场景）”章节。
步骤2 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤3 在部署面主菜单中选择“产品
>
软件管理
>
部署产品软件”。
步骤4 选择“ManageOne”产品，进入“产品部署详情”页面。
步骤5 单击右上方“安装”，进入“安装”页面。
步骤6 在“特性”区域取消选中“统一认证组件”特性。
步骤7 拖动右侧滚动条至最下方，单击“下一步”，进入“资源变更”页面。
步骤8 单击右下方“确定”，在弹出的“警告”对话框中单击“确定”，进入“产品部署详
情”页面，开始卸载或缩容IAM部署特性。
步骤9 查看卸载或缩容IAM部署特性是否成功。同时在“部署历史”区域可以查看其部署
“状态”和“进度”。
●
若“总览”区域的“特性列表”中无“统一认证组件”特性且部署“状态”为
“成功”时，表示卸载或缩容IAM部署特性成功，继续执行步骤10，重新安装
IAM部署特性。
●
若部署“状态”为“失败”时，可单击“操作”列的“重试”，并按照界面指引
操作，若部署“状态”依然“失败”时，请联系技术支持工程师协助解决。
重新安装IAM部署特性
步骤10 执行步骤3-步骤5，再次进入“安装”页面。
步骤11 在“特性”区域重新选中“统一认证组件”特性。
步骤12 拖动右侧滚动条至最下方，单击“下一步”，进入“资源变更”页面。
步骤13 单击右下方“确定”，在弹出的“警告”对话框中单击“确定”，进入“产品部署详
情”页面，开始重新安装IAM部署特性。
2

## Page 1299

步骤14 查看重新安装IAM部署特性是否成功。同时在“部署历史”区域可以查看其部署“状
态”和“进度”。
若“总览”区域的“特性列表”中存在“统一认证组件”特性且部署“状态”为“成
功”时，表示重新安装IAM部署特性成功。否则，请联系技术支持工程师协助解决。
步骤15 对于异地容灾场景，故障修复后需建立主备站点的异地容灾关系，具体操作请参见
《华为云Stack
8.1.0
运维指南》中“配置异地容灾系统（华为云Stack场景）”章
节。
----结束
2.5.3.2
恢复
IAM
数据库数据
现象描述
当IAM数据文件出现文件权限错乱、内容被篡改等异常无法恢复时，使用部署面的数
据恢复功能和IAM备份数据文件，独立恢复IAM的业务数据。
故障恢复时长
若IAM数据异常时，通过本章节进行恢复，恢复的整个流程参考时长大概需要30分
钟，实际操作时长可能受环境、数据量大小、虚拟机的I/O性能等因素影响会有所偏
差。
前提条件
●
已获取到ManageOne部署面的web地址和用户密码。
●
ManageOne部署面登录正常。
●
IAM服务所在的ManageOne虚拟机正常登录。
●
提供备份恢复的SFTP服务器正常。
●
SFTP备份服务器上必须有部署面和产品的备份文件及其签名，否则数据盘上的数
据无法恢复。
操作步骤
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在部署面主菜单中选择“备份与恢复
>
数据恢复
>
恢复产品数据”。
步骤3 单击列表左侧 ，选中“ManageOne”产品。
步骤4 在当前产品的“备份文件”列选择要恢复的备份文件。
步骤5 单击当前产品左侧 ，只选择名称为“IAM”的服务组。
步骤6 单击“恢复”，在弹出的“确认”对话框中单击“是”，提示正在进行恢复产品数据
的前置检查。
2

## Page 1300

步骤7 前置检查完成后，在“确认”对话框中单击“是”，提示正在加载信息。
步骤8 信息加载完成后，在“确认”对话框中单击“是”，提示正在加载信息。
步骤9 信息加载完成后，提示任务创建成功，在对话框中单击“任务列表”，进入“任务列
表”页面。也可以在对话框中单击“确定”，在主菜单中选择“系统
>
任务列表”，
进入“任务列表”页面。
步骤10 在任务列表中可以查看当前任务的执行情况。
当“任务进度”为100%且“任务状态”显示“执行成功”时，表示IAM数据恢复成
功。否则，请联系技术支持工程师协助解决。
说明
当前操作完成后，需要清理IAM Redis数据库缓存，具体操作请参见3.28 清理IAM Redis数据库
缓存。
----结束
2.5.3.3
调整
IAM
接口流控参数
现象描述
当IAM暴露的外部接口出现高并发调用等异常攻击导致业务异常（如登录不上或者登
录慢、接口响应明显比之前变慢）时，通过ManageOne的运维面进行接口限流设置，
快速停止IAM服务的非核心接口，只保留核心接口；同时，还可以调整核心接口的流
控参数值，确保核心接口的可用性。
故障恢复时长
若IAM接口出现高并发调用导致业务异常时，通过本章节进行恢复，恢复的整个流程
参考时长大概需要20分钟，实际操作时长可能受环境、要修改流控的接口数量等因素
影响会有所偏差。
前提条件
●
已获取到ManageOne运维面的web地址和用户密码。
●
ManageOne运维面登录正常，集成网关流控开关开启。
操作步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“系统管理
>
系统设置
>
集成网关”，进入“集成网关”页面。
步骤3 根据高频接口调用请求来源，判断需要修改的接口流控。
●
对于来自APIG转发的请求：选择“北向集成网关”页签，执行步骤4，修改北向
接口。
2

## Page 1301

说明
–
调用IAM接口若为iam-apigateway-proxy前缀开头的域名，代表来自APIG的请求。
–
对于来自APIG转发的请求，如果是从8.0.2及之前版本升级至8.1.0版本的，需要选择
“南向集成网关”页签，执行步骤4，修改南向接口。
●
对于来自云服务的请求：选择“南向集成网关”页签，执行步骤4，修改南向接
口。
说明
调用IAM接口若iam-cache-proxy前缀开头的域名，代表来自云服务的请求。
步骤4 判断是否已分析出异常高并发调用的接口。
●
是，执行步骤5，在集成网关页面配置对应接口的流控。
●
否，执行步骤6，先屏蔽掉非核心接口。
说明
IAM接口分级划分为3个等级，分别为：level1、level2、level3；接口的重要程度为：
level1>level2>level3。
–
各IAM接口等级具体请参见2.5.3.5 运维面关键微服务清单和IAM接口等级划分章节。
–
屏蔽接口时，遵循优先屏蔽level3等级的接口，其次屏蔽level2等级的接口，不屏蔽
level1等级的接口的原则，保证核心接口可用。
步骤5 单击接口列表操作列的“配置”，在弹出的“流控配置”对话框中，将“总限流数”
设置的数值减小以拦截异常调用。
步骤6 单击接口列表操作列的“配置”，在弹出的“流控配置”对话框中，将“总限流数”
设置为1。
----结束
2.5.3.4
切换运维面至最小系统状态
背景介绍
ManageOne运维面切换至最小系统状态（只保留核心功能）的情况下，以下核心功能
仍然可以正常提供服务，不强依赖资源管理（CMDB）等其他非核心功能：
1. 运维面可以正常登录。
2.
告警模块仍然可以正常的接收来自eSight和FSP的告警、查看告警列表和详情。
3.
运维面“系统管理
>
日志管理”模块下的日志相关功能仍然可以正常的接收和查
看日志。
说明
运维面最小系统状态下核心功能依赖的服务列表请参见2.5.3.5 运维面关键微服务清单和IAM接
口等级划分。
前提条件
●
已获取到ManageOne运维面的web地址和用户密码。
●
运维面最小系统状态下核心功能依赖的服务需要能够正常提供服务。
2

## Page 1302

操作步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式依次登录微服务的部署节点ManageOne-
Service01/02或者ManageOne-APPServer0X、ManageOne-DataServer0X节点，并执
行以下操作。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
说明
获取节点的IP地址方法请参见3.13 如何查找节点对应的IP地址，没有上述节点的请跳过。
1.
执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
2.
执行以下命令，切换至mojetty服务所在目录。
cd /opt/oss/rtsp/mojetty-x.x
说明
x.x：表示最大版本号。
3.
执行以下命令，切换服务进程启动模板。
sed -i 's/workingMode=.*/workingMode=mini/g' cfg.properties
4.
执行以下命令，重启当前节点。
reboot
步骤2 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤3 查看运维面是否登录成功。
●
是，登录功能正常，只依赖运维登录的其他服务可以正常使用，继续执行步骤4验
证告警功能。
●
否，请联系技术支持工程师协助解决。
步骤4 在主菜单中选择“集中监控
>
告警管理
>
当前告警”，进入“当前告警”页面。
步骤5 查看告警列表是否正常显示。
●
是，告警列表功能正常，执行步骤6。
●
否，请联系技术支持工程师协助解决。
步骤6 单击告警列表右侧 ，查看告警详情信息是否正常显示。
●
是，告警功能正常，继续执行步骤7验证操作日志功能。
●
否，请联系技术支持工程师协助解决。
步骤7 在主菜单中选择“系统管理
>
日志管理
>
操作日志”，进入“操作日志”页面。
步骤8 查看日志信息是否正常显示。
●
是，操作日志功能正常。
2

## Page 1303

●
否，请联系技术支持工程师协助解决。
注意
ManageOne运维面的其他业务故障修复后，需要切换回正常系统运行状态。切换步骤
与当前切换运维面至最小系统状态章节的操作步骤类似，具体请参见步骤1~步骤8，其
中步骤1.3操作步骤有所差异，需要将切换服务进程启动模板命令替换为以下命令：
sed -i 's/workingMode=.*/workingMode=normal/g' cfg.properties
----结束
2.5.3.5
运维面关键微服务清单和
IAM
接口等级划分
华为云Stack场景，IAM接口等级划分请参见本文档附件《ManageOne
8.1.0
微服务清
单和IAM接口等级划分》表中的IAM接口等级划分页签。
华为云Stack场景，登录功能、告警功能所依赖的微服务请参见本文档附件
《ManageOne
8.1.0
微服务清单和IAM接口等级划分》表中的微服务清单页签。
2.5.4
资源管理服务异常
现象描述
资源管理（CMDB）作为云平台的数据集成总线，在新装、升级、日常云服务、监控
等各业务都依赖CMDB（Configuration
Management
Database）的服务。一旦
CMDB服务出现异常，就会影响上层业务的正常使用。
当前需要重点保障的场景有：升级和日常运行过程中的紧急情况。
可能原因
●
外部接口的不合理大量调用
外部接口的大量调用，导致数据库的压力增大，响应缓慢，进而引起CMDB接口
超时，服务被隔离，最终引起CMDB接口不可用。而外部服务出现不合理的调
用，主要是由于自身的缺陷，导致缓存失效，从而引起持续大量请求CMDB接
口。
●
CMDB内部任务的调用
CMDB内部的合规检查任务和资源采集消费任务，在任务执行过程中也会存在较
多的调用CMDB的接口，在做重点业务保障的情况下，也可以暂时停掉。
前提条件
已获取ManageOne-Service01和ManageOne-Service02节点的sopuser和root用户的
密码。
操作步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录ManageOne-Service01和
ManageOne-Service02节点。获取节点的IP地址方法请参见3.13 如何查找节点对应的
IP地址。
2

## Page 1304

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
步骤3 执行以下命令，新建一个临时文件夹。
mkdir /tmp/task/
步骤4 执行以下命令，复制脚本至新建的临时文件夹下。
cp /opt/oss/Product/apps/MOICAgent/tools/pyscript/plugins/extenal/6.5.0/
task/* /tmp/task/
步骤5 执行以下命令，修改临时文件夹下的脚本权限。
chown -R ossadm:ossgroup /tmp/task/
步骤6 执行以下命令，切换至ossadm用户。
su ossadm
步骤7 执行以下命令，转换文件格式。
dos2unix /tmp/task/*
步骤8 执行以下命令，停止相关任务，释放CMDB接口调用。
sh /tmp/task/mo_cmdb_period_task_stop.sh
说明
需要停止的相关任务如下：
●
系统资源采集数据消费任务
●
租户资源采集数据消费任务
●
统一调度任务
●
合规检查周期任务
●
数据清洗任务
步骤9 当CMDB服务恢复正常时，执行以下命令，重新启动相关任务。
sh /tmp/task/mo_cmdb_period_task_start.sh
----结束
2.5.5
数据库故障
2.5.5.1
产品数据库实例异常
现象描述
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”。在左侧导航树中选择“中间
件监控”，在页面左上方选择对应的产品，在页面的“关系数据库”或“Redis数据
库”页签下查看数据库实例的“状态”为“未运行”或“未知”。
2

## Page 1305

可能原因
●
数据库实例所在节点可能被停止。
●
数据库实例被人为停止。
●
数据库进程异常后重启失败。
●
数据库文件损坏。
●
误删除操作系统数据库文件。
处理步骤
步骤1 检查数据库实例所在虚拟机是否停止。
●
是，请启动虚拟机，并查看故障是否已恢复。
若故障已恢复则操作结束，否则执行步骤2。
●
否，执行步骤2。
步骤2 检查数据库实例的“状态”。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”
页面。
3.
在左侧导航树中选择“中间件监控”。
4.
单击页面左上方 选择对应的产品。
5.
查看数据库实例运行状态。
在“关系数据库”或“Redis数据库”页签中检查数据库实例的“状态”是否为
“未运行”。
–
是，请参见3.23 启动产品数据库手工启动数据库实例所在节点。
启动成功，数据库实例的状态为“正在运行”，则故障已恢复。
说明
如数据库实例是人为停止，请排查人为停止原因，在其任务完成后启动。
启动失败，数据库实例状态仍为“未运行”，则执行步骤3。
–
否，则执行步骤3。
步骤3 恢复数据库应用程序，具体操作请参见《华为云Stack
8.1.0
运维指南》中“恢复数据
库应用程序”章节。
步骤4 登录部署面查看数据库实例是否恢复正常。
●
如果数据库实例的状态恢复正常，则故障已恢复。
●
如果数据库实例的状态未恢复正常，请联系技术支持工程师协助解决。
----结束
2

## Page 1306

2.5.5.2
系统重启后主数据库实例运行状态异常
现象描述
系统重启后，在“关系数据库”或“Redis数据库”页签中主数据库实例的“状态”为
“未运行”或“未知”，“复制状态”为“异常”。
可能原因
主数据库实例所在节点异常下电导致主数据库实例文件损坏或操作系统损坏，从而使
主数据库实例所在节点无法启动。
处理步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录故障数据库实例所在节点，获取数据
库实例所在节点的IP地址请参见3.14 如何查找数据库实例所在节点的IP地址和端口
号。
步骤2 执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
步骤3 执行如下命令，创建临时目录。
如下操作命令以目录“log_info”为例，请根据实际情况替换。
mkdir /tmp/log_info
步骤4 执行如下命令，将日志文件复制至该目录并设置权限和属组。
cp -r /opt/zenith/data/数据库实例名称/log /tmp/log_info
chmod -R 750 /tmp/log_info
chown -R sopuser. wheel /tmp/log_info
步骤5 执行如下命令，退出至sopuser用户。
exit
步骤6 使用FileZilla工具以sopuser用户通过SFTP方式将“/tmp”目录下的操作系统日志文件
下载至本地PC的任意路径，具体操作请参见《ManageOne
8.1.0
安全管理指南》中
“使用FileZilla传输文件”章节。
步骤7 日志下载成功后，需清理临时目录。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录数据库所在节点。
2.
执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
3.
执行以下命令，清理“/tmp/log_info”目录。
rm -rf /tmp/log_info
4.
执行以下命令，退出至sopuser用户。
exit
2

## Page 1307

步骤8 联系技术支持工程师根据日志文件修复主数据库实例故障。
●
已修复，操作完成。
● 未修复，执行步骤9。
步骤9 执行如下操作，进行主备数据库实例倒换。
注意
数据库实例倒换可能会存在数据丢失风险。由于重启数据库之前，无法确定主备数据
库实例所在节点的数据是否完全同步。请尽量在业务量少的情况下进行主备数据库实
例倒换，以减少影响。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录ManageOne-Deploy01节点。
2.
执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
3.
执行以下命令，查询数据库实例ID和备数据库实例名称。
cd /opt/oss/manager/apps/DBAgent/bin
./dbsvc_adm -cmd query-db-instance
系统提示类似如下回显信息：
DBInstanceId ClassId InstNumber Tenant AzName IP Port State
DBType Version Role Rpl Status MasterID GuardMode DataCheckSum isSSL RplPort
managedbsvr-0-999@1-999 primary managedbsvr-0-999 manager cn-global-1-a 10.120.243.233
32080 Up gauss V100R003C20CP1152 Master Normal -- -- 962349459
on 26950
managedbsvr-0-999@1-999 primary managedbsvr-1-999 manager cn-global-1-a 10.120.243.123
32080 Up gauss V100R003C20CP1152 Slave Normal managedbsvr-0-999 --
962349459 on 26950
–
数据库实例ID可以从“InstNumber”列获取，例如
“managedbsvr-0-999”。
–
备数据库实例名称可以从“Slave”所在行的“DBInstanceId”列获取，例如
“managedbsvr-0-999@1-999”。
4.
执行以下命令，进行数据库实例倒换。
cd /opt/oss/manager/apps/CloudbMgmtService/bin
./switchtool.sh -cmd switchover -instid
数据库实例ID
-newmaster
备数据库
实例名称
说明
数据库实例ID和备数据库实例名称从步骤9.3获取。
步骤10 验证主备数据库实例倒换结果。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”
页面。
2

## Page 1308

3.
在左侧导航树中选择“中间件监控”。
4.
单击页面左上方 选择对应的产品。
5.
在“关系数据库”或“Redis数据库”页签中查看，原备数据库实例的“角色”由
“Slave”变成“Master”，且“状态”为“正在运行”，数据库的“复制状态”
为“正常”，表示主备数据库实例倒换成功。
6.
如果操作结果与预期不符，请联系技术支持工程师协助解决。
----结束
2.5.5.3
主数据库实例异常且备数据库实例无法自动升主
现象描述
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”。在左侧导航树中选择“中间
件监控”，在“中间件监控”页面左上方选择对应的产品，在页面的“关系数据库”
或“Redis数据库”页签下查看主数据库实例的“状态”为“未运行”或“未知”，备
数据库实例的“状态”为“正常”，且长时间内备数据库实例无法自动升主。
可能原因
●
数据库被禁止倒换场景如下：
数据库升级、节点启停以及产品定制禁止倒换等。
●
在主数据库实例异常前，主备数据不同步场景如下：
主备数据差异过大，数据延迟以及主备数据库实例之间复制链路断开等。
操作步骤
步骤1 检查数据库实例所在虚拟机是否停止。
●
是，请启动虚拟机，并查看故障是否已恢复。
若故障已恢复则操作结束，否则执行步骤2。
●
否，执行步骤2。
步骤2 检查节点是否故障。
●
是，请参见2.5.2 节点故障修复节点故障。
●
否，执行步骤3。
步骤3 检查数据库实例的“状态”。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”
页面。
3.
在左侧导航树中选择“中间件监控”。
4.
单击页面左上方 选择对应的产品。
5.
查看数据库实例运行状态。
2

## Page 1309

在“关系数据库”或“Redis数据库”页签中检查数据库实例的“状态”是否为
“未运行”。
–
是，请参见3.23 启动产品数据库手工启动数据库实例所在节点。
启动成功，数据库实例的状态为“正在运行”，则故障已恢复。
说明
如数据库实例是人为停止，请排查人为停止原因，在其任务完成后启动。
启动失败，数据库实例状态仍为“未运行”，则执行步骤4。
–
否，则执行步骤4。
步骤4 恢复数据库应用程序，具体操作请参见《华为云Stack
8.1.0
运维指南》中“恢复数据
库应用程序”章节。
步骤5 登录部署面查看数据库实例是否恢复正常。
● 如果数据库实例的状态恢复正常，则故障已恢复。
●
如果数据库实例的状态未恢复正常，请联系技术支持工程师协助解决。
----结束
2.5.6
异地容灾系统故障
当异地容灾系统发生故障时，帮助您快速恢复故障场景，提升运维效率。
2.5.6.1
异地容灾系统心跳异常
现象描述
在部署面的“管理异地容灾系统”页面中，主站点和备站点之间的心跳状态显示为
（异常）。
可能原因
●
主站点和备站点之间心跳网络异常。
●
主站点或备站点的异地容灾服务异常。
●
主站点和备站点部署节点上的异地容灾系统证书不匹配或者已过期。
处理步骤
说明
该故障排查方法比较复杂，此处只介绍初步的排查方法，如果仍不能解决，请联系技术支持工程
师协助处理。
步骤1 检查主站点和备站点之间的心跳网络是否连通。
1. 使用PuTTY工具以sopuser用户通过SSH方式登录主站点的部署节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在
对应节点下该帐户的默认密码。
2.
执行以下命令，测试主站点和备站点部署节点的连通性。
2

## Page 1310

–
如果IP地址为IPv4：
> ping
备站点部署节点的心跳IP地址
–
如果IP地址为IPv6：
> ping6
备站点部署节点的心跳IP地址
查看系统回显信息：
–
如果回显如下类似信息，表示可以ping通，说明网络连接正常。
64 bytes from
备站点部署节点的心跳IP地址:
icmp_seq=1 ttl=251 time=42.1 ms
–
如果等待1分钟无回显信息，说明网络连接异常，请联系管理员检查并恢复网
络。
3.
按“Ctrl+C”终止ping命令。
步骤2 分别检查主站点和备站点部署节点的异地容灾进程是否正常。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”
页面。
3.
单击页面左上角 选择CloudSOP-UniEP。
4.
在左侧导航树中选择“服务监控”。
5.
选择“进程”页签。
6.
在“进程”页面，查看是否有“drmgrservice-x-x”进程，且该进程的“状态”是
否为“正在运行”。
说明
x为实例编号，具体以实际为准。
–
是，表示该进程存在，且运行正常。
–
否，请联系技术支持工程师协助解决。
7.
参考以上操作，检查备站点异地容灾进程是否正常，如果异常请联系技术支持工
程师协助修复异地容灾进程。
步骤3 检查主站点和备站点部署节点的异地容灾系统证书是否过期。
1.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，
登录ManageOne运维面。
–
密码方式：输入帐号和密码。默认帐号“admin”。
– USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输
入PIN码。
2.
在主菜单中选择“集中监控
>
告警管理
>
当前告警”，检查告警界面显示正常。
3.
查看是否存在主备站点名称为“ALM-51025 异地容灾证书已过期”的告警。
–
是，请更新异地容灾证书，具体操作请参见《ManageOne
8.1.0
安全管理
指南》中“上传并更新异地容灾系统证书”章节。
–
否，则表示不是异地容灾证书过期导致该故障。
步骤4 联系技术支持工程师检查主站点和备站点部署节点异地容灾系统证书是否匹配。
----结束
2

## Page 1311

2.5.6.2
异地容灾复制异常
2.5.6.2.1
主备站点数据库数据同步异常
现象描述
在部署面的“管理异地容灾系统”页面中，主站点和备站点之间的“数据同步状态”
显示为“异常”，并且单击 展开产品信息后，查看“数据类型”为“数据库”的状
态，也显示为“异常”。
可能原因
主站点和备站点产品之间的数据复制链路通信异常。
异地容灾系统的数据复制异常定位思路如图2-13所示，本地数据库采用主备模式部
署，数据写入主数据库，然后主数据库再同步给备数据库，如主站点DB 01上的数据同
步给DB 02，备站点DB 03上的数据同步给DB 04。数据进行异地复制时，主站点数据
会从主数据库同步给备站点的主数据库，如主站点DB 01上的数据同步给备站点DB
03。
图2-13 异地容灾系统复制异常定位思路
影响数据复制的主要因素有以下几点：
●
主备站点数据复制链路。
●
本地节点间的数据复制链路。
●
数据库运行状态。
处理步骤
步骤1 检查主备站点间的数据复制链路是否正常。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录主站点的主部署节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在
对应节点下该帐户的默认密码。
2.
执行以下命令，切换至主站点产品的主数据库实例所在节点。
ssh
主站点产品的主数据库实例所在节点IP地址
3.
执行以下命令，测试主站点和备站点数据库节点的连通性。
2

## Page 1312

说明
以下命令中的节点IP地址为备站点上与主站点产品的主数据库实例名称相同所在节点的IP
地址。
–
如果IP地址为IPv4：
ping
备站点某节点IP地址
–
如果IP地址为IPv6：
ping6
备站点某节点IP地址
查看系统回显信息：
–
如果回显如下类似信息，表示可以ping通，说明网络连接正常，按“Ctrl
+C”终止ping命令并执行步骤2。
64 bytes from
备站点某节点的IP地址:
icmp_seq=1 ttl=251 time=42.1 ms
–
如果等待1分钟后无回显信息，说明网络连接异常，按“Ctrl+C”终止ping命
令，并联系管理员检查和恢复网络后执行步骤2。
步骤2 在主站点上检查本地主备数据库实例状态。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”
页面。
3.
单击页面左上角 选择对应的产品。
4.
在左侧导航树中选择“中间件监控”。
5.
选择“关系数据库”页签。
6.
在“关系数据库”页面，查看主备数据库实例状态。
–
如果主备数据库实例的“状态”为“正在运行”，“复制状态”为“正
常”，则数据库实例状态正常，执行步骤3。
–
如果主备数据库实例的“状态”为“未运行”或“未知”，“复制状态”为
“异常”，则数据库实例状态异常，请联系技术支持工程师协助解决。
步骤3 强制同步主备站点间数据。
1.
在部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”，进入
“管理异地容灾系统”页面。
2. 在待同步数据的异地容灾系统行中单击 ，选择产品的数据同步方向。
若主备站点的状态为主用和备用，无需选择产品的数据同步方向，系统会自动从
主用站点向备用站点同步数据。
须知
选择数据同步方向时，异地容灾系统会根据用户选择方向进行全量数据同步，并
覆盖被同步的站点产品数据。建议以含有最新数据的产品为主用站点产品，向对
端站点产品同步。若选择由备用站点向主用站点产品同步，则首先备用站点会升
级为主用，然后再进行产品数据同步。
2

## Page 1313

3.
按照界面上的指引完成相关操作。
4.
检查操作结果。如果操作结果与预期不符，请联系技术支持工程师协助解决。
a.
在部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”，
进入“管理异地容灾系统”页面。
b.
查看主备站点间的心跳状态为 。
c.
查看所有产品的“数据同步状态”为“已同步”或者“同步中”。如果“数
据同步状态”显示为“延迟”，表示主站点和备站点有较多的数据正在同
步，请等待数据同步完成后再检查状态。
d.
主用站点运维面能正常登录。
----结束
2.5.6.2.2
高可靠消息数据复制异常
现象描述
主备站点之间的高可靠消息数据复制状态显示异常。
可能原因
MqDRService微服务或MessagingBrokeService微服务出现异常。
处理步骤
步骤1 查看任务列表详情信息，根据详情信息，重启对应站点的高可靠消息服务。
1. 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“系统
>
任务列表”，查看异地容灾系统的任务列表的详
细信息。
3.
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”。
4.
在左侧导航树中选择“服务监控”。
5.
单击页面左上方 选择对应的产品。
6.
选择“服务”页签，在左上方的搜索框中输入“MQS”，并单击 。
7.
选择所有“服务名称”为“MQS”的实例，单击“停止”。
8.
在“确认”对话框中，单击“确定”。
9.
待“MQS”服务相关的实例停止完成后，再单击“启动”。
10.
在“确认”对话框中，单击“确定”。
如果“MQS”服务相关的实例状态显示为“正在运行”，则表示MQS服务已正
常，否则请联系技术支持工程师协助解决。
11. 如果部署了其他产品，请重复执行步骤1.5～步骤1.10。
12.
在另一站点上重复执行步骤1.1～步骤1.11。
步骤2 强制同步主备站点间数据。
2

## Page 1314

1.
在主站点部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系
统”。
2.
在待同步数据的异地容灾系统行中单击 ，选择产品的数据同步方向。
若主备站点的状态为主用和备用，无需选择产品的数据同步方向，系统会自动从
主用站点向备用站点同步数据。
须知
选择数据同步方向时，异地容灾系统会根据用户选择方向进行全量数据同步，并
覆盖被同步的站点产品数据。建议以含有最新数据的产品为主用站点产品，向对
端站点产品同步。若选择由备用站点向主用站点产品同步，则首先备用站点会升
级为主用，然后再进行产品数据同步。
3.
按照界面上的指引完成相关操作。
4.
检查操作结果。如果操作结果与预期不符，请联系技术支持工程师协助解决。
a.
在部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”，
进入“管理异地容灾系统”页面。
b. 在页面中查看主备站点间的心跳状态为 。
c.
在页面中查看所有产品的“数据同步状态”为“已同步”或者“同步中”。
如果“数据同步状态”显示为“延迟”，表示主站点和备站点有较多的数据
正在同步，请等待数据同步完成后再检查状态。
d.
主用站点运维面能正常登录。
----结束
2.5.6.3
异地容灾系统界面加载异常或者操作时发生异常
现象描述
部署面中的“管理异地容灾系统”页面加载时发生异常，但其他功能页面都能正常显
示；或者在“管理异地容灾系统”页面执行容灾操作时发生异常，例如提示查询异地
容灾系统信息失败，但其他功能页面都能正常操作。
可能原因
异地容灾相关服务DRMgrService异常。
处理步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录异常的异地容灾系统界面所属站点的
部署节点。
说明
请先登录ManageOne-Deploy01节点执行以下操作，然后登录ManageOne-Deploy02节点执行
以下操作。获取节点IP地址的方法请参见3.13 如何查找节点对应的IP地址。
步骤2 执行以下命令，切换至ossadm用户。
> su - ossadm
2

## Page 1315

Password:ossadm用户的密码
步骤3 执行以下命令，查询异地容灾服务状态。
> source /opt/oss/manager/bin/engr_profile.sh
> ipmc_adm -cmd statusapp -tenant manager
系统回显如下类似信息，查看DRMgrService服务的“Status”。
...
drmgrservice-0-0 drmgrservice DRMgrService manager cluster 10.10.67.76 53986
RUNNING
...
步骤4 根据查询结果，选择对应操作。
容灾服务状态 操作
“Status”显示为“STOPPED” 执行以下命令，启动异地容灾服务。
> ipmc_adm -cmd startapp -app
DRMgrService -tenant manager
当系统回显如下信息时，说明服务启动成功，否
则请联系技术支持工程师协助解决。
Starting process drmgrservice-0-0 ... success
“Status”显示为
“RUNNING”
执行以下命令，重启异地容灾服务。
> ipmc_adm -cmd restartapp -app
DRMgrService -tenant manager
当系统回显如下信息时，说明服务重启成功，否
则请联系技术支持工程师协助解决。
Stopping process drmgrservice-0-0 ... success Starting
process drmgrservice-0-0 ... success
“Status”显示为
“ABNORMAL”
步骤5 异地容灾服务启动后等待5分钟，检查异地容灾状态。如果各状态与预期不符，请联系
技术支持工程师协助解决。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”，进入
“管理异地容灾系统”页面。
3.
查看主备站点间的心跳状态为 。
4.
查看主备站点所有产品的容灾状态为“主用”或者“备用”。
如果产品状态显示为“初始化中”，强制同步主备站点上该产品的数据，具体操
作请参见《华为云Stack
8.1.0
运维指南》的“同步主备产品数据”章节。
5.
查看所有产品的“数据同步状态”为“已同步”或者“同步中”。
如果“数据同步状态”显示为“延迟”，表示主站点和备站点有较多的数据正在
同步，请等待数据同步完成后再检查状态。如果等待10分钟后，仍存在“数据同
步状态”为“已同步”或者“同步中”之外状态的产品，强制同步主备站点上该
产品的数据，具体操作请参见《华为云Stack
8.1.0
运维指南》的“同步主备产品
数据”章节。
2

## Page 1316

6.
主用站点的运维面能正常登录。
----结束
2.5.6.4
重启主备站点异地容灾服务后产品状态异常
现象描述
主备站点重启异地容灾服务后，主备站点产品在部署面的“管理异地容灾系统”页面
的状态显示为“初始化中”。
处理步骤
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”，进入“管
理异地容灾系统”页面。
步骤3 查看主备站点之间的心跳状态。
●
如果心跳状态为 （正常）或者 （部分异常），执行4。
●
如果心跳状态为 （异常），请参见2.5.6.1 异地容灾系统心跳异常进行修复，
再执行4。
步骤4 在待同步数据的产品所在行“操作”列中，单击 ，选择产品的数据同步方向。
若主备站点的状态为主用和备用，无需选择产品的数据同步方向，系统会自动从主用
站点向备用站点同步数据。
须知
选择数据同步方向时，异地容灾系统会根据用户选择方向进行全量数据同步，并覆盖
被同步的站点产品数据。建议以含有最新数据的产品为主用站点产品，向对端站点产
品同步。若选择由备用站点向主用站点产品同步，则需要备用站点会升级为主用，然
后再进行产品数据同步。
步骤5 按照界面上的指引完成相关操作。
步骤6 检查操作结果。如果操作结果与预期不符，请联系技术支持工程师协助解决。
1.
在部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”，进入
“管理异地容灾系统”页面。
2.
查看主备站点间的心跳状态为 。
3.
查看所有产品的“数据同步状态”为“已同步”或者“同步中”。如果“数据同
步状态”显示为“延迟”，表示主站点和备站点有较多的数据正在同步，请等待
数据同步完成后再检查状态。
2

## Page 1317

4.
主用站点运维面能正常登录。
----结束
2.5.6.5
重启主用站点容灾服务后异地容灾系统异常
现象描述
主站点和备站点之间的心跳状态异常（心跳状态为 ），重启主用站点的异地容灾
服务后容灾系统异常。
可能原因
主备站点的心跳状态异常。
处理步骤
具体处理方法请参见2.5.6.4 重启主备站点异地容灾服务后产品状态异常。
2.5.6.6
异地容灾接管后主用站点的主备数据库实例异常
现象描述
备用站点产品接管后，在主用站点部署面的“维护
>
运维管理
>
全景监控
>
中间件监
控”页面的“关系数据库”页签中，被接管产品的数据库实例的“复制状态”为“异
常”。
可能原因
接管前主用站点产品的主数据库实例异常。
处理步骤
步骤1 尝试强制同步主备站点间的数据。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”，进入
“管理异地容灾系统”页面。
3. 在待同步数据的产品所在行“操作”列中，单击 ，选择产品的数据同步方向，
按照界面上的指引完成相关操作。
若主备站点的状态为主用和备用，无需选择产品的数据同步方向，系统会自动从
主用站点向备用站点同步数据。
2

## Page 1318

须知
选择数据同步方向时，异地容灾系统会根据用户选择方向进行全量数据同步，并
覆盖被同步的站点产品数据。建议以含有最新数据的产品为主用站点产品，向对
端站点产品同步。若选择由备用站点向主用站点产品同步，则首先备用站点会升
级为主用，然后再进行产品数据同步。
步骤2 查看主备数据库实例的状态。
1.
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”。
2. 在左侧导航树中选择“中间件监控”。
3.
在“中间件监控”页面左上方选择对应的产品。
4.
选择“关系数据库”页签，查看主备数据库实例的状态是否恢复正常。
– 如果主备数据库实例的“状态”均为“正在运行”，“复制状态”均为“正
常”，则故障已恢复。
–
如果主备数据库实例的“状态”均为“正在运行”，“复制状态”均为“异
常”，请联系华为技术支持工程师。
5.
重复执行步骤2.1
~
步骤2.4，在备用站点查看主备数据库实例的状态。
----结束
2.5.6.7
删除异地容灾系统后清除产品节点的容灾信息
现象描述
产品节点下电或者异常时删除异地容灾系统，在“任务列表”页面中显示删除异地容
灾系统部分成功和删除产品部分成功，在删除产品部分成功的任务详细信息中显示删
除失败的节点IP地址。节点恢复正常后需清除产品节点上的容灾信息，否则在非异地
容灾场景时该节点上的业务异常。
可能原因
产品节点下电或者异常。
处理步骤
说明
●
若删除异地容灾系统后还需重新创建，则无需执行本节操作，可直接创建。
●
若删除异地容灾系统后无需再重建，请根据删除产品的任务详细信息中删除失败的节点的IP
地址，在对应的站点上执行本节操作。
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录部署节点。
说明
只需在ManageOne-Deploy01节点执行以下操作。获取节点IP地址的方法请参见3.13 如何查找
节点对应的IP地址。
步骤2 执行以下命令，切换至ossadm用户。
> su - ossadm
Password:ossadm用户的密码
2

## Page 1319

步骤3 执行以下命令，清除产品节点上的容灾信息。
> cd /opt/oss/manager/apps/DRMgrService/bin
> bash dr_repair.sh
系统回显如下信息时，根据站点实际情况选择清除产品节点信息后，是否启动产品所
有服务。
Start the product services of cdo after the repair? (y/n):
以清除产品节点信息后需启动产品所有服务为例，系统回显如下类似信息时，说明操
作执行成功，否则请联系技术支持工程师协助解决。
...
Starting the product services of Product...
Product services of product started successfully.
Complete.
步骤4 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤5 在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”页
面。
步骤6 在左侧导航树中选择“服务监控”。
步骤7 单击页面左上方 选择对应的产品。
步骤8 选择“服务”页签。
步骤9 在“服务”页面，查看OMMHA实例的运行状态，否则请跳过。
●
若“状态”为“正在运行”，请执行步骤10。
●
若“状态”为“未运行”，单击服务列表右上方的“启动”，按照界面指引完成
相关操作，然后执行步骤10。
●
若“状态”为“部分运行”、“未知”或“故障”，请联系技术支持工程师协助
解决。
步骤10 在左侧导航树中选择“节点监控”，进入“节点监控”页面。
步骤11 在“节点监控”页面，查看恢复正常的产品节点的状态。
● 若产品节点的“服务状态”为“运行正常”，则产品节点状态修复成功。
●
若产品节点的“服务状态”为“部分运行”、“未知”或“故障”，请联系技术
支持工程师协助解决。
●
若产品节点的“服务状态”为“未运行”，在节点页面上方单击“启动”，在下
拉框中选择“启动服务”，按照界面指引完成相关操作。
----结束
2

## Page 1320

2.5.6.8
操作异地容灾系统后的任务列表详细信息提示消息队列出现异常
现象描述
执行如创建异地容灾、倒换异地容灾、强制同步异地容灾和删除异地容灾等异地容灾
操作时，任务列表中显示“执行失败”。查看任务列表的详细信息，提示如Kafka连接
失败、Zookeeper连接失败、接口调用失败等信息。
可能原因
主备站点中的MqDRService、MessagingBrokeService或ZookeeperService出现异常。
处理步骤
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在部署面主菜单中选择“系统
>
任务列表”，查看异地容灾系统的任务列表的详细信
息。
步骤3 根据提示的异常信息执行如下操作。
1.
在主菜单中选择“维护
>
运维管理
>
全景监控”。
2.
在左侧导航树中选择“服务监控”。
3.
在“服务监控”页面左上方选择对应的产品。
4.
单击“进程”页签。
5.
根据提示的详细信息，选择所有对应进程名称的实例，单击“停止”，按照界面
指引完成相关操作。
–
Kafka连接失败：选择msgbrksrv。
–
Zookeeper连接失败：选择zookeeperapp。
–
接口调用失败：选择mqdrsrv。
6.
待对应进程的实例停止完成后，再单击“启动”。按照界面指引完成相关操作。
如果对应进程的实例状态显示为“正在运行”，则表示消息队列服务已正常，否
则请联系技术支持工程师协助解决。
步骤4 在备站点上重启消息队列服务，具体操作请参见步骤1～步骤3。
步骤5 强制同步主备站点间数据。
1.
在主站点部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系
统”。
2.
在待同步数据的异地容灾系统行中单击 ，选择主备站点的数据同步方向。
2

## Page 1321

须知
–
若主备站点的状态非主用和备用，则需要选择产品的数据同步方向，异地容灾
系统会根据用户选择方向进行全量数据同步，并覆盖被同步的站点产品数据。
建议以含有最新数据的产品为主用站点产品，向对端站点产品同步。
–
若主备站点的状态为主用和备用，无需选择产品的数据同步方向，系统会自动
从主用站点向备用站点同步数据。
3.
按照界面上的指引完成相关操作。
4.
检查操作结果。如果操作结果与预期不符，请联系技术支持工程师协助解决。
a.
在部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”，
进入“管理异地容灾系统”页面。
b.
在页面中查看主备站点间的心跳状态为 。
c.
在页面中查看所有产品的“数据同步状态”为“已同步”或者“同步中”。
如果“数据同步状态”显示为“延迟”，表示主站点和备站点有较多的数据
正在同步，请等待数据同步完成后再检查状态。
d. 主用站点运维面能正常登录。
----结束
2.5.7
其它故障
2.5.7.1
浏览器故障（Firefox 浏览器访问
Web
界面时显示异常）
现象描述
使用Firefox浏览器访问Web界面时，滚动鼠标时界面出现黑色暗影情况，设置Firefox
浏览器的参数后可解决这些问题。本章以Firefox 68为例介绍设置Firefox浏览器的相关
操作。
可能原因
浏览器参数设置问题造成显示异常。
处理步骤
步骤1 单击Firefox浏览器右上角的 。
步骤2 单击“选项”。
步骤3 在左侧选择“常规”，在右侧的“性能”区域中取消勾选“使用推荐的性能设置”和
“自动启用硬件加速”。
步骤4 重启Firefox浏览器。
----结束
2

## Page 1322

2.5.7.2 MCZKService
数据文件损坏导致
mczkapp
进程异常
现象描述
●
mczkapp进程的CPU使用率长期处于100%以上。
●
MCZKService数据文件损坏导致该服务无法启动。
说明
●
MCZKService是基于zookeeper三方件的服务，存有部分业务状态数据，数据会持久化到磁
盘。服务重启的时候会优先加载磁盘数据，如果磁盘数据损坏无法读取，会导致服务启动失
败。
●
MCZKService集群部署场景：所有集群节点的MCZKService数据文件同时发生损坏，会导致
数据丢失。若MCZKService数据文件损坏的节点个数少于集群节点总数的一半，不影响
MCZKService正常提供服务。MCZKService数据文件损坏的节点修复后能自动提供服务。
可能原因
节点异常下电或者磁盘空间已满导致MCZKService数据文件损坏，从而导致mczkapp
进程异常。
处理步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录mczkapp进程异常的节点。
mczkapp进程的名称例如“mczkapp-0-0”。
步骤2 执行以下命令，切换至ossadm用户。
su - ossadm
Password:ossadm用户的密码
步骤3 执行以下命令，停止mczkapp进程。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd stopapp -tenant manager -app MCZKService
系统回显如下类似信息，表示mczkapp进程停止成功，否则请联系技术支持工程师协
助解决。
Stopping process mczkapp-0-0 ... success
步骤4 执行以下命令，删除mczkapp进程的配置文件。
rm -rf /var/share/oss/manager/MCZKService/data_v2/*
rm -rf /var/share/oss/manager/MCZKService/datalog_v2/*
步骤5 执行以下命令，启动mczkapp进程。
ipmc_adm -cmd startapp -tenant manager -app MCZKService
系统回显如下类似信息，表示mczkapp进程启动成功，否则请联系技术支持工程师协
助解决。
Starting process mczkapp-0-0 ... success
步骤6 查看mczkapp进程的“状态”和“CPU使用率”。
2

## Page 1323

1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”
页面。
3.
单击页面左上方 选择“CloudSOP-UniEP”。
4.
在左侧导航树中选择“服务监控”。
5.
选择“进程”页签。
6.
在“进程”页面，查看以“mczkapp”开头的服务进程的“状态”和“CPU使用
率”。
–
如果“状态”为“正在运行”，且“CPU使用率”恢复正常，则故障恢复，
处理结束。
–
如果“状态”为“启动中”或“停止中”，单服务的启停时长一般不超过1分
钟，如果服务长时间处于该状态，请联系技术支持工程师协助解决。
–
如果“状态”为“故障”、“未知”或“未运行”，说明mczkapp进程运行
异常，请联系技术支持工程师协助解决。
----结束
2.5.7.3
备份服务器存储空间不足导致备份文件失败
现象描述
在部署面进行备份操作时，由于待备份节点上的文件无法传输到备份服务器，导致备
份操作失败。
可能原因
备份服务器上的备份路径存储空间不足。
处理步骤
步骤1 使用PuTTY工具以备份服务器用户通过SSH方式登录备份服务器。
说明
若使用部署节点作为备份服务器，请先使用sopuser用户通过SFTP方式登录备份服务器，再切换
到备份服务器用户。
步骤2 执行以下命令，确认各分区使用情况。
df -h
如以下回显所示，备份路径“/opt/backup”所在的分区“/opt”仅剩14G空闲空间，
需要及时进行清理。
Filesystem Size Used Avail Use% Mounted on
... ...
/dev/mapper/vg_root-lv_opt 498G 464G 14G 97% /opt
tmpfs 5.9G 0 5.9G 0% /run/user/3001
tmpfs 5.9G 0 5.9G 0% /run/user/0
2

## Page 1324

说明
备份路径请根据实际情况替换。
步骤3 执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
步骤4 执行以下命令，删除无用目录。
rm -r
无用目录
须知
清理磁盘空间为危险操作，请确保待删除文件/文件夹已不再使用后，谨慎进行清理。
步骤5 执行以下命令，退出root用户。
exit
----结束
2.5.7.4
部署面无法访问
现象描述
●
使用浏览器访问部署面时，Web登录界面显示异常或者无法登录。
●
对于异地容灾场景，本节以在主站点上操作为例，若备站点部署面无法访问，请
参见主站点上的操作在备站点上执行。
可能原因
●
部署节点被下电或者网络异常。
●
部署面数据库状态异常。
●
部署面服务异常。
处理步骤
说明
该故障排查方法比较复杂，此处只介绍初步的排查方法，如果仍不能解决，请联系技术支持工程
师协助解决。
步骤1 排查部署节点是否被下电。
请联系管理员检查节点下电情况并上电。
对于异地容灾场景，请联系管理员检查主备站点部署节点的下电情况，若两站点的部
署节点都被下电，则联系管理员上电，然后执行以下操作，否则请执行步骤2。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
2

## Page 1325

默认帐号：admin。
2.
在部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”，进入
“管理异地容灾系统”页面。
3.
在待同步数据的产品所在行“操作”列中，单击 ，选择主备站点产品的数据同
步方向。
须知
选择数据同步方向时，请谨慎确认数据的同步方向，防止数据丢失。
4.
按照界面上的指引完成相关操作。
5.
检查操作结果。如果操作结果与预期不符，请联系技术支持工程师协助解决。
a.
在部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”，
进入“管理异地容灾系统”页面。
b.
查看主备站点间的心跳状态为 。
c.
查看所有产品的“数据同步状态”为“已同步”或者“同步中”。如果“数
据同步状态”显示为“延迟”，表示主站点和备站点有较多的数据正在同
步，请等待数据同步完成后再检查状态。
d.
主用站点运维面能正常登录。
步骤2 排查部署面网络是否故障。
请联系管理员检查网络状态并修改故障。
步骤3 排查部署面数据库实例是否异常。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录部署节点。
说明
请先登录ManageOne-Deploy01节点执行以下操作，然后登录ManageOne-Deploy02节点
执行以下操作。获取节点IP地址的方法请参见3.13 如何查找节点对应的IP地址。
2.
执行以下命令，切换至ossadm用户。
su - ossadm
Password:ossadm用户的密码
3. 执行以下命令，查看部署面数据库运行状态。
cd /opt/oss/manager/apps/DBAgent/bin
bash dbsvc_adm -cmd query-db-instance
系统提示如下类似回显信息：
DBInstanceId ClassId InstNumber Tenant AzName IP Port State
DBType ...
backuprdb-0-999 single backuprdb-0-999 manager cn-global-1-a 10.7.162.90 26522
redis ...
cloudsopdbsvr-1-0@2-0 primary cloudsopdbsvr-1-0 cdo service 10.7.162.93 32080 Up
gauss ...
cloudsopdbsvr-1-0@2-0 primary cloudsopdbsvr-2-0 cdo service 10.7.162.92 32080 Up
gauss ...
dbmgr_rdb-0-999 single dbmgr_rdb-0-999 manager cn-global-1-a 10.7.162.90 32091 --
redis ...
...
2

## Page 1326

–
当“State”为“Up”或者“--”时，说明该数据库实例运行正常，执行4。
–
当“State”为“Down”时，说明该数据库实例停止运行，执行步骤3.4。
4.
在PuTTY工具中以ossadm用户执行以下命令，禁止主备数据库实例在180分钟内
发生倒换。
cd /opt/oss/manager/agent/bin
bash dbha_switch_tool.sh -cmd set-ignore-nodes -nodes all -expire 180
如果回显信息中未显示“Successful”，则表示执行失败，请联系技术支持工程师
协助解决。
5.
执行以下命令，启动部署面数据库。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd startdc -tenant manager
系统提示如下类似回显信息，所有进程都提示“success”，则说明部署面数据库
启动成功。否则请联系技术支持工程师协助解决。
============================ Starting data container processes...
Starting redis process woadapterrdb-1-14 ... success
...
Starting redis process serviceinspectionrdb-1-3 ... success
Starting redis process privilegerdb-1-28 ... success
============================ Starting data container processes is complete.
6.
执行以下命令，恢复主备数据库实例的倒换。
cd /opt/oss/manager/agent/bin
bash dbha_switch_tool.sh -cmd del-ignore-nodes
如果回显信息中未显示“Successful”，则表示执行失败，请联系技术支持工程师
协助解决。
步骤4 排查部署面服务是否异常。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录部署节点。
说明
请先登录ManageOne-Deploy01节点执行以下操作，然后登录ManageOne-Deploy02节点
执行以下操作。
2.
执行以下命令，切换至ossadm用户。
su - ossadm
Password:ossadm用户的密码
3.
执行以下命令，查看部署面运行状态。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd statusapp -tenant manager
系统提示如下类似回显信息：
Process Name Process Type App Name Tenant Name Process Mode
IP PID Status
backupwebsite-0-0 backupwebsite BackupWebsite manager cluster
10.93.95.239 341187 RUNNING
unideploywebsite-0-0 unideploywebsite UniDeployWebsite manager cluster
10.93.95.239 341202 RUNNING
mcfebservice-0-0 mcfebservice MCFEBService manager cluster
10.93.95.239 341553 RUNNING
...
[All Processes: 16] [Running: 16] [Not Running: 0]
–
当“Not Running”为“0”时，说明所有进程都运行正常。
2

## Page 1327

–
当“Not Running”为非“0”时，说明存在停止运行或者故障的进程，执行
步骤4.4。
4.
执行以下命令，启动部署面服务。
ipmc_adm -cmd startapp -tenant manager
系统提示如下类似回显信息，所有进程都提示“success”，则说明部署面服务启
动成功，否则请联系技术支持工程师协助解决。
Starting process backupwebsite-0-0 ... success
Starting process smapp-0-0 ... success
Starting process cron-0-0 ... success
...
----结束
2.5.7.5
系统故障导致告警无法自动清除
现象描述
在进行告警清理时，对于可以自动清除的告警系统无法自动清除。
可能原因
系统服务故障。
处理步骤
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在部署面主菜单中选择“维护
>
告警配置
>
设置告警上报参数”，进入“设置告警上
报参数”页面。
步骤3 在列表右上方单击“同步告警”。
步骤4 弹出“提示”对话框，单击“确定”。
步骤5 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤6 等待5分钟后，在主菜单中选择“集中监控
>
告警管理
>
当前告警”，查看告警是否
自动清除。
●
是，结束。
●
否，请联系技术支持工程师协助解决。
----结束
2

## Page 1328

2.5.7.6
备份文件版本不对应导致恢复产品节点操作系统失败
现象描述
使用旧版本的备份文件恢复产品节点操作系统之后，在部署面主菜单中选择“系统
>
任务列表”，查看恢复产品节点操作系统任务的“任务状态”为“执行失败”，“详
细信息”提示安装Agent失败。
可能原因
使用升级前的备份文件来恢复产品节点操作系统。
前提条件
联系技术支持工程师在待恢复操作系统的产品节点上安装对应版本的osconfig。
软件包数字签名文件
为了防止软件包在传递过程或存储期间被恶意篡改，下载软件包时需下载对应的数字
签名文件用于完整性验证。
在软件包下载之后，请参考《OpenPGP签名验证指南》，对从Support网站下载的软
件包进行PGP数字签名校验。如果校验失败，请不要使用该软件包，先联系华为技术
支持工程师解决。
使用软件包安装/升级之前，也需要按上述过程先验证软件包的数字签名，确保软件包
未被篡改。
运营商客户请访问：https://support.huawei.com/carrier/digitalSignatureAction
企业客户请访问：https://support.huawei.com/enterprise/zh/tool/pgp-verify-
TL1000000054
处理步骤
步骤1 在待恢复操作系统的产品节点上重新安装Agent。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录部署节点。
说明
只需在ManageOne-Deploy01节点执行以下操作。
2.
执行以下命令切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
3.
在待恢复产品节点上重新安装Agent。
cd /opt/oss/manager/apps/MCDeployService/tools/resmgr
bash installagent.sh -nodemgrip 192.168.0.1
当系统提示如下信息时，重新安装Agent成功，表示恢复产品节点操作系统成功。
Install agent successfully.
2

## Page 1329

说明
“192.168.0.1”为待恢复产品节点的IP地址。
----结束
2.5.7.7 tmp
目录的空间满导致部署面
Web
页面显示空白
现象描述
登录部署面的Web页面后，页面显示空白。
可能原因
部署面页面的部分请求，会将一些缓存文件写入缓存目录，当缓存目录磁盘被占满
时，缓存目录无法写入，造成这些请求资源文件无法返回部署面，页面显示空白。
处理步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式分别登录ManageOne-Deploy01和
ManageOne-Deploy02节点。
步骤2 执行以下命令，查看节点上磁盘空间情况。
df -h
系统回显如下类似信息：
Filesystem Size Used Avail Use% Mounted on
/dev/sda3 17G 5.0G 11G 32% /
...
/dev/sda6 5.0G 208M 4.8G 5% /tmp
/dev/mapper/oss_vg-opt_vol 290G 290G 0G 100% /opt
tmpfs 3.2G 0 3.2G 0% /run/user/3001
tmpfs 3.2G 0 3.2G 0% /run/user/0
步骤3 在回显信息的“Mounted on”列中查看“/opt”目录所对应的“Use%”是否达到
100%。
●
若达到100%，是由于“/opt/oss/tmp”目录空间已满，请清理该目录的空间或
者联系技术支持工程师协助解决。
●
若未达到100%，是由于其他原因造成，请联系技术支持工程师协助解决。
步骤4 清理目录空间后重新登录部署面。
●
若页面显示正常，操作结束。
●
若页面仍显示空白，请联系技术支持工程师协助解决。
----结束
2.5.7.8 ZookeeperService
数据文件损坏导致
zookeeperapp
进程异常
现象描述
ZookeeperService进程的CPU使用率长期处于100%以上或ZookeeperService服务无法
启动，查看ZookeeperService数据文件损坏。
2

## Page 1330

可能原因
节点异常下电或磁盘空间已满导致ZookeeperService数据文件损坏，从而导致
zookeeperapp进程异常。
处理步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录zookeeperapp进程异常的节点。
说明
获取进程所在节点的IP地址请参见3.15 如何查找服务所在节点的IP地址。
步骤2 执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
步骤3 执行以下命令，导入环境变量。
source /opt/oss/manager/bin/engr_profile.sh
步骤4 执行以下命令，查看ZookeeperService服务状态。
ipmc_adm -cmd statusapp -app ZookeeperService -tenant Product
●
输出结果为如下类似信息，若服务状态是“STOPPED”，表示服务异常，则执行
步骤6。
Process Name Process Type App Name Tenant Name Process Mode IP PID
Status
zookeeperapp-1-0 zookeeperapp ZookeeperService Product multi x.x.x.x 66794
STOPPED
●
输出结果为如下类似信息，若服务状态是“RUNNING”，表示服务当前正在运
行，则执行步骤5。
Process Name Process Type App Name Tenant Name Process Mode IP PID
Status
zookeeperapp-1-0 zookeeperapp ZookeeperService Product multi x.x.x.x 66794
RUNNING
步骤5 执行以下命令，停止zookeeperapp进程。
ipmc_adm -cmd stopapp -tenant Product -app ZookeeperService
系统回显如下类似信息，表示zookeeperapp进程停止成功，否则请联系技术支持工程
师协助解决。
Stopping process zookeeperapp-1-0 ... success
步骤6 执行以下命令，查看ZookeeperService服务日志。
vi /var/log/oss/Product/ZookeeperService/oss.zookeeper.log
输出结果为如下类似信息，表示ZookeeperService服务文件损坏。
java.io.IOException: Transaction log: /
/opt/share/Product/ZookeeperService/datalog_v2/version-2/log.c034b2 has invalid magic number -42140
编辑完成后，按“Esc”键并执行:wq!命令保存退出。
步骤7 执行以下命令，切换至ossuser用户。
su - ossuser
2

## Page 1331

Password:ossuser用户的密码
步骤8 执行以下命令，删除服务中损坏的文件。
rm -rf /var/share/oss/Product/ZookeeperService/data_v2/*
rm -rf /var/share/oss/Product/ZookeeperService/datalog_v2/*
说明
如果文件损坏，属主权限变为“？？？？”，会导致删除失败，可以执行mv命令移动无法删除
的文件目录到其他位置。
以datalog_v2下version-2目录为例，执行如下命令。
mv /var/share/oss/Product/ZookeeperService/datalog_v2/version-2 /tmp/version-2
步骤9 执行以下命令，切换至ossadm用户。
exit
步骤10 执行以下命令，导入环境变量。
source /opt/oss/manager/bin/engr_profile.sh
步骤11 执行以下命令，启动zookeeperapp进程。
ipmc_adm -cmd startapp -tenant Product -app ZookeeperService
系统回显如下类似信息，表示zookeeperapp进程启动成功，否则请联系技术支持工程
师协助解决。
Starting process zookeeperapp-1-0 ... success
----结束
2.5.7.9
节点重启后服务状态异常
现象描述
●
节点重启后，服务未正常启动。
●
无法正常登录部署面。
处理步骤
步骤1 使用PuTTY工具，通过sopuser用户登录异常节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换至ossadm用户。
su - ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（ManageOne）”页签
中，在对应节点下该帐户的默认密码。
步骤3 执行以下命令，启动微服务。
cd /opt/oss/manager/agent/bin
. engr_profile.sh
2

## Page 1332

./ipmc_adm -cmd startnode
执行完成后查看回显中有无“failed”项。
●
如果没有，表示执行成功。
●
如果有，请联系技术支持工程师协助解决。
----结束
2.5.7.10
磁盘损坏进入维护模式
现象描述
挂载磁盘操作的过程中，系统自动进入维护模式。
显示类似如下信息时，说明磁盘已损坏。
[3.116335]systemd-fsck[597]:/dev/mapper/oss_vg-optlog_vol:Inodes that were part of a corrupted orphan
linked list found.
[3.118363]systemd-fsck[597]:/dev/mapper/oss_vg-optlog_vol:UNEXPECTED INCONSISTENCY;RUN fsck
MANUALLY.
[3.119977]systemd-fsck[597]:/dev/mapper/oss_vg-optlog_vol:(i.e.,without -a or -p options)
说明
/dev/mapper/oss_vg-optlog_vol为磁盘名称，请依据实际环境替换。
可能原因
虚拟机下电。
处理步骤
步骤1 进入维护模式后，系统自动以root用户登录。
步骤2 执行以下命令，卸载磁盘。
umount
磁盘名称
步骤3 显示如下信息时，执行如下命令，停止正在使用的进程，然后再卸载磁盘。
[root@EulerOS-BaseTemplate ~]# umount /dev/mapper/oss_vg-optlog_vol
umount: /opt: target is busy.
(In some cases useful info about processes that use
the device is found by lsof(8) or fuser(1))
fuser -ck /opt
umount
磁盘名称
说明
opt为目录名称。
步骤4 执行以下命令，修复磁盘。
fsck.ext4 -f -y
磁盘名称
步骤5 执行以下命令，重启虚拟机。
reboot
2

## Page 1333

步骤6 使用PuTTY工具通过sopuser用户登录异常节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤7 执行以下命令，切换至root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤8 执行以下命令，验证故障是否恢复。
df -h
查看回显信息中是否存在“/dev/mapper/oss_vg-opt_vol”和“/dev/mapper/
oss_vg-optlog_vol
”这两行并且有数据显示，回显示例如下。
Filesystem Size Used Avail Use% Mounted on
/dev/vda1 7.9G 2.2G 5.3G 29% /
devtmpfs 11G 0 11G 0% /dev
tmpfs 11G 12K 11G 1% /dev/shm
tmpfs 11G 4.8M 11G 1% /run
tmpfs 11G 0 11G 0% /sys/fs/cgroup
/dev/mapper/oss_vg-opt_vol 103G 5.7G 92G 6% /opt
/dev/mapper/oss_vg-optlog_vol 25G 1.5G 22G 7% /opt/log
●
是，表示故障已恢复。
●
否，请联系技术支持工程师处理。
----结束
2.5.7.11
操作系统出现只读状态
现象描述
执行命令时，操作系统变成只读状态。
可能原因
●
虚拟机下电。
●
操作系统文件或磁盘损坏。
●
存储设备空间已满。
处理步骤
步骤1 重启操作系统，环境有可能会自动恢复。
如果在恢复过程中出现如下回显信息，说明挂载磁盘异常。
[3.116335]systemd-fsck[597]:/dev/mapper/oss_vg-optlog_vol:Inodes that were part of a corrupted orphan
linked list found.
[3.118363]systemd-fsck[597]:/dev/mapper/oss_vg-optlog_vol:UNEXPECTED INCONSISTENCY;RUN fsck
MANUALLY.
[3.119977]systemd-fsck[597]:/dev/mapper/oss_vg-optlog_vol:(i.e.,without -a or -p options)
步骤2 请参见2.5.7.10 磁盘损坏进入维护模式手动恢复操作系统。
步骤3 如果手动恢复操作系统失败，请按Ctrl+D强制尝试登录。
----结束
2

## Page 1334

2.5.7.12
登录
ManageOne
时界面提示无法访问
现象描述
登录ManageOne运维面、部署面或运营面时无法访问页面。
可能原因
ManageOne业务服务在运行时所需要的工作目录丢失导致后台服务启动失败。
●
如果无法访问ManageOne运维面，用户需要登录ManageOne-Service01、
ManageOne-Sevice02节点恢复故障。
●
如果无法访问ManageOne部署面，用户需要登录ManageOne-Deploy01、
ManageOne-Deploy02节点恢复故障。
●
B2B场景：
–
如果无法访问ManageOne运营管理面，用户需要登录ManageOne-
Service03、ManageOne-Sevice04节点恢复故障。
–
如果无法访问ManageOne租户面，用户需要登录ManageOne-Tenant01、
ManageOne-Tenant02节点恢复故障。
●
非B2B场景：如果无法访问ManageOne运营面，用户需要登录ManageOne-
Service03、ManageOne-Sevice04节点恢复故障。
处理步骤
这里以无法访问ManageOne部署面为例，用户登录ManageOne-Deploy01、
ManageOne-Deploy02节点恢复故障，具体恢复操作请参见以下步骤。
步骤1 使用PuTTY工具，以sopuser用户登录ManageOne-Deploy01节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换到ossadm用户。
su - ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（ManageOne）”页签
中，在对应节点下该帐户的默认密码。
步骤3 执行以下命令，恢复服务所需的工作目录。
. /opt/oss/manager/bin/engr_profile.sh
cd /opt/oss/manager/agent/rtsp/mccommon/tools/shscript
sh ossrunpy.sh TroubleRecoveryMgmt recreateDirectories
执行完成后，查看回显中有无“failed”项。
●
如果没有，表示执行成功。
●
如果有，请联系技术支持工程师协助解决。
步骤4 执行以下命令，启动服务。
ipmc_adm -cmd startbus
ipmc_adm -cmd startapp
2

## Page 1335

执行完成后查看回显中有无“failed”项。
●
如果没有，表示执行成功。
●
如果有，请联系技术支持工程师协助解决。
步骤5 重复执行1~4，登录ManageOne-Deploy02节点，完成故障恢复操作。
步骤6 重新登录ManageOne部署面，检查登录是否成功。
●
是，表示执行成功。
●
否，请联系技术支持工程师协助解决。
----结束
2.5.7.13 PKI
证书过期导致运营面无法登录
PKI证书过期导致运营面无法登录，为了避免证书过期导致系统存在安全风险，建议定
期更新。
更新PKI证书请联系技术支持工程师协助解决。
2.5.7.14 ER
证书过期导致运维面和运营面无法登录
ER证书过期导致运维面、运营面无法登录，为了避免证书过期导致系统存在安全风
险，建议定期更新。
前提条件
已获取以下证书文件并保存至PC，并获取身份证书私钥的密码：
●
server.cer：身份证书文件。
●
server_key.pem：身份证书对应的私钥。
●
trust.cer：信任证书文件。
背景信息
●
ER证书保存在所有产品节点的“/opt/oss/Product/etc/ssl/er”目录。
●
ER证书相关文件如下所示：
– cert_pwd：用于存放身份证书加密密码的文件。
–
manifest.json：证书配置文件。
–
server.cer：身份证书文件。
–
server_key_crypto.pem：身份证书对应的私钥。
–
server.p12：p12格式的证书。
–
server_key.pem：身份证书对应的私钥。
–
trust.cer：信任证书文件。
–
trust.jks：jks格式的信任证书文件。
更新ER证书时，ManageOne会自动生成manifest.json、server.p12和trust.jks文
件。
2

## Page 1336

操作须知
●
更新ER证书时系统会自动将旧ER证书备份至部署节点的“/opt/oss/
manager/var/tmp/er_随机码”目录。
例如“/opt/oss/manager/var/tmp/er_202022222”。
●
更新证书时会自动启停服务，请谨慎操作，建议在业务空闲期执行本节操作。
●
请按如下顺序进行重启主备节点进程，否则会发生主备倒换。
a.
停止备节点进程。
b.
更新备节点证书。
c.
停止主节点进程。
d. 更新主节点证书。
e.
启动主节点进程。
f.
启动备节点进程。
●
部署节点主备判断方法请参见3.16 判断节点的主备。
操作步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录ManageOne-Deploy01节点。
说明
●
请勿使用部署节点的浮动IP地址登录节点，使用固定IP地址登录，否则将导致PuTTY工具连
接会中断，从而更新证书失败。
●
证书更新过程中需重启服务，期间PuTTY工具长时间无任何操作可能会超时断连导致更新证
书失败，请设置PuTTY工具的超时时间，具体操作请参见《ManageOne
8.1.0
安全管理指
南》中的“如何防止PuTTY工具超时断连”章节。
步骤2 执行以下命令，创建新证书的临时上传目录并修改其权限，例如“/tmp/
management1”。
> mkdir /tmp/management1
> chmod 750 /tmp/management1
步骤3 使用FileZilla工具以sopuser用户通过SFTP方式将ER证书上传至步骤1中的节点
“/tmp/management1”目录。
步骤4 执行以下命令，修改证书文件的权限。
> chmod 640 /tmp/management1/*
步骤5 执行以下命令，创建已获取新证书的存放目录和修改其权限。
> mkdir -p /tmp/cer/management
> chmod -R 750 /tmp/cer/management
步骤6 执行如下命令，切换到root用户。
sudo su root
步骤7 执行以下命令，将证书文件复制至“/tmp/cer/management”。
> cp /tmp/management1/* /tmp/cer/management
步骤8 执行以下命令，设置新证书的权限。
2

## Page 1337

> chmod 700 /tmp/cer/management
> find /tmp/cer/management -type f | xargs chmod 600
> chown -R ossadm:ossgroup /tmp/cer/
步骤9 执行如下命令，切换到ossadm用户。
su ossadm
步骤10 执行以下命令，更新ER证书。
> cd /opt/oss/manager/apps/UniEPService/tools/common
> bash updatecertificate.sh -certtype er -certpath /tmp/cer/management
说明
如果部署面的部署模式是单机模式，且部署节点和产品节点为同一个节点，“UniEPService”需
替换为“UniEPLiteService”。
如果ER证书采用ECDSA加密算法，以上命令为“bash
updatecertificate.sh -certtype er -
certpath /tmp/cer/management -type
ecdsa”。
系统回显如下类似信息：
Replacing the er certificates...please waiting.
1.management
2.<产品名称>
Please select the number of the product information:
步骤11 输入“management”对应的序号，按“Enter”。
系统回显如下信息：
Replacing the certificates will interrupt services. Are you sure you want to continue? (y/n)
步骤12 输入“y”，按“Enter”。
系统回显如下信息，依次输入已获取的新证书的身份证书私钥密码，并设置新密码。
Please input the old password of new certificate:
Password:
Please input the new password of new certificate:
Password:
Please confirm the new password of new certificate:
Password:
新证书的新密码需满足以下复杂度要求：
●
密码必须是10～32个字符。
●
密码必须包含如下四种字符的组合：
–
至少一个大写字母
–
至少一个小写字母
–
至少一个数字
–
至少一个特殊字符!"#$%&'()*+,-./:;<=>?@[]^`{_|}~
●
密码中不能同时存在特殊字符双引号（"）和单引号（'）。
●
密码中不能使用3个或3个以上连续的相同字符。
●
密码中不能使用4个或4个以上相同的字符。
系统将更新ER证书并自动重启部署面的ER相关服务。
2

## Page 1338

●
若系统回显如下信息，表示ER证书更新完成，执行步骤13。
Certificates replaced successfully.
●
若系统回显其他信息，表示ER证书更新失败，请恢复更新失败的ER证书，具体操
作请参见《ManageOne
8.1.0
安全管理指南》中的“回退更新失败的ER证书”
章节，然后联系技术支持工程师定位并处理问题。
步骤13 登录部署面界面，若能登录成功则表示证书更新成功，否则请联系技术支持工程师。
步骤14 删除临时文件。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录部署节点。
2.
执行如下命令，切换到root用户。
sudo su root
3.
执行以下命令，删除临时目录下的文件。
> cd /tmp
> rm -rf management1
4.
执行以下命令，删除临时目录下的文件。
> cd /tmp/
> rm -rf cer/*
5.
执行以下命令，退出root用户。
> exit
步骤15 更新成功后所有的历史备份数据会失效，请备份部署面的应用程序和数据。具体操作
请参见《华为云Stack
8.1.0
运维指南》的“手工备份ManageOne部署面的应用程序
和数据”章节。
----结束
后续处理
若使用浏览器登录运维或运营面时，Web浏览器提示类似“您的连接并不安全”，您
需将服务器证书添加至浏览器的证书中，具体操作请参见《ManageOne
8.1.0
安全管
理指南》中“设置浏览器信任证书”章节。
2.5.7.15
节点时间跳变后周期报表中部分周期报表未继续执行
现象描述
环境时间有跳变，导致存在数据库中的任务下次执行时间跳到系统错误的跳变时间
点，周期报表可能长期不执行。
可能原因
系统掉电等。
处理步骤
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
2

## Page 1339

● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“运维分析
>
我的报表
>
周期报表”，进入到“周期报表任务管理”
界面。
步骤3 记录所有受影响的周期报表参数。
步骤4 勾选需要删除的报表，单击“操作”列的 或任务列表上方的“删除”，可以单个或
批量删除受影响的周期报表。
步骤5 单击“创建”，在弹出界面中按提示输入步骤3记录的参数，单击“确定”。
步骤6 重复执行步骤5，直至重新创建完所有受影响的周期报表。
----结束
验证恢复结果
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。默认帐号“admin”。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在主菜单中选择“运维分析
>
我的报表
>
周期报表”，进入到“周期报表任务管理”
界面。
步骤3 观察周期报表的下次执行时间，时间已恢复至修复后的系统时间，则说明周期任务恢
复成功。
----结束
2.5.7.16 SFTP
复制状态异常
现象描述
异常下电场景导致SFTP复制状态异常。
处理步骤
步骤1 异地容灾场景，强制同步操作。
说明
仅异地容灾场景需要执行该步骤。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“高可用
>
异地高可用系统
>
管理异地容灾系统”，进入
“管理异地容灾系统”。
3.
在“异地容灾产品列表”的操作列单击 ，并选择同步方向。
2

## Page 1340

说明
强制同步方向应选择“当前主用站点->当前备用站点”。
4.
同步完成后，在“异地容灾产品列表”中左侧单击 ，查看SFTP服务器数据类型的
状态是否为“已同步”。
–
是，操作结束。
–
否，请执行步骤2。
步骤2 使用PuTTY工具，以sopuser用户登录ManageOne-Service03节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，切换到ossadm用户。
su - ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（ManageOne）”页签
中，在对应节点下该帐户的默认密码。
步骤4 执行以下命令，进入“/opt/meterfiles”目录。
cd /opt/meterfiles/
步骤5 执行以下命令，查看modr.conf文件。
cat modr.conf
步骤6 查看文件内容是否显示正常。
显示内容示例如下则表示正常，如果文件格式不一样，清空文件内容，等下一个同步
周期（1分钟）会自动修复。
meteradmin_status=DONE
taskfileadmin_status=DONE
autoopsadmin_status=DONE
attachadm_status=DONE
logctadm_status=DONE
fdsftpadm_status=DONE
eappadm_status=DONE
cloudmarketadm_status=DONE
●
是，请执行步骤7。
●
否，请联系技术支持工程师协助解决。
步骤7 使用PuTTY工具，以sopuser用户登录ManageOne-Service04节点，并重复执行步骤3
～步骤6。
----结束
2.5.7.17
安装
MOICAgent
异常
现象描述
安装MOICAgent异常。
可能原因
MOICAgent版本不匹配，导致证书无法解析。
2

## Page 1341

操作步骤
步骤1 登录ManageOne运维面，在主菜单选择“系统管理
>
关于”，查看ManageOne产品
的当前版本号。
步骤2 查询MOICAgent证书的Base64字符串。
1.
使用PuTTY工具以sopuser用户登录节点。
说明
–
节点为ManageOne-Service01/02或者ManageOne-AppServer0X的任意一个节点。
– 请参考参考信息获取节点IP地址。
2.
执行以下命令，切换到ossadm用户。
su ossadm
说明
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“B类（ManageOne）”页签
中，帐户名称为“ossadm”对应的默认密码。
3.
执行以下命令，获取并记录证书的Base64字符串。
source /opt/oss/manager/bin/engr_profile.sh
export SSL_ROOT=/opt/oss/manager/etc/ssl
python
import util.httpclient
import socket
host_ip = socket.gethostbyname(socket.getfqdn(socket.gethostname()))
client = util.httpclient.CommonHttpClient(host_ip,32018,True,False)
client.get("/rest/moicagentmgmtservice/v1/current-cert")
步骤3 使用浏览器登录对应Region的DMK平台。
登录地址：https://DMK主页的访问地址:8443。例如，https://192.168.127.54:8443。
默认帐号：datoping
说明
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”页签中，产品名称为
“FusionSphere Service（DMK）”帐户名称为“datoping”对应的默认密码。
步骤4 执行以下步骤，添加fsp帐号到DMK帐号仓库。
1.
在左侧导航树中，选择“帐号仓库”。
2.
查看“帐号名称”列中是否已存在fsp帐号。
– 是，单击fsp帐号所在行的“删除”，在提醒框中单击“确定”，且继续执行
步骤4.3。
–
否，继续执行步骤4.3。
3.
单击页面左上角“添加帐号”按钮，进入“添加帐号”界面。
4.
请参见下表，添加fsp帐号。
2

## Page 1342

表2-26 添加fsp帐号参数说明
参数 参数说明 备注
帐号名称 连接目标主机用到的SSH用户名。
fsp
描述 对帐号进行相关说明。
用户自定义。
实例：fsp
组 从下拉列表中选择帐号所属的组。 选择“ManageOne”
和“OTD”组。
类型
–
密码方式：如果待安装节点的
登录鉴权方式为用户和密码方
式，则选择此项。
–
密钥方式：如果待安装节点的
登录鉴权方式为秘钥文件方
式，则选择此项。
选择“密码方式”。
密码 连接目标主机的fsp帐号密码。
说明
默认密码：请参见《华
为云Stack 8.1.0 帐户一
览表》的“A类（后
台）”页签中，产品名
称为“FusionSphere
Service”帐户名称为
“fsp”对应的默认密
码。
确认密码 再次输入SSH密码。
-
配置sudo许可 建议打开。
-
Sudo用户名 Sudo用户名，当需要在远程节点
执行sudo操作时填写。
root
Sudo密码 Sudo密码，该密码用于用户在远
程节点执行sudo操作密码认证。
-
步骤5 单击“确定”，完成帐号添加。系统提示帐号添加成功后，在帐号列表中可查询到新
添加的帐号信息。
步骤6 验证新添加帐号fsp的用户名密码正确性。
1.
在帐号列表中，单击新添加的fsp帐号所在行的“验证”。
2.
在“验证”页面，输入新增计算节点的external_om的IP地址，“Root切换”选择
“su”。
说明
多个计算节点的IP地址用逗号隔开。
3.
单击“确定”。系统将显示帐号连通性测试结果。
–
验证结果显示OK，表明帐号信息无误，验证通过。
–
若验证不通过，请检查失败节点的fsp和root密码是否为步骤4.4中填写的密
码。
2

## Page 1343

步骤7 在左侧导航树中，选择“包仓库”，
●
如果MOICAgent软件包和步骤1查询的ManageOne版本号一致，执行步骤8。
●
如果MOICAgent软件包和步骤1查询的ManageOne版本号不一致，单击
MOICAgent软件包所在行的“删除”，删除MOICAgent软件包。
单击界面左上角的“添加”，参考步骤1查询的ManageOne版本号，根据界面提
示上传对应ManageOne版本的MOICAgent软件包。
步骤8 执行以下步骤，安装MOICAgent服务。
1.
在DMK平台左侧导航树中，选择“部署向导”。
2.
在“服务配置”栏，在“服务”页签选择“MOICAgent”，并配置以下参数：
–
选择版本：选择本次部署的软件包版本号。
–
选择部署操作：选择“安装”。
–
选择区域：选择“local”。
–
主机仓库：否。
–
灰度部署：否。
3.
单击“下一步”，选择“ManageOne”组。
4.
修改配置文件。
在配置文件中参考样例修改如下内容：
...
remote_user: fsp
agent_listen_address: "{{ansible_ssh_host}}"
agent_listen_port: 26401
agent_client_address: "{{ansible_ssh_host}}"
agentmgr_ip_port:
LVS的域名或IP地址:
27337
agent_cert:
Base64字符串
– “remote_user”的值为：fsp。
–
“agent_listen_port”的值默认为：26401。
–
“agentmgr_ip_port”的值为LVS的域名。从HUAWEI
CLOUD Stack Deploy
导出的参数信息汇总文件的“工具生成的其他参数”页签中规划的参数描述
通常为：ManageOne的LVS域名，获取即可。在没有域名的情况下，可以在
参数信息汇总文件的“工具生成的IP参数”页签中搜索“ManageOne-LVS-
Ip”的IP地址并填入。
–
“agent_cert”的值为步骤2中记录的Base64字符串。
5.
修改节点配置文件。
删除原有节点配置文件内容，将如下内容复制到节点配置文件中，并修改物理服
务器的IP地址：
[su_host_group]
agent0 ansible_ssh_host=物理服务器的IP地址
agent1 ansible_ssh_host=物理服务器的IP地址
如果有多个物理服务器需要下发配置，则按照“agentX ansible_ssh_host=物理服
务器的IP地址”的格式逐行增加即可。
说明
“物理服务器的IP地址”为计算节点的external_om的IP地址。
6.
配置信息完成后，单击“执行”，开始服务的安装操作。
7.
查看安装状态。
a.
在左侧导航树中，选择“任务管理”。
2

## Page 1344

b.
查找到该安装任务，当“任务名称”栏的状态更新为 时，表示MOICAgent
安装任务执行成功。
8.
（可选）关联服务监控模板。
a.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地
址:31943”，登录ManageOne运维面。
▪
密码方式：输入帐号和密码。默认帐号“admin”。
▪
USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，
并输入PIN码。
b.
在主菜单中选择“集中监控
>
监控配置
>
云服务配置 ”。
c.
在云服务配置页面上方单击“模板解绑”。
d.
单击OpenStack类型所在行的“编辑”。
e.
参考界面提示，在“节点信息”页签勾选新增的物理服务器IP，在“监控模
板页签”为新增的物理服务器关联os_template模板。
步骤9 验证MOICAgent是否安装成功。
1.
使用PuTTY工具以fsp用户登录新扩容的计算节点。
2.
执行如下命令，并按提示输入“root”用户的密码，切换到“root”用户。
sudo su root
3.
执行以下命令，防止PuTTY超时退出。
TMOUT=0
4.
执行如下命令，查询MOICAgent进程状态。
ps -ef | grep -v grep | grep icagent
显示如图2-14所示，说明安装成功。
图2-14 查询MOICAgent进程状态
----结束
参考信息
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在主菜单中选择“产品
>
软件管理
>
部署产品软件”。
步骤3 单击“ManageOne”卡片。
步骤4 在“节点列表”区域查找节点的IP地址。
----结束
2

## Page 1345

2.5.8
数据库常用操作
本章节介绍数据库的登录和退出操作。
操作步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录数据库节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
说明
● GaussDB
V3数据库节点获取方法：登录ManageOne部署面，选择“维护
>
运维管理
>
全
景监控”，在“节点监控”页面左上方，单击 并选择“ManageOne”，在左侧导航树中
选择“中间件监控”页面的“关系数据库”页签，单击所需数据库节点名称，在节点详情页
面上方的管理IP地址即为该数据库节点的IP地址。
●
Redis数据库节点获取方法：登录ManageOne部署面，选择“维护
>
运维管理
>
全景监
控”，在“节点监控”页面左上方，单击 并选择“ManageOne”，在左侧导航树中选择
“中间件监控”页面的“Redis数据库”页签，单击所需数据库节点名称，在节点详情页面上
方的管理IP地址即为该数据库节点的IP地址。
步骤2 执行以下命令，切换至dbuser用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
su - dbuser
步骤3 执行以下命令，登录数据库。
● GaussDB 100
V3数据库：
cd /opt/zenith/app/bin
./zsql sys@GaussDB 100
V3数据库节点的IP地址:GaussDB
100
V3数据库实例的
端口号
说明
GaussDB 100
V3数据库节点的IP地址、GaussDB
100
V3数据库实例的端口号的获取方法
请参见3.14 如何查找数据库实例所在节点的IP地址和端口号。
Please enter password:
输入GaussDB 100 V3数据库dbuser用户密码：默认密码请参见《华为云Stack 8.1.0 帐户一览表》的“B类
（ManageOne）”页签中，在对应节点下该帐户的默认密码。
当系统提示如下类似回显信息时，表示登录数据库成功。否则，请联系技术支持
工程师协助解决。
connected.
SQL>
登录成功后输入“exit”可退出登录。
●
Redis数据库：
cd /opt/redis/bin
./redis-cli -h 10.93.59.218 -p 26657 -cipherdir /opt/redis/etc/cipher/1
auth
accessrdb@dbuser@Redis数据库dbuser用户密码
2

## Page 1346

参数名称 描述
-h
Redis数据库节点的IP地址。获取方法请参见3.14 如何查找数据库
实例所在节点的IP地址和端口号。
-p
Redis数据库实例的端口号。获取方法请参见3.14 如何查找数据库
实例所在节点的IP地址和端口号。
-cipherdir
Redis数据库加密路径。
说明
–
accessrdb：Redis数据库名称。
–
Redis数据库dbuser用户密码：默认密码请参见《华为云Stack
8.1.0
帐户一览表》的
“B类（ManageOne）”页签中，在对应节点下该帐户的默认密码。
当系统提示如下类似回显信息时，表示登录数据库成功。否则，请联系技术支持
工程师协助解决。
OK
192.168.20.188:26657>
登录成功后输入“exit”或“quit”可退出登录。
----结束
2.5.9 eSight
故障
如果是eSight V300R010C00SPC600及其补丁版本，请参考《eSight
V300R010C00SPC600
产品文档》中的“操作与维护
>
维护指南
>
故障处理”章
节。
如果是eSight 21.0.0及其补丁版本，请参考《eSight
21.0
产品文档》中的“操作与维
护
>
维护指南
>
故障处理”章节。
说明
●
取消和恢复eSight单点登录，如果是eSight V300R010C00SPC600及其补丁版本，请参见
《eSight
V300R010C00SPC600
产品文档 》中的“操作与维护
>
操作指南
>
用户认证
>
配置SSO认证
>
配置SSO认证（单机系统）”章节；如果是eSight 21.0.0及其补丁版本，请
参见《eSight
21.0
产品文档》中的“操作与维护
>
操作指南
>
系统管理
>
安全管理
> SSO
配置
> CAS
SSO配置
>
配置CAS SSO”章节中的“SSO客户端配置”相关内容。
●
如果要查询eSight版本号，详情请参见《华为云Stack
8.1.0
运维指南》中的“查询eSight版
本号”章节。
2.6
公共组件故障
2.6.1 Gaussdb
故障
2.6.1.1
数据库系统故障处理
数据库系统故障指的是因当前数据库高可用场景限制导致的系列故障，该类故障都可
以通过修复手段使系统满足数据库高可用机制触发数据库的自我修复。
2

## Page 1347

2.6.1.1.1
备数据库无法升主
现象描述
主数据库已经故障无法响应业务请求，备数据库无法升主。
可能原因
主数据库的故障特殊，导致备数据库无法满足升主条件，如主数据库虽然故障但浮动
IP无法解绑，导致备库无法绑定浮动IP而无法升主。
定位思路
强制重启主数据库所在的虚拟机节点，释放数据库的浮动IP资源。
前提条件
●
已获取登录Fusionsphere Openstack控制节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
●
已获取内置DC管理员帐户的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
处理步骤
步骤1 执行以下命令登录Fusionsphere Openstack控制节点。
ssh
用户名@Openstack控制节点IP地址
默认帐户：fsp
步骤2 执行以下命令，并按提示输入root用户的密码，切换到root。
su - root
步骤3 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤4 选择鉴权方式。
使用内置DC管理员的OpenStack
Keystone
V3鉴权，输入“1”，按“Enter”，并按
提示输入“OS_USERNAME”的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
2

## Page 1348

密码输入成功后如果有cps host-list和nova list命令的自动回显信息，则表示环境变
量导入成功。导入成功后系统使用内置DC管理员的Keystone V3鉴权。可以正常执行
CPS命令和OpenStack命令。
在OpenStack的Mitaka版本中，Keystone命令行接口做了归一化处理，全部封装为
OpenStack命令。在Identity service注册为V3路径时，原Keystone命令行在执行
tenant/role/service相关命令时会存在兼容性问题。请优先使用Keystone V3鉴权，并
使用同等功能的openstack project/role/service命令。
步骤5 执行如下命令查询主数据库所在虚拟机节点的uuid。
nova list --all-|grep
'数据库所在的虚拟机节点IP'
图2-15 查询uuid结果
查询出的红框部分表示虚拟机的uuid。
步骤6 执行如下命令，强制重启主数据库虚拟机节点。
nova reboot
虚拟机节点的uuid
–hard
斜体部分需要替换为步骤5中查询出的实际虚拟机uuid。
步骤7 等待3-5分钟，登录备数据库执行如下命令检查数据库是否升主。
source /etc/profile
service gaussdb query
图2-16 数据库状态
●
是，执行结果如图2-16所示表示备数据库升主成功，故障处理成功。
●
否，执行结果如果和图2-16不一致，请联系技术支持工程师协助解决。
----结束
2

## Page 1349

2.6.1.1.2
备数据库异常无法启动
现象描述
备数据库显示故障，无法自恢复。
可能原因
正常情况下备数据异常时会自动从主库同步数据自我修复，但是如果因为网络等原因
超过两次修复失败备库就会停止恢复需要人工恢复。
定位思路
执行人工修复，强制备库从主库同步数据。
前提条件
已获取登录PUB-DB节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
处理步骤
步骤1 使用“PuTTY”，登录PUB-DB01节点。
默认帐户：fsp
步骤2 执行以下命令，并按提示输入root用户的密码，切换到root。
sudo su
步骤3 执行以下命令，检查数据库状态，并查看当前登录节点是否为备节点。
service had query
回显信息类似如图2-17所示，“ROLE”为“active”的节点为主节点，否则为备节
点。
图2-17 数据库状态
步骤4 根据步骤3的回显信息，判断当前登录节点是否为备节点？
●
是，执行步骤5。
●
否，重复执行步骤1~步骤2登录PUB-DB02节点后，执行步骤5。
步骤5 执行如下命令切换用户到dbadmin。
su dbadmin
2

## Page 1350

步骤6 执行如下命令，同步主库数据。
gs_ctl build
图2-18 同步主库数据
●
是，执行结果如图2-18所示表示数据库备库恢复成功，故障处理成功。
●
否，执行结果如果和图2-18不一致，请联系技术支持工程师协助解决。
----结束
2.6.1.2
非数据库系统故障处理
非数据库系统故障，一般指无法通过数据库本身机制恢复的故障，例如操作系统故障
等场景。
2.6.1.2.1
单数据库节点故障
现象描述
单个数据库节点的操作系统不可登录或者无法启动，数据库无法在其上正常运行。
可能原因
系统盘只读。
定位思路
使用相同镜像和相同IP信息重建数据库虚拟机后重新安装数据库恢复。
前提条件
●
已获取登录数据库节点的fsp密码和root密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
●
已获取Gaussdb登录DMK的帐户的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“A类（Portal）”页签
中，该帐户对应的默认密码。
2

## Page 1351

处理步骤
步骤1 使用数据库安装用户gaussdb登录另一个未故障的数据库节点。
默认帐户：fsp
步骤2 执行以下命令，并按提示输入root用户的密码，切换到root。
sudo su
步骤3 执行如下命令检查未故障的数据库节点状态是否正常。
service gaussdb query
图2-19 数据库状态
●
是，查询结果和图2-19一致，执行步骤4。
●
否，查询结果和图2-19不一致，需要按照2.6.1.2.2 主备数据库节点故障章节处理
故障。
步骤4 重新创建故障的数据库虚拟机，并初始化虚拟机。
步骤5 在浏览器中输入http://DMK浮动IP:8443，使用安装数据库的DMK帐户登录DMK。
默认帐户：gaussdb
步骤6 在左侧导航树中，选择“部署向导”。
步骤7 在“服务配置”栏，选择“第三方组件”页签中的GaussdbHA，并配置如下参数。
●
选择版本：选择和主库一致的版本号
●
选择部署操作：安装
●
选择区域：local
●
主机仓库：否
●
灰度发布：否
步骤8 单击“下一步”，系统进入“节点和用户配置”。
步骤9 选择正确的组和帐号。
步骤10 修改配置文件。
节点配置文件中删除未故障的节点，只保留需要重新安装数据库的节点。
步骤11 单击“执行”，给重建的数据库节点安装数据库。
2

## Page 1352

步骤12 安装完成后使用数据库安装用户登录重建的数据库节点，执行如下命令查看数据库状
态。
service gaussdb query
图2-20 数据库状态
查询结果和图2-20类似表示故障处理结束，如果和图2-20不一样，请联系技术支持工
程师协助解决。
----结束
2.6.1.2.2
主备数据库节点故障
现象描述
主备数据库节点的操作系统不可登录或者无法启动，数据库无法在其上正常运行。
可能原因
系统盘只读。
定位思路
使用相同镜像和相同IP信息重建数据库虚拟机后重新安装数据库恢复。
处理步骤
步骤1 确认故障数据库是否存在近期的远端数据库备份。
●
是，执行步骤2。
●
否，请联系技术支持工程师协助解决。
步骤2 请参考2.2.1 云平台故障诊断（调用链）重建主备数据库节点的虚拟机。
步骤3 请联系技术支持工程师协助解决给主备数据库节点安装数据库。
2

## Page 1353

步骤4 参考《华为云Stack
8.1.0
运维指南》 中“ 恢复数据
>
恢复公共组件数据>恢复
Combined API/VPC/API
Gateway/TaskCenter/SDR/CCS数据
>
全量数据恢复”章节，
进行数据恢复。
----结束
2.6.2 DNS
故障
2.6.2.1
管理虚拟机上所有域名无法解析
现象描述
管理虚拟机上所有域名无法解析。
可能原因
●
管理虚拟机配置文件/etc/resolv.conf文件配置了错误的DNS地址。
●
管理虚拟机和DNS管理侧节点网络不通。
●
DNS进程故障。
处理步骤
步骤1 判断DNS所在的虚拟机OM-SRV01或OM-SRV02是否正常登录。
●
是，执行步骤3。
●
否，执行步骤2。
步骤2 请参考2.2.1 云平台故障诊断（调用链）修复虚拟机，任务结束。
步骤3 使用“PuTTY”，通过故障节点IP地址，以节点业务帐号，登录到故障节点。
默认帐户：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤4 执行以下命令，打开配置文件/etc/resolv.conf。
vi /etc/resolv.conf
步骤5 检查配置文件中的两个IP是否为DNS管理侧的两个节点的IP，即OM-SRV01和OM-
SRV02节点的IP。
●
是，继续执行步骤6。
●
否，修正为正确的DNS IP，重新测试。如果域名可以解析，则表示问题解决，否
则继续执行步骤6。
步骤6 在故障节点执行如下命令测试故障节点和DNS管理侧节点是否网络连通。
ping DNS-IP
●
是，继续执行步骤7。
●
否，请联系技术支持工程师协助处理后再行排查。
步骤7 通过“PuTTY”，以fsp帐号登录到DNS管理侧节点，执行如下命令，并输入root帐号
密码，切换到root用户。
2

## Page 1354

sudo su - root
步骤8 执行如下命令，检查named进程状态。
systemctl status named
显示如下类似回显信息，表示named进程意外终止。
步骤9 执行命令如下，重启named服务。
systemctl restart named
●
若无任何回显信息表示重启成功，再次执行如下命令检查named进程状态。
systemctl status named
显示如下类似回显信息，表示named进程恢复正常。
●
若重启named进程有如下回显信息，则表示named进程启动失败。
Job for named.service failed because the control process exited with error code. See "systemctl status
named.service" and "journalctl -xe" for details.
执行如下命令，根据错误提示修复named进程。
systemctl status named
journalctl -xe
修复后，再次尝试重启named进程，如果依然失败，请联系技术支持工程师协助
解决。
----结束
2.6.2.2
租户虚拟机上域名无法解析
现象描述
租户虚拟机上所有域名无法解析。
可能原因
●
租户虚拟机配置文件/etc/resolv.conf文件配置了错误的DNS地址。
2

## Page 1355

●
租户虚拟机和DNS租户侧网络节点网络不通。
●
DNS进程故障。
●
租户侧DNS配置错误。
处理步骤
步骤1 判断DNS所在的虚拟机TDNS-TNTP01和TDNS-TNTP02是否正常登录。
●
是，执行步骤3。
●
否，执行步骤2。
步骤2 请参考2.2.1 云平台故障诊断（调用链）修复虚拟机，任务结束。
步骤3 登录到租户虚拟机，以linux为例。
步骤4 执行以下命令，打开配置文件/etc/resolv.conf。
vi /etc/resolv.conf
步骤5 检查配置文件中的两个IP是否为DNS租户侧两个节点的DMZ_Service平面的IP。
●
是，继续执行步骤6。
●
否，修改为正确的DNS租户侧IP，重新测试。如果域名可以解析，则表示问题解
决，否则继续执行步骤6。
步骤6 在故障节点执行如下命令测试故障节点和DNS租户侧节点网络连通性。
ping
DNS租户侧DMZ_Service平面IP
●
是，即网络连通，执行步骤10。
●
否，即网络不连通，继续执行步骤7。
步骤7 通过“PuTTY”，以fsp帐号登录到DNS租户侧节点
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤8 执行如下命令，并输入root帐号密码，切换到root用户。
sudo su - root
步骤9 执行如下命令，检查租户虚拟机的网段（external_relay_network）到DMZ_Service平
面的路由配置是否存在。
route -n
●
是，请联系技术支持工程师协助处理网络问题。
●
否，执行步骤10。
步骤10 在浏览器中输入http://DMK浮动IP:8443登录DMK平台。
默认帐户：udns
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“A类（Portal）”页签中，该
帐户对应的默认密码。
步骤11 在左侧导航树中，选择“部署向导”。
步骤12 在“服务配置”栏，选择“DNS-Internal”。
2

## Page 1356

步骤13 按照以下参数进行设置。
●
选择版本：选择本次部署的软件包版本号。
●
选择部署操作：选择“配置租户侧网关”。
●
选择区域：“local”。
●
主机仓库：“否”。
●
灰度发布：“否”。
步骤14 单击“下一步”，系统进入“节点和用户配置”。
步骤15 选择所属“组”DNS-Internal与预先添加的“帐号”udns。
步骤16 按照模板格式修改路由配置。
步骤17 配置信息完成后，单击“执行”，开始配置路由。
步骤18 查看状态。
1.
在左侧导航树中，选择“任务管理”。
2.
查找到该安装任务，当“任务名称”栏的状态更新为 时，表示安装成功。
步骤19 再次执行步骤9检查路由配置，如果网络恢复，执行步骤20。
步骤20 登录DNS租户侧节点，执行如下命令，检查named进程状态。
systemctl status named
●
named进程正常，执行步骤22。
●
named进程意外终止，执行步骤21。
显示如下类似回显信息，表示named进程意外终止。
步骤21 执行命令如下，重启named服务。
systemctl restart named
●
若无任何回显信息表示重启成功，再次执行如下命令检查named进程状态。
systemctl status named
显示如下类似回显信息，表示named进程恢复正常。
2

## Page 1357

●
若重启named进程有如下回显信息，则表示named进程启动失败。
Job for named.service failed because the control process exited with error code. See "systemctl status
named.service" and "journalctl -xe" for details.
执行如下命令，根据错误提示修复named进程。
systemctl status named
journalctl -xe
修复后，再次尝试重启named进程，如果依然失败，请联系技术支持工程师协助
解决。
步骤22 如果named进程正常，域名依然无法解析，则查看/etc/named.conf配置文件中的
forward地址是否正确。
执行以下命令，打开配置文件/etc/named.conf。
vi /etc/named.conf
查看forwarders配置的IP是否为有效的外部DNS服务器，并检查网络连通性，如果不正
确，参考《华为云Stack
8.1.0
运维指南》中的“修改DNS-Internal的上级DNS地址”
章节修改。
----结束
2.6.2.3
某个域名无法解析或解析错误
现象描述
某个域名无法解析，或解析错误，其他域名可以正常解析。
可能原因
●
该域名没有在DNS上添加相关配置。
●
在本机/etc/hosts文件的中配置了错误的域名IP对应关系
2

## Page 1358

处理步骤
步骤1 判断DNS所在的虚拟机是否正常登录。管理侧DNS部署在OM-SRV01和OM-SRV02
上，租户侧DNS部署在TDNS-TNTP01和TDNS-TNTP02上。
●
是，执行步骤3。
●
否，执行步骤2。
步骤2 请参考2.2.1 云平台故障诊断（调用链）修复虚拟机，任务结束。
步骤3 在浏览器中输入http://DMK浮动IP:8443登录DMK平台。
默认帐户：udns
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“A类（Portal）”页签中，该
帐户对应的默认密码。
步骤4 在左侧导航树中，选择“部署向导”。
步骤5 在“服务配置”栏，选择“DNS-Internal”。
步骤6 按照以下参数进行设置。
●
选择版本：选择本次部署的软件包版本号。
●
选择部署操作：选择“域名配置”。
●
选择区域：“local”。
●
主机仓库：“否”。
●
灰度发布：否。
步骤7 单击“下一步”，系统进入“节点和用户配置”。
步骤8 选择所属“组”DNS-Internal与预先添加的“帐号”udns。
步骤9 查看配置文件中是否有所需域名的配置。如果没有域名配置或域名配置错误，请先添
加所需域名配置或修改正确的域名配置。
步骤10 配置信息完成后，单击“执行”，开始修改配置操作。
步骤11 查看安装状态。
1.
在左侧导航树中，选择“任务管理”。
2.
查找到该安装任务，当“任务名称”栏的状态更新为 时，表示配置修改成功。
步骤12 如果解析依然异常，登录故障节点的/etc/hosts文件中是否有相关配置，如果有，删除
相关配置，如果依然异常，请联系技术支持工程师协助解决。
----结束
2.6.3 APIGateway
故障
2.6.3.1
访问业务 API，返回“502
Bad
Gateway”
现象描述
通过APIG访问接口，返回“502
Bad
Gateway”。
2

## Page 1359

可能原因
shubao服务全部异常，nginx没有可以转发的shubao服务。
处理步骤
步骤1 使用PuTTY，以paas用户登录APIGWZK01节点。
步骤2 执行以下命令，并按提示输入root用户的密码，切换到root用户。
sudo su
步骤3 执行以下命令，查看shubao进程状态。
ps -ef | grep resty
●
如果显示如下图所示，表示当前节点shubao进程正常，请在APIGWZK02和
APIGWZK03节点（CSHA场景还有APIGWZK04节点）重复执行步骤1～步骤3。
●
如果显示如下图所示，表示当前节点存在shubao运行异常，请执行步骤4。
步骤4 执行以下命令，切换到apigateway用户。
su - apigateway
步骤5 执行以下命令，启动shubao进程。
sh /opt/apigateway/resty/shell/restart.sh
步骤6 检查故障是否解除。
●
是，任务结束。
●
否，请联系技术支持。
----结束
2.6.3.2
访问业务 API，返回“404
Not
Found”
现象描述
通过APIG访问接口，返回“404
Not
Found”。
可能原因
●
API不存在或者没有部署。
●
后端服务不存在。
处理步骤
步骤1 调用IAM的“/v3/auth/tokens”接口获取任意租户的token。
步骤2 带token访问如下接口，获取API的注册信息，可以使用postman等工具进行操作。
2

## Page 1360

https://{{AGW-Nginx-Float-IP}}/v1/apigw/extension/api-fusion/apis?service_name={{服务名}}
须知
1.
{{AGW-Nginx-Float-IP}}需要从底座安装部署导出表“2.1 工具生成的IP参数”中
查找同名的参数值进行替换。
2.
{{服务名}}为云服务注册API时的服务名，如果不清楚服务名，可以为空，此时查找
所有的API信息。
3.
必须要带X-Auth-Token访问该接口。
步骤3 查看调用API时使用的路径、协议和请求方式等是否正确。
●
是，执行步骤4。
●
否，请根据实际业务API进行修改。执行步骤4。
步骤4 请检查后端服务是否连通。
●
是，请联系技术支持。
●
否，请开启后端服务。
----结束
2.6.3.3
访问业务 API，返回“504
Gateway
Time-out”
现象描述
通过APIG访问接口，返回“504
Gateway
Time-out”。
可能原因
Shubao服务全部异常，nginx没有可以转发的shubao服务。
处理步骤
步骤1 查看API请求返回error_msg与error_code，根据错误码说明进行问题定位。
步骤2 使用PuTTY，以paas用户登录APIGWZK节点。
步骤3 执行以下命令，并按提示输入root用户的密码，切换到root用户。
sudo su
步骤4 执行以下命令，打开shubao的access日志，根据日志内容定位服务器内部问题。
tail -f /var/log/apigateway/shubao/runtime/access.log
步骤5 再次发送API请求，通过日志定位到超时组件。
步骤6 查看相应组件error日志，定位问题。
步骤7 如果还存在问题，请联系技术支持。
----结束
2

## Page 1361

2.6.3.4
访问业务 API，返回“500
Internal Server
Error”
现象描述
通过APIG访问接口，返回“500
Internal Server
Error”。
可能原因
Shubao服务内部异常。
处理步骤
步骤1 查看API请求返回error_msg与error_code，根据错误码说明进行问题定位。
步骤2 使用PuTTY，以paas用户登录APIGWZK节点。
步骤3 执行以下命令，并按提示输入root用户的密码，切换到root用户。
sudo su
步骤4 执行以下命令，打开shubao的error日志，根据日志内容定位服务器内部问题。
tail -f /var/log/apigateway/shubao/runtime/error.log
步骤5 如果还存在问题，请联系技术支持。
----结束
2.6.4
组合
API
故障
2.6.4.1
组合
API
服务故障
现象描述
镜像转换、组合API合并部署在CPT-SRV01和CPT-SRV02节点。组合API服务所在虚拟
机或者tomcat进程出现故障时将会导致组合API功能异常。重启组合API节点的tomcat
进程后还无法恢复业务时，需按照下列步骤重新部署组合API服务。
可能原因
虚拟机掉电重启，服务运行依赖的文件损坏或缺失。
处理步骤
步骤1 使用“PuTTY”工具，登录组合API故障节点管理IP地址。
默认帐号：fsp。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
sudo su - root
2

## Page 1362

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤3 执行以下命令，备份组合API的目录。
cd /home/apicombination
mkdir backup
cp -arf /opt/apicom/tomcat /home/apicombination/backup
步骤4 登录DMK控制台。
登录地址：https://DMK浮动IP:8443。
帐号：apicom。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤5 单击“任务管理”，在“所有服务”的下拉列表选择“APICombination”，查看组合
API服务当前版本。
步骤6 单击“部署向导”，选择服务和版本。
●
选择服务：APICombination。
●
选择版本：步骤5中查询到的版本号。
●
选择部署操作：卸载。
●
其余选项保持默认。
步骤7 单击“下一步”，选择节点和用户配置。
●
组：ApiCom。
●
帐号：apicombination
(apicombination
local)。
●
其余选项保持默认。
步骤8 单击“执行”，在弹出框中单击“确认”进行卸载操作。
步骤9 等待卸载任务执行完成，查看执行结果是否成功，若卸载失败，请联系技术支持工程
师协助解决。
步骤10 重复执行步骤6~步骤9，“选择部署操作”选择“安装tomat”，其他操作保持一致，
等待安装tomcat任务执行完成。
步骤11 请参考步骤1~步骤2，使用“PuTTY”工具，登录组合API故障节点管理IP地址，并切
换至“root”用户。
步骤12 执行以下命令，恢复组合API的SCC配置。
rm -rf /opt/apicom/tomcat/conf/scc
cp -arf /home/apicombination/backup/tomcat/conf/scc /opt/apicom/tomcat/
conf/
步骤13 重复执行步骤4~步骤9，“选择部署操作”选择“安装”，其他操作保持一致，等待安
装apicom服务任务执行完成。
步骤14 重复执行步骤4~步骤9，“选择部署操作”选择“健康检查”，其他操作保持一致，等
待健康检查任务执行完成。健康检查任务执行成功表示重新部署组合API服务成功。
2

## Page 1363

步骤15 执行以下命令，删除备份的组合api目录。
rm -rf /home/apicombination/backup/
----结束
2.6.5 CloudScope
公共组件故障
表2-27 CloudScope公共组件故障处理
公共组件 参考手册 参考章节
CloudMidd
leWareZoo
keeper
●
企业网：《公有云运维平台
CloudMiddleWareZookeeper
1.1.5.1
版本文档》
●
运营商：《公有云运维平台
CloudMiddleWareZookeeper
1.1.5.1
版本文档》
《CloudMiddleWareZook
eeper 1.1.5.1
工具指导
书》
>
故障处理
Kafka
●
企业网：《公有云运维平台
Kafka
2.3.1
版本文档》
●
运营商：《公有云运维平台
Kafka
2.3.1
版本文档》
《Kafka
2.3.1
工具指导
书》
>
故障处理
Redis
●
企业网：《公有云运维平台
Redis
1.1.3
版本文档》
●
运营商：《公有云运维平台
Redis
1.1.3
版本文档》
《Redis 1.1.3 工具指导
书》 > 故障处理
CloudLVS
●
企业网：《公有云运维平台
CloudLVS 20.12.2
版本文档》
●
运营商：《公有云运维平台
CloudLVS 20.12.2
版本文档》
《CloudLVS
20.12.2
工具
指导书》
>
故障处理
CloudNgin
x
●
企业网：《公有云运维平台
CloudNginx 20.12.2
版本文档》
●
运营商：《公有云运维平台
CloudNginx 20.12.2
版本文档》
《CloudNginx
20.12.2
工
具指导书》
>
故障处理
etcd
●
企业网：《公有云运维平台
etcd
1.1.2
版本文档》
● 运营商：《公有云运维平台 etcd
1.1.2 版本文档》
《etcd
1.1.2
工具指导
书》
>
故障处理
CloudALB
●
企业网：《公有云运维平台
CloudALB 3.2.3
版本文档》
●
运营商：《公有云运维平台
CloudALB 3.2.3
版本文档》
《CloudALB
3.2.3
工具指
导书》
>
故障处理
2

## Page 1364

2.7
云服务故障
表2-28 HiCloud服务
服务 参考手册 参考章节
HiCloud
《HiCloud-VMware
1.0.14
用户指南》
维护
>
故障案例
Hicloud
《HiCloud-Security
1.0.14
用户指南》
维护
>
故障案例
表2-29 计算服务
服务 参考手册 参考章节
●
弹性云服务
器（ECS）
●
裸金属服务
器（BMS）
●
镜像服务
（IMS）
●
弹性伸缩
（AS）
《 计算服务
8.1.0
维护指
南(for 华为云Stack
8.1.0)》
《计算服务
8.1.0
故障管理(for 华
为云Stack 8.1.0)》> 故障处理
表2-30 存储服务
服务 参考手册 参考章节
云硬盘（EVS） 《云硬盘(EVS)
8.1.1
维护
指南(for 华为云Stack
8.1.0)》
《云硬盘(EVS)
8.1.1
故障管理(for
华为云Stack 8.1.0)》
>
故障处理
弹性文件服务
（SFS）
《弹性文件服务(SFS)
8.1.1 维护指南(for 华为云
Stack 8.1.0 )》
《弹性文件服务(SFS) 8.1.1 故障管
理(for 华为云Stack 8.1.0)》 > 故障
处理
对象存储服务
3.0（OBS）
《对象存储服务3.0(OBS)
3.21.9.5h&s
维护指南(for
华为云Stack 8.1.0)》
《对象存储服务3.0(OBS)
3.21.9.5h&s
故障管理(for 华为云
Stack
8.1.0)》
>
故障处理
2

## Page 1365

表2-31 网络服务
服务 参考手册 参考章节
●
弹性IP
（EIP）
●
弹性负载均
衡（ELB）
●
云解析服务
（DNS）
● 网络ACL
（Network
ACL）
●
虚拟私有云
（VPC）
●
VPC终端节点
（VPCEP）
●
虚拟专用网
络（VPN）
●
云专线
（DirectCon
nect）
●
云连接服务
（CC）
《网络服务
8.1.0
维护指南
(for
华为云Stack 8.1.0)》
《网络服务
8.1.0
故障管理(for 华
为云Stack 8.1.0)》
>
故障处理
表2-32 灾备服务
服务 参考手册 参考章节
●
云硬盘备份
（VBS）
●
云服务器备
份（CSBS）
《备份服务(CSBS&VBS)
8.2.0
维护指南(for 华为云
Stack
8.1.0)》
《备份服务(CSBS&VBS)
8.2.0
故障
管理(for 华为云Stack 8.1.0)》
>
故障处理
● 云服务器容
灾服务
（CSDR）
●
云服务器高
可用
（CSHA）
●
云硬盘高可
用（VHA）
《容灾服务
(CSDR&CSHA&VHA)
8.2.0
维护指南(for 华为云
Stack
8.1.0)》
《容灾服务(CSDR&CSHA&VHA)
8.2.0
故障管理(for 华为云Stack
8.1.0)》
>
故障处理
2

## Page 1366

表2-33 容器服务
服务 参考手册 参考章节
云容器引擎服务
（CCE）
《云容器引擎服务(CCE)
21.9.5
维护指南(for 华为云
Stack
8.1.0)》
《云容器引擎服务(CCE)
21.9.5
故
障管理(for 华为云Stack 8.1.0)》
>
故障处理
容器镜像服务
（SWR）
《容器镜像服务(SWR)
21.9.0
维护指南(for 华为云
Stack
8.1.0)》
《容器镜像服务(SWR)
21.9.0
故障
管理(for 华为云Stack 8.1.0)》
>
故障处理
应用服务网格
（ASM）
《 应用服务网格(ASM)
21.9.0
维护指南(for 华为云
Stack
8.1.0)》
《应用服务网格(ASM)
21.9.0
故障
管理(for 华为云Stack 8.1.0)》
>
故障处理
表2-34 安全服务
服务 参考手册 参考章节
●
安全指数服
务（SIS）
●
边界防火墙
（EdgeFW）
●
密钥管理服
务（KMS）
● 数据加密服
务（DEW）
●
数据库审计
服务
（DBAS）
●
云防火墙
（CFW）
《安全服务(FusionGuard)
8.1.0.SPC1
维护指南(for 华
为云Stack
8.1.0
)》
《安全服务(FusionGuard)
8.1.0.SPC1
故障管理(for 华为云
Stack
8.1.0)》
>
故障处理
Web应用防火墙
（WAF）
《Web应用防火墙(WAF)
1.1.8.1
维护指南(for 华为云
Stack
8.1.0)》
《Web应用防火墙(WAF)
1.1.8.1
故障管理(for 华为云Stack
8.1.0)》
>
故障处理
企业主机安全服
务（HSS）
《企业主机安全(HSS)
1.17.4.1
维护指南(for 华为
云Stack 8.1.0)》
《企业主机安全(HSS)
1.17.4.1
故
障管理(for 华为云Stack 8.1.0)》
>
故障处理
云堡垒机
（CBH）
《云堡垒机(CBH)
1.1.4.1
维护指南(for 华为云Stack
8.1.0)》
《云堡垒机(CBH)
1.1.4.1
故障管
理(for 华为云Stack 8.1.0)》
>
故
障处理
计算安全运营平
台(CSP)
《计算安全平台(CSP)
3.0.1.1
维护指南(for 华为云
Stack
8.1.0)》
《计算安全平台(CSP)
3.0.1.1
故
障管理(for 华为云Stack 8.1.0)》
>
故障处理
2

## Page 1367

服务 参考手册 参考章节
安全运营中心
(SOC)
《安全运营中心(SOC)
1.0.2.1
维护指南(for 华为云
Stack
8.1.0)》
《安全运营中心(SOC)
1.0.2.1
故
障管理(for 华为云Stack 8.1.0)》
>
故障处理
安全智能分析平
台服务（ISAP）
《安全智能分析平台(ISAP)
1.0.10.1
维护指南(for 华为
云Stack 8.1.0)》
《安全智能分析平台(ISAP)
1.0.10.1
故障管理(for 华为云
Stack
8.1.0)》
>
故障处理
数据安全中心
（DSC）
《数据安全中心(DSC)
1.1.1
维护指南(for 华为云Stack
8.1.0)》
《数据安全中心(DSC)
1.1.1
故障
管理(for 华为云Stack 8.1.0)》
>
故障处理
表2-35 数据库服务
服务 参考手册 参考章节
云数据库
（GaussDB(for
openGauss)）
《云数据库
GaussDB(for
openGauss) 2.6.7.210
维护
指南(for 华为云Stack
8.1.0)》
《云数据库
GaussDB(for
openGauss) 2.6.7.210
故障管理
(for
华为云Stack 8.1.0)》
>
故障
处理
数据复制服务
（DRS）
《数据复制服务(DRS)
2.6.7.210
维护指南(for 华
为云Stack 8.1.0)》
《数据复制服务(DRS)
2.6.7.210
故障管理(for 华为云Stack
8.1.0)》
>
故障处理
文档数据库服务
（DDS）
《文档数据库服务(DDS)
2.6.7.210
维护指南(for 华
为云Stack 8.1.0)》
《文档数据库服务(DDS)
2.6.7.210
故障管理(for 华为云
Stack
8.1.0)》
>
故障处理
云数据库
（RDS）
《云数据库(RDS)
2.6.7.200
维护指南(for 华为云Stack
8.1.0)》
《云数据库(RDS)
2.6.7.200
故障
管理(for 华为云Stack 8.1.0)》
>
故障处理
表2-36 应用服务
服务 参考手册 参考章节
应用与数据集成
平台（ROMA
Connect）
《应用与数据集成平台
(ROMA Connect) 1.7.1
维
护指南(for 华为云Stack
8.1.0)》
《应用与数据集成平台(ROMA
Connect) 1.7.1
故障管理(for 华为
云Stack 8.1.0)》
>
故障处理
分布式缓存服务
（DCS）
《分布式缓存服务(DCS)
1.7.1
维护指南(for 华为云
Stack
8.1.0)》
《分布式缓存服务(DCS)
1.7.1
故
障管理(for 华为云Stack 8.1.0)》
>
故障处理
2

## Page 1368

服务 参考手册 参考章节
应用管理与运维
平台
（ServiceStage
）
《应用管理与运维平台
(ServiceStage) 1.7.1
维护
指南(for 华为云Stack
8.1.0)》
《应用管理与运维平台
(ServiceStage) 1.7.1
故障管理
(for
华为云Stack 8.1.0)》
>
故障
处理
应用运维管理
（AOM）
云日志服务
（LTS）
《应用运维管理(AOM)
1.7.1
维护指南(for 华为云
Stack
8.1.0)》
《应用运维管理(AOM)
1.7.1
故
障管理(for 华为云Stack 8.1.0)》
>
故障处理
区块链服务
（BCS）
《区块链服务(BCS)
1.7.1
维
护指南(for 华为云Stack
8.1.0)》
《区块链服务(BCS)
1.7.1
故障管
理(for 华为云Stack 8.1.0)》
>
故
障处理
应用性能管理
(APM)
《应用性能管理(APM)
1.7.1
维护指南(for 华为云
Stack
8.1.0)》
《应用性能管理(APM)
1.7.1
故障
管理(for 华为云Stack 8.1.0)》
>
故障处理
表2-37 EI企业智能服务
服务 参考手册 参考章节
MapReduce服
务（MRS）
《MapReduce服务(MRS)
3.1.2-LTS
维护指南(for 华为
云Stack 8.1.0)》
《MapReduce服务(MRS)
3.1.2-
LTS
故障管理(for 华为云Stack
8.1.0)》
>
故障处理
数据仓库服务
（DWS）
《数据仓库服务(DWS)
8.1.1.5
维护指南(for 华为云
Stack
8.1.0)》
《数据仓库服务(DWS)
8.1.1.5
故
障管理(for 华为云Stack 8.1.0)》
>
故障处理
数据湖治理中心
（DGC）
《数据湖治理中心(DGC)
2.9.0.1
维护指南(for 华为云
Stack
8.1.0)》
《数据湖治理中心(DGC)
2.9.0.1
故障管理(for 华为云Stack
8.1.0)》
>
故障处理
ModelArts
《
ModelArts 3.3.0
维护指
南(for 华为云Stack
8.1.0)》
《ModelArts
3.3.0
故障管理(for
华为云Stack 8.1.0)》
>
故障处理
图引擎服务
（GES）
《图引擎服务(GES)
2.2.23
维护指南(for 华为云Stack
8.1.0)》
《图引擎服务(GES)
2.2.23
故障
管理(for 华为云Stack 8.1.0)》
>
故障处理
表2-38 物联网服务
服务 参考手册 参考章节
IoT设备接入
（IoTDA）
《IoT设备接入(IoTDA)
21.9.0
维护指南(for 华为云
Stack
8.1.0)》
《IoT设备接入(IoTDA)
21.9.0
故
障管理(for 华为云Stack 8.1.0)》
>
故障处理
2

## Page 1369

服务 参考手册 参考章节
IoT数据分析
（IoTA）
《IoT数据分析(IoTA)
21.9.0
维护指南(for 华为云
Stack
8.1.0)》
《IoT数据分析(IoTA)
21.9.0
故障
管理(for 华为云Stack 8.1.0)》
>
故障处理
路网数字化服务
（DRIS）
《路网数字化服务(DRIS)
21.9.0
维护指南(for 华为云
Stack
8.1.0)》
《路网数字化服务(DRIS)
21.9.0
故障管理(for 华为云Stack
8.1.0)》
>
故障处理
2

## Page 1370

3
常见问题
3.1
导入环境变量
系统在安装完成后，默认打开鉴权模式，在执行CPS及OpenStack命令前，需要先导入
环境变量才能操作。系统提供了导入环境变量的快捷脚本，可直接执行脚本即可。
前提条件
● 已完成FusionSphere OpenStack第一台主机的安装。
●
已通过root用户登录主机。
操作步骤
步骤1 执行以下命令，导入环境变量。
source set_env
回显如下类似信息：
please choose environment variable which you want to import:
(1) openstack environment variable (keystone v3)
(2) cps environment variable
(3) openstack environment variable legacy (keystone v2)
(4) openstack environment variable of cloud_admin (keystone v3)
please choose:[1|2|3|4]
步骤2 选择鉴权方式。
目前提供四种方式可供用户选择，使用内置DC管理员的Keystone V3鉴权、CPS鉴权、
Keystone
V2鉴权、使用内置云管理员的Keystone V3鉴权。请根据以下详细介绍按照
实际需求选择。
●
使用内置DC管理员的Keystone V3鉴权，输入“1”，按“Enter”，并按提示输
入“OS_USERNAME”的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
密码输入成功后如果有cps host-list和nova list命令的自动回显信息，则表示环
境变量导入成功。导入成功后系统使用内置DC管理员的Keystone V3鉴权。可以
正常执行CPS命令和OpenStack命令。
3

## Page 1371

在OpenStack的Mitaka版本中，Keystone命令行接口做了归一化处理，全部封装
为OpenStack命令。在Identity service注册为V3路径时，原Keystone命令行在执
行tenant/role/service相关命令时会存在兼容性问题。请优先使用Keystone V3鉴
权，并使用同等功能的openstack project/role/service命令。
●
使用CPS的鉴权，输入“2”，按“Enter”，并按提示输入“CPS_USERNAME”
的用户名和密码。
默认帐户：cps_admin
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“cps_admin”帐户对应的默认密码。
输入完成后如果有cps host-list命令的自动回显信息，则表示环境变量导入成功。
使用CPS鉴权导入环境变量后只能执行CPS相关命令，无法执行OpenStack命令，
所以回显信息会在执行完nova list后提示“ERROR...”。
在未完全部署完成FusionSphere OpenStack之前，OpenStack鉴权还未启用，或
Keystone鉴权异常时，可使用CPS鉴权。
●
使用Keystone V2鉴权，输入“3”，按“Enter”，并按提示输入
“OS_USERNAME”的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“dc_admin”帐户对应的默认密码。
密码输入成功后如果有cps host-list和nova list命令的自动回显信息，则表示环
境变量导入成功。导入成功后系统使用Keystone V2鉴权。可以正常执行CPS命令
和OpenStack命令。
●
使用内置云管理员帐号的Keystone V3鉴权，输入“4”，按“Enter”，并按提示
输入“cloud_admin”（内置的云管理员帐号）的密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（FusionSphere
OpenStack）”页签中，“cloud_admin”帐户对应的默认密码。
密码输入成功后如果有cps host-list和nova list命令的自动回显信息，则表示环
境变量导入成功。导入成功后系统使用内置云管理员帐号的Keystone V3鉴权。可
以正常执行CPS命令和OpenStack命令。
说明
●
在对接Service OM或ManageOne的情况下，请使用V3版本的鉴权方式。
●
如果执行的操作需要使用“cloud_admin”帐户权限（例如，使用PasswordManager命令
重置GaussDB数据库帐户密码），请使用内置云管理员帐号的OpenStack
Keystone
V3鉴
权。
●
如果导入环境变量时选择使用Keystone鉴权，但环境还未部署nova-api，将导致cps
host-
list回显成功，nova list回显异常，部署nova-api服务后即可正常使用nova相关命令。
步骤3 在多DC场景下，如果每个DC都部署了独立的glance，在每个DC导入环境变量时，还
需要执行以下命令，导入该DC的OS_IMAGE_URL。
export OS_IMAGE_URL=https://image.az.dc.domainname.com:443
az.dc.domainname.com:443为该DC中设置的glance域名。
----结束
3.2
使用
PuTTY
通过公私钥对认证方式登录节点
在系统经过SSH安全加固后，禁用了SSH通过口令认证的访问方式。本操作指导用户使
用PuTTY工具和认证所需的私钥，来登录待访问的节点。
3

## Page 1372

前提条件
●
待访问节点已完成SSH的安全加固，包括：
–
启用SSH通过公私钥对认证的方式，且节点已经配置好公钥证书。
–
已禁用SSH通过口令认证的方式。
●
已获取与公钥证书匹配的私钥证书。如果私钥证书为加密证书，还需要获取私钥
证书的密码。
默认的私钥证书获取方式如下：
访问http://support.huawei.com并登录，网页右上角搜索“FusionSphere默认
公私钥”，通过搜索结果中的第一个条目（FusionSphere 默认公私钥【文档】）
获取证书。
操作步骤
步骤1 在当前的本地PC上，是否已经使用PuTTY工具，通过公私钥对认证方式登录过待访问
的节点？
●
是，执行步骤7。
●
否或无法确定，执行步骤2。
步骤2 运行PuTTY工具，在主界面，输入待访问节点的IP地址和SSH端口号（默认为22）。
步骤3 在左侧“Category”区域选择“Connection
> SSH >
Auth”。
进入SSH的认证配置界面。
步骤4 单击“Browse”，在弹出窗口中选择已获取的私钥证书，单击“打开”。
私钥证书文件名为“*.ppk”。当前默认的私钥证书为从版本发布路径获取的
“id_rsa.ppk”。
配置后如下图所示。
3

## Page 1373

图3-1 配置私钥证书
步骤5 在左侧“Category”区域选择“Session”。
进入主界面。
步骤6 为方便后续多次访问，在“Saved Sessions”中自定义会话名称，单击“Save”保存
会话。
如下图所示。
3

## Page 1374

图3-2 保存会话
该步骤执行完成后，跳转至步骤8。
步骤7 选择已保存的会话，单击“Load”加载会话。
步骤8 单击“Open”开启会话。
步骤9 按要求输入访问节点的登录用户名，即可开始访问节点。
如果使用的私钥证书为加密证书，则还要按提示输入私钥证书的密码。
版本配套的默认私钥证书为加密证书。
默认密码：请参见《华为云Stack
8.1.0
证书一览表》的“FusionSphere OpenStack”
页签中，与子部件名称对应的证书的默认密码。
----结束
3.3
登录和注销
Service OM
界面
指导管理员登录Service OM，进行界面的相关操作。
前提条件
●
本地PC已设置所要求的分辨率。推荐使用的分辨率为1366*768、1440*900。为保
证较好的使用效果，建议横向分辨率不小于1280px。
●
已获取ManageOne运维面的IP地址。
●
已获取登录ManageOne运维面的用户名、密码。
3

## Page 1375

登录
Service OM
界面
步骤1 使用浏览器，登录ManageOne运维面。
●
登录地址：https://ManageOne运维面主页的访问地址:31943。例如，https://
oc.type.com:31943。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
进入ManageOne运维面的首页。
步骤2 在页面右下方的“常用链接”导航栏中，单击“Service OM”，选择区域后进入
Service
OM界面。
----结束
用户注销
在界面右上方，单击用户名，选择“退出”，即可退出当前用户登录，回到登录界
面。
3.4
登录
FusionSphere OpenStack
安装部署界面
（ManageOne 方式）
步骤1 使用浏览器，通过地址“https://ManageOne运维面主页的访问地址:31943”，登录
ManageOne运维面。
●
密码方式：输入帐号和密码。
–
默认帐号：admin
–
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（Portal）”
页签中，“ManageOne运维面”帐户对应的默认密码。
● USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 在页面右下方的“常用链接”导航栏中，单击“FusionSphere CPS”进入
FusionSphere
OpenStack安装部署界面。
----结束
3.5
使用
PuTTY
登录
FusionSphere OpenStack
节点
当需要在主机后台执行命令时，首先需要登录至相关节点，再执行命令。
本章节主要描述用户使用PuTTY工具登录FusionSphere OpenStack控制节点的通用操
作。
3

## Page 1376

操作步骤
步骤1 使用PuTTY，通过External OM平面IP地址登录OpenStack控制节点。
默认帐号：fsp。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
系统同时支持密码和公私钥对身份进行认证，如果使用公私钥对进行登录认证请参见
3.2
使用PuTTY通过公私钥对认证方式登录节点。
说明
External
OM平面IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导出
的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜索“参
数名称”为Reverse-Proxy的数据，获取对应的IP地址。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 导入环境变量，具体请参考3.1 导入环境变量。
----结束
3.6
使用
PuTTY
登录
Service OM
节点
当需要在主机后台执行命令时，首先需要登录至相关节点，再执行命令。
本章节主要描述用户使用PuTTY工具登录Service OM节点的通用操作。
操作步骤
登录Service OM主节点
步骤1 使用PuTTY，通过Service OM节点管理IP地址，登录Service OM主节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
说明
Service
OM节点管理IP地址的获取方式：请获取软件安装阶段HUAWEI
CLOUD Stack
Deploy导
出的参数信息汇总文件《xxx_export_all_v2_CN.xlsx》，并在“工具生成的IP参数”页签搜索
“参数名称”为OM-externalOM-Float-IP的数据，获取对应的IP地址。
步骤2 执行以下命令，并按提示输入“root”用户的密码，切换至“root”用户。
su - root
3

## Page 1377

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
----结束
登录Service OM备节点
步骤1 登录Service OM主节点。
步骤2 在Service OM主节点，执行以下命令，获取主备节点的IP地址。
QueryHaState
LOCAL_HOST=allinonefm0
LOCAL_STATE=active
LOCAL_IP=192.168.61.138
REMOTE_HOST=allinonefm1
REMOTE_STATE=standby
REMOTE_IP=192.168.61.165
步骤3 参考登录Service OM主节点，通过步骤2中的备节点IP地址，登录Service OM备节
点。
----结束
3.7
技术支持
华为技术有限公司为客户提供全方位的技术支持，用户如果在产品使用或维护过程
中，遇到难以确定或难以解决的问题，可以通过以下渠道自助获取信息服务：
●
华为云Stack信息中心：https://doc.hcs.huawei.com/hcs/
●
智能问答机器人：http://support.huawei.com/eirobot/
●
互动社区：https://forum.huawei.com/enterprise/zh/Index
若通过以上方式仍不能解决问题，用户可与就近的华为办事处联系，也可直接与公司
总部联系。
●
通过华为公司驻当地办事处的热线电话反馈。
●
通过网站中“联系我们”页面提供的求助方式反馈。
–
企业用户：http://support.huawei.com/enterprise
–
运营商用户：http://support.huawei.com
3.8
查找并处理主机或者虚拟机系统中的大文件
背景信息
当磁盘使用率过大，上报相关告警，需要清理无效文件，可参考本章节查找并处理主
机或虚拟机系统中的大文件。
3

## Page 1378

前提条件
●
需要排查的主机或者虚拟机的登录地址。
●
磁盘使用率过大的分区路径。
说明
从告警的详细信息可获取相关内容。
处理步骤
步骤1 使用“PuTTY”登录主机或者虚拟机的后台，并切换到root用户。
说明
不同系统的登录帐户和密码不一样，请根据实际情况使用对应主机或者虚拟机的登录信息。
步骤2 执行以下命令搜索系统中可能存在的大文件。
find /var/ -size +500M
说明
其中/var/为磁盘使用率过大的分区路径，+500M为搜索的文件大小，表示在/var/路径下搜索大
于500M的文件。建议搜索超过500M的文件，可以根据实际情况进行修改。
以系统上报《华为云Stack
8.1.0
故障管理》中“ALM-9215 系统磁盘使用率过大”告
警为例，如下图。
执行命令find
/opt/goku/data/ -size
+500M，回显信息如下，表示在/opt/goku/
data/upload/目录搜索到test01.zip~test06.zip 6个大文件。
[root@allinonefm0 fsp]# find /opt/goku/data/ -size +500M
/opt/goku/data/upload/test01.zip
/opt/goku/data/upload/test02.zip
/opt/goku/data/upload/test03.zip
/opt/goku/data/upload/test04.zip
/opt/goku/data/upload/test05.zip
/opt/goku/data/upload/test06.zip
[root@allinonefm0 fsp]#
步骤3 请与客户确认搜索到的大文件否为客户自己上传的文件。
●
是，用户可以自行处理，处理完毕。
●
否，请联系技术支持工程师协助解决。
----结束
3

## Page 1379

3.9
手动调整物理网络平面映射关系
使用FusionSphere OpenStack安装部署界面完成FusionSphere OpenStack安装部署
后，需要触发网络分组，并按规划配置其他网络平面。
说明
如果使用工具部署时，在LLD参数模板文件中配置了物理网络平面映射关系，且安装过程中网络
平面映射任务成功执行，则本章节操作可以跳过。
前提条件
●
已完成所有主机的安装。
●
已完成FusionSphere OpenStack的安装部署。
●
已登录FusionSphere OpenStack安装部署界面，具体操作请参见3.4 登录
FusionSphere
OpenStack安装部署界面（ManageOne方式）。
配置管理与业务网络平面
步骤1 创建新的物理网络。
根据环境部署阶段的网络规划，创建各节点使用的物理网络。
说明
●
管理网络和业务网络合并部署时，管理网络和业务网络共同使用系统默认创建的物理网络
physnet1，此时不需要创建新的物理网络。
●
管理网络和业务网络分离部署时，需要创建新的物理网络physnet2，physnet1添加管理网络
网卡，physnet2添加业务网络网卡。
图3-3 创建物理网络
1.
单击“配置
>
网络”。
3

## Page 1380

2.
单击“物理网络配置”下的 。
3.
设置新物理网络的参数。
表3-1 参数取值
参数名称 参数取值 参数说明
物理网络名称 根据网络规划填
写，例如
physnet2。
设置为physnet2即可。
用户也可自定义物理网络名称，名称
不区分大小写，新建的物理网络名称
不能和系统中已存在的物理网络名称
冲突。例如，servicenet1和
SERVICENET1名称会冲突。
起始VLAN 根据网络规划填
写。
起始VLAN：根据网络规划填写。
结束VLAN 根据网络规划填
写。
结束VLAN：根据网络规划填写。
说明
–
新建物理网络的VLAN范围可与已有物
理网络的VLAN范围重合，但要保证物
理网络包含的网卡前端不能二层互通。
–
外部网络使用的VLAN不能包含在物理
网络的VLAN范围内，新建物理网络的
VLAN范围包含业务平面使用的VLAN
即可。
例如起始VLAN配置为2，结束VLAN配
置为3500，外部网络规划使用3500以
上的VLAN值。
探测VLAN 根据网络规划填
写。
探测VLAN：在配置OpenStack的“配
置NOVA”界面开启“虚拟机HA功能
开关”的前提条件，用以确保虚拟机
无脑裂。KVM场景下虚拟机HA功能的
前置条件，用以确保虚拟机无脑裂。
如果需要开启虚拟机HA，一定需要提
前在每一个物理网络上规划探测
VLAN，且确保已在交换机上放通了此
VLAN，此VLAN在所有节点上可达。
如果业务上线后再规划探测VLAN，网
络配置变更成本太高，对业务运行影
响较大。
需确保配置的VLAN不在物理网络的
VLAN范围内。
探测VLAN未配置
不产生告警
根据网络规划填
写。
设置探测VLAN后，如果发生异常，系
统会上报告警，如果不想上报告警，
可以勾选“探测VLAN未配置不产生告
警”。
4.
单击“提交”。
3

## Page 1381

说明
–
可通过单击物理网络所在行的 删除新添加的物理网络。如果此网络中已运行有虚拟
机，删除后会影响虚拟机，请谨慎操作。但系统默认创建的“physnet1”网络不支持
删除。
–
可通过单击物理网络所在行的 修改物理网络的“起始VLAN”、“结束VLAN”或
者“探测VLAN”。
–
创建物理网络时，需要保证创建的物理网络至少绑定了一个网卡。
----结束
网口映射配置
创建物理网络后，必须映射主机的物理网口，才能正常提供网络通信。
系统根据主机网卡的PCI值对主机进行分组，网卡PCI值完全相同的主机划分为一个
组。按此原则，如果系统中主机为完全均质，即各主机网卡的PCI值完全相同时，系统
将所有主机划分为一个主机组。
3

## Page 1382

说明
界面中显示的物理网口的编号不是和主机实际的网口编号一一对应，如果需要查看对应关系，可
参考以下方式：
1.
使用PuTTY登录主机后执行ll /sys/class/net/命令获取网卡的PCI值，结合物理网口的网卡规
划，确定需要映射到物理网络的网卡PCI值。
显示如下类似信息：
例如：查询到的网卡eth6的pci值为0000:82:00.0。
2.
登录物理服务器所在的交换机，使用命令依次关闭服务器与交换机连接的端口，返回服务
器，使用命令ethtool
ethX
可查看断开的端口状态，确认服务器物理网卡与网卡PCI值的对
应关系。
断开前状态，显示如下类似信息：
断开后状态，显示如下类似信息：
3

## Page 1383

步骤1 采用自动分组方式划分主机组。
步骤2 针对每个主机组映射物理网卡到新创建的物理网络。
说明
下图中 为选定网卡绑定模式后的显示效果，实际选择过程中会显示其他绑定模式。
3

## Page 1384

●
将需要映射的物理网口对应的业务网络网卡拖拽进新建的物理网络physnet2
的下方区域框中。
实际操作时，先确定物理网络的网卡规划。“物理网口”区域选择显示网卡的NIC编
号，将确定的网卡拖拽到物理网络的下方区域框中。
说明
“物理网口”区域中显示系统中可配置为PCI直通的智能网卡，可配置PCI直通的智能网卡有特殊
标识，如 。PCI编号相同的网口标记的数字相同，且会同步操作。
●
选择网卡后设置网络映射的平面类型，选择“内核态OVS网桥”
●
对于“内核态OVS网桥”，可以支持网卡组成bond模式，并可以选择网卡
的绑定模式，请分别为管理组与计算组中的physnet2选择LACP模式（二层负载均
衡、fast）。
3

## Page 1385

表3-2 参数取值
参数名
称
参数取
值
参数说明
bond
模式
根据网
络规划
填写。
–
主备模式：绑定的对象为两个网口时，如需提高可靠
性，建议将绑定的网口配置为主备关系。主备模式速率
等同于单个网口的速率。
–
基于源MAC负载均衡：绑定的对象为两个或两个以上的
网口时，通过源MAC地址负载均衡算法，使绑定后的带
宽高于单个网口的带宽。绑定后的端口具备检测链路层
故障、自动切换故障链路的功能。
网卡绑定模式为基于源MAC负载均衡模式时，还需要在
网口连接的交换机上做端口汇聚配置，即将主机绑定的
网口在对端交换机上的端口配置到同一个Eth-trunk，并
将Eth-trunk设置为负载分担模式，流分担模式设置为根
据源MAC值进行流分担，否则会导致网络通信异常。
– LACP:
绑定的对象为两个或两个以上的网口时，通过
MAC或IP地址负载均衡算法，使绑定后的带宽高于单个
网口的带宽。同时使用LACP协议，使绑定后的端口具备
检测链路层故障、自动切换故障链路的功能。
网卡绑定模式为LACP模式时，还需要在网口连接的交换
机上做端口汇聚配置，即将主机绑定的网口在对端交换
机上的端口配置到同一个Eth-trunk，并在该Eth-trunk上
开启BPDU协议报文转发功能，否则会导致网络通信异
常。
选择LACP时，可支持以下两种负载均衡方式。
▪
二层负载均衡：通过源或目的MAC地址进行负荷分
担。
▪
三层负载均衡：通过源或目的IP地址或端口进行负荷
分担。该模式一般用于大部分网络流量跨三层网络的
场景。
选择LACP时，可支持以下两种内部协议报文的频率模
式。
▪
slow：LACP内部协议报文的频率为30s/次。
▪
fast：LACP内部协议报文的频率为1s/次。
●
单击 并在弹出的对话框中单击“确认”。
3

## Page 1386

须知
●
如果已经选择了映射类型，需要修改时有以下注意事项：
删除后重新增加网络映射，需要在重启主机后按照新创建映射类型的指导操作。但
是如果删除硬直通的映射，再重新增加硬直通的映射，删除后不用重启主机，只需
要在重新增加后重启一次主机即可。
●
已经添加了网卡并提交成功的网络平面不能再增加新的网卡或者修改网卡的虚拟网
口数量等配置，如果需要修改，可将已有的网卡删除后重新拖动添加网卡，等待约
一分钟后重启主机。
●
对于物理网络平面和平面类型，有以下约束：
–
不同主机组在使用同一物理网络平面时，物理网络平面对应的平面类型需要保
持一致。如果配置为不一致，可能会导致虚拟机迁移或虚拟机resize失败。
–
但是在以下情况下，可以存在同一物理网络平面在不同主机组配置为不同的平
面类型：
如果某一个物理网络平面在计算组的平面类型设置为EVS或SRIOV，同时需要
使用FusionSphere OpenStack为该网络平面上的虚拟机提供DHCP服务时，该
物理网络在控制组的平面类型可以设置为OVS。
----结束
配置存储网络平面（配置 Cinder）
步骤1 单击“配置
> OpenStack >
Cinder”，展开Cinder配置区域框。
步骤2 单击“配置存储网络平面”。
须知
●
管理存储使用IP SAN时，需要配置两个存储平面storage_data0、storage_data1；
使用FusionStorage Block时，只需要配置storage_data0这一个存储平面。
●
业务存储使用IP SAN时，需要配置两个存储平面storage_data2、storage_data3；
使用FusionStorage Block时，只需要配置storage_data2这一个存储平面。
●
业务存储对接FCSAN存储时，使用光纤连接，不用配置存储平面。
步骤3 参见步骤2中的内容，根据环境部署阶段的网络规划，删除默认的管理对应网卡，拖动
添加存储平面对应的网卡。
说明
●
已经添加了网卡并提交成功的网络平面不能再增加新的网卡，如果需要修改已有网络平面中
的网卡，可将已有的网卡删除后重新拖动添加。
●
配置用于对接Fusionstorage Block存储的网络平面时，两个网卡的bond模式必须配置为主备
模式。
●
工具部署时，系统会自动填写存储网络平面的相关网络参数，此处只需选择相应网卡到对应
平面即可。
●
注意根据网络规划区分管理存储平面与业务存储平面。
3

## Page 1387

步骤4 配置完成后在页面最下方单击“提交”。
----结束
配置
VXLAN
物理网络（配置 Nova）
步骤1 选择“配置
>
OpenStack”。
步骤2 单击“Nova”，展开Nova配置区域框。
步骤3 修改“VXLAN物理网络名称”，选择规划与Agile Controller-DCN对接的物理网络。
须知
● VXLAN所在物理网络默认为空。
●
在对接Agile Controller-DCN场景时，该物理网络必须与Agile Controller-DCN所在
物理网络保持一致。
步骤4 配置完成后在页面最下方单击“提交”。
----结束
3.10
如何清理
DNS
缓存
在配置对接外部DNS场景，涉及到修改外部DNS配置或外部DNS故障修复之后，需要
手动清除FusionSphere OpenStack系统DNS缓存，对应配置可立即生效。
前提条件
● FusionSphere
OpenStack系统功能正常。
● 外部DNS服务器配置正常。
操作步骤
步骤1 使用PuTTY，以Reverse-Proxy登录FusionSphere OpenStack控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
说明
通过反向IP地址登录时，需确保已在安装阶段正确配置了反向代理。如果没有配置反向代理，可
通过“172.28.0.2”的IP地址在安装使用的本地PC中登录第一个主机。
步骤2 执行以下命令并输入root密码，切换到root用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤3 执行以下命令，防止系统超时退出。
3

## Page 1388

TMOUT=0
步骤4 导入环境变量，选择鉴权方式为CPS鉴权，请参考3.1 导入环境变量。
步骤5 执行以下命令，清除FusionSphere OpenStack系统DNS缓存，保证最新的外部DNS服
务器配置生效。
cps host-template-instance-operate --service dns dns-server --action stop
cps host-template-instance-operate --service dns dns-server --action start
步骤6 执行以下命令，检测系统DNS解析功能是否正常。
nslookup az1.dc1.domainname.com
解析结果与外部DNS服务器配置一致，则表示DNS解析功能正常。
az1.dc1.domainname.com为配置在外部DNS服务器的域名。
●
是，结束。
●
否，联系技术支持工程师协助解决。
----结束
3.11
虚拟机状态异常
现象描述
租户虚拟机状态异常或虚拟机状态与电源状态不一致。
可能原因
●
对虚拟机进行的操作类型只有部分操作系统支持。
●
对虚拟机同时进行两种或以上操作，如同时进行挂载卷、卸载卷、挂载网卡、卸
载网卡与重建、迁移、修改规格中的任意两种操作。
●
对虚拟机进行操作过程中出现系统内部异常或网络异常。
处理步骤
当虚拟机异常状态为故障时，处理方法请参考《华为云Stack 8.1.0 故障管理》中的
“ALM-70102虚拟机ERROR状态告警”章节。
3.12
操作日志
ID
的获取方法
使用场景
当用户申请订单实施失败时，通过查找操作日志ID，在运维界面中根据查找的ID找到
对应的调用链ID，查找失败原因，发现故障点完成问题定界。
处理步骤
步骤1 使用浏览器，以VDC管理员登录ManageOne。
3

## Page 1389

非B2B场景登录地址：https://ManageOne运营面的访问地址。例如，https://
console.demo.com。
B2B场景登录地址：https://ManageOne租户面的访问地址。例如，https://
tenant.demo.com。
登录方式分为“密码认证”和“USB Key认证”。
●
密码认证：输入帐号和密码。
● USB
Key认证：插入已预置用户证书的USB Key，选择设备和用户证书，并输入
PIN码。
步骤2 单击界面右上方的用户名，在下拉框中单击“我的申请”。
步骤3 在“我的申请”界面中查看“订单状态”为“失败”的订单，记录“创建时间”和其
他信息。
步骤4 在左侧导航树中选择“我的日志”。
步骤5 在“我的日志”界面中单击“过去三个月”右侧的 ，选择“自定义操作时间”。
步骤6 在“自定义操作时间”界面中第一个时间选择框中选择订单创建时间（和步骤3中记录
的创建时间一致，精确到分钟即可），单击“确定”。
步骤7 在“自定义操作时间”界面单击“确定”。
步骤8 在“我的日志”界面右上方的输入框中输入资源名称，单击 查询操作日志。
步骤9 单击日志左侧 ，展开日志详情。
步骤10 确认日志详情中信息和步骤3中记录的信息匹配，并记录下此时的“操作日志ID”即为
运维面中所需的操作日志ID。
----结束
3.13
如何查找节点对应的
IP
地址
现象描述
定位服务故障时，已得知服务所在节点的节点名称，需要查看节点的管理IP地址。
处理步骤
以下介绍查找节点对应的管理IP地址的方法。
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”页
面。
步骤3 单击页面左上方 选择对应的产品。
3

## Page 1390

步骤4 在“节点名称”列查找待查询管理IP地址的节点。
步骤5 单击节点名称，进入节点详情页面。
步骤6 在节点详情页面左上方的“管理IP地址”即为该节点的IP地址。
----结束
3.14
如何查找数据库实例所在节点的
IP
地址和端口号
现象描述
定位数据库故障时，需要了解数据库实例所在节点的管理IP地址和端口号。
处理步骤
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”页
面。
步骤3 单击页面左上方 选择对应的产品。
步骤4 在左侧导航树中选择“中间件监控”。
步骤5 在“中间件监控”页面，查看数据库实例对应的节点名称和端口号。
●
若数据库实例为关系数据库，单击“关系数据库”页签，在关系数据库列表，查
看数据库实例对应的节点名称。该数据库实例对应的端口即为数据库实例的端口
号。
●
若数据库实例为Redis数据库，单击“Redis数据库”页签，在Redis数据库列表，
查看数据库实例对应的节点名称。该数据库实例对应的端口即为数据库实例的端
口号。
步骤6 单击节点名称，进入节点详情页面。
步骤7 在节点详情页面左上方的“管理IP地址”即为该数据库实例所在节点的IP地址。
----结束
3.15
如何查找服务所在节点的
IP
地址
现象描述
定位服务故障时，需要了解服务所在节点的管理IP地址。
3

## Page 1391

背景信息
一个服务可能对应一个或多个服务实例，一个服务实例包含一个或多个进程，各个进
程可能部署在相同或不同的节点上。以OTenantSecurity服务为例，介绍查找服务所在
节点的管理IP地址的方法。
处理步骤
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”页
面。
步骤3 在左侧导航树中选择“服务监控”。
步骤4 单击页面左上方 选择对应的产品。
步骤5 选择“服务”页签。
步骤6 在左上角的搜索框中输入“OTenantSecurity”，按“Enter”。
表格中显示当前产品中所有的“OTenantSecurity”服务实例。
步骤7 单击服务实例名称，进入“服务诊断”页面。
步骤8 在“服务诊断”页面下方选择“微服务”页签，单击微服务名称，进入微服务诊断页
面。
说明
如果有多个服务实例，请逐个单击查找。
步骤9 在页面下方选择“进程”页签，查看进程对应的节点名称。
步骤10 单击节点名称，进入节点详情页面。
步骤11 在节点详情页面左上方的“管理IP地址”即为该服务所在节点的IP地址。
----结束
3.16
判断节点的主备
使用场景
提供节点的主备判断方法。
处理步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录部署了OMMHA进程的节点。
说明
OMMHA节点IP地址的查询方法请参见3.15 如何查找服务所在节点的IP地址。
3

## Page 1392

步骤2 执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
步骤3 执行以下命令，查看节点的主备状况及资源状态。
●
部署节点：
cd /opt/oss/manager/apps/OMMHAService/bin
bash status.sh
●
非部署节点
cd /opt/oss/Product/apps/OMMHAService/bin
bash status.sh
系统回显如下类似信息，“HAActive”字段代表节点的主备状况，“active”代表主
节点，“standby”代表备节点。“HostName”字段代表节点的节点名称，可根据节
点名称获取该节点的IP地址，具体操作请参见3.15 如何查找服务所在节点的IP地址。
HAMode
double
NodeName HostName HAVersion
StartTime HAActive HAAllResOK HARunPhase
ha1 MOC-ManageOne-Service03 V100R001C01 2019-12-17
16:55:10 active normal Actived
ha2 MOC-ManageOne-Service04 V100R001C01 2019-12-20
01:13:59 standby normal Deactived
NodeName ResName ResStatus
ResHAStatus ResType
ha1 RMCritical Active_normal Normal
Active_standby
ha1 RMFloatIp Normal Normal
Single_active
ha1 RMIrNic Normal Normal
Double_active
ha1 SwitchStatus Normal Normal
Double_active
ha2 RMCritical Standby_normal Normal
Active_standby
ha2 RMFloatIp Stopped Normal
Single_active
ha2 RMIrNic Normal Normal
Double_active
ha2 SwitchStatus
----结束
3.17
启动部署面数据库
介绍如何通过命令方式启动部署面数据库。
操作步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录部署节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
3

## Page 1393

说明
●
请分别登录ManageOne-Deploy01、ManageOne-Deploy02节点执行相应操作。
●
获取部署节点的IP地址的方法请参见3.13 如何查找节点对应的IP地址。
步骤2 执行以下命令，切换至ossadm用户。
su - ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（ManageOne）”页签
中，在对应节点下该帐户的默认密码。
步骤3 执行以下命令，启动部署面数据库。
> source /opt/oss/manager/bin/engr_profile.sh
> ipmc_adm -cmd startdc -tenant manager
系统提示如下类似回显信息，所有进程都提示“success”，则说明部署面数据库启动
成功。否则请联系技术支持工程师协助解决。
============================ Starting data container processes...
Starting redis process woadapterrdb-1-14 ... success
...
Starting redis process serviceinspectionrdb-1-3 ... success
Starting redis process privilegerdb-1-28 ... success
============================ Starting data container processes is complete.
----结束
3.18
查询产品名称
通过数据库实例名称查询该数据库实例所属产品的名称。
操作步骤
步骤1 查询数据库实例所在的节点名称。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”
页面。
3.
单击页面左上方 选择ManageOne产品。
4.
在左侧导航树中选择“中间件监控”。
5.
选择“关系数据库”页签。
6.
在关系数据库列表查看数据库实例对应的“节点名称”。
步骤2 使用PuTTY工具以sopuser用户通过SSH方式登录部署节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
3

## Page 1394

说明
●
只需在主部署节点执行相应操作。
●
部署节点的查询方法请参见3.13 如何查找节点对应的IP地址，主备节点的判断请参见3.16
判断节点的主备。
步骤3 执行以下命令，切换至ossadm用户。
su - ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（ManageOne）”页签
中，在对应节点下该帐户的默认密码。
步骤4 执行以下命令，查看节点所属的产品名称。
cd /opt/oss/manager/etc/sysconf
cat nodelists.json
系统回显如下类似信息，“hostname”的值为步骤1中查询到的节点名称，
“assignedToTenancy”值为该节点所属产品名称，“assignedToStage”值为该节点
所属的Stage名称。
...
"azName": "mo-global-1-a",
"domainName": "",
"defaultStandby": false,
"hostname": "MOC-ManageOne-Tenant01",
"assignedToStage": "Product",
"isGlobal": false,
"state": 2,
"assignedToTenancy": "Product",
"IPAddresses": [
...
----结束
3.19
加密签名证书的私钥
更新证书需要使用已加密的签名证书私钥，如果用户获取的私钥未加密，请参考本章
节对私钥进行加密。
前提条件
●
已获取待加密的签名证书的私钥：signing_key.pem。
●
已获取登录需要加密文件服务所在节点的sopuser和ossuser用户的密码。
操作步骤
步骤1 使用FileZilla工具以sopuser用户通过SFTP方式登录需要加密文件服务所在节点，将
“signing_key.pem”文件上传至“/tmp”目录。
步骤2 使用PuTTY工具以sopuser用户通过SSH方式登录需要加密文件服务所在节点，获取服
务所在节点的IP地址的方法请参考3.15 如何查找服务所在节点的IP地址。
步骤3 执行如下命令，设置文件的权限。
chmod -R 640 /tmp/signing_key.pem
3

## Page 1395

步骤4 执行如下命令，切换到root用户。
sudo su root
步骤5 执行如下命令，复制文件。
cp /tmp/signing_key.pem /home/ossuser/signing_key.pem
步骤6 执行如下命令，修改文件属主和权限。
cd /home/ossuser
chown ossuser:ossgroup signing_key.pem
chmod 600 signing_key.pem
步骤7 执行如下命令，切换到ossuser用户。
su - ossuser
步骤8 执行如下命令，对私钥进行加密。
openssl rsa -in signing_key.pem -aes128 -out signing_key.pem
根据提示输入密码。
Enter PEM pass phrase:
signing_key.pem的密码
Verifying - Enter PEM pass phrase:
signing_key.pem的密码
说明
●
为了保证系统的通信安全，建议使用安全加密算法加密私钥。
●
新加密后的signing_key.pem文件，会覆盖“/home/ossuser”目录下未加密的
signing_key.pem文件。
步骤9 执行如下命令，切换root用户，删除临时文件。
sudo su root
cd /tmp
rm -rf signing_key.pem
步骤10 执行如下命令，退出root用户。
exit
----结束
3.20
恢复部署面
当部署面服务异常或数据库异常导致部署面无法正常访问时，可通过该功能恢复部署
面的应用程序、数据库应用程序和产品数据。
前提条件
●
已获取存储于备份服务器的部署面备份文件及其签名文件。
备份文件存储路径为“/备份服务器用户根目录/配置备份参数的路径/
management/management/时间戳/节点名称”。例如，备份服务器的登录用
户为ftpuser用户，该路径为“/home/ftpuser/backup/management/
management/20190729002834588/nodename”。
3

## Page 1396

部署面备份文件为“management.tar.gz”，对应签名文件为
“management.tar.gz.sign”。
备份文件中的数据签名密钥文件为“backupCommon.tar.gz”，对应签名文件为
“backupCommon.tar.gz.sign”。恢复部署面的应用程序和数据时，需要与部署
面备份文件放置在同一目录层级下。
●
已联系技术支持工程师获取对应版本的完整性校验工具包“BKSigntool-工具版本-
使用操作系统_系统类型_pkg.tar”至PC。
●
已获取待恢复部署节点的ossadm和sopuser用户的密码。
操作须知
● 对于异地容灾场景，若正在执行除冻结产品服务外的其他容灾相关任务，请待容
灾任务执行完成后再执行本节操作，避免恢复任务或者容灾任务失败。
●
恢复ManageOne-Deploy01和ManageOne-Deploy02节点数据库软件时，可能会
导致产品功能短暂不可用。
操作步骤
步骤1 根据部署面的部署模式及数据库类型，参见表3-3执行相关操作。
表3-3 场景分类
场景 操作
单个虚拟机故障。 在故障虚拟机上执行2～8。
部署虚拟机正常运行，需要恢复部署面
的应用程序和数据到某时间点。
不支持恢复部署面的应用程序和数据到
某时间点。
步骤2 使用FileZilla工具以sopuser用户通过SFTP方式将完整性校验工具包和部署面备份文件
及签名文件上传至故障虚拟机的“/tmp”目录。
●
BKSigntool-工具版本-使用操作系统_系统类型_pkg.tar：完整性校验工具包
●
management.tar.gz：部署面备份文件
●
management.tar.gz.sign：部署面备份文件的签名文件
●
backupCommon.tar.gz：数据签名密钥文件
●
backupCommon.tar.gz.sign：数据签名密钥文件的签名文件
步骤3 使用PuTTY工具以sopuser用户通过SSH方式登录故障虚拟机。
步骤4 执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
步骤5 执行以下命令，防止系统超时退出。
TMOUT=0
步骤6 恢复部署面的应用程序和数据，具体操作请参见表3-4。
3

## Page 1397

表3-4 恢复单个虚拟机的节点类型对应的操作
节点类型 执行如下命令
ManageOne-Deploy01或者
ManageOne-Deploy02节点
sudo /usr/local/uniepsudobin/
execute.sh
/tmp/BKSigntool-工具版本-使用
操作系统_系统类型_pkg.tar
/opt/
backupManagement
recoveryGaussManagement.sh /tmp/
management.tar.gz yes
ManageOne-Service04节点
sudo /usr/local/uniepsudobin/
execute.sh
/tmp/BKSigntool-工具版本-使用
操作系统_系统类型_pkg.tar
/opt/
backupManagement
recoveryGaussManagement.sh /tmp/
management.tar.gz
●
当系统回显类似如下信息时，表示需要输入数据签名密钥的保护密码，以校验备
份包。
Please enter the protect password:
默认密码：Changeme_123。
●
当系统回显类似如下信息时，表示部署面恢复成功，且数据库实例和部署面服务
也成功启动。
Management restored successfully.
●
当系统回显类似如下信息时，说明恢复过程中启动部署面服务失败。请先联系技
术支持工程师，查看部署面数据库实例的状态是否正常。
ERROR: Start management app service falied.
ERROR: Please check if the dbInstance status is ok, if its not ok, please recovery the dbInstance first,
and then try to start management.
ERROR: Restore management failure.
–
部署面数据库实例状态正常，说明部署面服务启动失败并不是由部署面数据
库实例状态异常所导致，请联系技术支持工程师协助解决。
–
部署面数据库实例状态异常，请先修复数据库，具体操作请参见2.5.5 数据库
故障，并手动启动部署面服务，具体操作请参见3.22 启动部署面服务。
●
当系统回显类似如下信息时，说明校验部署面备份文件失败，请联系技术支持工
程师协助解决。
ERROR: Verify /opt/backupManagement/management.tar.gz failed.
ERROR: Restore management failure.
●
当系统回显类似如下信息时，说明任务执行失败，请联系技术支持工程师协助解
决。
ERROR: Restore management failure.
步骤7 执行以下命令，退出ossadm用户。
exit
步骤8 执行以下命令，删除上传到临时目录的文件。
rm -f /tmp/management.tar.gz
rm -f /tmp/management.tar.gz.sign
3

## Page 1398

rm -f
/tmp/BKSigntool-工具版本-使用操作系统_系统类型_pkg.tar
----结束
3.21
共部署节点故障
本章节主要针对ManageOne-Deploy01、ManageOne-Deploy02和ManageOne-
Service04节点发生故障时，对其进行故障恢复。
3.21.1
单个共部署节点故障
介绍ManageOne-Deploy01、ManageOne-Deploy02和ManageOne-Service04节点
中，其中一个节点异常恢复方法。
操作步骤
步骤1 恢复部署面，请参见3.20 恢复部署面。
步骤2 恢复产品，请参见《华为云Stack
8.1.0
运维指南》中“恢复产品应用程序”章节。
----结束
3.21.2
多个共部署节点故障
现象描述
部署面使用的数据库为GaussDB 100，部署面无法正常访问。
可能原因
●
部署面服务或数据库异常。
●
多个部署节点同时故障。
处理步骤
步骤1 从备份服务器获取部署面对应节点的备份文件“management.tar.gz”及其签名文件
“management.tar.gz.sign”。
备份文件中的数据签名密钥文件为“backupCommon.tar.gz”，对应签名文件为
“backupCommon.tar.gz.sign”。恢复部署面的应用程序和数据时，需要与部署面备
份文件放置在同一目录层级下。
说明
备份文件存储路径为“/备份服务器用户根目录/配置备份参数的路径/management/
management/时间戳/节点名称”。例如，备份服务器的登录用户为ftpuser用户，该路径为
“/home/ftpuser/backup/management/management/20190729002834588/
ManageOne-Delpoy01”。
步骤2 联系技术支持工程师获取对应版本的完整性校验工具包“BKSigntool-工具版本-使用操
作系统_系统类型_pkg.tar”至PC。
步骤3 使用FileZilla工具以sopuser用户通过SFTP方式将完整性校验工具包和部署面备份文件
及签名文件上传至故障节点的“/tmp”目录。
3

## Page 1399

●
BKSigntool-工具版本-使用操作系统_系统类型_pkg.tar：完整性校验工具包
●
management.tar.gz：部署面备份文件
●
management.tar.gz.sign：部署面备份文件的签名文件
●
backupCommon.tar.gz：数据签名密钥文件
●
backupCommon.tar.gz.sign：数据签名密钥文件的签名文件
步骤4 停止部署面的数据库和服务。
1.
使用PuTTY工具以sopuser用户通过SSH方式依次登录ManageOne-Deploy01、
ManageOne-Deploy02、ManageOne-Service04节点。
2.
执行以下命令，切换到ossadm用户。
sudo su root
默认密码为：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，
在对应节点下该帐户的默认密码。
su - ossadm
3.
执行以下命令，停止部署面服务和数据库。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd stopmgr
系统提示如下类似回显信息，则说明部署面服务和数据库停止成功。如果停止失
败，执行步骤5。
...
============================ Stopping management processes is complete.
...
============================ Stopping management dc is complete
步骤5 分别在ManageOne-Deploy01、ManageOne-Deploy02、ManageOne-Service04这
三个节点执行以下操作，进行恢复前预处理。
1.
使用PuTTY工具以sopuser用户通过SSH方式依次登录ManageOne-Deploy01、
ManageOne-Deploy02、ManageOne-Service04节点。
2.
执行以下命令，切换到root用户。
sudo su root
默认密码为：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，
在对应节点下该帐户的默认密码。
3.
执行以下命令，进行恢复前预处理。
[ -d /var/share/oss/manager-bak ] || cp -a /var/share/oss/manager /var/
share/oss/manager-bak
rm -rf /var/share/oss/manager/{MCZKService/}
4.
执行以下命令，查询ossadm的进程。
ps -fww -uossadm --no-headers
–
若无系统回显，则执行步骤5.6。
–
若存在系统回显，则执行步骤5.5。
5.
执行以下命令停止ossadm进程。
ps -fww -uossadm --no-headers |awk '{print $2}'|xargs kill -9
说明
执行后使用ps -ef命令查询，确保已无ossadm用户启动的进程。
3

## Page 1400

6.
执行以下命令，查询dbuser的进程。
ps -fww -udbuser --no-headers
–
若无系统回显，则执行步骤6。
–
若存在系统回显，则执行步骤5.7。
7.
执行如下命令，停止ossadm进程。
ps -fww -udbuser --no-headers |awk '{print $2}'|xargs kill -9
说明
执行后使用ps -ef命令查询，确保已无dbuser用户启动的进程。
步骤6 查询部署面主备数据库实例所在节点。
● 若ManageOne-Deploy01和ManageOne-Deploy02节点均故障时，执行以下操
作。
a.
使用PuTTY工具以sopuser用户通过SSH方式登录ManageOne-Deploy01或者
ManageOne-Deploy02节点。
b. 执行以下命令查找“mgrdbInstanceName”的主数据库实例所在节点。
cd /tmp
zgrep --binary-files=text 'mgrdbInstanceName=managedbsvr'
management.tar.gz
▪
若系统回显如下类似信息，则表示该节点为“mgrdbInstanceName”的
主数据库实例所在节点。
mgrdbInstanceName=managedbsvr-0-999
▪
若系统没有回显信息，则表示该节点为“mgrdbInstanceName”的备数
据库实例所在节点。
●
若ManageOne-Deploy01或者ManageOne-Deploy02节点其中一个故障时，该故
障节点为“mgrdbInstanceName”的备数据库实例所在节点。
步骤7 执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
步骤8 执行如下命令，防止系统超时退出。
TMOUT=0
步骤9 恢复部署面的应用程序和数据。参考表1 不同故障节点操作命令。
表3-5 不同故障节点操作命令
故障节点 执行以下命令
“mgrdbInstanceName”的主数据库实例所在节
点
sudo /usr/local/uniepsudobin/
execute.sh
/tmp/BKSigntool-工具版本-使用操作
系统_系统类型_pkg.tar
/opt/
backupManagement
restoreManagement.sh /tmp/
management.tar.gz yes
3

## Page 1401

故障节点 执行以下命令
“mgrdbInstanceName”的备数据库实例所在节
点
sudo /usr/local/uniepsudobin/
execute.sh
/tmp/BKSigntool-工具版本-使用操作
系统_系统类型_pkg.tar
/opt/
backupManagement
recoveryGaussManagement.sh /tmp/
management.tar.gz yes
ManageOne-Service04节点
sudo /usr/local/uniepsudobin/
execute.sh
/tmp/BKSigntool-工具版本-使用操作
系统_系统类型_pkg.tar
/opt/
backupManagement
recoveryGaussManagement.sh /tmp/
management.tar.gz
1.
若部署面数据库所在ManageOne-Deploy01和ManageOne-Deploy02节点故障
时，有以下情况。
–
ManageOne-Deploy01和ManageOne-Deploy02都故障时
i.
执行表1 不同故障节点操作命令中“mgrdbInstanceName”的主数据库
实例所在节点的操作。
ii.
执行表1 不同故障节点操作命令中“mgrdbInstanceName”的备数据库
实例所在节点的操作。
–
单节点故障时
执行表1 不同故障节点操作命令中“mgrdbInstanceName”的备数据库实例
所在节点的操作。
2.
若部署面非数据库节点ManageOne-Service04故障时，执行表1 不同故障节点操
作命令中ManageOne-Service04节点的操作。
●
当系统回显类似如下信息时，表示需要输入数据签名密钥的保护密码，以校验备
份包。
Please enter the protect password:
默认密码：Changeme_123。
●
系统回显以下信息时，表示部署面恢复成功，且数据库实例和部署面服务也成功
启动。
Restore management successfully.
●
系统回显以下信息时，说明恢复过程中启动部署面服务失败。请先联系技术支持
工程师协助解决，查看部署面数据库实例的状态是否正常。
ERROR: Start management app service falied.
ERROR: Please check if the dbInstance status is ok, if its not ok, please recovery the dbInstance first,
and then try to start management.
ERROR: Restore management failure.
–
部署面数据库实例状态正常，说明部署面服务启动失败并不是由部署面数据
库实例状态异常所导致，请联系技术支持工程师协助解决。
–
部署面数据库实例状态异常，请先修复数据库，具体操作请参见2.5.5 数据库
故障，并手动启动部署面服务，具体操作请参见3.22 启动部署面服务。
●
系统回显类似如下信息，说明校验部署面备份文件失败，请联系技术支持工程师
协助解决。
ERROR: Verify /opt/backupManagement/management.tar.gz failed.
ERROR: Restore management failure.
3

## Page 1402

●
系统回显如下信息时，说明任务执行失败，请联系技术支持工程师协助解决。
ERROR: Restore management failure.
步骤10 执行以下命令，退出ossadm用户。
exit
步骤11 执行以下命令，删除上传到临时目录的文件。
rm -rf /tmp/management.tar.gz
rm -rf /tmp/management.tar.gz.sign
rm -rf
/tmp/BKSigntool-工具版本-使用操作系统_系统类型_pkg.tar
步骤12 检查产品数据库实例的“状态”。
1.
使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
2.
在部署面主菜单中选择“维护
>
运维管理
>
全景监控”。
3.
在页面左上方选择对应的产品。
4.
查看数据库实例运行状态。
在“关系数据库”或“Redis数据库”页签中检查数据库实例的“状态”是否为
“正在运行”。
–
是，执行步骤13。
–
否，请先修复数据库，具体操作请参见2.5.5 数据库故障。
步骤13 恢复产品的应用程序，具体操作请参见《华为云Stack
8.1.0
运维指南》中“恢复产品
应用程序”章节。
----结束
3.22
启动部署面服务
介绍如何通过命令方式重启部署面服务。
前提条件
已获取ManageOne-Deploy01和ManageOne-Deploy02节点的sopuser、root和
ossadm用户密码。
操作步骤
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录部署面备节点，即节点IP地址不包含
部署面浮动IP地址的节点。
步骤2 执行以下命令，切换到ossadm用户。
sudo su root
Password:root用户的密码
su - ossadm
3

## Page 1403

步骤3 执行以下命令，停止OMMHA服务。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd stopapp -tenant manager -app OMMHAService
系统提示如下类似回显信息，所有进程都提示“success”，则说明OMMHA服务停止
成功，否则请联系技术支持工程师协助解决。
Stopping process ommha-0-0 ... success
步骤4 执行以下命令，重启该节点所有服务。
ipmc_adm -cmd restartapp -tenant manager
系统提示如下类似回显信息，所有进程都提示“success”，则说明该节点所有服务重
启成功，否则请联系技术支持工程师协助解决。
...
Stopping process deployapp-0-0 ... success
Stopping process mczkapp-0-0 ... success
Stopping process etcd-0-0 ...success
...
Starting process deployapp-0-0 ... success
Starting process mczkapp-0-0 ...success
Starting process etcd-0-0 ... success
...
步骤5 使用PuTTY工具以sopuser用户通过SSH方式登录部署面主节点。
步骤6 执行以下命令，切换到ossadm用户。
sudo su root
Password:root用户的密码
su - ossadm
步骤7 执行以下命令，停止OMMHA服务。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd stopapp -tenant manager -app OMMHAService
系统提示如下类似回显信息，所有进程都提示“success”，则说明OMMHA服务停止
成功，否则请联系技术支持工程师协助解决。
Stopping process ommha-0-0 ... success
步骤8 执行以下命令，重启该节点所有服务。
ipmc_adm -cmd restartapp -tenant manager
系统提示如下类似回显信息，所有进程都提示“success”，则说明该节点所有服务重
启成功，否则请联系技术支持工程师协助解决。
...
Stopping process deployapp-0-0 ... success
Stopping process mczkapp-0-0 ... success
Stopping process etcd-0-0 ...success
...
Starting process deployapp-0-0 ... success
Starting process mczkapp-0-0 ...success
Starting process etcd-0-0 ... success
...
3

## Page 1404

步骤9 使用PuTTY工具以sopuser用户通过SSH方式登录其他部署节点。
步骤10 执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
步骤11 执行以下命令，重启所有服务。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd restartapp -tenant manager
系统提示如下类似回显信息，所有进程都提示“success”，则说明该节点所有服务重
启成功，否则请联系技术支持工程师协助解决。
...
Stopping process deployapp-0-0 ... success
Stopping process mczkapp-0-0 ... success
Stopping process etcd-0-0 ...success
...
Starting process deployapp-0-0 ... success
Starting process mczkapp-0-0 ...success
Starting process etcd-0-0 ... success
...
步骤12 使用PuTTY工具以sopuser用户通过SSH方式登录OMMHA主节点。
步骤13 执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
步骤14 执行以下命令，启动OMMHA服务。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd startapp -tenant manager -app OMMHAService
系统提示如下类似回显信息，所有进程都提示“success”，则说明OMMHA服务启动
成功，否则请联系技术支持工程师协助解决。
Starting process ommha-0-0 ... success
步骤15 使用PuTTY工具以sopuser用户通过SSH方式登录OMMHA备节点。
步骤16 执行以下命令，切换到ossadm用户。
su - ossadm
Password:ossadm用户的密码
步骤17 执行以下命令，启动OMMHA服务。
source /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd startapp -tenant manager -app OMMHAService
系统提示如下类似回显信息，所有进程都提示“success”，则说明OMMHA服务启动
成功，否则请联系技术支持工程师协助解决。
Starting process ommha-0-0 ... success
----结束
3

## Page 1405

3.23
启动产品数据库
介绍如何启动产品数据库。
操作步骤
步骤1 使用浏览器登录ManageOne部署面。
登录地址：https://ManageOne部署面浮动IP地址:31945。例如，https://
192.168.0.1:31945。
默认帐号：admin。
步骤2 在部署面主菜单中选择“维护
>
运维管理
>
全景监控”，默认进入“节点监控”页
面。
步骤3 单击页面左上方 选择ManageOne，参见表3-6完成相关操作。
表3-6 启动数据库
任务 操作指导
启动产品的所有数据库 在界面上方，单击“启动”，在下拉框中选择“启动
数据库”，按照界面指引完成相关操作。
启动单个节点的数据库 在“节点监控”页面，单击该节点所在行“操作”列
的 ，按照界面指引完成相关操作。
步骤4 任务执行成功后，在“节点列表”中查看节点的“数据库状态”为“正在运行”。
步骤5 对于异地容灾场景，设置产品为解冻状态，具体操作请参见《华为云Stack
8.1.0
运维
指南》中“冻结产品服务自动启动（华为云Stack场景）”章节。
----结束
3.24
取消与恢复
ServiceOM
基于
ManageOne
运维面的单
点登录
环境部署后，工具已默认配置ServiceOM基于ManageOne运维面的单点登录。如遇
ManageOne运维面故障，此时如需访问ServiceOM，可参见本章节取消单点登录配
置。ManageOne运维面故障恢复后，建议恢复单点登录。
前提条件
●
已完成ManageOne运维面的安装。
●
已获取ManageOne运维面主页的访问地址和端口号。
操作步骤
●
取消单点登录
3

## Page 1406

步骤1 使用PuTTY工具，以OM-externalOM-Float-IP登录ServiceOM主节点。
默认帐号：fsp。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
说明
ServiceOM节点管理IP地址在参数信息汇总文件中获取，在汇总文件的“2.1 工具生成的IP参
数”页签中查找“OM-externalOM-Float-IP”参数。
步骤2 执行以下命令，切换到root用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 执行以下命令，配置单点登录功能。
sh /opt/panda/manager/sosessionservice/install/3rd_sso.sh
显示如下回显信息：
This shell script config ocLogin sso.
Please input operate type [ set or restore ]:
步骤5 输入“restore”，按“Enter”。
步骤6 通过本地登录ServiceOM验证是否成功。
登录地址：https://Service OM的网络地址:端口号。例如，https://192.168.0.1:553。
默认帐号：admin。
----结束
● 恢复单点登录
步骤1 使用PuTTY工具，以OM-externalOM-Float-IP登录ServiceOM主节点。
默认帐号：fsp。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
说明
ServiceOM节点管理IP地址在参数信息汇总文件中获取，在汇总文件的“2.1 工具生成的IP参
数”页签中查找“OM-externalOM-Float-IP”参数。
步骤2 执行以下命令，切换到root用户。
su - root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
3

## Page 1407

步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 执行以下命令，配置单点登录功能。
sh /opt/panda/manager/sosessionservice/install/3rd_sso.sh
显示如下回显信息：
This shell script config ocLogin sso.
Please input operate type[ set or restore ]:
步骤5 输入“set”，按“Enter”。
步骤6 输入ManageOne运维面主页的访问地址，按“Enter”。
示例：oc.type3.com
显示如下回显信息：
Please input
sso port.
步骤7 输入ManageOne运维面的端口号，按“Enter”。
示例：31943
显示如下回显信息：
Please input International language('en_US' or 'zh_CN').
步骤8 输入ManageOne运维面SSO服务安装时设置的语言类型。
中文输入：
zh_CN
----结束
3.25
创建虚拟机
在ServiceOM界面，可创建各云服务的管理类虚拟机。在创建虚拟机前，需提前准备
好创建虚拟机所需要的虚拟机规格、镜像、虚拟网络、虚拟机组等信息。
背景信息
虚拟机运行在某个主机上，并从主机上获取所需的CPU、内存等计算资源，以及图形
处理器、网络连接和存储访问等能力。多台虚拟机可以同时运行在一台主机中。
前提条件
●
已获取ServiceOM的web地址以及用户密码。
●
已创建规格。
●
已上传和注册所需镜像。
●
已创建虚拟网络。
3

## Page 1408

操作步骤
步骤1 登录ServiceOM界面。
●
使用浏览器，通过本地方式登录ServiceOM界面。
登录地址：https://Service OM的网络地址:端口号。例如，https://
192.168.0.1:553。
默认帐号：admin。
●
通过ManageOne运维面首页的单点登录方式。
a.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地
址:31943”，登录ManageOne运维面。
▪
密码方式：输入帐号和密码。默认帐号“admin”。
▪
USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，
并输入PIN码。
b.
在运维面首页的常用链接区域单击ServiceOM，单击所需登录的区域，例
如：华北，跳转至ServiceOM界面。
说明
●
环境部署后，工具已默认配置ServiceOM基于ManageOne运维面的单点登录。
●
若单点登录失败，需取消ServiceOM的单点登录，通过本地方式登录ServiceOM界面，具体
操作请参见3.24 取消与恢复ServiceOM基于ManageOne运维面的单点登录。
步骤2 在主菜单中选择“服务列表
>
资源
>
计算资源”，进入“计算资源”页面。
步骤3 单击右上方的“创建虚拟机”。
步骤4 选择可用分区，具体配置操作请参见表3-7，配置完成后在右下方单击“下一步”，在
弹出的提示框中单击“确定”。
表3-7 选择可用分区的参数及说明
参数 说明 操作说明
项目 新建虚拟机所在的项
目。
-
可用分区 新建虚拟机的可用分
区。
选择：manage-az。
步骤5 选择所需镜像，单击镜像名称为“image-ManageOne-xxx”左侧的 ，选中该镜
像，在右下方单击“下一步”。
说明
xxx:表示最大版本号。
步骤6 选择虚拟机规格，具体配置操作请参见表3-8，配置完成后在右下方单击“下一步”。
3

## Page 1409

表3-8 选择虚拟机规格的参数及说明
参数 说明 操作说明
磁盘类型 新建虚拟机的磁盘类
型。包括：云磁盘和本
地磁盘。
选择：云硬盘。
系统盘 新建虚拟机的系统盘。 8（根据实际需要设置）。
选择规格 新建虚拟机的规格。
1.
在规格列表右上方的输入框中输入
故障虚拟机名称，单击 。
2.
单击规格名称左侧的 ，选中该规
格。
步骤7 选择存储，单击存储SLA名称 为“manager.fsa.csg”左侧的 ，选中该存储，在右下
方单击“下一步”。
步骤8 选择网络，具体配置操作请参见表3-9，在右下方单击“下一步”。
表3-9 选择网络的参数及说明
参数 说明 操作说明
端口类
型
新建虚拟机的端口类
型。
-
共享类
型
新建虚拟机的共享类
型。包括：非共享网
络和共享网络。
选择：非共享类型。
选择网
络
新建虚拟机的网络。
●
项目：选择“service”。
●
网络：选择“external_om”。
说明
– B2B场景下：
▪
ManageOne-Tenant和ManageOne-
SubRegion-Static虚拟机的网络平面为
“DMZ_Service”。
▪
其他的虚拟机网络平面都为
“external_om ”。
–
非B2B场景下：所有虚拟机的网络平面都为
“external_om ”。
3

## Page 1410

参数 说明 操作说明
IPv4子
网
是否指定新建虚拟机
所在的IPv4子网。选
择：指定。
子网：-
IP地址：根据实际情况设置。
浮动IP地址：-
说明
IP地址：
●
当单节点故障时，IP地址是故障虚拟机的IP地址。
● 当只有数据盘故障时，IP地址需要输入当前网段IP地
址。
安全组 新建虚拟机所在的安
全组。
选择：关闭。
步骤9 配置新建虚拟机的基本信息，具体配置操作请参见表3-10，配置完成后在右下方单击
“下一步”。
表3-10 基本信息的参数及说明
参数 说明 操作说明
虚拟机名称 新建虚拟机的名称。 根据界面提示输入。
主机 是否指定新建虚拟机所
在的主机。选择：指
定。
1.
在列表右上方的输入框中输入故障
虚拟机的主机ID，单击 。
2.
单击主机名称左侧的 ，选中该主
机。
虚拟机组 是否指定新建虚拟机的
虚拟机组。选择：不指
定。
-
附加信息 附加信息说明。
-
描述 相关描述说明。
-
步骤10 确认已配置的所有信息，单击“确认”。
步骤11 在弹出“确认”对话框，单击“确定”，进入任务中心页面。
步骤12 完成创建虚拟机任务。返回计算资源页面的虚拟机页签，当该虚拟机的状态为“运行
中”时表示虚拟机创建成功。
----结束
3.26
创建磁盘
您可在ServiceOM界面创建磁盘，并挂载至管理虚拟机供管理虚拟机使用。
3

## Page 1411

前提条件
已获取ServiceOM的web地址以及用户密码。
操作步骤
步骤1 登录ServiceOM界面。
●
使用浏览器，通过本地方式登录ServiceOM界面。
登录地址：https://Service OM的网络地址:端口号。例如，https://
192.168.0.1:553。
默认帐号：admin。
●
通过ManageOne运维面首页的单点登录方式。
a. 使用浏览器，通过地址“https://ManageOne运维面主页的访问地
址:31943”，登录ManageOne运维面。
▪
密码方式：输入帐号和密码。默认帐号“admin”。
▪
USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，
并输入PIN码。
b.
在运维面首页的常用链接区域单击ServiceOM，单击所需登录的区域，例
如：华北，跳转至ServiceOM界面。
说明
●
环境部署后，工具已默认配置ServiceOM基于ManageOne运维面的单点登录。
●
若单点登录失败，需取消ServiceOM的单点登录，通过本地方式登录ServiceOM界面，具体
操作请参见3.24 取消与恢复ServiceOM基于ManageOne运维面的单点登录。
步骤2 在主菜单中选择“服务列表
>
资源
>
存储资源”，进入“存储资源”页面。
步骤3 在左侧导航栏单击“存储资源
>
可用分区
>
磁盘”，进入“磁盘”页面。
步骤4 单击“创建磁盘”。在弹出的“创建磁盘”对话框中配置新建磁盘的基本信息，具体
配置操作请参见表3-11。
表3-11 创建磁盘参数说明
参数 说明 操作说明
名称 新建磁盘的名称。 根据界面提示输入。
项目 新建磁盘所在项目。
-
可用分区 新建磁盘的可用分区。
manage-az
容量 新建磁盘的容量。 输入故障虚拟机的磁盘容量。
磁盘类型 新建的磁盘类型。
manager.fsa.csg
步骤5 配置完成后，单击“确定”。弹出“提示”对话框，单击“确定”，进入任务中心页
面。
3

## Page 1412

步骤6 完成新建磁盘任务。返回磁盘页面，当该磁盘的状态为“可用”时表示磁盘创建成
功。
----结束
3.27
挂载磁盘
将已创建的磁盘挂载至管理虚拟机，供管理虚拟机使用。
前提条件
已获取ServiceOM的web地址以及用户密码。
操作步骤
步骤1 登录ServiceOM界面。
●
使用浏览器，通过本地方式登录ServiceOM界面。
登录地址：https://Service OM的网络地址:端口号。例如，https://
192.168.0.1:553。
默认帐号：admin。
●
通过ManageOne运维面首页的单点登录方式。
a.
使用浏览器，通过地址“https://ManageOne运维面主页的访问地
址:31943”，登录ManageOne运维面。
▪
密码方式：输入帐号和密码。默认帐号“admin”。
▪
USB
Key方式：插入已预置用户证书的USB Key，选择设备和用户证书，
并输入PIN码。
b.
在运维面首页的常用链接区域单击ServiceOM，单击所需登录的区域，例
如：华北，跳转至ServiceOM界面。
说明
● 环境部署后，工具已默认配置ServiceOM基于ManageOne运维面的单点登录。
●
若单点登录失败，需取消ServiceOM的单点登录，通过本地方式登录ServiceOM界面，具体
操作请参见3.24 取消与恢复ServiceOM基于ManageOne运维面的单点登录。
步骤2 在主菜单中选择“服务列表
>
资源
>
存储资源”，进入“存储资源”页面。
步骤3 在左侧导航栏单击“存储资源
>
可用分区
>
磁盘”，进入“磁盘”页面。
步骤4 在磁盘列表中查找到需要挂载至虚拟机的磁盘，单击该磁盘所在行的“更多
>
挂
载”。
步骤5 在弹出的“挂载”对话框中选中该磁盘要挂载的虚拟机，单击“确定”。弹出“提
示”对话框，单击“确定”，进入任务中心页面。
步骤6 完成挂载磁盘任务。返回磁盘页面，当该磁盘的状态为“正在使用”时表示挂载磁盘
成功。
----结束
3

## Page 1413

3.28
清理
IAM Redis
数据库缓存
背景介绍
●
IAM服务独立部署时部署在ManageOne-IAM01、ManageOne-IAM02、
ManageOne-IAM03三个节点。
●
IAM服务非独立部署时部署在ManageOne-Service03、ManageOne-Service04两
个节点。
●
数据库节点为ManageOne-DB01、ManageOne-DB02。
前提条件
已获取IAM服务所在节点的sopuser和root用户的密码。
操作步骤
清理iamcache redis数据库缓存
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录IAM服务任一节点。获取节点的IP地
址方法请参见3.13 如何查找节点对应的IP地址。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
步骤3 执行以下命令，查询iamcache redis数据库对应的master节点信息。
su ossadm -c '/opt/oss/manager/apps/DBAgent/bin/dbsvc_adm -cmd query-
db-instance -type redis| grep iamcachedb'
步骤4 使用PuTTY工具以sopuser用户通过SSH方式登录步骤3中查到的master服务后台节
点。
步骤5 执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
步骤6 执行以下命令，连接iamcache redis数据库。
/opt/redis/bin/redis-cli -cipherdir /opt/redis/etc/cipher/ -h
IP地址
-p
端口号
-a
iamcachedb@dbuser@iamcachedb数据库的用户密码
3

## Page 1414

说明
●
IP地址：为步骤3中查询到的master节点IP地址。
●
端口号：为步骤3中查询到的master节点端口号。
●
iamcachedb数据库的用户密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类
（ManageOne）”页签中，在该帐户对应的默认密码。
● 如果当前步骤执行失败，请查看/opt/redis/etc/cipher/目录下是否还有个“1”目录，如果
有，执行以下命令重试。
/opt/redis/bin/redis-cli -cipherdir /opt/redis/etc/cipher/1 -h
IP地址
-p
端口号
-a
iamcachedb@dbuser@iamcachedb数据库的用户密码
步骤7 执行以下命令，验证iamcache redis数据库是否连接成功。
keys *
若系统回显信息无报错，表示iamcache redis数据库连接成功，否则，请联系技术支持
工程师协助解决。
步骤8 执行以下命令，清理iamcache redis数据库缓存。
flushall
若系统回显信息中包含“OK”字样的信息时，表示清理缓存成功，继续执行步骤9清
理iamssodb redis数据库缓存。否则，请联系技术支持工程师协助解决。
清理iamssodb redis数据库缓存
步骤9 使用PuTTY工具以sopuser用户通过SSH方式登录IAM服务任一节点。获取节点的IP地
址方法请参见3.13 如何查找节点对应的IP地址。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤10 执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
步骤11 执行以下命令，查询iamssodb redis数据库对应的master节点信息。
su ossadm -c '/opt/oss/manager/apps/DBAgent/bin/dbsvc_adm -cmd query-
db-instance -type redis| grep iamssodb'
步骤12 使用PuTTY工具以sopuser用户通过SSH方式登录步骤11中查到的master服务后台节
点。
步骤13 执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
步骤14 执行以下命令，连接iamssodb redis数据库。
/opt/redis/bin/redis-cli -cipherdir /opt/redis/etc/cipher/ -h
IP地址
-p
端口号
-a
iamssodb@dbuser@iamssodb数据库的用户密码
3

## Page 1415

说明
●
IP地址：为步骤11中查询到的master节点IP地址。
●
端口号：为步骤11中查询到的master节点端口号。
●
iamssodb数据库的用户密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类
（ManageOne）”页签中，在该帐户对应的默认密码。
●
如果当前步骤执行失败，请查看/opt/redis/etc/cipher/目录下是否还有个“1”目录，如果
有，执行以下命令重试。
/opt/redis/bin/redis-cli -cipherdir /opt/redis/etc/cipher/1 -h
IP地址
-p
端口号
-a
iamssodb@dbuser@iamssodb数据库的用户密码
步骤15 执行以下命令，验证iamssodb redis数据库是否连接成功。
keys *
若系统回显信息无报错，表示iamssodb redis数据库连接成功，否则，请联系技术支持
工程师协助解决。
步骤16 执行以下命令，清理iamssodb redis数据库缓存。
flushall
若系统回显信息中包含“OK”字样的信息时，表示清理缓存成功，否则，请联系技术
支持工程师协助解决。
----结束
3.29
如何检查故障恢复后虚拟机进程的运行状态是否正常
故障恢复后，需检查虚拟机进程的运行状态。
操作步骤
步骤1 使用PuTTY工具，通过sopuser用户登录ManageOne-Deploy01节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换至ossadm用户。
su - ossadm
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（ManageOne）”页签
中，在对应节点下该帐户的默认密码。
步骤3 执行以下命令，检查进程状态。
. /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd statusapp
回显信息类似如下：
Process Name Process Type App Name Tenant Name Process Mode
IP PID Status
mohawiswebsite-3-0 mohawiswebsite MOHawisWebsite Product
cluster 192.168.33.25 11958 RUNNING
moresourcemgmtservice-3-0 moresourcemgmtservice MOResourceMgmtService Product
cluster 192.168.33.25 11901 RUNNING
3

## Page 1416

apimlb-3-0 apimlb APIMLBService Product critical
192.168.33.25 - STOPPED
. /opt/oss/manager/bin/engr_profile.sh
ipmc_adm -cmd statusbus
回显信息类似如下：
Process Name Process Type App Name Tenant Name Process Mode IP PID Status
ir-1-0 ir BusService Product multi 192.168.170.37 11822 RUNNING
er-1-0 er ERService Product critical 192.168.170.37 - STOPPED
说明
● App
Name列表示微服务名称。
●
Status列表示进程的运行状态：RUNNING为运行，STOPPED为停止。
查看所有进程的运行状态是否为“RUNNING”。
●
是，使用PuTTY工具，以sopuser用户登录ManageOne-Deploy02节点，并重复
执行步骤2~步骤3，检查ManageOne-Deploy02节点的进程状态。
●
否，请联系技术支持工程师协助解决。
说明
●
针对同一个微服务，如果“Process Mode”为“single”或“critical”，有且只有一个节点
的“Status”为“RUNNING”是正常的。如果“Process Mode”为“cluster”或
“multi”，所有节点的“Status”为“RUNNING”是正常的。
●
其余场景都是异常的，异常处理请联系技术支持工程师协助解决。
----结束
3.30
如何避免因停电等故障导致的虚拟机时间错误
现象描述
由于ManageOne的部署节点未配置外部NTP（Network
Time
Protocol）时钟源，当
出现停电等故障时，ManageOne的节点时间与当地时间不一致，虚拟机时间错误。
处理步骤
步骤1 使用PuTTY工具以sopuser用户登录ManageOne-Deploy01节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换至root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，编辑操作系统NTP服务配置文件。
vim /etc/chrony.conf
3

## Page 1417

步骤4 在配置文件最后一行添加需要的NTP时钟源。示例如下：
server
<NTP时钟源1的IP地址>
key 10001 iburst trust version 4
server
<NTP时钟源2的IP地址>
key 10001 iburst version 4
说明
回显信息中“trust”表示优先从<NTP时钟源1的IP地址>同步。
步骤5 按“Esc”，输入以下命令，保存退出。
:wq!
步骤6 执行以下命令，重启NTP服务。
systemctl restart chronyd
步骤7 执行以下命令，查看NTP服务运行状态。
chronyc -n sources
M S Name/IP address Stratum Poll Reach LastRx Last sample
===============================================================================
^ ? x.x.x.x 0 10 0 - +0ns[ +0ns] +/- 0ns
●
若系统回显信息中“S”的值为“*”，代表部署节点与上级NTP服务器间的网络
连接正常。
●
若系统回显信息中“S”的值为“?”，代表部署节点与上级NTP服务器间的网络
连接异常。
----结束
3.31
如何清理磁盘空间
现象描述
在登录系统、安装软件包等操作时，很容易出现操作失败的现象。
可能原因
系统长期运行而未进行过磁盘空间大小清理，导致磁盘空间不足。
处理步骤
须知
删除文件不可恢复，请谨慎选择以下操作。
步骤1 以sopuser用户通过SSH方式登录ManageOne-Deploy01节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换到root用户。
sudo su root
3

## Page 1418

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，确认各分区使用情况。
df -h
如果回显信息中的某个分区的使用率超过了80%，建议进行清理。
Filesystem Size Used Avail Use% Mounted on
/dev/xvda3 17G 2.5G 14G 16% /
devtmpfs 7.8G 152K 7.8G 1% /dev
tmpfs 7.8G 0 7.8G 0% /dev/shm
/dev/xvda1 1003M 50M 903M 6% /boot
/dev/xvda5 1003M 18M 935M 2% /home
/dev/xvda10 5.0G 915M 3.9G 19% /usr
/dev/xvda6 3.0G 176M 2.7G 7% /var
/dev/xvda7 5.0G 3.0G 1.7G 64% /var/log
/dev/xvda8 1003M 18M 935M 2% /var/log/audit
/dev/xvda9 1003M 18M 935M 2% /var/tmp
/dev/mapper/oss_vg-opt_vol 89G 76G 13G 85% /opt
/dev/mapper/oss_vg-optlog_vol 30G 178M 28G 1% /opt/log
步骤4 以清理“/opt”目录文件为例。执行以下命令，进入“/opt”目录，并使目录所占的空
间按照从大到小的顺序显示（单位：兆）。
cd /opt
du -sm * |sort -rn
从如下回显信息中可知pub目录占用空间最大，约12.5G。
12492 pub
5887 tools
2598 mysql
1092 oss
762 log
96 share
15 redis
1 sudobin2
1 lost+found
1 aquota.user
1 aquota.group
步骤5 执行以下命令，进入“pub”目录，并使目录所占空间按照从大到小的顺序显示（单
位：兆）。
cd pub
du -sm * |sort -rn
从如下回显信息中可知software目录占用空间最大。
12492 software
557 upload
1 manager
1 backup_local
步骤6 参考步骤5中的命令，进入“software”目录，找出占用空间较大并且不再使用的文
件。
步骤7 执行以下命令，删除文件。
rm -r xxx
3

## Page 1419

说明
xxx表示需要删除的文件。
步骤8 如果存在其他使用率超过80%的目录，请参考以上操作清理磁盘空间，否则请跳过本
步骤。
----结束
后续建议
定期检查并清理磁盘空间。
3.32
如何设置浮动
IP
地址
背景信息
安装业务前，由于业务特性要求可能需要在服务器上配置一个临时的浮动IP地址，而
该临时浮动IP地址在业务没有接管前，服务器操作系统被意外重启了，导致该临时浮
动IP地址失效而无法继续安装业务，此时需要在服务器上重新配置临时浮动IP地址。
前提条件
已获取服务器的浮动IP地址。
处理步骤
步骤1 使用PuTTY工具以sopuser用户登录服务器操作系统。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换到root用户。
sudo su root
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，配置服务器的浮动IP地址。
ifconfig eth0:0
<服务器的浮动IP地址>
步骤4 执行以下命令，查看浮动IP地址是否配置正确。
ifconfig eth0:0
----结束
3.33
如何检查
IP
地址冲突
现象描述
网络连接不稳定或者异常闪断的现象。
3

## Page 1420

处理步骤
以下以节点的IP地址为192.168.1.100，对应的网卡名称为eth0作为示例，请根据实际
情况替换。
步骤1 使用PuTTY工具以sopuser用户登录待检查的节点。
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换到root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，检查是否存在冲突的IP地址。
arping -D -I eth0 -c 2 192.168.1.100
●
如果回显如下类似信息，说明不存在冲突的IP地址。
ARPING 192.168.1.100 from 0.0.0.0 eth0
Sent 2 probes (2 broadcast(s))
Received 0 response (s)
●
如果回显如下类似信息，则存在冲突的IP地址。
ARPING 192.168.1.100 from 0.0.0.0 eth0
Unicast reply from 192.168.1.100 [20:0B:C7:A0:32:31] for 192.168.1.100 [20:0B:C7:A0:32:31] 0.810ms
Sent 1 probes (1 broadcast(s))
Received 1 response (s)
----结束
3.34
如何在异常下电后上电系统
现象描述
在服务器异常下电并且上电之后，需确保所有业务恢复正常运行。
说明
● 请确保虚拟机时间与当地时间一致。如果不一致，请参见3.30 如何避免因停电等故障导致的
虚拟机时间错误进行处理。
● 如果上电后导致虚拟机磁盘异常，请参见3.35 如何处理虚拟机异常上下电导致的磁盘异常进
行处理。
操作影响
服务部署系统具有随服务器操作系统上电自动启动服务机制，对于服务器上电顺序无
要求，系统上电后所有业务将自动恢复正常运行。
处理步骤
对所有服务器上电，上电无先后顺序要求。
3

## Page 1421

3.35
如何处理虚拟机异常上下电导致的磁盘异常
问题描述
一般是由于异常断电，常见为设备被强制关机/重启，存储突然断连等导致VM磁盘异
常。
现象说明
开机出现如下异常显示，则需要按照本文中操作步骤进行处理。
systemd-fsck[605]: /dev/sda2: UNEXPECTED INCONSISTENCY; RUN fsck MANUALLY.
systemd-fsck[605]: (i.e., without -a or -p options)
[ 13.652068] systemd-fsck[605]: fsck failed with error code 4.
Welcome to emergency mode. Use "systemctl default" or ^D to activate default mode.
Give root password for maintenance
(or type Control-D to continue):
操作步骤
步骤1 输入“root”帐号的密码进入emergency mode进行磁盘修复。
步骤2 根据系统提示，执行以下命令进行修复。
fsck -y
磁盘名
例如：损坏磁盘名为/dev/sdb2，则执行命令fsck
-y
/dev/sdb2。
须知
当存在如下提示，表示磁盘损坏。
fsck.ext4 /dev/sda2
e2fsck 1.42.7 (21-Jan-2013)
/dev/sda2 is mounted.
e2fsck: Cannot continue, aborting.
此时表示/dev/sda2是挂载状态不能被fsck修复，可以尝试执行命令mount
-on
remount,ro
/dev/sda2将磁盘设置为read only，再执行fsck /dev/sda2进行修复，修
复完成后输入exit即可恢复正常。
步骤3 确认EulerOS的“root”密码。
●
如果EulerOS忘记“root”密码，则执行步骤4。
●
如果密码已知，则执行步骤5。
步骤4 执行以下命令，恢复“root”密码。
1.
在“grub”选项菜单按e进入编辑模式，输入grub帐户“root”及默认密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类（ManageOne）”
页签中，在该帐户的默认密码。
2.
在“linux16 /boot/vmlinuz-****”行末尾增加“init=/bin/bash”（不含引号）。
3.
在键盘上同时按下“ctrl”和“x”，启动到shell，进入单用户模式。
4.
执行以下命令，挂载文件系统为可写模式。
3

## Page 1422

mount -no remount,rw /
5.
执行passwd命令，并按照提示修改“root”帐号的密码。
须知
如果之前系统启用了selinux，必须运行以下命令，否则将无法正常启动系统：
touch /.autorelabel
运行命令exec /sbin/init来正常启动，或者用命令exec /sbin/reboot进入单用户
后，可执行以下命令，对所有“/etc/fstab”里的文件进行检查：
mount -no remount,ro /
umount -a
/usr/sbin/fsck -AsCy
exit
步骤5 如果以上方法均无效，可尝试进入emergency mode后直接执行命令systemctl
default进入系统。
进入系统后，执行命令dmesg|grep
-i
error检查启动日志，查看相关错误日志是否存
在，如果依旧存在，极有可能是存储异常，请联系技术支持工程师协助解决。
----结束
3.36
如何处理虚拟机下电
MessagingBrokeService
服务重
启后
Kafka
异常
现象描述
节点下电MessagingBrokeService服务重启后，kafka异常。
处理步骤
步骤1 执行如下步骤，依次登录ManageOne-Service01、ManageOne-Service02、
ManageOne-Service03节点，CSHA场景下需要登录ManageOne-Service04节点。
1.
使用sopuser用户登录MessagingBrokeService服务所在节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在
对应节点下该帐户的默认密码。
2.
执行以下命令，切换至root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在
对应节点下该帐户的默认密码。
3.
执行以下命令，检查MessagingBrokeService服务的运行状态。
su ossadm -c ". /opt/oss/manager/bin/engr_profile.sh; ipmc_adm -cmd
statusapp -app MessagingBrokeService"
显示如下信息：
msgbrksrv-2-0 msgbrksrv MessagingBrokeService Product cluster 192.168.191.125 11006 RUNNING
3

## Page 1423

说明
RUNNING表示运行状态正常，STOPPED表示运行状态异常。
步骤2 执行以下命令，停止MessagingBrokeService服务，依次遍历所有服务状态正常的节
点。
su ossadm -c ". /opt/oss/manager/bin/engr_profile.sh; ipmc_adm -cmd
stopapp -app MessagingBrokeService"
步骤3 执行以下命令，修改MessagingBrokeService服务配置文件，依次遍历所有节点。
sed -i 's/unclean.leader.election.enable=false/
unclean.leader.election.enable=true/g' /opt/oss/Product/apps/
MessagingBrokeService/kafka/bin/GenerateConfig/Kafka/server.properties
步骤4 执行以下命令，按照先异常后正常的顺序，启动MessagingBrokeService服务，依次遍
历所有节点。
su ossadm -c ". /opt/oss/manager/bin/engr_profile.sh; ipmc_adm -cmd
startapp -app MessagingBrokeService"
说明
按照步骤1中查询到的状态顺序启动，启动过程中必须一个节点启动完成后再启动另一个节点。
步骤5 执行以下命令，检查MessagingBrokeService服务状态是否正常。
su ossadm -c ". /opt/oss/manager/bin/engr_profile.sh; ipmc_adm -cmd
statusapp -app MessagingBrokeService"
●
是，等所有服务正常启动后，执行以下命令，修改MessagingBrokeService服务配
置文件。
sed -i 's/unclean.leader.election.enable=true/
unclean.leader.election.enable=false/g' /opt/oss/Product/apps/
MessagingBrokeService/kafka/bin/GenerateConfig/Kafka/
server.properties
●
否，请联系技术支持工程师协助解决。
步骤6 执行以下命令，停止MessagingBrokeService服务，依次遍历所有节点。
su ossadm -c ". /opt/oss/manager/bin/engr_profile.sh; ipmc_adm -cmd
stopapp -app MessagingBrokeService"
步骤7 执行以下命令，启动MessagingBrokeService服务，依次遍历所有节点。
su ossadm -c ". /opt/oss/manager/bin/engr_profile.sh; ipmc_adm -cmd
startapp -app MessagingBrokeService"
步骤8 执行以下命令，退出root用户。
exit
----结束
3.37
如何下载日志
当定位操作系统故障或者数据库故障时，通过命令的方式下载日志到本地。
3

## Page 1424

采集操作系统日志
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录待查询节点，获取节点的IP地址请参
见3.13 如何查找节点对应的IP地址。
步骤2 执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
步骤3 执行以下命令，创建日志临时存放目录。以下操作以目录“log_info”为例，请根据实
际情况替换。
mkdir /tmp/log_info
步骤4 执行以下命令，修改日志存放目录的权限。
chmod 750 /tmp/log_info
步骤5 执行以下命令，将操作系统日志复制到临时目录下并设置属组和权限，并退出至
sopuser用户。
cp /var/log/messages /tmp/log_info
chmod 640 /tmp/log_info/messages
chown -R sopuser:wheel /tmp/log_info
exit
步骤6 使用FileZilla工具以sopuser用户通过SFTP方式将“ /tmp/log_info”目录下的操作系
统日志文件下载至本地PC的任意路径。
步骤7 日志下载成功后，需删除临时目录。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录步骤1中的节点。
2.
执行以下命令，删除临时目录。
cd /tmp
rm -rf log_info
----结束
采集
Redis
数据库日志
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录数据库所在节点，获取数据库所在节
点的IP地址请参见3.14 如何查找数据库实例所在节点的IP地址和端口号。
步骤2 执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
步骤3 执行以下命令，创建日志临时存放目录。以下操作以目录“log_info”为例，请根据实
际情况替换。
mkdir /tmp/log_info
步骤4 执行以下命令，修改日志临时存放目录的权限。
chmod 750 /tmp/log_info
3

## Page 1425

步骤5 执行以下命令，将数据库日志复制到临时目录下并设置属组和权限。
cp
/opt/redis/data/数据库实例名称/数据库实例名-login.log
/tmp/log_info
chmod 640
/tmp/log_info/数据库实例名-login.log
chown -R sopuser:wheel /tmp/log_info
exit
步骤6 使用FileZilla工具以sopuser用户通过SFTP方式将“ /tmp/log_info”目录下的操作系
统日志文件下载至本地PC的任意路径。
步骤7 日志下载成功后，需删除临时目录。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录数据库所在节点。
2.
执行以下命令，删除临时目录。
cd /tmp
rm -rf log_info
----结束
采集
GaussDB 100
数据库日志
步骤1 使用PuTTY工具以sopuser用户通过SSH方式登录数据库所在节点，获取数据库所在节
点的IP地址请参见3.14 如何查找数据库实例所在节点的IP地址和端口号。
步骤2 执行以下命令，切换至root用户。
sudo su root
Password:root用户的密码
步骤3 执行以下命令，创建日志临时存放目录。以下操作以目录“log_info”为例，请根据实
际情况替换。
mkdir /tmp/log_info
步骤4 执行以下命令，修改日志临时存放目录的权限。
chmod 750 /tmp/log_info
步骤5 执行以下命令，将数据库日志复制到临时目录下并设置属组和权限。
cp -a
/opt/zenith/data/数据库实例名称/log/audit
/tmp/log_info
chmod 750 /tmp/log_info/audit
chmod 640 /tmp/log_info/audit/*
chown -R sopuser:wheel /tmp/log_info
exit
步骤6 使用FileZilla工具以sopuser用户通过SFTP方式将“/tmp/log_info”目录下的操作系
统日志文件下载至本地PC的任意路径。
步骤7 日志下载成功后，需删除临时目录。
1.
使用PuTTY工具以sopuser用户通过SSH方式登录数据库所在节点。
2.
执行以下命令，需删除临时目录。
3

## Page 1426

cd /tmp
rm -rf log_info
----结束
3.38
如何设置
ManageOne
虚拟机规格
ManageOne所部属的虚拟机，根据管理规模不同，虚拟机规格不同。
●
不支持查看100000VM管理规模和Global独立部署场景的虚拟机规格列表。
●
不同类型的虚拟机规格不同，同一类型的虚拟机规格相同，例如：ManageOne-
Service01、ManageOne-Service02节点在不同管理规模下虚拟机规格相同。
●
ManageOne虚拟机资源ARM规格请参考表3-12。
●
ManageOne虚拟机资源X86规格请参考表3-13。
注意
ManageOne管理多个从Region管理区时，这里管理规模指的是“ManageOne所
要管理的所有从Region管理区管理规模之和”。
表3-12 ManageOne虚拟机资源ARM规格列表
档
位
节点名 虚
拟
机
（
个
）
v
C
P
U
（
个
）
M
E
M
（
G
B
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
50
P
M/
50
0V
M
ManageOne-
Deploy01~02
2 6 1
4
8 70 80
必选
ManageOne-
Service01~04
4 6 2
2
8 130 20
0
必选
ManageOne-
DB01~02
2 4 1
4
8 200 20
0
必选
ManageOne-
Tenant01~02
2 2 6 8 30 30
必选
ManageOne-
LogCenter01~02
2 4 8 8 300 15
0
统一日志组件，华
为云Stack场景必选
ManageOne-
MOPortal01~02
2 2 6 8 30 20
可选组件，默认不
安装，客户可选安
装
3

## Page 1427

档
位
节点名 虚
拟
机
（
个
）
v
C
P
U
（
个
）
M
E
M
（
G
B
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
vAPP01~02
2 2 4 8 80 30
可选组件，默认不
安装，客户可选安
装，6.3.X升级场景
数据盘为72G
ManageOne-
AutoOps01~02
2 4 6 8 60 10
0
可选组件，默认不
安装，客户可选安
装，部署于Global
Public-Service区
ManageOne-
APS-Global-
DMZ-Proxy01~02
2 2 4 8 60 80
可选组件，默认不
安装，客户可选安
装，Global的DMZ
ManageOne-
APS-Region-
DMZ-Proxy01~02
2 2 4 8 60 80
可选组件，默认不
安装，客户可选安
装，部署于各从
Region管理区的
DMZ区
ManageOne-
AgentServer01~0
2
2 4 4 8 100 50
必选
统一Agent控制节点
ManageOne-
CloudMarket01~
02
2 2 6 8 40 30
可选
混合云市场，依赖
混合云
ManageOne-ES
（仅高可用场
景）
1 4 8 8 60 -
CSHA场景额外新增
节点
ManageOne-Arb
（仅高可用场
景）
1 4 8 50 - -
CSHA场景额外新增
节点
ManageOne-
SubRegion-
Static01~02
2 2 4 40 100 50
必选
10
0P
M/
10
00
V
M
ManageOne-
Deploy01~02
2 6 1
4
8 70 80
必选
ManageOne-
Service01~04
4 6 2
4
8 200 20
0
必选
3

## Page 1428

档
位
节点名 虚
拟
机
（
个
）
v
C
P
U
（
个
）
M
E
M
（
G
B
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
DB01~02
2 6 1
6
8 200 20
0
必选
ManageOne-
Tenant01~02
2 2 6 8 30 30
必选
ManageOne-
LogCenter01~02
2 4 8 8 300 15
0
统一日志组件，华
为云Stack场景必选
ManageOne-
MOPortal01~02
2 2 6 8 30 20
可选组件，默认不
安装，客户可选安
装
ManageOne-
vAPP01~02
2 2 4 8 80 30
可选组件，默认不
安装，客户可选安
装，6.3.X升级场景
数据盘为72G
ManageOne-
AutoOps01~02
2 4 6 8 60 10
0
可选组件，默认不
安装，客户可选安
装，部署于Global
Public-Service区
ManageOne-
APS-Global-
DMZ-Proxy01~02
2 2 4 8 60 80
可选组件，默认不
安装，客户可选安
装，Global的DMZ
ManageOne-
APS-Region-
DMZ-Proxy01~02
2 2 4 8 60 80
可选组件，默认不
安装，客户可选安
装，部署于各从
Region管理区的
DMZ区
ManageOne-
AgentServer01~0
2
2 4 4 8 100 50
必选
统一Agent控制节点
ManageOne-
CloudMarket01~
02
2 2 8 8 40 50
可选
混合云市场，依赖
混合云
ManageOne-ES
（仅高可用场
景）
1 4 8 8 80 -
CSHA场景额外新增
节点
3

## Page 1429

档
位
节点名 虚
拟
机
（
个
）
v
C
P
U
（
个
）
M
E
M
（
G
B
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-Arb
（仅高可用场
景）
1 4 8 50 - -
CSHA场景额外新增
节点
ManageOne-
SubRegion-
Static01~02
2 2 4 40 100 50
必选
20
0P
M/
20
00
V
M
ManageOne-
Deploy01~02
2 6 1
4
8 70 12
0
必选
ManageOne-
Service01~04
4 6 2
8
8 260 30
0
必选
ManageOne-
DB01~02
2 6 2
0
8 300 30
0
必选
ManageOne-
Tenant01~02
2 4 8 8 30 30
必选
ManageOne-
LogCenter01~02
2 6 1
6
8 300 20
0
统一日志组件，华
为云Stack场景必选
ManageOne-
MOPortal01~02
2 4 8 8 30 20
可选组件，默认不
安装，客户可选安
装
ManageOne-
vAPP01~02
2 2 4 8 80 30
可选组件，默认不
安装，客户可选安
装，6.3.X升级场景
数据盘为72G
ManageOne-
AutoOps01~02
2 6 1
0
8 80 10
0
可选组件，默认不
安装，客户可选安
装，部署于Global
Public-Service区
ManageOne-
APS-Global-
DMZ-Proxy01~02
2 4 8 8 60 10
0
可选组件，默认不
安装，客户可选安
装，Global的DMZ
ManageOne-
APS-Region-
DMZ-Proxy01~02
2 4 8 8 60 10
0
可选组件，默认不
安装，客户可选安
装，部署于各从
Region管理区的
DMZ区
3

## Page 1430

档
位
节点名 虚
拟
机
（
个
）
v
C
P
U
（
个
）
M
E
M
（
G
B
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
AgentServer01~0
2
2 8 8 8 200 50
必选
统一Agent控制节点
ManageOne-
CloudMarket01~
02
2 2 8 8 40 50
可选
混合云市场，依赖
混合云
ManageOne-ES
（仅高可用场
景）
1 4 1
2
8 160 -
CSHA场景额外新增
节点
ManageOne-Arb
（仅高可用场
景）
1 4 8 50 - -
CSHA场景额外新增
节点
ManageOne-
SubRegion-
Static01~02
2 2 4 40 100 50
必选
50
0P
M/
50
00
V
M
ManageOne-
Deploy01~02
2 6 1
4
8 70 15
0
必选
ManageOne-
Service01~04
4 1
0
4
8
8 500 50
0
必选
ManageOne-
DB01~02
2 8 2
4
8 600 60
0
必选
ManageOne-
Tenant01~02
2 4 8 8 30 50
必选
ManageOne-
LogCenter01~02
2 8 3
2
8 600 40
0
统一日志组件，华
为云Stack场景必选
ManageOne-
MOPortal01~02
2 4 8 8 30 20
可选组件，默认不
安装，客户可选安
装
ManageOne-
vAPP01~02
2 4 6 8 100 50
可选组件，默认不
安装，客户可选安
装，6.3.X升级场景
数据盘为92G
ManageOne-
AutoOps01~02
2 8 1
6
8 80 10
0
可选组件，默认不
安装，客户可选安
装，部署于Global
Public-Service区
3

## Page 1431

档
位
节点名 虚
拟
机
（
个
）
v
C
P
U
（
个
）
M
E
M
（
G
B
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
APS-Global-
DMZ-Proxy01~02
2 8 1
6
8 80 10
0
可选组件，默认不
安装，客户可选安
装，Global的DMZ
ManageOne-
APS-Region-
DMZ-Proxy01~02
2 8 1
6
8 80 10
0
可选组件，默认不
安装，客户可选安
装，部署于各从
Region管理区的
DMZ区
ManageOne-
AgentServer01~0
2
2 8 1
6
8 200 50
必选
统一Agent控制节
点，标准和高阶规
格一致
ManageOne-
CloudMarket01~
02
2 4 1
0
8 60 50
可选
混合云市场，依赖
混合云
ManageOne-ES
（仅高可用场
景）
1 6 1
8
8 300 -
CSHA场景额外新增
节点
ManageOne-Arb
（仅高可用场
景）
1 4 8 50 - -
CSHA场景额外新增
节点
ManageOne-
SubRegion-
Static01~02
2 4 8 40 100 50
必选
10
00
P
M/
10
00
0V
M
ManageOne-
Deploy01~02
2 6 1
4
8 70 15
0
必选
ManageOne-
Service01~04
4 1
2
6
4
8 100
0
60
0
必选
ManageOne-
DB01~02
2 8 4
8
8 100
0
60
0
必选
ManageOne-
Tenant01~02
2 4 8 8 30 50
必选
ManageOne-
LogCenter01~03
3 1
6
3
2
8 100
0
50
0
统一日志组件，华
为云Stack场景必选
3

## Page 1432

档
位
节点名 虚
拟
机
（
个
）
v
C
P
U
（
个
）
M
E
M
（
G
B
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
MOPortal01~02
2 4 8 8 30 20
可选组件，默认不
安装，客户可选安
装
ManageOne-
vAPP01~02
2 6 8 8 120 60
可选组件，默认不
安装，客户可选安
装，6.3.X升级场景
数据盘为112G
ManageOne-
AutoOps01~02
2 1
6
3
2
8 120 20
0
可选组件，默认不
安装，客户可选安
装，部署于Global
Public-Service区
ManageOne-
APS-Global-
DMZ-Proxy01~02
2 1
6
3
2
8 100 10
0
可选组件，默认不
安装，客户可选安
装，Global的DMZ
ManageOne-
APS-Region-
DMZ-Proxy01~02
2 1
6
3
2
8 100 10
0
可选组件，默认不
安装，客户可选安
装，部署于各从
Region管理区的
DMZ区
ManageOne-
AgentServer01~0
2
2 1
6
3
2
8 300 10
0
必选
统一Agent控制节
点，标准和高阶规
格一致
ManageOne-
CloudMarket01~
02
2 6 1
0
8 80 50
可选
混合云市场，依赖
混合云
ManageOne-ES
（仅高可用场
景）
1 8 2
4
8 600 -
CSHA场景额外新增
节点
ManageOne-
LogCenter04（仅
高可用场景）
1 1
6
3
2
8 100
0
-
CSHA场景额外新增
节点
ManageOne-Arb
（仅高可用场
景）
1 4 8 50 - -
CSHA场景额外新增
节点
3

## Page 1433

档
位
节点名 虚
拟
机
（
个
）
v
C
P
U
（
个
）
M
E
M
（
G
B
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
SubRegion-
Static01~02
2 4 8 40 100 50
必选
30
00
P
M/
30
00
0V
M
ManageOne-
Deploy01~02
2 6 1
4
8 70 30
0
必选
ManageOne-
Service01~02
2 2
4
9
6
8 500 30
0
必选
扩容至3W规模的数
据盘大小为1000G，
安装3W规模场景下
为500G
ManageOne-
Service03~04
2 1
6
6
4
8 500 30
0
必选
扩容至3W规模的数
据盘大小为1000G，
安装3W规模场景下
为500G
ManageOne-
ES01~03
3 1
2
3
2
8 200
0
50
0
必选
ManageOne-
DB01~02
2 1
6
6
4
8 200
0
80
0
必选
ManageOne-
Tenant01~02
2 8 1
6
8 30 50
租户Console节点，
部署租户面的
website
ManageOne-
LogCenter01~05
5 1
6
3
2
8 220
0
60
0
统一日志组件，华
为云Stack场景必选
ManageOne-
MOPortal01~02
2 4 8 8 30 50
可选组件，默认不
安装，客户可选安
装
ManageOne-
vAPP01~02
2 6 8 8 120 60
可选组件，默认不
安装，客户可选安
装，6.3.X升级场景
数据盘为112G
ManageOne-
AutoOps01~02
2 1
6
3
2
8 120 30
0
可选组件，默认不
安装，客户可选安
装，部署于Global
Public-Service区
3

## Page 1434

档
位
节点名 虚
拟
机
（
个
）
v
C
P
U
（
个
）
M
E
M
（
G
B
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
APS-Global-
DMZ-Proxy01~02
2 1
6
3
2
8 100 10
0
可选组件，默认不
安装，客户可选安
装，Global的DMZ
ManageOne-
APS-Region-
DMZ-Proxy01~02
2 1
6
3
2
8 100 10
0
可选组件，默认不
安装，客户可选安
装，部署于各从
Region管理区的
DMZ区
ManageOne-
AgentServer01~0
2
2 1
6
3
2
8 300 10
0
必选
统一Agent控制节
点，标准和高阶场
景同一个规格
ManageOne-
CloudMarket01~
02
2 8 1
0
8 80 50
可选
混合云市场，依赖
混合云
ManageOne-ES
（仅高可用场
景）
1 1
2
3
2
8 200
0
-
CSHA场景额外新增
节点
ManageOne-
LogCenter04（仅
高可用场景）
1 1
6
3
2
8 220
0
-
CSHA场景额外新增
节点
ManageOne-Arb
（仅高可用场
景）
1 4 8 50 - -
CSHA场景额外新增
节点
ManageOne-
SubRegion-
Static01~02
2 4 8 40 100 50
必选
3

## Page 1435

表3-13 ManageOne虚拟机资源X86规格列表
档
位
节点名 虚
拟
机
（
个
）
vC
PU
（
个
）
ME
M
（
GB
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
50
P
M/
50
0V
M
ManageOne-
Deploy01~02
2 4 14 8 70 80
必选
ManageOne-
Service01~04
4 6 22 8 13
0
20
0
必选
ManageOne-
DB01~02
2 4 14 8 20
0
20
0
必选
ManageOne-
Tenant01~02
2 2 6 8 30 30
必选
ManageOne-
LogCenter01~02
2 4 8 8 30
0
15
0
统一日志组
件，华为云
Stack场景必选
ManageOne-
MOPortal01~02
2 2 6 8 30 20
可选组件，默
认不安装，客
户可选安装
ManageOne-
vAPP01~02
2 2 4 8 80 30
可选组件，默
认不安装，客
户可选安装，
6.3.X升级场景
数据盘为72G
ManageOne-
AutoOps01~02
2 4 6 8 60 10
0
可选组件，默
认不安装，客
户可选安装，
部署于Global
Public-Service
区
ManageOne-APS-
Global-DMZ-
Proxy01~02
2 2 4 8 60 80
可选组件，默
认不安装，客
户可选安装，
Global的DMZ
ManageOne-APS-
Region-DMZ-
Proxy01~02
2 2 4 8 60 80
可选组件，默
认不安装，客
户可选安装，
部署于各从
Region管理区
的DMZ区
3

## Page 1436

档
位
节点名 虚
拟
机
（
个
）
vC
PU
（
个
）
ME
M
（
GB
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
AgentServer01~02
2 2 4 8 10
0
50
必选
统一Agent控
制节点
ManageOne-
CloudMarket01~02
2 2 6 8 40 30
可选
混合云市场，
依赖混合云
ManageOne-ES
（仅高可用场景）
1 4 8 8 60 -
CSHA场景额外
新增节点
ManageOne-Arb
（仅高可用场景）
1 4 8 50 - -
CSHA场景额外
新增节点
ManageOne-
SubRegion-
Static01~02
2 2 4 40 10
0
50
必选
10
0P
M/
10
00
V
M
ManageOne-
Deploy01~02
2 4 14 8 70 80
必选
ManageOne-
Service01~04
4 6 24 8 20
0
20
0
必选
ManageOne-
DB01~02
2 6 16 8 20
0
20
0
必选
ManageOne-
Tenant01~02
2 2 6 8 30 30
必选
ManageOne-
LogCenter01~02
2 4 8 8 30
0
15
0
统一日志组
件，华为云
Stack场景必选
ManageOne-
MOPortal01~02
2 2 6 8 30 20
可选组件，默
认不安装，客
户可选安装
ManageOne-
vAPP01~02
2 2 4 8 80 30
可选组件，默
认不安装，客
户可选安装，
6.3.X升级场景
数据盘为72G
3

## Page 1437

档
位
节点名 虚
拟
机
（
个
）
vC
PU
（
个
）
ME
M
（
GB
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
AutoOps01~02
2 4 6 8 60 10
0
可选组件，默
认不安装，客
户可选安装，
部署于Global
Public-Service
区
ManageOne-APS-
Global-DMZ-
Proxy01~02
2 2 4 8 60 80
可选组件，默
认不安装，客
户可选安装，
Global的DMZ
ManageOne-APS-
Region-DMZ-
Proxy01~02
2 2 4 8 60 80
可选组件，默
认不安装，客
户可选安装，
部署于各从
Region管理区
的DMZ区
ManageOne-
AgentServer01~02
2 2 4 8 10
0
50
必选
统一Agent控
制节点
ManageOne-
CloudMarket01~02
2 2 8 8 40 50
可选
混合云市场，
依赖混合云
ManageOne-ES
（仅高可用场景）
1 4 8 8 80 -
CSHA场景额外
新增节点
ManageOne-Arb
（仅高可用场景）
1 4 8 50 - -
CSHA场景额外
新增节点
ManageOne-
SubRegion-
Static01~02
2 2 4 40 10
0
50
必选
20
0P
M/
20
00
V
M
ManageOne-
Deploy01~02
2 4 14 8 70 12
0
必选
ManageOne-
Service01~04
4 6 28 8 26
0
30
0
必选
ManageOne-
DB01~02
2 6 20 8 30
0
30
0
必选
ManageOne-
Tenant01~02
2 4 8 8 30 30
必选
3

## Page 1438

档
位
节点名 虚
拟
机
（
个
）
vC
PU
（
个
）
ME
M
（
GB
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
LogCenter01~02
2 6 16 8 30
0
20
0
统一日志组
件，华为云
Stack场景必选
ManageOne-
MOPortal01~02
2 4 8 8 30 20
可选组件，默
认不安装，客
户可选安装
ManageOne-
vAPP01~02
2 2 4 8 80 30
可选组件，默
认不安装，客
户可选安装，
6.3.X升级场景
数据盘为72G
ManageOne-
AutoOps01~02
2 6 10 8 80 10
0
可选组件，默
认不安装，客
户可选安装，
部署于Global
Public-Service
区
ManageOne-APS-
Global-DMZ-
Proxy01~02
2 4 8 8 60 10
0
可选组件，默
认不安装，客
户可选安装，
Global的DMZ
ManageOne-APS-
Region-DMZ-
Proxy01~02
2 4 8 8 60 10
0
可选组件，默
认不安装，客
户可选安装，
部署于各从
Region管理区
的DMZ区
ManageOne-
AgentServer01~02
2 4 8 8 20
0
50
必选
统一Agent控
制节点
ManageOne-
CloudMarket01~02
2 2 8 8 40 50
可选
混合云市场，
依赖混合云
ManageOne-ES
（仅高可用场景）
1 4 12 8 16
0
-
CSHA场景额外
新增节点
ManageOne-Arb
（仅高可用场景）
1 4 8 50 - -
CSHA场景额外
新增节点
3

## Page 1439

档
位
节点名 虚
拟
机
（
个
）
vC
PU
（
个
）
ME
M
（
GB
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
SubRegion-
Static01~02
2 2 4 40 10
0
50
必选
50
0P
M/
50
00
V
M
ManageOne-
Deploy01~02
2 4 14 8 70 15
0
必选
ManageOne-
Service01~04
4 10 48 8 50
0
50
0
必选
ManageOne-
DB01~02
2 8 24 8 60
0
60
0
必选
ManageOne-
Tenant01~02
2 4 8 8 30 50
必选
ManageOne-
LogCenter01~02
2 8 32 8 60
0
40
0
统一日志组
件，华为云
Stack场景必选
ManageOne-
MOPortal01~02
2 4 8 8 30 20
可选组件，默
认不安装，客
户可选安装
ManageOne-
vAPP01~02
2 4 6 8 10
0
50
可选组件，默
认不安装，客
户可选安装，
6.3.X升级场景
数据盘为92G
ManageOne-
AutoOps01~02
2 8 16 8 80 10
0
可选组件，默
认不安装，客
户可选安装，
部署于Global
Public-Service
区
ManageOne-APS-
Global-DMZ-
Proxy01~02
2 8 16 8 80 10
0
可选组件，默
认不安装，客
户可选安装，
Global的DMZ
ManageOne-APS-
Region-DMZ-
Proxy01~02
2 4 8 8 60 10
0
可选组件，默
认不安装，客
户可选安装，
部署于各从
Region管理区
的DMZ区
3

## Page 1440

档
位
节点名 虚
拟
机
（
个
）
vC
PU
（
个
）
ME
M
（
GB
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
AgentServer01~02
2 8 16 8 20
0
50
必选
统一Agent控
制节点
ManageOne-
CloudMarket01~02
2 4 10 8 60 50
可选
混合云市场，
依赖混合云
ManageOne-ES
（仅高可用场景）
1 6 18 8 30
0
-
CSHA场景额外
新增节点
ManageOne-Arb
（仅高可用场景）
1 4 8 50 - -
CSHA场景额外
新增节点
ManageOne-
SubRegion-
Static01~02
2 2 4 40 10
0
50
必选
10
00
P
M/
10
00
0V
M
ManageOne-
Deploy01~02
2 4 14 8 70 15
0
必选
ManageOne-
Service01~04
4 12 64 8 10
00
60
0
必选
ManageOne-
DB01~02
2 8 48 8 10
00
60
0
必选
ManageOne-
Tenant01~02
2 4 8 8 30 50
必选
ManageOne-
LogCenter01~03
3 16 32 8 10
00
50
0
统一日志组
件，华为云
Stack场景必选
ManageOne-
MOPortal01~02
2 4 8 8 30 20
可选组件，默
认不安装，客
户可选安装
ManageOne-
vAPP01~02
2 6 8 8 12
0
60
可选组件，默
认不安装，客
户可选安装，
6.3.X升级场景
数据盘为112G
3

## Page 1441

档
位
节点名 虚
拟
机
（
个
）
vC
PU
（
个
）
ME
M
（
GB
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-
AutoOps01~02
2 16 32 8 12
0
20
0
可选组件，默
认不安装，客
户可选安装，
部署于Global
Public-Service
区
ManageOne-APS-
Global-DMZ-
Proxy01~02
2 16 32 8 10
0
10
0
可选组件，默
认不安装，客
户可选安装，
Global的DMZ
ManageOne-APS-
Region-DMZ-
Proxy01~02
2 4 8 8 60 10
0
可选组件，默
认不安装，客
户可选安装，
部署于各从
Region管理区
的DMZ区
ManageOne-
AgentServer01~02
2 16 32 8 30
0
10
0
必选
统一Agent控
制节点
ManageOne-
CloudMarket01~02
2 6 10 8 80 50
可选
混合云市场，
依赖混合云
ManageOne-ES
（仅高可用场景）
1 8 24 8 60
0
-
CSHA场景额外
新增节点
ManageOne-
LogCenter04（仅高
可用场景）
1 16 32 8 10
00
-
CSHA场景额外
新增节点
ManageOne-Arb
（仅高可用场景）
1 4 8 50 - -
CSHA场景额外
新增节点
ManageOne-
SubRegion-
Static01~02
2 4 8 40 10
0
50
必选
3

## Page 1442

档
位
节点名 虚
拟
机
（
个
）
vC
PU
（
个
）
ME
M
（
GB
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
30
00
P
M/
30
00
0V
M
ManageOne-
Deploy01~02
2 4 14 8 70 30
0
必选
ManageOne-
Service01~02
2 24 96 8 50
0
30
0
必选
扩容至3W规模
的数据盘大小
为1000G，安
装3W规模场景
下为500G
ManageOne-
Service03~04
2 16 64 8 50
0
30
0
必选
扩容至3W规模
的数据盘大小
为1000G，安
装3W规模场景
下为500G
ManageOne-
ES01~03
3 12 32 8 20
00
50
0
必选
ManageOne-
DB01~02
2 16 64 8 20
00
80
0
必选
ManageOne-
Tenant01~02
2 8 16 8 30 50
租户Console节
点，部署租户
面的website
ManageOne-
LogCenter01~05
5 16 32 8 22
00
60
0
统一日志组
件，华为云
Stack场景必选
ManageOne-
MOPortal01~02
2 4 8 8 30 50
可选组件，默
认不安装，客
户可选安装
ManageOne-
vAPP01~02
2 6 8 8 12
0
60
可选组件，默
认不安装，客
户可选安装，
6.3.X升级场景
数据盘为112G
ManageOne-
AutoOps01~02
2 16 32 8 12
0
30
0
可选组件，默
认不安装，客
户可选安装，
部署于Global
Public-Service
区
3

## Page 1443

档
位
节点名 虚
拟
机
（
个
）
vC
PU
（
个
）
ME
M
（
GB
）
系
统
盘
（
GB
）
数
据
盘
（
GB
）
IO
PS
备注
ManageOne-APS-
Global-DMZ-
Proxy01~02
2 16 32 8 10
0
10
0
可选组件，默
认不安装，客
户可选安装，
Global的DMZ
ManageOne-APS-
Region-DMZ-
Proxy01~02
2 16 32 8 10
0
10
0
可选组件，默
认不安装，客
户可选安装，
部署于各从
Region管理区
的DMZ区
ManageOne-
AgentServer01~02
2 16 32 8 30
0
10
0
必选
统一Agent控
制节点，标准
和高阶场景同
一个规格
ManageOne-
CloudMarket01~02
2 8 10 8 80 50
可选
混合云市场，
依赖混合云
ManageOne-ES
（仅高可用场景）
1 12 32 8 20
00
-
CSHA场景额外
新增节点
ManageOne-
LogCenter05（仅高
可用场景）
1 16 32 8 22
00
-
CSHA场景额外
新增节点
ManageOne-Arb
（仅高可用场景）
1 4 8 50 - -
CSHA场景额外
新增节点
ManageOne-
SubRegion-
Static01~02
2 4 8 40 10
0
50
必选
3.39
如何恢复
ManageOne-SubRegion-Static
虚拟机的产
品
现象描述
当ManageOne-SubRegion-Static01或者ManageOne-SubRegion-Static02虚拟机出现
故障无法使用时，或者该虚拟机被删除的情况下，参见此章节恢复故障的虚拟机。
3

## Page 1444

前提条件
已获取对应版本的ManageOne静态虚拟机软件包“MOConsoleFrameworkService-
StaticServer-*.zip”至本地PC。
●
运营商用户：点此前往。
●
企业用户：点此前往。
软件包数字签名文件
为了防止软件包在传递过程或存储期间被恶意篡改，下载软件包时需下载对应的数字
签名文件用于完整性验证。
在软件包下载之后，请参考《OpenPGP签名验证指南》，对从Support网站下载的软
件包进行PGP数字签名校验。如果校验失败，请不要使用该软件包，先联系华为技术
支持工程师解决。
使用软件包安装/升级之前，也需要按上述过程先验证软件包的数字签名，确保软件包
未被篡改。
运营商客户请访问：https://support.huawei.com/carrier/digitalSignatureAction
企业客户请访问：https://support.huawei.com/enterprise/zh/tool/pgp-verify-
TL1000000054
操作步骤
步骤1 通过PuTTY工具以sopuser用户登录新建虚拟机。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤2 执行以下命令，切换至root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，防止系统超时退出。
TMOUT=0
步骤4 执行以下命令，创建用户及用户组。
/usr/sbin/groupadd ossgroup
/usr/sbin/useradd ossuser -m -d /home/ossuser -g ossgroup
rm -rf /home/ossuser/.bash*
cp /etc/skel/.bash_logout /home/ossuser
cp /etc/skel/.bash_profile /home/ossuser
cp /etc/skel/.bashrc /home/ossuser
echo "Changeme_123" | passwd --stdin ossuser
chown -R ossuser:ossgroup /home/ossuser
3

## Page 1445

步骤5 上传ManageOne静态虚拟机软件包“MOConsoleFrameworkService-StaticServer-
*.zip”至对应节点的/tmp目录下。
步骤6 执行以下命令，创建业务目录并拷贝ManageOne静态虚拟机软件包。
mkdir -p /var/log/staticServer/nginx
chown -R ossuser:ossgroup /var/log/staticServer
mkdir -p /opt/onframework/staticServer
cp
/tmp/ManageOne静态虚拟机软件包
/opt/onframework/staticServer
步骤7 执行以下命令，解压ManageOne静态虚拟机软件包。
cd /opt/onframework/staticServer
unzip -q -o
/opt/onframework/staticServer/ManageOne静态虚拟机软件包
步骤8 执行以下命令，修改目录权限。
find /opt/onframework/staticServer/ -type d -print0 | xargs -0 chmod 750
find /opt/onframework/staticServer/ -type f -print0 | xargs -0 chmod 640
find /opt/onframework/staticServer/ -type f -name '*.py' -print0 | xargs -0
chmod 550
find /opt/onframework/staticServer/ -type f -name '*.sh' -print0 | xargs -0
chmod 550
chown -R ossuser:ossgroup /opt/onframework/
步骤9 执行以下命令，删除ManageOne静态虚拟机软件包。
rm -f
/opt/onframework/staticServer/ManageOne静态虚拟机软件包
步骤10 执行以下命令，切换至ossuser用户。
su ossuser
步骤11 执行以下命令，安装ManageOne静态虚拟机软件包。
sh /opt/onframework/staticServer/install/install.sh
当前虚拟机的节点IP地址
步骤12 执行以下命令，切换至root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤13 执行以下命令，注册monitor进程。
sed -i '/nginx_monitor.sh/d' /etc/crontab
echo '*/1 * * * * ossuser sh /opt/onframework/staticServer/bin/
nginx_monitor.sh check &> /dev/null' >> /etc/crontab
步骤14 执行以下命令，注册日志分割配置。
echo > /etc/logrotate.d/nginx
export logrotate_cfg="/var/log/staticServer/nginx/access.log\n
3

## Page 1446

/var/log/staticServer/nginx/error.log \n
/var/log/staticServer/nginx/monitor.log {\n
daily\n
create 0600 ossuser ossgroup\n
rotate 30\n
maxage 365\n
missingok\n
dateext\n
compress\n
notifempty\n
noolddir\n
dateformat -%Y%m%d.%s\n
}
"
echo -e ${logrotate_cfg} >> /etc/logrotate.d/nginx
logrotate /etc/logrotate.d/nginx
步骤15 执行以下命令，检查静态虚拟机的功能是否正常。
ps -ef | grep nginx
netstat -anp | grep 4858
若系统回显信息中同时存在进程和端口，说明静态虚拟机的功能正常。否则请联系技
术支持工程师协助处理。
步骤16 增加ssh白名单。
echo AllowUsers sopuser ossuser@192.168.0.1 ossuser@192.168.0.2
ossuser@192.168.0.3 ossuser@192.168.0.4 >> /etc/ssh/sshd_config
说明
● 192.168.0.1：为另一台正常的ManageOne-SubRegion-Static虚拟机IP地址，请根据实际IP
替换。
● 192.168.0.2：需要在参数信息汇总文件中获取，在汇总文件的“2.4 VM信息总览”页签中查
找“OM-SRV-01”参数对应的IP地址。
● 192.168.0.3：需要在参数信息汇总文件中获取，在汇总文件的“2.4 VM信息总览”页签中查
找“OM-SRV-02”参数对应的IP地址。
●
192.168.0.4：需要在参数信息汇总文件中获取，在汇总文件的“2.1 工具生成的ip参数”页
签中查找“DMK-Float-IP”参数对应的IP地址。
3

## Page 1447

步骤17 重启ssh服务。
service sshd restart
步骤18 恢复故障虚拟机的云服务静态资源。
rsync --delete -azP ossuser@192.168.0.1:/opt/onframework/static/ /opt/
onframework/static/
说明
192.168.0.1：为另一台正常的ManageOne-SubRegion-Static虚拟机IP地址，请根据实际IP替
换。
----结束
3.40
如何恢复
MORabbitMQService
服务故障
现象描述
当ManageOne-Service03或者ManageOne-Service04虚拟机故障时，在执行相关故障
恢复操作后，需要在ManageOne部署面“维护 > 运维管理 > 全景监控”的服务监控
页面的“服务”页签查看MORabbitMQService服务状态，若不是“正在运行”状态，
参考本章节恢复MORabbitMQService服务故障。
处理步骤
步骤1 使用PuTTY工具以sopuser用户登录MORabbitMQService服务部署节点。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
说明
MORabbitMQService服务部署节点为ManageOne-Service03和ManageOne-Service04，需要
在ManageOne-Service03和ManageOne-Service04节点上同步执行步骤2~步骤6。
步骤2 执行以下命令，切换到root用户。
sudo su root
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类后台”页签中，在对应
节点下该帐户的默认密码。
步骤3 执行以下命令，进入“/opt/share/Product/MORabbitMQService/mnesia”目录。
cd /opt/share/Product/MORabbitMQService/mnesia
步骤4 执行“ll”命令，查看文件列表。
步骤5 执行以下命令，清理缓存文件。
rm -rf rabbit@*
3

## Page 1448

步骤6 执行以下命令，重启MORabbitMQService服务。
su - ossadm -c "/opt/oss/manager/agent/bin/ipmc_adm -cmd restartapp -app
MORabbitMQService"
若系统回显信息如上图所示，则表明MORabbitMQService服务重启完成，否则，请联
系技术支持工程师协助解决。
步骤7 在ManageOne-Service03或者ManageOne-Service04任意一个节点上，执行以下命
令，查看rabbitmq集群状态。
cd /opt/oss/Product/apps/MORabbitMQService/
source envs/MORabbitMQService.properties
source bin/set_env
rabbitmqctl cluster_status
若系统回显信息如上图所示，则表明rabbitmq集群状态恢复正常，否则，请联系技术
支持工程师协助解决。
步骤8 在ManageOne-Service03或者ManageOne-Service04任意一个节点上，执行如下命
令，在rabbitmq服务中添加autoops和rts帐号。
说明
autoops和rts帐号的默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“B类
（ManageOne）”页签中，在对应节点下该帐户的默认密码。若密码已被修改，请使用修改过
后的密码创建帐号，否则会导致对应的业务无法访问rabbitmq。
cd /opt/oss/Product/apps/MORabbitMQService/bin
su ossuser
./create_machine_account.sh 'autoops'
'autoops帐号密码'
./create_machine_account.sh 'rts'
'rts帐号密码'
3

## Page 1449

若系统回显信息如上图所示，表示在rabbitmq中创建帐号成功，否则，请联系技术支
持工程师协助解决。
----结束
3.41
如何开启调用链功能
调用链功能在系统安装后初始为关闭状态，如需使用该功能，请参考如下步骤手动开
启。
操作步骤
使用PuTTY工具以sopuser用户通过SSH方式依次登录MOLog服务下
MOLogCenterService微服务所在的所有节点，并执行以下操作。
MOLogCenterService微服务所在节点的查询方法请参见3.15 如何查找服务所在节点
的IP地址。
步骤1 执行以下命令，切换到root用户。
sudo su root
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》的“A类后台”页签中，查找对
应节点下该帐户的默认密码。
步骤2 执行以下命令修改resource.properties配置文件。
vim /opt/oss/Product/apps/MOLogCenterService/webapps/ROOT/WEB-INF/
classes/resource.properties
说明
Product代表产品名称，产品名称为Product或ManageOne，请根据实际情况替换。
按键盘“i”键编辑，修改配置文件中如下参数的值：
dispatchGrayLogCollectTask=true
参数值为false表示关闭调用链功能，参数值为true表示开启调用链功能。
修改完成后按键盘“Esc”键退出编辑模式，输入“:wq!”保存修改。
步骤3 执行如下命令重启MOLogCenterService微服务。
su ossadm -c '. /opt/oss/manager/bin/engr_profile.sh && ipmc_adm -cmd
restartapp -app MOLogCenterService'
步骤4 执行如下命令，退出当前用户。
exit
----结束
3

## Page 1450

3.42
典型
Cinder
问题定位指导
3.42.1
排查
FusionSphere OpenStack
●
若是cinder模块发生错误，根据日志即可定位错误原因。
●
若是环境配置错误，参考文档手册，其中列出了常见问题的处理方法。
●
若是周边模块产生问题，则将日志信息传递给相关人员协同定位错误原因。
本文重点探讨cinder模块中错误的情形。
3.42.1.1
查询对应卷信息
步骤1 使用PuTTY，以“Reverse-Proxy”（在参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》的“2.1 工具生成的ip参数”页签中搜索）字段对应的
IP地址登录FusionSphere OpenStack节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤2 执行su root命令，输入root帐号密码，切换至root帐号。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤3 执行以下命令，导入环境变量。
source set_env
导入过程中，请输入1，选择环境变量“openstack
environment variable (keystone
v3)”，输入dc_admin帐户密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
步骤4 执行如下命令，查询卷详情。
cinder show volume_id
●
若返回“Service
Unavailable (HTTP
503)”，如图3-4所示，说明cinder-api服务
未启动。
a.
执行如下命令，启动cinder-api服务，如图3-5所示，启动服务大概需要几十
秒时间，请稍作等候。
cps host-template-instance-operate --action start --service cinder
cinder-api
b.
执行如下命令，查看服务的状态。
cps template-instance-list --service cinder cinder-api
c.
若仍旧未启动，查看/var/log/fusionsphere/component/cinder-api/cinder-
api_*.log日志，以及/var/log/fusionsphere/component/cinder-apiControl/
cinder-apiControl_*.log启动日志，排查失败原因。
d.
服务正常后，执行步骤4。
3

## Page 1451

图3-4
Service Unavailable
图3-5 启动cinder-api服务
●
若回显显示卷详情，则说明该卷未被删除。
执行如下命令，查询host的详细信息，如图3-6所示。
cinder show volume_id | zgrep host
图3-6 host信息
● 若回显信息类似图3-7，则说明该卷已被删除，执行以下步骤在数据库查看host详
细信息。
图3-7 卷被删除后的回显信息
a.
执行如下命令，查询数据库所在节点的IP地址，即“omip”对应的IP地址。
如图3-8所示。
cps template-instance-list --service gaussdb gaussdb
图3-8 数据库信息
b.
使用PuTTY，通过步骤4.a中查询到的IP地址（“status”为“active”的IP地
址）登录数据库主节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
c.
执行su root命令，输入root帐号密码，切换至root帐号。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页
签中，在对应节点下该帐户的默认密码。
d.
执行如下命令，导入环境变量。
source set_env
3

## Page 1452

导入过程中，请输入1，选择环境变量“openstack
environment variable
(keystone
v3)”，输入dc_admin帐户密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
e.
执行如下命令，登录数据库。
su gaussdba
f.
执行如下命令，进入数据库，并输入gaussdba帐户密码。
gsql -d cinder
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
g. 执行如下命令，查询该volume_id的host信息，如图3-9所示。
select host from volumes where id = 'volume_id';
图3-9 volume_id的host信息
通过上述操作可以获得host的信息。
●
若host信息不为“None”，说明调度成功已选择AZ。
参考3.42.1.4 查询cinder-volume日志查询cinder-volume日志进行错误定位。
●
若host信息为“None”，表示未选择到AZ，说明cinder-api或cinder-scheduler报
错，继续执行3.42.1.2 查看cinder-api日志进行错误定位。
----结束
3.42.1.2
查看
cinder-api
日志
步骤1 使用PuTTY，以“Reverse-Proxy”（在参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》的“2.1 工具生成的ip参数”页签中搜索）字段对应的
IP地址登录FusionSphere OpenStack节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤2 执行su root命令，输入root帐号密码，切换至root帐号。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤3 执行以下命令，导入环境变量。
source set_env
导入过程中，请输入1，选择环境变量“openstack
environment variable (keystone
v3)”，输入dc_admin帐户密码。
3

## Page 1453

默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
步骤4 执行如下命令，查询所有cinder-api控制节点的IP地址，即“omip”对应的所有IP地
址，如图3-10所示。
cps template-instance-list --service cinder cinder-api
图3-10 控制节点信息
步骤5 通过步骤4中查询到的IP地址依次登录所有cinder-api控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
说明
●
由于控制节点是分布式部署，需要对每一个控制节点进行查询。
●
所有控制节点均有cinder-api日志，上层下发的请求可能在任何一个节点上处理。
步骤6 执行su root命令，输入root帐号密码，切换至root帐号。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤7 执行以下步骤根据卷volume_id查找request id，定位处理请求的节点。
说明
●
因为节点处理该请求是随机分配的，所以在每个一个控制节点上都要根据卷volume_id查找
request
id。
● request
id格式为req-xxx。
1.
执行如下命令，查看cinder-api文件目录，如图3-11所示。
ll /var/log/fusionsphere/component/cinder-api
图3-11 cinder-api文件目录
3

## Page 1454

2.
执行如下命令，通过volume_id搜索日志文件查找request id。根据错误发生的时
间，匹配查找到的日志信息，获得request id，如图3-12所示。
zgrep volume_id /var/log/fusionsphere/component/cinder-api/*
图3-12 查找request
id
3.
执行如下命令，在该节点根据request id继续查询日志信息，根据ERROR字样，查
看报错信息，如图3-13所示。
zgrep req_id /var/log/fusionsphere/component/cinder-api/*
–
找到报错信息，则根据日志信息解决问题。
–
没有找到报错信息。
若是创建空白卷，或者使用镜像创卷产生错误（备份、快照创卷不涉及
cinder-scheduler过程），进入3.42.1.3 查看cinder-scheduler日志继续定
位。
图3-13 报错信息
----结束
3.42.1.3
查看
cinder-scheduler
日志
步骤1 使用PuTTY，以“Reverse-Proxy”（在参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》的“2.1 工具生成的ip参数”页签中搜索）字段对应的
IP地址登录FusionSphere OpenStack节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤2 执行su root命令，输入root帐号密码，切换至root帐号。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤3 执行以下命令，导入环境变量。
source set_env
导入过程中，请输入1，选择环境变量“openstack
environment variable (keystone
v3)”，输入dc_admin帐户密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
步骤4 执行如下命令，查询所有cinder-scheduler控制节点。
3

## Page 1455

cps template-instance-list --service cinder cinder-scheduler
步骤5 通过步骤4中查询到的IP地址依次登录所有cinder-scheduler控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤6 执行su root命令，输入root帐号密码，切换至root帐号。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤7 执行如下命令，在所有cinder-scheduler控制节点上，根据步骤7中获得的request id搜
索cinder-scheduler日志，根据错误发生的时间，找到ERROR字样，查看报错信息。
zgrep req_id /var/log/fusionsphere/component/cinder-scheduler/ *
步骤8 根据报错信息分析错误产生的原因并进行处理。
----结束
3.42.1.4
查询
cinder-volume
日志
若日志查询到了卷对应的后端存储，即host字段不为None，说明cinder-volume组件
报错。
操作步骤
步骤1 使用PuTTY，以“Reverse-Proxy”（在参数信息汇总文件
《xxx_export_all_v2_CN.xlsx》的“2.1 工具生成的ip参数”页签中搜索）字段对应的
IP地址登录FusionSphere OpenStack节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤2 执行su root命令，输入root帐号密码，切换至root帐号。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤3 如果该卷未被删除，执行如下命令，查询卷详情中的host信息，判断后端存储类型，
如图3-14所示。
cinder show volume_id | zgrep host
图3-14 卷详情中的host信息
步骤4 如果该卷已被删除，则需要在数据库查询host信息，判断后端存储类型。
3

## Page 1456

1.
执行如下命令，查询数据库所在节点的IP地址，即“omip”对应的IP地址。如图
3-15所示。
cps template-instance-list --service gaussdb gaussdb
图3-15 数据库信息
2.
使用PuTTY，通过步骤4.1中查询到的IP地址（“status”为“active”的IP地址）
登录数据库主节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
3.
执行su root命令，输入root帐号密码，切换至root帐号。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签
中，在对应节点下该帐户的默认密码。
4.
执行以下命令，导入环境变量。
source set_env
导入过程中，请输入1，选择环境变量“openstack
environment variable
(keystone
v3)”，输入dc_admin帐户密码。
默认密码：请参见《华为云Stack 8.1.0 帐户一览表》“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
5.
执行如下命令，登录数据库。
su gaussdba
6.
执行如下命令，进入数据库，并输入gaussdba帐户密码。
gsql -d cinder
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
7.
执行如下命令，查询该volume_id的host信息，如图3-16所示。
select host from volumes where id = 'volume_id';
图3-16 volume_id的host信息
步骤5 通过host的字段信息查询所有cinder-volume控制节点的IP地址，即使“omip”对应的
IP地址。如图3-17所示。
cps template-instance-list --service cinder cinder-volume-xxx
如果步骤4.7中查询的后端存储为cinder-vrm001，则cinder-volume-xxx为cinder-
volume-vrm001；如果查询到的是cinder-kvm001，则cinder-volume-xxx为cinder-
volume-kvm001。
3

## Page 1457

图3-17 后端存储节点
步骤6 通过步骤5中查询到的IP地址依次登录所有cinder-volume控制节点。
默认帐号：fsp
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤7 执行su root命令，输入root帐号密码，切换至root帐号。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》的“A类（后台）”页签中，在
对应节点下该帐户的默认密码。
步骤8 执行以下命令，导入环境变量。
source set_env
导入过程中，请输入1，选择环境变量“openstack
environment variable (keystone
v3)”，输入dc_admin帐户密码。
默认密码：请参见《华为云Stack
8.1.0
帐户一览表》“B类（FusionSphere
OpenStack）”页签中，该帐户对应的默认密码。
步骤9 执行如下命令，查询每个节点上的cinder-volume-xxx日志。
zgrep req_id /var/log/fusionsphere/component/cinder-volume-xxx/*
req_id
为步骤7中查询到的request id。
cinder-volume-xxx与步骤5中的配置相同。
步骤10 依据查询到的日志信息进行分析和处理。
----结束
3

